{"inframe":true,"title":"移动主页","hidden":false,"roles":{"demo":1,"default":1,"basic":1,"dev":1},"children":[{"configs":{"title":"首页","itemId":"xip.thome","head":"<style type=\"text/css\">    \n.x-hidebar .x-toolbar{display:none !important;}\n<\/style>\n<meta name=\"apple-mobile-web-app-title\" content=\"兴竹云ERP\">\n<link rel=\"shortcut icon\" href=\"images/xc.png\"/>\n<link rel=\"apple-touch-icon\" href=\"images/xc.png\"/>"},"events":{"finalize":"app.computeIconWidth();","initialize":"Wb.apply(app, {\n  viewCnt:0,\n  /**\n   * 添加系统返回前进按钮的历史记录。\n   * @param {Mixed} param 参数。如果参数类型为字符串则指定为url，否则指定为控件，并以其id作为url。\n   */\n  addHistory: function(param) {\n    if (param) {\n      app.history.add({\n        url: Ext.isString(param) ? param : param.getId()\n      }, true);\n    }\n  },\n  /**\n   * 按系统返回前进按钮时触发的事件。用户可以重载此方法以自定义系统返回前进按钮功能。\n   * @param {String} param 用户使用addHistory添加的参数或添加的控件itemId。\n   */\n  setHistory: function(param) {\n    if (Ext.getBody().down('div[class~=x-mask]:not([class~=x-item-hidden])')) {\n      //如果存在模态窗口禁止使用导航\n      app.disableSetHistory = true;\n      app.addHistory(app.container.getActiveItem());\n      return;\n    }\n    if (!param) {\n      if (app.container.getActiveItem() != app.appList)\n        app.container.setActiveItem(app.appList);\n      else\n        Wb.toast(Str.backToExit);\n      return;\n    }\n    var item = Ext.getCmp(param);\n    if (item)\n      app.container.setActiveItem(item);\n  },\n  computeIconWidth: function() {\n    var i, j, containerWidth = app.home.innerElement.getWidth() - 16,\n      minVal = containerWidth,\n      iconWidth = 80;\n    for (i = 80; i < 100; i++) {\n      j = containerWidth % i;\n      if (j < minVal) {\n        minVal = j;\n        iconWidth = i;\n      }\n    }\n    app.appIconWidth = iconWidth;\n  },\n  refreshApps: function() {\n    app.appList.store.load();\n  },\n  close: function() {\n    app.mainMenu.hide();\n    var item = app.container.getActiveItem();\n    //外部加载的模块\n    if (item.__url)\n      app.container.remove(item);\n  },\n  logout: function() {\n    Wb.request({\n      url: 'frameAction.do?method=logout',\n      success: function(resp) {\n        window.location.replace('./');\n      }\n    });\n  },\n  setTheme: function() {\n    var found, url = 'xip/touch/theme/theme.xwl';\n    Wb.run({\n      url: url,\n      success: function(scope) {\n        Wb.each(scope, function(k, v) {\n          if (v && (v.isViewport || v.initialConfig && v.initialConfig.isViewport)) {\n            var newCard = Ext.create('Ext.Container',{\n              xtype: 'container',\n              layout: 'fit',\n              title:'皮肤设置'\n            });\n            newCard.add(v);\n            newCard.__glyph = '&#xf0ce';\n            newCard.__image = '';\n            newCard.__title = '皮肤设置';\n            newCard.__url = url;\n            app.mainNav.push(newCard);\n            return false;\n          }\n        });\n      }\n    });\n  },\n  chgPwd: function() {\n    var found, url = 'xip/touch/chgPwd/chgPwd.xwl';\n    Wb.run({\n      url: url,\n      success: function(scope) {\n        Wb.each(scope, function(k, v) {\n          if (v && (v.isViewport || v.initialConfig && v.initialConfig.isViewport)) {\n            var newCard = Ext.create('Ext.Container',{\n              xtype: 'container',\n              layout: 'fit',\n              title:'修改密码'\n            });\n            newCard.add(v);\n            newCard.__glyph = '&#xf007';\n            newCard.__image = '';\n            newCard.__title = '修改密码';\n            newCard.__url = url;\n            app.mainNav.push(newCard);\n            return false;\n          }\n        });\n      }\n    });\n  }\n});\napp.history = new Ext.app.History({\n  listeners: {\n    change: function(url) {\n      if (app.disableSetHistory)\n        app.disableSetHistory = false;\n      else\n        app.setHistory(url);\n    }\n  }\n});\n"},"children":[{"configs":{"file":"m?xwl=xip/touch/wf/taskDtl","itemId":"task"},"children":[],"expanded":false,"type":"xwl"},{"configs":{"file":"m?xwl=xip/touch/notice/noticeDtl","itemId":"noticeDtl"},"children":[],"expanded":false,"type":"xwl"},{"configs":{"title":"待办","layout":"fit","itemId":"taskMain","iconCls":"compose","createInstance":"false"},"events":{"activate":"var grid = container.down('#taskList');\nvar text = container.down('#taskSearchTitle');\ngrid.store.load({params:{\"searchText\":text.getValue()}});"},"children":[{"configs":{"docked":"top","itemId":"toolbar1"},"children":[{"configs":{"placeHolder":"待办标题","xtype":"searchfield","itemId":"taskSearchTitle"},"events":{"action":"app.taskStore.load({params:{\"searchText\":text.getValue()}});"},"children":[],"expanded":false,"type":"ttext"}],"expanded":true,"type":"ttoolbar"},{"configs":{"cls":"x-hidebar","rowNumber":"true","itemId":"taskList"},"events":{"itemtap":"app.task.init(app.mainNav,record.data);\napp.mainNav.push(app.task._taskDtl);"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"xtype":"rownumberer","width":"30","itemId":"romNumCol"},"children":[],"expanded":false,"type":"tcolumn"},{"configs":{"text":"标题","width":"300","dataIndex":"TASKTITLE","itemId":"TASKTITLE"},"children":[],"expanded":false,"type":"tcolumn"},{"configs":{"text":"发起人","width":"100","dataIndex":"FROMUSERNAME","itemId":"FROMUSERNAME"},"children":[],"expanded":false,"type":"tcolumn"},{"configs":{"text":"日期","width":"120","dataIndex":"BEGINDATE","itemId":"BEGINDATE"},"children":[],"expanded":false,"type":"tcolumn"}],"expanded":true,"type":"array"},{"configs":{"storeName":"taskStore","itemId":"store","autoLoad":"false","url":"m?xwl=xip/touch/home/data/getTasks"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"tgrid"}],"expanded":false,"type":"tcontainer"},{"configs":{"title":"通知","layout":"fit","itemId":"notice","iconCls":"organize","createInstance":"false"},"events":{"show":"var noticeGrid = container.down('#noticeList');\nif(noticeGrid)\nnoticeGrid.store.load();\n"},"children":[{"configs":{"cls":"x-hidebar","rowNumber":"true","itemId":"noticeList"},"events":{"itemtap":"app.noticeDtl.init(app.mainNav,record.data);\napp.mainNav.push(app.noticeDtl._notice);","show":"grid.store.load();"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"xtype":"rownumberer","width":"30","itemId":"romNumCol"},"children":[],"expanded":false,"type":"tcolumn"},{"configs":{"text":"标题","width":"300","dataIndex":"NOTICE_TITLE","itemId":"noticeTitle"},"children":[],"expanded":false,"type":"tcolumn"},{"configs":{"text":"日期","width":"120","dataIndex":"CREATION_DATE","itemId":"sendDate"},"children":[],"expanded":false,"type":"tcolumn"}],"expanded":true,"type":"array"},{"configs":{"storeName":"noticeStore","itemId":"store","autoLoad":"false","url":"m?xwl=xip/touch/home/data/getNotices"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"tgrid"}],"expanded":false,"type":"tcontainer"},{"configs":{"title":"设置","layout":"fit","itemId":"setting","iconCls":"settings","createInstance":"false"},"children":[{"configs":{"itemTpl":"<div style='height:40px'><span class='wb_glyph'>&#x{glyph};<\/span>&nbsp;{text}<\/div>","scrollable":"false","itemId":"dataview1","padding":"8"},"events":{"itemtap":"record.get('handler')();"},"children":[{"configs":{"data":" [{\n   text: Str.logout,\n   glyph: 'f011',\n   handler: app.logout\n }, {\n   text: Str.refreshApps,\n   glyph: 'f021',\n   handler: app.refreshApps\n }, {\n   text: '皮肤设置',\n   glyph: 'f0ce',\n   handler: app.setTheme\n },{\n   text: '修改密码',\n   glyph: 'f007',\n   handler: app.chgPwd\n }]","itemId":"store","fields":"['text', 'glyph', 'handler']"},"children":[],"expanded":false,"type":"tstore"}],"expanded":true,"type":"tdataview"}],"expanded":false,"type":"tcontainer"},{"configs":{"appGlyph":"f015","layout":"fit","itemId":"viewport"},"children":[{"configs":{"itemId":"mainNav"},"events":{"pop":"app.viewCnt = app.viewCnt-1;\n","push":"app.viewCnt = app.viewCnt+1;"},"children":[{"configs":{"docked":"bottom","itemId":"toolbar1"},"children":[{"configs":{"itemId":"spacer1"},"children":[],"expanded":false,"type":"tspacer"},{"configs":{"ui":"plain","text":"首页","glyph":"f015","itemId":"btnHome"},"events":{"tap":"app.mainNav.pop(app.viewCnt);"},"children":[],"expanded":false,"type":"tbutton"},{"configs":{"ui":"plain","text":"待办","glyph":"f00b","itemId":"btnTask"},"events":{"tap":"var taskMain = app.mainNav.down('#taskMain');\nif (taskMain === null || taskMain === undefined) {\n  app.mainNav.push(app._taskMain);\n}else{\n  app.mainNav.setActiveItem(taskMain);\n}"},"children":[],"expanded":false,"type":"tbutton"},{"configs":{"ui":"plain","text":"通知","glyph":"f003","itemId":"btnNotice"},"events":{"tap":"var notice = app.mainNav.down('#notice');\nif (notice === null || notice === undefined) {\n  app.mainNav.push(app._notice);\n}else{\n  app.mainNav.setActiveItem(notice);\n}"},"children":[],"expanded":false,"type":"tbutton"},{"configs":{"ui":"plain","text":"设置","glyph":"f013","itemId":"btnSetting"},"events":{"tap":"var setting = app.mainNav.down('#setting');\nif (setting === null || setting === undefined) {\n  app.mainNav.push(app._setting);\n}else{\n  app.mainNav.setActiveItem(setting);\n}"},"children":[],"expanded":true,"type":"tbutton"},{"configs":{"itemId":"spacer2"},"children":[],"expanded":false,"type":"tspacer"}],"expanded":true,"type":"ttoolbar"},{"configs":{"title":"集成开发平台","layout":"fit","itemId":"home","iconCls":"home"},"children":[{"configs":{"cls":"dataview-inline","style":"background-color:white;","itemTpl":"<table width='{[app.appIconWidth]}px' style='table-layout:fixed;color:#737373;'>\n  <tr><td align='center' valign='middle' style='height:60px;'><div class='wb_glyph4 x-dv-item-pad' style='width:48px;height:48px;background-size:cover;background-image:url({image});'>{glyph}<\/div><\/td><\/tr>\n  <tr><td align='center' valign='top' style='height:30px;'><div style='font-size:13px;'>{title}<\/div><\/td><\/tr>  \n<\/table>","inline":"true","padding":"8","itemId":"appList"},"events":{"itemtap":"var found, url = record.get('url');\napp.mainNav.items.each(function(item) {\n  if (item.__url == url) {\n    found = true;\n    app.mainNav.setActiveItem(item);\n    return;\n  }\n});\nif (found)\n  return;\nWb.run({\n  url: url,\n  success: function(scope) {\n    Wb.each(scope, function(k, v) {\n      if (v && (v.isViewport || v.initialConfig && v.initialConfig.isViewport)) {\n        if(scope.init){\n          scope.init(app.mainNav);         \n        }\n         //app.toolbar1.show();\n        var newCard = Ext.create('Ext.Container',{\n          layout: 'fit',\n          title:record.get('title')\n        });\n        newCard.add(v);\n        newCard.__glyph = record.get('glyph');\n        newCard.__image = record.get('image');\n        newCard.__title = record.get('title');\n        newCard.__url = url;\n        app.mainNav.push(newCard);\n        return false;\n      }\n    });\n  }\n});"},"children":[{"configs":{"maskBindObject":"true","autoLoad":"true","itemId":"store","url":"m?xwl=xip/touch/home/data/get-apps","fields":"['title', 'image', 'glyph', 'url']"},"children":[],"expanded":false,"type":"tstore"}],"expanded":false,"type":"tdataview"}],"expanded":true,"type":"tcontainer"}],"expanded":true,"type":"tnavigate"}],"expanded":true,"type":"tviewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}