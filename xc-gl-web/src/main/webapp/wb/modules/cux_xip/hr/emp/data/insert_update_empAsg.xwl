{"inframe":false,"title":"分配信息的新增与修改","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"//为新增的数据加上ASG_ID\nvar id,ids=[],lds = [];\nvar rows = Wb.decode(request.getParameter('insertArray'));\nvar rec = Wb.decode(request.getParameter('insertLdEmpArray'));\n\nWb.each(rows,function(r) {\n    id = java.util.UUID.randomUUID();\n    r.ASG_ID = id;\n    ids.push({\n      ASG_ID: id\n    });\n});\nWb.each(rec,function(r) {\n    id = java.util.UUID.randomUUID();\n    r.LD_EMP_ID = id;\n    lds.push({\n      LD_EMP_ID: id\n    });\n});\napp.info(rec);\nrequest.setAttribute('insertArray', Wb.encode(rows)); //重置记录\nrequest.setAttribute('insertLdEmpArray', Wb.encode(rec)); //重置记录\napp.send(ids); //把id列表发送到客户端以同步到表格\napp.send(lds); //把id列表发送到客户端以同步到表格\n","itemId":"module"},"children":[{"configs":{"sql":"insert into xc_gl_ld_emps\n  (ld_emp_id,\n   emp_id,\n   ledger_id,\n   is_enabled,\n   creation_date,\n   created_by,\n   last_update_date,\n   last_updated_by\n )\nvalues\n  ({?LD_EMP_ID?},\n   {?EMP_ID?},\n   {?LEDGER_ID?},\n   1,\n   {?timestamp.sys.date?},\n   {?XIP.userId?},\n   {?timestamp.sys.date?},\n   {?XIP.userId?}\n  )","transaction":"start","arrayName":"insertLdEmpArray","itemId":"inertLdEmp"},"children":[],"expanded":false,"type":"query"},{"configs":{"sql":"insert into xip_pub_emp_asg\n  (\n   asg_id,\n   emp_id,\n   post_id,\n   dept_id,\n   org_id,\n   enabled,\n   creation_date,\n   created_by,\n   last_update_date,\n   last_updated_by,\n   post_seq)\nvalues\n  ({?ASG_ID?},\n   {?EMP_ID?},\n   {?POST_ID?},\n   {?DEPT_ID?},\n   {?ORG_ID?},\n   {?ENABLED?},\n   {?timestamp.sys.date?},\n   {?XIP.userId?},\n   {?timestamp.sys.date?},\n   {?XIP.userId?},\n   'N'\n  )","transaction":"start","arrayName":"insertArray","itemId":"inertEmpAsg"},"children":[],"expanded":true,"type":"query"},{"configs":{"sql":"update xip_pub_emp_asg\n   set emp_id            = {?EMP_ID?},\n       post_id           = {?POST_ID?},\n       dept_id           = {?DEPT_ID?},\n       org_id            = {?ORG_ID?},\n       enabled           = {?ENABLED?},\n       last_update_date  = {?timestamp.sys.date?},\n       last_updated_by   = {?XIP.userId?},\n       last_update_login = {?XIP.userId?}\n where asg_id = {?ASG_ID?}\n","transaction":"start","arrayName":"updateArray","itemId":"updateEmpAsg"},"children":[],"expanded":false,"type":"query"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}