{"title":"Function Management(函数管理)","inframe":false,"hidden":false,"roles":{"default":1},"pageLink":"","children":[{"configs":{"title":"{#moduleTitle#}","serverScript":"request.setAttribute(\"contextPath\", request.getContextPath());\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/rep/base-settings/functions/functionManage\");","itemId":"module"},"events":{"initialize":"var isNew=true;     //是否新增记录标记\nvar isNewSql=true;  //是否新增记录标记-参数编辑窗口\nvar isDrag = false;\t//参数表格是否拖拽标志\n\nfunction paramGridSave(fun_Id){\nif (!Wb.verifyGrid(app.paramGrid)) //验证数据是否合法\n  return;\n  \nWb.sync({\n  grid: app.paramGrid,\n  url: 'm?xwl=xsr/repBase/repFormulaManage/repFunReg/repFunReg/db/save_Param',\n  params:{fun_id:funId},\n  message: '正在保存中...',\n  success: function(resp) {\n    //ID_FIELD值在后台生成，把返回的ID_FIELD值列表同步到表格中\n    Wb.syncCreate(app.paramGrid, Wb.decode(resp.responseText));\n  }\n});\n}\n\n//判断是否存在引用参数设置\nfunction containRelaPara(str,type){\n  //var regu= /{\\w+}/i;  //g:全文检索，i:不区别大小写\n  var regu;\n  if (type==='P') {regu= /{\\w+}/i;}   //级联参数\n //if (type=='S') {regu=/$\\W+$/i;}   //会话变量,直接在sql里写{?suitId?}即可\n  var re   = new RegExp(regu);   \n\n  if   (str.search(re)   !=  -1)      \n  {     \n    return re.exec(str)+'';   \n  }     \n  else     \n  {   \n    return '';\n  }\n} \n"},"children":[{"configs":{"itemId":"functionButtons"},"children":[{"configs":{"text":"{#saveBtn#}","itemId":"btnSave","iconCls":"save_icon"},"events":{"click":"/*\n *自定义函数保存\n *1、新增\n *2、修改\n */\nif(!app.paramForm.getForm().isValid()){\n  Wb.info('{#la_mustFillTip#}');\n  return false;\n}\nif(isNew===true) {\n var _addFuntion = {\n     'FUN_ID':'',\n     'FUNC_TYPE':app.FUN_TYPE.getValue(),\n     'FUNC_CODE':app.FUN_CODE.getValue(),\n     'FUNC_NAME':app.FUN_NAME.getValue(),\n     'FUNC_DESC':app.FUN_DESC.getValue(),\n     'FUNC_CALTYPE':app.FUN_CALTYPE.getValue(),\n     'FUNC' : app.FUNC.getValue(),\n     'ENABLED':app.ENABLE_FLAG.getValue()\n };\n Wb.request({\n   url: 'm?xwl=xc/rep/base-settings/functions/db/insert_function',\n   params:_addFuntion,\n   success: function(resp) {\n     var res=Wb.decode(resp.responseText);\n     app.FUN_ID.setValue(res.PRIMARY_KEY);\n     app.FUN_CODE.setReadOnly(true);\n     isNew = false;\n     Wb.info('{#la_saveSuccess#}');\n   }\n });\n}else{\n   var _editFuntion = {\n     'FUN_ID':app.FUN_ID.getValue(),\n     'FUNC_TYPE':app.FUN_TYPE.getValue(),\n     'FUNC_NAME':app.FUN_NAME.getValue(),\n     'FUNC_DESC':app.FUN_DESC.getValue(),\n     'FUNC_CALTYPE':app.FUN_CALTYPE.getValue(),\n     'FUNC' : app.FUNC.getValue(),\n     'ENABLED':app.ENABLE_FLAG.getValue()\n };\n Wb.request({\n   url: 'm?xwl=xc/rep/base-settings/functions/db/update_function',\n   params:Wb.encode(_editFuntion),\n   success: function(resp) {\n     Wb.info('{#la_saveSuccess#}');\n   }\n });\n}\n"},"children":[],"type":"button","expanded":false},{"configs":{"text":"{#cancelBtn#}","itemId":"btnClose","iconCls":"cancel_icon"},"events":{"click":"app.functionAddWin.close();"},"children":[],"type":"button","expanded":false}],"type":"array","expanded":true},{"configs":{"itemId":"windows"},"children":[{"configs":{"height":"500","layout":"border","width":"850","buttonAlign":"center","dialog":"false","itemId":"functionAddWin","modal":"true","maximizable":"true","createInstance":"false"},"events":{"show":"app.labelDesc.setText('{#la_girdTips#}',false);\nif (isNew === true) {\n  win.setTitle('{#addLabel#}');\n  win.setIconCls('record_add_icon');\n  \n} else {\n  win.setTitle('{#editLabel#}');\n  win.setIconCls('record_edit_icon');\n}","close":"/*窗口关闭时的操作\n *1、还原参数表格拖动标识\n *2、若参数表格发生过拖动，保存拖动后的参数顺序，否则不进行相关操作\n */\nif(isDrag){\n  Wb.request({\n    url:'m?xwl=xc/rep/base-settings/functions/db/update_param_order',\n    params:{modify:Wb.getData(app.paramGrid.getStore(),true)}\n  });\n}\nisDrag = false;\napp.queryBtn.fireEvent('click');"},"children":[{"configs":{"region":"north","style":"border-width:0px","buttonAlign":"center","buttons":"app.functionButtons","bodyPadding":"10","border":"true","itemId":"paramForm"},"children":[{"configs":{"height":"30","layout":"column","columnWidth":"1","border":"false","itemId":"tr1"},"children":[{"configs":{"labelWidth":"80","hidden":"true","labelAlign":"right","itemId":"FUN_ID"},"children":[],"type":"text","expanded":true},{"configs":{"tagConfigs":"columnWidth:0.45","labelWidth":"{#labelWidth#}","allowBlank":"false","labelAlign":"right","itemId":"FUN_CODE","fieldLabel":"{#la_necessaryCode#}"},"children":[],"type":"text","expanded":true},{"configs":{"tagConfigs":"columnWidth:0.45","labelWidth":"{#bigLabelWidth#}","allowBlank":"false","labelAlign":"right","itemId":"FUN_NAME","fieldLabel":"{#la_necessaryName#}"},"children":[],"type":"text","expanded":true}],"type":"panel","expanded":true},{"configs":{"height":"30","layout":"column","columnWidth":"1","border":"false","itemId":"tr2"},"children":[{"configs":{"tagConfigs":"columnWidth:0.45","labelWidth":"{#labelWidth#}","allowBlank":"false","displayField":"VAL_NAME","valueField":"VAL_CODE","labelAlign":"right","itemId":"FUN_TYPE","fieldLabel":"{#la_necessaryType#}"},"children":[{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=xc/rep/rep-common/select-func-type"},"children":[],"type":"store","expanded":false}],"type":"combo","expanded":false},{"configs":{"tagConfigs":"columnWidth:0.45","labelWidth":"{#bigLabelWidth#}","allowBlank":"false","labelAlign":"right","itemId":"FUNC","fieldLabel":"{#la_necessaryMethod#}"},"children":[],"type":"text","expanded":true}],"type":"panel","expanded":true},{"configs":{"height":"30","layout":"column","columnWidth":"1","border":"false","itemId":"tr3"},"children":[{"configs":{"tagConfigs":"columnWidth:0.45","labelWidth":"{#labelWidth#}","allowBlank":"false","displayField":"VAL_NAME","valueField":"VAL_CODE","labelAlign":"right","itemId":"FUN_CALTYPE","fieldLabel":"{#la_necessrayOperate#}"},"children":[{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=xc/rep/rep-common/select-fetch-data-type"},"children":[],"type":"store","expanded":false}],"type":"combo","expanded":true},{"configs":{"tagConfigs":"columnWidth:0.45","labelWidth":"{#bigLabelWidth#}","labelAlign":"right","itemId":"FUN_DESC","fieldLabel":"{#la_functionDesc#}"},"children":[],"type":"text","expanded":true}],"type":"panel","expanded":true},{"configs":{"height":"30","layout":"column","columnWidth":"1","border":"false","itemId":"tr4"},"children":[{"configs":{"tagConfigs":"columnWidth:0.45","labelWidth":"{#labelWidth#}","displayField":"VAL_NAME","value":"Y","valueField":"VAL_CODE","labelAlign":"right","itemId":"ENABLE_FLAG","fieldLabel":"{#la_isEnable#}"},"children":[{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=xc/rep/rep-common/select-yn"},"children":[],"type":"store","expanded":false}],"type":"combo","expanded":true}],"type":"panel","expanded":true}],"type":"form","expanded":true},{"configs":{"region":"center","pagingBar":"false","selType":"checkboxmodel","itemId":"paramGrid","viewConfig":"{\n  plugins: {\n    ptype: 'gridviewdragdrop'\n  },\n  listeners: {\n    beforedrop: function(node, data, overModel, dropPosition, dropHandlers) {\n    },\n    drop: function(node, data, overModel, dropPosition, eOpts) {\n      isDrag = true;\n      var _newOrder = 1;\n      var paramStore = app.paramGrid.getStore() ;\n      paramStore.each(function(record){\n        record.set('PARAM_ORDER',_newOrder) ;\n        _newOrder ++;\n      });\n      paramStore.commitChanges() ;\n    }\n  }\n}"},"events":{"itemdblclick":"app.btnEditParam.fireEvent('click') ;"},"children":[{"configs":{"pageSize":"-1","autoLoad":"false","itemId":"store","url":"m?xwl=xc/rep/base-settings/functions/db/query_function_params"},"children":[],"type":"store","expanded":true},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#addBtn#}","itemId":"btnAddParam","iconCls":"table_add_icon"},"events":{"click":"if (app.FUN_ID.getValue()===\"\") {\n  Wb.info('{#la_saveFunTip#}');\n}else{\n  var win=new Ext.window.Window(app._paramWin_Sql);\n  win.show();\n  win.setTitle('{#la_addParams#}');\n  win.setIconCls('record_add_icon');\n  app.winParamOrder.setValue(1);\n  app.winParamId.setValue('-1');\n  app.paramFunId.setValue(app.FUN_ID.getValue());\n}\n\n"},"children":[],"type":"item","expanded":true},{"configs":{"text":"{#editBtn#}","itemId":"btnEditParam","iconCls":"table_edit_icon"},"events":{"click":"var recs = app.paramGrid.getSelection();\nif (recs.length!=1) {\n  Wb.warn('{#la_selectTip#}');\n  return;\n}else{\n  var win=new Ext.window.Window(app._paramWin_Sql);\n  win.show();\n  win.setTitle('{#la_editParams#}');\n  win.setIconCls('record_edit_icon');\n  app.winParamOrder.setValue(recs[0].data.PARAM_ORDER);\n  app.winParamId.setValue(recs[0].data.PARAM_ID);\n  app.paramFunId.setValue(recs[0].data.FUNC_ID);\n  app.winParamCode.setValue(recs[0].data.PARAM_CODE);\n  app.winParamName.setValue(recs[0].data.PARAM_NAME);\n  app.winParamDesc.setValue(recs[0].data.PARAM_DESC);\n  app.winParamSql.setValue(recs[0].data.PARAM_LOV);\n  app.winEnabledFlag.setValue(recs[0].data.ENABLED);\n  app.winMandatory.setValue(recs[0].data.MANDATORY);\n  app.winParamCode.setReadOnly(true);\n}\n\n\n"},"children":[],"type":"item","expanded":true},{"configs":{"text":"{#deleteBtn#}","itemId":"btnDelParam","iconCls":"delete_icon"},"events":{"click":"var recs = app.paramGrid.getSelection();\nWb.request({\n  url:'m?xwl=xc/rep/base-settings/functions/db/delete_params',\n  params:{'destory':Wb.getData(recs),'FUNC_CODE':app.FUN_CODE.getValue()},\n  success:function(resp){\n    Wb.info('{#la_delSuccTips#}');\n    Wb.remove(app.paramGrid);\n  },\n  failure:function(resp){\n    Wb.info('{#la_delFailTips#}');\n  }\n});"},"children":[],"type":"item","expanded":true},{"configs":{"text":"->","itemId":"step"},"children":[],"type":"item","expanded":false},{"configs":{"itemId":"labelDesc"},"children":[],"type":"label","expanded":false}],"type":"toolbar","expanded":true},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#rownum#}","width":"50","align":"center","xtype":"rownumberer","itemId":"rownum"},"children":[],"type":"column","expanded":true},{"configs":{"hidden":"true","dataIndex":"FUN_ID","titleAlign":"center","itemId":"fun_id"},"children":[],"type":"column","expanded":true},{"configs":{"hidden":"true","dataIndex":"PARAM_ID","titleAlign":"center","itemId":"par_id"},"children":[],"type":"column","expanded":true},{"configs":{"text":"{#la_functionCode#}","width":"130","dataIndex":"PARAM_CODE","titleAlign":"center","itemId":"par_code"},"children":[],"type":"column","expanded":true},{"configs":{"text":"{#la_functionName#}","width":"180","dataIndex":"PARAM_NAME","titleAlign":"center","itemId":"par_name"},"children":[],"type":"column","expanded":true},{"configs":{"text":"{#la_paramCodeOrder#}","align":"center","width":"60","dataIndex":"PARAM_ORDER","titleAlign":"center","itemId":"par_no"},"children":[],"type":"column","expanded":false},{"configs":{"text":"{#la_paramSql#}","width":"220","dataIndex":"PARAM_LOV","titleAlign":"center","itemId":"par_lov"},"children":[],"type":"column","expanded":true},{"configs":{"text":"{#la_isEnable#}","align":"center","width":"80","dataIndex":"ENABLED_NAME","titleAlign":"center","itemId":"enable_flag"},"children":[],"type":"column","expanded":true},{"configs":{"text":"{#la_mandatory#}","align":"center","width":"80","dataIndex":"MANDATORY_NAME","titleAlign":"center","itemId":"mandatory"},"children":[],"type":"column","expanded":true}],"type":"array","expanded":true}],"type":"grid","expanded":true}],"type":"window","expanded":true},{"configs":{"height":"400","width":"500","layout":"fit","buttonAlign":"center","dialog":"true","itemId":"paramWin_Sql","modal":"true","createInstance":"false"},"events":{"show":"app.label2.setText(app.FUN_NAME.getValue(),false);\n","close":"Wb.reload(app.paramGrid);"},"children":[{"configs":{"itemId":"buttons"},"children":[{"configs":{"text":"{#saveBtn#}","itemId":"saveParamBtn","iconCls":"save_icon"},"events":{"click":"/*函数参数保存\n *新增\n *编辑\n */\nif(!app.functionParamForm.getForm().isValid()){\n  Wb.warn('{#la_mustFillTip#}');\n  return false;\n}\nif(app.winParamId.getValue() === '-1'){\n  var _paramObject = {\n    'PARAM_ID':'',\n    'FUNC_ID' : app.paramFunId.getValue(),\n    'PARAM_CODE' : app.winParamCode.getValue(),\n    'PARAM_NAME' : app.winParamName.getValue(),\n    'PARAM_DESC' : app.winParamDesc.getValue(),\n    'PARAM_ORDER': app.winParamOrder.getValue(),\n    'PARAM_LOV'  : app.winParamSql.getValue(),\n    'ENABLED': app.winEnabledFlag.getValue(),\n    'MANDATORY': app.winMandatory.getValue()\n  };\n  Wb.request({\n    url:'m?xwl=xc/rep/base-settings/functions/db/insert_fun_param',\n    params:_paramObject,\n    success:function(response){\n      Wb.info('{#la_saveSuccess#}');\n      app.paramWin_Sql.close();\n    }\n  });\n}else{\n    var _paramObject = {\n    'PARAM_ID':app.winParamId.getValue(),\n    'PARAM_NAME' : app.winParamName.getValue(),\n    'PARAM_DESC' : app.winParamDesc.getValue(),\n    'PARAM_ORDER': app.winParamOrder.getValue(),\n    'PARAM_LOV'  : app.winParamSql.getValue(),\n    'ENABLED': app.winEnabledFlag.getValue(),\n    'MANDATORY': app.winMandatory.getValue()\n  };\n  Wb.request({\n    url:'m?xwl=xc/rep/base-settings/functions/db/update_fun_param',\n    params:_paramObject,\n    success:function(response){\n      Wb.info('{#la_saveSuccess#}');\n      app.paramWin_Sql.close();\n    }\n  });\n}"},"children":[],"type":"button","expanded":true},{"configs":{"text":"{#cancelBtn#}","itemId":"cancelParamBtn","iconCls":"cancel_icon"},"events":{"click":"app.paramWin_Sql.close();"},"children":[],"type":"button","expanded":true}],"type":"array","expanded":true},{"configs":{"bodyStyle":"background:transparent;","style":"border-width:0px","layout":"form","border":"false","itemId":"functionParamForm"},"children":[{"configs":{"bodyStyle":"background:transparent;","layout":"column","itemId":"panel4"},"children":[{"configs":{"text":"{#la_functionLabel#}：","margin":"8 0 0 150","itemId":"label1"},"children":[],"type":"label","expanded":true},{"configs":{"margin":"8 0 0 0","itemId":"label2"},"children":[],"type":"label","expanded":true}],"type":"panel","expanded":true},{"configs":{"bodyStyle":"background:transparent;","border":"false","itemId":"panel1"},"children":[{"configs":{"hidden":"true","itemId":"paramFunId"},"children":[],"type":"text","expanded":true},{"configs":{"labelWidth":"80","hidden":"true","labelAlign":"right","itemId":"winParamId"},"children":[],"type":"text","expanded":true},{"configs":{"labelWidth":"{#bigLabelWidth#}","allowBlank":"false","width":"450","labelAlign":"right","itemId":"winParamCode","fieldLabel":"{#la_neParaCode#}"},"children":[],"type":"text","expanded":true},{"configs":{"labelWidth":"{#bigLabelWidth#}","allowBlank":"false","width":"450","labelAlign":"right","itemId":"winParamName","fieldLabel":"{#la_neParaName#}"},"children":[],"type":"text","expanded":true},{"configs":{"labelWidth":"{#bigLabelWidth#}","width":"450","labelAlign":"right","itemId":"winParamDesc","fieldLabel":"{#la_paramDesc#}"},"children":[],"type":"text","expanded":true},{"configs":{"labelWidth":"{#bigLabelWidth#}","height":"85","width":"450","labelAlign":"right","itemId":"winParamSql","fieldLabel":"{#la_paramSql#}"},"children":[],"type":"textarea","expanded":true}],"type":"panel","expanded":true},{"configs":{"bodyStyle":"background:transparent;","layout":"column","border":"false","itemId":"panel2"},"children":[{"configs":{"labelWidth":"{#smallLabelWidth#}","displayField":"VAL_NAME","width":"150","valueField":"VAL_CODE","value":"Y","labelAlign":"right","itemId":"winEnabledFlag","fieldLabel":"{#la_isEnable#}"},"children":[{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=xc/rep/rep-common/select-yn"},"children":[],"type":"store","expanded":false}],"type":"combo","expanded":true},{"configs":{"labelWidth":"{#smallLabelWidth#}","displayField":"VAL_NAME","width":"150","valueField":"VAL_CODE","value":"Y","labelAlign":"right","itemId":"winMandatory","fieldLabel":"{#la_mandatory#}"},"children":[{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=xc/rep/rep-common/select-yn"},"children":[],"type":"store","expanded":false}],"type":"combo","expanded":true},{"configs":{"labelWidth":"{#smallLabelWidth#}","minValue":"0","width":"150","labelAlign":"right","itemId":"winParamOrder","fieldLabel":"{#la_paramCodeOrder#}"},"children":[],"type":"number","expanded":false}],"type":"panel","expanded":true},{"configs":{"itemId":"panel3"},"children":[{"configs":{"width":"450","html":"<b>【注意】:<\/b><font color=blue>1、动态参数<font color=\"red\">{?参数名称?}<\/font>，参数名称与\"{?\"和\"?}\"之间不能存在<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n空格且参数名称与[<a href='{#contextPath#}/SessionListController.do?method=getSessionParams' target='_blank' style='color:red;'>Session会话<\/a>]的变量名称一致；<br><br>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n2、级联参数<font color=\"red\">{{参数名称}}<\/font>，参数名称与\"{{\"和\"}}\"之间不能存在空格。<br><br>\n","labelAlign":"left","itemId":"lblInfo"},"children":[],"type":"label","expanded":true}],"type":"panel","expanded":true}],"type":"form","expanded":true}],"type":"window","expanded":true}],"type":"folder","expanded":true},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","style":"border-width:0px","layout":"column","bodyPadding":"10","border":"false","itemId":"queryForm"},"children":[{"configs":{"layout":"fit","columnWidth":".25","border":"false","itemId":"td1"},"children":[{"configs":{"labelWidth":"{#labelWidth#}","labelAlign":"right","itemId":"functionCode","fieldLabel":"{#la_functionCode#}"},"events":{"specialkey":"if(e.getKey() == 13){\n  app.queryBtn.fireEvent('click') ;\n}"},"children":[],"type":"text","expanded":false}],"type":"panel","expanded":true},{"configs":{"layout":"fit","columnWidth":".25","border":"false","itemId":"td2"},"children":[{"configs":{"labelWidth":"{#labelWidth#}","labelAlign":"right","itemId":"functionName","fieldLabel":"{#la_functionName#}"},"events":{"specialkey":"if(e.getKey() == 13){\n  app.queryBtn.fireEvent('click') ;\n}"},"children":[],"type":"text","expanded":false}],"type":"panel","expanded":true},{"configs":{"layout":"column","columnWidth":".2","border":"false","itemId":"td3"},"children":[{"configs":{"text":"{#queryBtn#}","margin":"0 10 0 20","itemId":"queryBtn","iconCls":"seek_icon"},"events":{"click":"app.functionGrid.store.load({\n  out:app.queryForm\n});"},"children":[],"type":"button","expanded":false},{"configs":{"text":"{#resetBtn#}","itemId":"resetBtn","iconCls":"refresh_icon"},"events":{"click":"app.queryForm.getForm().reset();\napp.functionGrid.getStore().load();\n"},"children":[],"type":"button","expanded":false}],"type":"panel","expanded":true}],"type":"form","expanded":true},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"functionGrid","viewConfig":"{\n enableTextSelection:true\n}"},"events":{"itemdblclick":"app.btnEdit.fireEvent('click');"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#addBtn#}","itemId":"btnAdd","iconCls":"file_add_icon"},"events":{"click":"isNew=true;\nvar win=new Ext.window.Window(app._functionAddWin);\nwin.show();\napp.paramGrid.store.reload();\n"},"children":[],"type":"item","expanded":false},{"configs":{"text":"{#editBtn#}","itemId":"btnEdit","iconCls":"file_edit_icon"},"events":{"click":"isNew=false;\nvar recs = app.functionGrid.getSelection();\nif (recs.length!=1) {\n  Wb.warn('{#la_selectTip#}');\n  return;\n}\nvar win=new Ext.window.Window(app._functionAddWin);\nwin.show();\nvar fun_id=recs[0].data.FUNC_ID;\napp.paramGrid.store.load({params:{'FUN_ID':fun_id}});\napp.FUN_CODE.setReadOnly(true);\napp.FUN_ID.setValue(fun_id);\napp.FUN_NAME.setValue(recs[0].data.FUNC_NAME);\napp.FUN_CODE.setValue(recs[0].data.FUNC_CODE);\napp.FUN_TYPE.setValue(recs[0].data.FUNC_TYPE);\napp.FUNC.setValue(recs[0].data.FUNC);\napp.FUN_CALTYPE.setValue(recs[0].data.FUNC_CALTYPE);\napp.FUN_DESC.setValue(recs[0].data.FUNC_DESC);\napp.ENABLE_FLAG.setValue(recs[0].data.ENABLED);\n"},"children":[],"type":"item","expanded":false},{"configs":{"text":"{#deleteBtn#}","itemId":"btnDelete","iconCls":"delete_icon"},"events":{"click":"/*函数删除\n *1、为了校验正常进行，一次只能删除一条记录\n *2、若函数已经被公式引用，不能删除\n */\nvar recs = app.functionGrid.getSelection();\nif(recs.length !== 1){\n  Wb.warn('{#la_selectTip#}');\n  return;\n}\nWb.request({\n  url:'m?xwl=xc/rep/base-settings/functions/db/delete_function',\n  params:{'FUN_ID':recs[0].data.FUNC_ID,'FUNC_CODE':recs[0].data.FUNC_CODE},\n  success:function(resp){\n    Wb.info('{#la_delSuccTips#}');\n    Wb.remove(app.functionGrid);\n  },\n  failure:function(resp){\n    Wb.info('{#la_delFailTips#}');\n  }\n});"},"children":[],"type":"item","expanded":true}],"type":"toolbar","expanded":true},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#rownum#}","width":"45","xtype":"rownumberer","align":"center","itemId":"rowNo"},"children":[],"type":"column","expanded":false},{"configs":{"text":"FUN_ID","hidden":"true","dataIndex":"FUNC_ID","itemId":"FUN_ID_COL"},"children":[],"type":"column","expanded":false},{"configs":{"text":"{#la_functionCode#}","width":"150","dataIndex":"FUNC_CODE","titleAlign":"center","itemId":"FUN_CODE_COL"},"children":[],"type":"column","expanded":false},{"configs":{"text":"{#la_functionName#}","width":"200","dataIndex":"FUNC_NAME","titleAlign":"center","itemId":"FUN_NAME_COL"},"children":[],"type":"column","expanded":false},{"configs":{"text":"{#la_functionType#}","width":"140","dataIndex":"FUNC_TYPE_NAME","titleAlign":"center","itemId":"FUN_TYPE_COL"},"children":[],"type":"column","expanded":false},{"configs":{"text":"{#la_functionRemote#}","width":"300","dataIndex":"FUNC","titleAlign":"center","itemId":"FUN_DB_SUB_COL"},"children":[],"type":"column","expanded":false},{"configs":{"text":"{#la_operateType#}","width":"120","dataIndex":"FUNC_CALTYPE_NAME","titleAlign":"center","itemId":"FUN_CALTYPE_COL"},"children":[],"type":"column","expanded":false},{"configs":{"text":"{#la_functionDesc#}","width":"200","dataIndex":"FUNC_DESC","titleAlign":"center","itemId":"FUN_DESC_COL"},"children":[],"type":"column","expanded":false},{"configs":{"text":"{#la_isEnable#}","width":"80","dataIndex":"ENABLE_FLAG_NAME","titleAlign":"center","itemId":"ENABLE_FLAG_COL"},"children":[],"type":"column","expanded":false}],"type":"array","expanded":true},{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xc/rep/base-settings/functions/db/query_functions"},"children":[],"type":"store","expanded":false}],"type":"grid","expanded":true}],"type":"viewport","expanded":true}],"type":"module","expanded":true}],"iconCls":""}