{"inframe":true,"title":"忘记密码","hidden":false,"roles":{"default":1},"children":[{"configs":{"cssLinks":"[\"xip/login/css/cssLogin2.css\"]","loginRequired":"false","loadJS":"ext+bootstrap","initScript":"var ctxPath = request.getContextPath();\nrequest.setAttribute(\"contextPath\",ctxPath);","serverScript":"//var serverUrl = com.xzsoft.xip.platform.util.PlatformUtil.getXipConfigVal(\"cas.casServerUrl\");\nvar serverUrl = com.xzsoft.xip.platform.util.PlatformUtil.getCasClient();\nrequest.setAttribute('serverUrl',serverUrl);","itemId":"module","head":"<meta name=\"viewport\"  content=\"width=device-width,initial-scale=1.0\"> \n<!-- <script>\n  function keydown(e){\n\tvar currKey=0,e=e||event;\n\tif(e.keyCode==13){\n      app.modify();\n\t}\n}\n  document.onkeydown = keydown;\n<\/script> -->"},"events":{"initialize":"//获取window的高度和容器DIV的高度,给DIV设置margin 让其上下居中\n// var bodyHeight = document.getElementById(\"container\").offsetHeight;\n// var windowHeight = window.innerHeight;\n// var height = (windowHeight-bodyHeight)/2;\n// document.getElementById(\"container\").style.margin=height+'px'+' 0px'+' 0px'+' 0px';\ndocument.getElementById(\"backLogin\").href = '{#serverUrl#}';\napp.modify = function(){\n  var name = document.getElementById('userNameOrEmail').value;\n  if(name.split('.').length==1){\n     name = name.toUpperCase();\n  }\n  if(Ext.isEmpty(name)){\n     document.getElementById('alertInfo').innerHTML = '请输入用户名或邮箱';\n     return false;\n  }\n//   if(name.split('.').length>1){\n//     //邮箱\n//     app.store.getProxy().url='m?xwl=xip/login/data/getUserInfoByEmail';\n//     app.store.load({params:{email:name},callback:function(){\n//        if(app.store.getCount>0){\n//          var start = app.store.getAt(0).get('START_DATE');\n//          var end = app.store.getAt(0).get('END_DATE');\n//          if(start.toString()==end.toString()){\n//             document.getElementById('alertInfo').innerHTML = '用户未激活';\n//             return false;\n//          }else{\n//               Ext.Ajax.request({ \n//                 url  : '{#contextPath#}'+'/platformAction.do?method=resetPassword',\n//                 method:'post',\n//                 params:{userName:name},\n//                 success: function(response,options){\n//                   var respText = Ext.JSON.decode(response.responseText);\n//                   document.getElementById('alertInfo').innerHTML = respText.msg;\n//                },\n//                failure : function(response,options){\n//                   document.getElementById('alertInfo').innerHTML = '服务器无响应';\n//                }\n//              });\n//          }\n//        }\n//     }});\n//   }else{\n//     app.store.getProxy().url='m?xwl=xip/login/data/getUserInfoByName';\n//     app.store.load({params:{user_name:name},callback:function(){\n//        if(app.store.getCount()>0){\n//          var start = app.store.getAt(0).get('START_DATE');\n//          var end = app.store.getAt(0).get('END_DATE');\n//          if(start.toString()==end.toString()){\n//             document.getElementById('alertInfo').innerHTML = '用户未激活';\n//             return false;\n//          }else{\n              \n//          }\n//        }\n//     }});\n//   }\n           Ext.Ajax.request({ \n                url  : '{#contextPath#}'+'/platformAction.do?method=resetPassword',\n                method:'post',\n                params:{userName:name},\n                success: function(response,options){\n                  var respText = Ext.JSON.decode(response.responseText);\n                  document.getElementById('alertInfo').innerHTML = respText.msg;\n               },\n               failure : function(response,options){\n                  document.getElementById('alertInfo').innerHTML = '服务器无响应';\n               }\n             });\n \n};"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xip/login/data/getUserInfoByName"},"children":[],"expanded":false,"type":"store"},{"configs":{"id":"loginbox","style":"font-family:微软雅黑;margin-top:15%;","text-align":"center","itemId":"div_container"},"children":[{"configs":{"class":"form-vertical","itemId":"bform1"},"children":[{"configs":{"itemId":"br4"},"children":[],"expanded":false,"type":"br"},{"configs":{"class":"control-group normal_text","itemId":"div_title"},"children":[{"configs":{"text":"请输入要找回密码的账号","style":"font-size:28px;font-weight:bold","itemId":"span1"},"children":[],"expanded":false,"type":"span"}],"expanded":false,"type":"div"},{"configs":{"itemId":"br2"},"children":[],"expanded":false,"type":"br"},{"configs":{"style":"color:red;font-size:13px","text-align":"center","itemId":"div_alertInfo","entityType":"row"},"children":[{"configs":{"id":"alertInfo","style":"font-family:微软雅黑","buttonType":"btn-group","itemId":"span1"},"children":[],"expanded":false,"type":"span"}],"expanded":false,"type":"div"},{"configs":{"itemId":"br3"},"children":[],"expanded":false,"type":"br"},{"configs":{"class":"col-sm-1 col-xs-1","itemId":"div1"},"children":[],"expanded":false,"type":"div"},{"configs":{"inputClass":"input-group","class":"col-sm-10 col-xs-10","itemId":"div_userName"},"children":[{"configs":{"style":"background-color:#28b779;color:#fff;border-radius:0px","inputClass":"input-group-addon","glyph":"f007","width":"40px","itemId":"span1"},"children":[],"expanded":true,"type":"span"},{"configs":{"id":"userNameOrEmail","style":"border-radius:0px","formType":"form-control","placeholder":"用户名/邮箱","itemId":"input1"},"children":[],"expanded":false,"type":"input"}],"expanded":true,"type":"div"},{"configs":{"itemId":"div2"},"children":[],"expanded":false,"type":"div"},{"configs":{"itemId":"br1"},"children":[],"expanded":false,"type":"br"},{"configs":{"itemId":"br5"},"children":[],"expanded":false,"type":"br"},{"configs":{"class":"form-actions","itemId":"div_botton"},"children":[{"configs":{"text":"下一步","style":"font-size:16px;width:100px","onclick":"app.modify();","itemId":"nextBtn","type":"btn-primary","size":"btn-sm"},"children":[],"expanded":false,"type":"bbutton"}],"expanded":true,"type":"div"},{"configs":{"itemId":"div_back"},"children":[{"configs":{"id":"backLogin","itemId":"a1"},"children":[{"configs":{"text":"返回","style":"font-weight:bold;color:yellow","text-align":"center","glyph":"f0e2","itemId":"span1"},"children":[],"expanded":false,"type":"span"}],"expanded":true,"type":"a"}],"expanded":false,"type":"div"}],"expanded":true,"type":"bform"}],"expanded":true,"type":"div"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}