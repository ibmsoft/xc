{"inframe":true,"title":"权限选择","hidden":false,"roles":{"default":1},"children":[{"configs":{"title":"设置默认角色","loadJS":"ext+bootstrap","initScript":" var userId = request.getSession().getAttribute(\"XzSessionVars\").get('userId');\nvar enUrl = request.getParameter('url');\nvar url = java.net.URLDecoder.decode(enUrl,'UTF-8');\nvar isResetPassword = request.getSession().getAttribute(\"XzSessionVars\").get('isResetPassword').toLowerCase();\nvar isIneffective = request.getSession().getAttribute(\"XzSessionVars\").get('isIneffective').toLowerCase();\nvar ctxPath = request.getContextPath() ;\n\n request.setAttribute(\"userId\",userId);\nrequest.setAttribute(\"contextPath\",ctxPath);\nrequest.setAttribute(\"url\",url);\nrequest.setAttribute(\"enUrl\",enUrl);\nrequest.setAttribute(\"isResetPassword\",isResetPassword);\nrequest.setAttribute(\"isIneffective\",isIneffective);","loginRequired":"false","itemId":"module","head":"<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">"},"events":{"initialize":"//动态获取div高度设置垂直居中\nvar bodyHeight = document.getElementById(\"containerdiv\").offsetHeight;\nvar windowHeight = window.innerHeight;\nvar height = (windowHeight-bodyHeight)/2;\ndocument.getElementById(\"containerdiv\").style.margin=height+'px';\n//保存按钮方法\napp.nba=function(){\n \nvar roleValue=document.getElementById('Iselect').value;\nvar url ='{#url#}';\nvar enUrl ='{#enUrl#}';\nvar isResetPassword = '{#isResetPassword#}';\nvar isIneffective = '{#isIneffective#}';\n\nif(roleValue===null || roleValue==='undefined' || roleValue===''){\n  document.getElementById('msg').innerHTML='请选择一个角色';\n  return false;\n}else{\n  document.getElementById('msg').innerHTML='';\n}\n// 提交请求\nExt.Ajax.request({\n  url : '{#contextPath#}' + '/frameAction.do?method=saveDefaultRole',\n  params  : {\n    'roleId' : roleValue\n  },\n  method  : 'post',\n  timeout : 3600000,\n  success : function(response, options) {\n    \n    var response =Ext.JSON.decode(response.responseText);\n    if(response.flag==1){\n      if('true'===isResetPassword||'true'===isIneffective){\n        window.location.href=\"{#contextPath#}/m?xwl=xip/login/modifyPasswordWithoutValidate&url=\"+enUrl;\t\n      }else{\n        window.location.href=url;\t\n      }\n    }else{\n      Ext.Msg.alert(\"提示\", response.msg);\n    }\n  },\n  failure : function(reponse, options) {\n    \n    var response = Ext.util.JSON.decode(response.responseText);\n    Ext.Msg.alert(\"提示\", response.msg);\n  }\n});\n  \n};"},"children":[{"configs":{"params":"{'userId':'{#userId#}'}","itemId":"store1","autoLoad":"true","url":"m?xwl=xip/login/data/setRolestore"},"events":{"load":"\nvar div=document.getElementById('inputdiv');\nvar select = document.createElement('select');\n    select.setAttribute('id', 'Iselect');  \n    select.setAttribute('style', 'width:150px;height:30px');\n    div.appendChild(select);\nvar sel= document.getElementById('Iselect'); \n    sel.options.add(new Option('请选择角色',''));\n     for(i=1;i<=app.store1.getCount();i++){\n        var userid= app.store1.getAt(i-1).get('ROLE_ID');\n        var name= app.store1.getAt(i-1).get('ROLE_NAME');\n        sel.options.add(new Option(name,userid));\n  }\n\n\n\n\n"},"children":[],"expanded":false,"type":"store"},{"configs":{"id":"containerdiv","class":"container-theme-showcase","itemId":"containerdiv"},"children":[{"configs":{"class":"row","itemId":"rowdev"},"children":[{"configs":{"class":"col-sm-2 col-md-3","itemId":"leftdiv"},"children":[],"expanded":true,"type":"div"},{"configs":{"id":"centerdev","class":"col-sm-8 col-md-6","itemId":"centerdev"},"children":[{"configs":{"class":"panel panel-primary","itemId":"paneldiv"},"children":[{"configs":{"text-align":"center","class":"panel-heading","itemId":"headerdiv"},"children":[{"configs":{"tagType":"h1","text":"默认角色设置","itemId":"header1"},"children":[],"expanded":false,"type":"header"}],"expanded":true,"type":"div"},{"configs":{"class":"panel-body","itemId":"bodydiv"},"children":[{"configs":{"text-align":"center","class":"form-group","itemId":"inputMenuGroup"},"children":[{"configs":{"itemId":"spandiv"},"children":[{"configs":{"id":"msg","style":"color:red ;font-size:13px;font-family:NSimSun","itemId":"span1"},"children":[],"expanded":false,"type":"span"}],"expanded":false,"type":"div"},{"configs":{"itemId":"br11"},"children":[],"expanded":false,"type":"br"},{"configs":{"id":"inputdiv","text-align":"center","itemId":"inputdiv"},"children":[],"expanded":true,"type":"div"},{"configs":{"itemId":"br1"},"children":[],"expanded":false,"type":"br"},{"configs":{"text-align":"center","itemId":"successdiv"},"children":[{"configs":{"text":"保&nbsp&nbsp存","class":"btn btn-success","onclick":"app.nba();","itemId":"successbbtn","type":"btn-success"},"children":[],"expanded":true,"type":"bbutton"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"},{"configs":{"class":"col-sm-2 col-md-3","itemId":"rightdiv"},"children":[],"expanded":true,"type":"div"}],"expanded":true,"type":"div"}],"expanded":true,"type":"div"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}