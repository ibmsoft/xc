{"inframe":true,"title":"登录","hidden":false,"roles":{"default":1},"children":[{"configs":{"title":"{#title#}","cssLinks":"[\"xip/login/css/cssLogin2.css\"]","loadJS":"ext","initScript":"var ctxPath = request.getContextPath();\nrequest.setAttribute(\"contextPath\",ctxPath);\nvar keyCode = request.getParameter('keyCode');\nrequest.setAttribute('keyCode',keyCode);\nvar session = request.getSession().getAttribute(\"XzSessionVars\");\nif(session!==null){\n  var language = request.getSession().getAttribute(\"XzSessionVars\").get('language');\n  request.setAttribute('language',language);\n}else{\n  var lang = com.xzsoft.xip.platform.util.PlatformUtil.getParamVal(\"XIP_DEFAULT_LANG\", \"P\", \"P\");\n  if(lang===null||lang===\"\"){\n    lang = \"zh\";\n  }\n  request.setAttribute('language',lang);\n}\n//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/login/login\");\n","loginRequired":"false","serverScript":"var appName = com.xzsoft.xip.platform.util.PlatformUtil.getAppName();\nrequest.setAttribute('appName',appName);\n\n\n\n//---------------------获取当前模块语言对应的.json文件，放到request中----------------\n//com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xip/login/login\");\n// request.setAttribute(\"userName\",request.getAttribute(\"user\"));\n// request.setAttribute(\"passWord\",request.getAttribute(\"pwd\"));\n// request.setAttribute(\"rem\",request.getAttribute(\"rem\"));\n// request.setAttribute(\"loginBtn\",request.getAttribute(\"loginBtn\"));\n// request.setAttribute(\"register\",request.getAttribute(\"register\"));\n// request.setAttribute(\"forgetPwd\",request.getAttribute(\"forgetPwd\"));\n// request.setAttribute(\"appNa\",request.getAttribute(\"appNa\"));","itemId":"module","head":"<link rel=\"shortcut icon\" href=\"images/xip.png\"/>\n<meta name=\"viewport\"  content=\"width=device-width,initial-scale=1.0\"> \n<link rel=\"stylesheet\" href=\"wb/libs/bs/css/bootstrap.css\"/>\n<link rel=\"stylesheet\" href=\"xip/bs/bootstrap-switch-master/dist/css/bootstrap3/bootstrap-switch.css\"/>\n<script type=\"text/javascript\" src=\"wb/libs/jquery/jquery.js\"><\/script> \n<!-- <script type=\"text/javascript\" src=\"login_{#language#}.js\"><\/script>  -->\n<script type=\"text/javascript\" src=\"xip/bs/bootstrap-switch-master/dist/js/bootstrap-switch.js\"><\/script> \n<script src=\"xip/login/js/bootstrap.min.js\"><\/script>\n\n\n<style>\n  a:link {\n    text-decoration: none;\n}\n  .modal-content{\n    height:240px\n  }\n  .close{\n    margin-top:-10px\n  }\n  <\/style>\n<script>\n  function keydown(e){\n\tvar currKey=0,e=e||event;\n\tif(e.keyCode==13){\n      login();\n      //app.loginAction();\n\t}\n}\ndocument.onkeydown=keydown;\n<\/script>\n<script>\n  //登录按钮的方法\n  function login(){\n    var p_cookie_name = '{#contextPath#}'.substring(1,'{#contextPath#}'.length);\n    var loginName = document.getElementById('userName').value;\n    var pwd = document.getElementById('password').value;\n  \n    if(loginName === null || loginName === ''){\n      document.getElementById('loginInfo').innerHTML = '请输入用户名';\n      return false;\n    }\n    if(pwd === null || pwd === ''){\n       document.getElementById('loginInfo').innerHTML = '请输入密码';\n       return false;\n    }\n    Ext.Ajax.request({\n     url  : '{#contextPath#}'+'/platformAction.do?method=personalLogin',\n     params : {\n           'loginName' : loginName.toUpperCase(), \n           'password'  : Xip.getMD5(pwd),\n           'url'       : '{#keyCode#}'},\n     method:'post',\n     success: function(response,options){\n       var respText = Ext.JSON.decode(response.responseText);\n       var flag = respText.flag;\n       if(flag == 1){\n         document.getElementById('loginInfo').innerHTML = respText.msg;\n       }else if(flag == -1){\n          document.getElementById('loginInfo').innerHTML = '登录异常';\n       }else{\n          var url = respText.url;\n          var isSave = document.getElementById('remCheck').checked;\n          if(isSave){\n            Wb.setCookie('XZ.'+p_cookie_name+'.userName',loginName);\n            Wb.setCookie('XZ.'+p_cookie_name+'.password',pwd);\n\t\t\t\t\t\t\t\n          }else{\n\t\t\t Wb.setCookie('XZ.'+p_cookie_name+'.userName','');\n\t\t \t Wb.setCookie('XZ.'+p_cookie_name+'.password','');\n          }\n          window.location.href = url;\n      }\n     \n     },\n      failure : function(response,options){\n        document.getElementById('loginInfo').innerHTML = '登录时发生错误';\n      }\n    });\n  }\n<\/script>\n<script>\n  function changeEn(){\n    //var objS = document.getElementById(\"select\");\n     Ext.Ajax.request({\n       url  : '{#contextPath#}'+'/platformAction.do?method=lanInsertInSession',\n       params : {\n             'language' : \"en\"},\n       method:'post',\n       success: function(response,options){\n         //刷新页面重新加载JS\n          location.reload();\n       },\n       failure: function(){\n       }\n     });\n    \n  }\n  <\/script>\n<script>\n  function changeZh(){\n    //var objS = document.getElementById(\"select\");\n     Ext.Ajax.request({\n       url  : '{#contextPath#}'+'/platformAction.do?method=lanInsertInSession',\n       params : {\n             'language' : \"zh\"},\n       method:'post',\n       success: function(response,options){\n         //刷新页面重新加载JS\n          location.reload();\n       },\n       failure: function(){\n       }\n     });\n    \n  }\n  <\/script>\n<script>\n  function qr(){\n     //打开模态框\n     $('#myModal').modal('show');\n    \n  }\n  <\/script>\n\n\n","initHtml":"<div class=\"modal fade\" id=\"myModal\" tabindex=\"-1\" role=\"dialog\" \n     aria-labelledby=\"myModalLabel\" aria-hidden=\"true\" >\n  <div class=\"modal-dialog\" style='padding-right:190px;padding-left:177px;padding-top:12%;'>\n    <div class=\"modal-content\"  >\n      <div class=\"modal-body\" >\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" \n               aria-hidden=\"true\" >×\n            <\/button>\n        <img src='{#contextPath#}/xipAction.do?method=getLoginQRImg' />\n      <\/div>\n    <\/div><!-- /.modal-content -->\n  <\/div><!-- /.modal -->\n<\/div>"},"events":{"finalize":"if('{#language#}'==\"en\"){\n  document.getElementById('appNa').innerHTML = '{#appNa#}';\n}else{\n//   document.getElementById('loginBtn').innerHTML =loginZh.loginBtn;\n//   document.getElementById('forgetPwd').innerHTML =loginZh.forgetPwd;\n//   document.getElementById('register').innerHTML =loginZh.register;\n\n//   document.getElementById('rem').innerHTML = loginZh.rem;\n//   document.getElementById('userName').placeholder = \"用户名\";\n//   document.getElementById('password').placeholder = \"密码\";\n  document.getElementById('appNa').innerHTML = '{#appName#}';\n  \n}\n  document.getElementById('userName').placeholder ='{#user#}';\n  document.getElementById('password').placeholder = '{#pwd#}';\n  document.getElementById('rem').innerHTML = '{#rem#}';\n  document.getElementById('loginBtn').innerHTML = '{#loginBtn#}';\n  document.getElementById('forgetPwd').innerHTML = '{#forgetPwd#}';\n  document.getElementById('register').innerHTML = '{#register#}';\n","initialize":"var switchChange=false;\n//重置 将switch变成off\napp.reset= function(){\n   if(switchChange){\n     $('#remCheck').bootstrapSwitch('toggleState');\n     $('#remCheck').bootstrapSwitch('setState', false);\n   }\n};\n//switch点击事件\n$('#remCheck').on('switchChange.bootstrapSwitch', function(event, state){\n    switchChange = document.getElementById('remCheck').checked;\n});\n//初始化switch开关\n$(\"[name='remC']\").bootstrapSwitch({\n  size:'mini',\n  state:false\n});\ndocument.getElementById('appNa').innerHTML = '{#appName#}';\nvar p_cookie_name = '{#contextPath#}'.substring(1,'{#contextPath#}'.length);\n//获取window的高度和容器DIV的高度,给DIV设置margin 让其上下居中\n// var bodyHeight = document.getElementById(\"container\").offsetHeight;\n// var windowHeight = window.innerHeight;\n// var height = (windowHeight-bodyHeight)/2;\n// document.getElementById(\"container\").style.margin=height+'px'+' 0px'+' 0px'+' 0px';\n\n//如果cookie里有信息就赋给用户名和密码\nvar _cookieUserName = Wb.getCookie(\"XZ.\"+p_cookie_name+\".userName\");\nvar _cookiePassword = Wb.getCookie(\"XZ.\"+p_cookie_name+\".password\");\nif(!Ext.isEmpty(_cookieUserName)){\n\tdocument.getElementById(\"userName\").value = _cookieUserName.toLowerCase();\n\tif(!Ext.isEmpty(_cookiePassword)){\n\t\tdocument.getElementById(\"password\").value=_cookiePassword;\n\t}\n    try{\n      $('#remCheck').bootstrapSwitch('toggleState');\n      $('#remCheck').bootstrapSwitch('setState', true);\n    }catch(e){\n    }\n\t//document.getElementById(\"remCheck\").checked=\"checked\";\n}\n\n\n\n"},"children":[{"configs":{"style":"margin-left:83%","inputClass":"input-group","itemId":"langauageDiv"},"children":[{"configs":{"text":"扫一扫","glyph":"f10b","onclick":"qr();","type":"btn-link","itemId":"qrcode"},"children":[],"expanded":false,"type":"bbutton"},{"configs":{"itemId":"span11"},"children":[],"expanded":false,"type":"span"},{"configs":{"text":"中文","style":"color:black","onclick":"changeZh();","type":"btn-link","itemId":"zh"},"children":[],"expanded":false,"type":"bbutton"},{"configs":{"text":"|","itemId":"span1"},"children":[],"expanded":false,"type":"span"},{"configs":{"text":"English","style":"color:black","onclick":"changeEn();","type":"btn-link","itemId":"en"},"children":[],"expanded":false,"type":"bbutton"}],"expanded":false,"type":"div"},{"configs":{"id":"loginbox","style":"font-family:微软雅黑;margin-top:10%","itemId":"div_body"},"children":[{"configs":{"id":"loginform","class":"form-vertical","itemId":"bform1"},"children":[{"configs":{"itemId":"br2"},"children":[],"expanded":false,"type":"br"},{"configs":{"class":"control-group normal_text","itemId":"div_title"},"children":[{"configs":{"id":"appNa","style":"font-size:25px;font-weight:bold","itemId":"span1"},"children":[],"expanded":false,"type":"span"}],"expanded":true,"type":"div"},{"configs":{"itemId":"br12"},"children":[],"expanded":false,"type":"br"},{"configs":{"class":"col-sm-2 col-xs-2","itemId":"div_leftU_Blank"},"children":[],"expanded":true,"type":"div"},{"configs":{"inputClass":"input-group","class":"col-sm-8 col-xs-8","itemId":"div_user"},"children":[{"configs":{"style":"background-color:#28b779;color:#fff;border-radius:0px","inputClass":"input-group-addon","glyph":"f007","width":"40px","itemId":"span1"},"children":[],"expanded":false,"type":"span"},{"configs":{"id":"userName","formType":"form-control","style":"border-radius:0px","placeholder":"用户名","itemId":"input1"},"children":[],"expanded":false,"type":"input"}],"expanded":true,"type":"div"},{"configs":{"class":"col-sm-10  col-xs-8","itemId":"div_rightU_Blank"},"children":[],"expanded":false,"type":"div"},{"configs":{"itemId":"br3"},"children":[],"expanded":false,"type":"br"},{"configs":{"itemId":"br4"},"children":[],"expanded":false,"type":"br"},{"configs":{"class":"col-sm-2 col-xs-2","itemId":"div_leftP_Blank"},"children":[],"expanded":true,"type":"div"},{"configs":{"text-align":"center","inputClass":"input-group","class":"col-sm-8 col-xs-8","itemId":"div_passWord"},"children":[{"configs":{"style":"background-color:#ffb848;color:#fff;border-radius:0px","inputClass":"input-group-addon","glyph":"f023","width":"40px","itemId":"span1"},"children":[],"expanded":false,"type":"span"},{"configs":{"id":"password","formType":"form-control","placeholder":"密码","width":"100%","itemId":"input1","type":"password"},"children":[],"expanded":false,"type":"input"}],"expanded":true,"type":"div"},{"configs":{"class":"col-sm-8","itemId":"div_rightP_Blank"},"children":[],"expanded":false,"type":"div"},{"configs":{"itemId":"br5"},"children":[],"expanded":false,"type":"br"},{"configs":{"class":"col-sm-2 col-xs-2","itemId":"div_Blank_left"},"children":[],"expanded":false,"type":"div"},{"configs":{"text-align":"center","inputClass":"input-group","class":"col-sm-8 col-xs-8","itemId":"div_rememberUandP"},"children":[{"configs":{"id":"rem","text":"记住用户名和密码","style":"color:black","text-align":"center","itemId":"span1"},"children":[],"expanded":true,"type":"span"},{"configs":{"id":"remCheck","name":"remC","itemId":"input1","type":"checkBox"},"children":[],"expanded":false,"type":"input"}],"expanded":true,"type":"div"},{"configs":{"class":"col-sm-8 col-xs-8","itemId":"div_Blank_right"},"children":[],"expanded":false,"type":"div"},{"configs":{"itemId":"br1"},"children":[],"expanded":false,"type":"br"},{"configs":{"class":"col-sm-2 col-xs-2","itemId":"div6"},"children":[],"expanded":false,"type":"div"},{"configs":{"style":"color:red;font-size:13px","text-align":"center","inputClass":"input-group","class":"col-sm-8 col-xs-8","itemId":"div_alertInfo"},"children":[{"configs":{"id":"loginInfo","style":"font-family:微软雅黑","buttonType":"btn-group","itemId":"span1"},"children":[],"expanded":false,"type":"span"}],"expanded":true,"type":"div"},{"configs":{"class":"col-sm-12 col-xs-12","itemId":"div7"},"children":[],"expanded":false,"type":"div"},{"configs":{"class":"col-sm-2 col-xs-2","itemId":"div1"},"children":[],"expanded":false,"type":"div"},{"configs":{"text-align":"center","inputClass":"input-group","class":"col-sm-8 col-xs-8","itemId":"div_button "},"children":[{"configs":{"id":"loginBtn","text":"登录","style":"font-size:15px;font-weight:bold","class":"pull-left","onclick":"login();","itemId":"loginBtn","type":"btn-primary","size":"btn-block"},"children":[],"expanded":false,"type":"bbutton"}],"expanded":true,"type":"div"},{"configs":{"class":"col-sm-12 col-xs-12","itemId":"div4"},"children":[],"expanded":false,"type":"div"},{"configs":{"itemId":"br6"},"children":[],"expanded":false,"type":"br"},{"configs":{"class":"col-sm-2 col-xs-2","itemId":"div2"},"children":[],"expanded":false,"type":"div"},{"configs":{"inputClass":"input-group","class":"col-sm-8 col-xs-8","itemId":"div_registerAndRempwd"},"children":[{"configs":{"id":"forgetPwd","text":"忘记密码","style":"color:black;margin-left:0px","itemId":"forgetPwd","type":"btn-link","href":"m?xwl=xip/login/forgetPwd"},"children":[],"expanded":false,"type":"a"},{"configs":{"id":"register","text":"用户注册","style":"color:black;margin-right:0px;font-color:balck","class":"pull-right","itemId":"register","type":"btn-link","href":"m?xwl=xip/login/userRegistered"},"children":[],"expanded":false,"type":"a"}],"expanded":false,"type":"div"},{"configs":{"itemId":"div5"},"children":[],"expanded":false,"type":"div"}],"expanded":true,"type":"bform"}],"expanded":false,"type":"div"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}