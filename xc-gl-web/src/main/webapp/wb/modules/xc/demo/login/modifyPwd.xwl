{"inframe":true,"title":"修改密码","hidden":false,"roles":{"default":1},"children":[{"configs":{"cssLinks":"[\"xip/login/css/cssLogin2.css\"]","initScript":"var ctxPath = request.getContextPath();\nrequest.setAttribute(\"contextPath\",ctxPath);\nvar user_id = request.getParameter('USER_ID');\nrequest.setAttribute(\"user_id\",user_id);\nvar pwdLenLimit= com.xzsoft.xip.platform.util.PlatformUtil.getSystemParamVal(\"PW_LEN_LIMIT\");\nrequest.setAttribute(\"PW_LEN_LIMIT\",pwdLenLimit);\nvar pwdIncludeChar =  com.xzsoft.xip.platform.util.PlatformUtil.getSystemParamVal(\"PW_INCLUDE_CHAR\");\nrequest.setAttribute(\"PW_INCLUDE_CHAR\",pwdIncludeChar);","loginRequired":"false","loadJS":"ext+bootstrap","jsLinks":"[\"pub/uip/common/scripts/md5.js\"]","serverScript":"//var serverUrl = com.xzsoft.xip.platform.util.PlatformUtil.getXipConfigVal(\"cas.casServerUrl\");\nvar serverUrl = com.xzsoft.xip.platform.util.PlatformUtil.getCasClient();\nrequest.setAttribute('serverUrl',serverUrl);\n","head":"<script>\n  function keydown(e){\n\tvar currKey=0,e=e||event;\n\tif(e.keyCode==13){\n      app.next();\n\t}\n}\ndocument.onkeydown=keydown;\n<\/script>\n<meta name=\"viewport\"  content=\"width=device-width,initial-scale=1.0\"> ","itemId":"module"},"events":{"initialize":"document.getElementById(\"backLogin\").href = '{#serverUrl#}'+'/m?xwl=xip/login/login';\napp.next = function(){\n  var newPwd = document.getElementById(\"pwd\").value;\n  var newPwdAgain = document.getElementById(\"pwdAgain\").value;\n  if(newPwd === null || newPwd === \"\" || newPwd === \"undefined\"){\n     document.getElementById('mes').innerHTML = \"请输入新密码\";\n     return false;\n   }\t\n  if(newPwdAgain === null || newPwdAgain === \"\" || newPwdAgain === \"undefined\"){\n     document.getElementById('mes').innerHTML = \"请输入再次输入密码\";\n     return false;\n   }\n  if('{#PW_INCLUDE_CHAR#}'=='Y'){\n    var re = new RegExp(\"[A-Za-z\\x21-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7e]\");\n    if(!re.test(newPwd)){\n      document.getElementById('mes').innerHTML = \"新密码必须要包含字母或者特殊字符!\";\n      return;\n    }\n  }\n  var _tmpLen = '{#PW_LEN_LIMIT#}';\n  if(Ext.isEmpty(_tmpLen) || _tmpLen===0){\n     \n      if(newPwd.length<6 && newPwdAgain.length<6){\n        document.getElementById('mes').innerHTML = \"密码长度不能少于6位\";\n        return false;\n      }\n  }else{  \n      if(newPwd.length<_tmpLen && newPwdAgain.length<_tmpLen){\n        document.getElementById('mes').innerHTML = '密码长度不能少于'+_tmpLen+'位';\n        return false;\n      }\n  }\n\n  if(newPwd!== newPwdAgain){\n    document.getElementById('mes').innerHTML = \"两次输入的密码不一致\";\n    return false;\n  }\n  var user_id = '{#user_id#}';\n //调用action中的方法\nExt.Ajax.request({\n  url  : '{#contextPath#}'+'/platformAction.do?method=updateUserPassword'+'&newPassWord='+hex_md5(newPwd)+'&user_id='+user_id,\n  method:'post',\n  success: function(response,options){\n      var respText = Ext.JSON.decode(response.responseText);\n      document.getElementById('mes').innerHTML = respText.msg;\n      if(respText.flag==\"0\"){\n        window.location.href = '{#serverUrl#}'+'/m?xwl=xip/login/login';\n      }\n  },\n  failure : function(response,options){\n    document.getElementById('mes').innerHTML = \"服务器无响应\";\n  }\n});\n\n};"},"children":[{"configs":{"id":"loginbox","style":"font-family:微软雅黑;margin-top:15%;","text-align":"center","itemId":"div_container"},"children":[{"configs":{"class":"form-vertical","itemId":"bform1"},"children":[{"configs":{"itemId":"br4"},"children":[],"expanded":false,"type":"br"},{"configs":{"class":"control-group normal_text","itemId":"div_title"},"children":[{"configs":{"text":"请输入新密码","style":"font-size:28px;font-weight:bold","itemId":"span1"},"children":[],"expanded":false,"type":"span"}],"expanded":false,"type":"div"},{"configs":{"style":"color:red;font-size:13px","text-align":"center","entityType":"row","itemId":"div_alertInfo"},"children":[{"configs":{"id":"mes","style":"font-family:微软雅黑","buttonType":"btn-group","itemId":"span1"},"children":[],"expanded":false,"type":"span"}],"expanded":false,"type":"div"},{"configs":{"itemId":"br3"},"children":[],"expanded":false,"type":"br"},{"configs":{"class":"col-sm-2 col-xs-2","itemId":"div1"},"children":[],"expanded":false,"type":"div"},{"configs":{"inputClass":"input-group","class":"col-sm-8 col-xs-8","itemId":"div_newPwd"},"children":[{"configs":{"style":"background-color:#28b779;color:#fff;border-radius:0px","inputClass":"input-group-addon","width":"40px","glyph":"f084","itemId":"span1"},"children":[],"expanded":true,"type":"span"},{"configs":{"id":"pwd","formType":"form-control","style":"font-size:15px;","placeholder":"新密码","type":"password","itemId":"input1"},"children":[],"expanded":false,"type":"input"}],"expanded":true,"type":"div"},{"configs":{"class":"col-sm-8 col-xs-8","itemId":"div2"},"children":[],"expanded":false,"type":"div"},{"configs":{"itemId":"br2"},"children":[],"expanded":false,"type":"br"},{"configs":{"class":"col-sm-2 col-xs-2","itemId":"div11"},"children":[],"expanded":false,"type":"div"},{"configs":{"inputClass":"input-group","class":"col-sm-8 col-xs-8","itemId":"div_newPwd2"},"children":[{"configs":{"style":"background-color:#28b779;color:#fff;border-radius:0px","inputClass":"input-group-addon","width":"40px","glyph":"f084","itemId":"span1"},"children":[],"expanded":true,"type":"span"},{"configs":{"id":"pwdAgain","formType":"form-control","style":"font-size:15px","placeholder":"确认新密码","type":"password","itemId":"input1"},"children":[],"expanded":false,"type":"input"}],"expanded":true,"type":"div"},{"configs":{"class":"col-sm-8 col-xs-8","itemId":"div22"},"children":[],"expanded":false,"type":"div"},{"configs":{"itemId":"br1"},"children":[],"expanded":true,"type":"br"},{"configs":{"class":"form-actions","itemId":"div_botton"},"children":[{"configs":{"text":"确认","style":"font-size:16px;width:100px","onclick":"app.next();","type":"btn-primary","itemId":"nextBtn","size":"btn-sm"},"children":[],"expanded":false,"type":"bbutton"}],"expanded":false,"type":"div"},{"configs":{"itemId":"div_back"},"children":[{"configs":{"id":"backLogin","itemId":"a1"},"children":[{"configs":{"text":"返回首页","style":"font-weight:bold;color:yellow","text-align":"center","glyph":"f064","itemId":"span1"},"children":[],"expanded":false,"type":"span"}],"expanded":true,"type":"a"}],"expanded":true,"type":"div"}],"expanded":true,"type":"bform"}],"expanded":true,"type":"div"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}