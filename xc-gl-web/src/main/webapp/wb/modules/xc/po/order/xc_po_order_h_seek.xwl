{"inframe":false,"title":"","hidden":false,"roles":{"default":1},"children":[{"configs":{"serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/po/order/json/xc_po_order_h\");\n// 获取审批流提供的单据ID\nvar bizId = request.getParameter(\"businessId\") ;\nrequest.setAttribute('orderHId',bizId);\n\nvar ctxPath = request.getContextPath() ;\nrequest.setAttribute('contextPath',ctxPath);","itemId":"module"},"events":{"initialize":"Ext.apply(app,{\n  initWin:function(params){\n    Ext.apply(app,params);\n    app.ORDER_H_TYPE.store.load();\n    if(params.flag=='history'){\n      Wb.request({\n        url:'m?xwl=xc/po/order/data/selectOrderHHisDataByHisId',//通过订单ID查询变更订单信息\n        params:{'orderHHisId':params.orderHHIsId},\n        success:function(resp){\n          var response = Wb.decode(resp.responseText);\n          if(response.total>0){\n            Wb.setValue(app.showWin,response.rows[0]);//主信息赋值\n            app.DOCUMENT_DATE.setValue(response.rows[0].documentDate);\n            app.PURCHASE_DEPT_NAME.setValue(response.rows[0].PURCHASE_DEPT_NAME);\n              app.orderLGrid.getStore().proxy.url='m?xwl=xc/po/order/data/getOrderLHisData';\n              app.orderLGrid.store.load({params:{'ORDER_H_HIS_ID':params.orderHHIsId}});\n          }\n        }\n      });\n    }else{\n      Wb.request({\n        url:'m?xwl=xc/po/order/data/selectOrderHDataById',//通过订单主信息ID查询\n        params:{'orderHId':params.orderHId},\n        success:function(resp){\n          var rec = Wb.decode(resp.responseText);\n          Wb.setValue(app.contentForm,rec.rows[0]);\n          app.DOCUMENT_DATE.setValue(rec.rows[0].documentDate);\n          app.PURCHASE_DEPT_NAME.setValue(rec.rows[0].PURCHASE_DEPT_NAME);\n\n        }\n      });\n        app.orderLGrid.store.load({params:{'orderHId':params.orderHId}});\n    }\n    app.showWin.show();\n  }\n});"},"children":[{"configs":{"height":"600","width":"1000","layout":"border","closeAction":"hide","itemId":"showWin","modal":"true"},"children":[{"configs":{"region":"north","layout":"auto","itemId":"contentForm","border":"false"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#po_order_save#}","itemId":"saveBtn","disabled":"true","iconCls":"save_icon"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#po_order_submit#}","itemId":"submitBtn","disabled":"true","iconCls":"up_icon"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#po_order_revoke#}","itemId":"revokeBtn","disabled":"true","iconCls":"cancel_icon"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#po_order_monitor#}","itemId":"monitorBtn","iconCls":"viewport_icon"},"events":{"click":"if(app.INS_CODE.getValue() === null || app.INS_CODE.getValue() === ''){\n  Wb.toast('{#po_order_ins_code#}');\n}\nelse{\n  XipWf.showMonitorPage(app.INS_CODE.getValue());\n}   \n"},"children":[],"expanded":false,"type":"button"}],"expanded":false,"type":"toolbar"},{"configs":{"layout":"column","margin":"10 10 0 0","itemId":"tr1","border":"false"},"children":[{"configs":{"layout":"fit","columnWidth":".25","itemId":"td1_1","border":"false"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"ORG_NAME","fieldLabel":"{#po_order_org#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".25","border":"false","itemId":"td1_2"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"VENDOR_NAME","fieldLabel":"{#po_order_vendor#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".25","itemId":"td1_3","border":"false"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"CONTRACT_NAME","fieldLabel":"{#po_order_contract#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".25","itemId":"td1_4","border":"false"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"DOCUMENT_DATE","fieldLabel":"{#po_order_start_date#}"},"children":[],"expanded":false,"type":"date"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","margin":"10 10 0 0","itemId":"tr2","border":"false"},"children":[{"configs":{"layout":"fit","columnWidth":".25","itemId":"td2_11","border":"false"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","displayField":"VAL_NAME","valueField":"VAL_CODE","labelAlign":"right","itemId":"ORDER_H_TYPE","fieldLabel":"{#po_order_order_type#}"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/po/order/data/getOrderType"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".25","border":"false","itemId":"td2_3"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"PURCHASE_DEPT_NAME","fieldLabel":"{#po_order_purchase_name#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".25","border":"false","itemId":"td2_31"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"DEPT_NAME","fieldLabel":"{#po_order_department#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".25","border":"false","itemId":"td2_311"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"PROJECT_NAME","fieldLabel":"{#po_order_project_name#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","margin":"10 10 0 0","itemId":"tr3","border":"false"},"children":[{"configs":{"layout":"fit","columnWidth":".25","itemId":"td4_1","border":"false"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"PURCHASE_PERSON_NAME","fieldLabel":"{#po_order_purchase_person#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".25","itemId":"td4_2","border":"false"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"SYS_AUDIT_STATUS_DESC","fieldLabel":"{#po_order_status#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".25","itemId":"td2_1","border":"false"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"ORDER_H_CODE","fieldLabel":"{#po_order_order_code#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".25","border":"false","itemId":"td2_11"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"VERSION","fieldLabel":"{#po_order_version#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","margin":"10 10 0 0","border":"false","itemId":"tr4"},"children":[{"configs":{"layout":"fit","columnWidth":".25","itemId":"td3_3","border":"false"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"INV_AMOUNT","fieldLabel":"{#po_order_inv_amount#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".25","itemId":"td3_4","border":"false"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"AMOUNT","fieldLabel":"{#po_order_amount#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".5","itemId":"td2_2","border":"false"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"ORDER_H_NAME","fieldLabel":"{#po_order_order_name#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"hidden":"true","border":"false","itemId":"hiddenPanel"},"children":[{"configs":{"itemId":"INS_CODE"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"orderLGrid","editable":"true"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#po_order_rowNum#}","xtype":"rownumberer","width":"50","align":"center","titleAlign":"center","itemId":"rowNum"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ORDER_L_NUM","hidden":"true","align":"center","dataIndex":"ORDER_L_NUM","titleAlign":"center","itemId":"ORDER_L_NUM_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#po_order_order_l_id#}","hidden":"true","dataIndex":"ORDER_L_ID","titleAlign":"center","itemId":"ORDER_L_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#po_order_material_id#}","hidden":"true","dataIndex":"MATERIAL_ID","titleAlign":"center","itemId":"MATERIAL_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#po_order_material_code#}","dataIndex":"MATERIAL_CODE","titleAlign":"center","itemId":"MATERIAL_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#po_order_material_name#}","dataIndex":"MATERIAL_NAME","titleAlign":"center","itemId":"MATERIAL_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#po_order_pur_code#}","dataIndex":"PUR_AP_H_CODE","titleAlign":"center","itemId":"PUR_AP_H_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"PUR_AP_L_ID","hidden":"true","dataIndex":"PUR_AP_L_ID","titleAlign":"center","itemId":"PUR_AP_L_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#po_order_dim#}","hidden":"true","dataIndex":"DIM_ID","titleAlign":"center","itemId":"DIM_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#po_order_dim#}","dataIndex":"DIM_NAME","titleAlign":"center","itemId":"DIM_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#po_order_qty#}","align":"right","dataIndex":"QTY","titleAlign":"center","itemId":"QTY_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#po_order_tax#}","align":"right","dataIndex":"TAX","titleAlign":"center","itemId":"TAX_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#po_order_price#}","align":"right","dataIndex":"PRICE","titleAlign":"center","itemId":"PRICE_COL","renderer":"return Wb.format(value,'0,000.00');"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#po_order_inv_price#}","align":"right","dataIndex":"INV_PRICE","titleAlign":"center","itemId":"INV_PRICE_COL","renderer":"return Wb.format(value,'0,000.00');"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#po_order_amount#}","align":"right","dataIndex":"AMOUNT","titleAlign":"center","itemId":"AMOUNT_COL","renderer":"return Wb.format(value,'0,000.00');"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#po_order_inv_amount#}","align":"right","dataIndex":"INV_AMOUNT","titleAlign":"center","itemId":"INV_AMOUNT_COL","renderer":"return Wb.format(value,'0,000.00');"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#po_order_if_close#}","dataIndex":"IS_CLOSE","titleAlign":"center","itemId":"IS_CLOSE_COL","renderer":"if(value=='Y') return '{#po_order_yes#}';\nif(value=='N') return '{#po_order_no#}';"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#RKSL#}","align":"right","dataIndex":"ENTRY_QTY","titleAlign":"center","itemId":"ENTRY_QTY_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#YKPJE#}","align":"right","dataIndex":"INVOICE_AMOUNT","titleAlign":"center","itemId":"INVOICE_AMOUNT_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"itemId":"store","url":"m?xwl=xc/po/order/data/getOrderLData"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#po_order_close#}","itemId":"closeBtn","iconCls":"stop_icon"},"events":{"click":"var recs =app.orderLGrid.getSelection();//选中的行\nif(recs.length<1){//没选中行\n  Wb.toast('{#po_order_select_record_least_one#}');\n  return;\n}\nvar ids = [];//id数组\nfor(var i=0;i<recs.length;i++){\n  var id = {'ORDER_L_ID':recs[i].data.ORDER_L_ID};\n  ids.push(id);\n}\n\nWb.request({\n  url:'{#contextPath#}/poOrderAction.do?method=updateOrerLStatusByLId',\n  params:{'ids':ids,'operate':'Y'},\n  success:function(resp){\n    console.log(11111111111);\n    var response = Wb.decode(resp.responseText);\n    if(response.flag=='0'){\n      Wb.toast('{#po_order_close_success#}');\n      app.orderLGrid.store.reload();\n    }else{\n      Wb.toast(response.msg);\n    }\n  }\n});"},"children":[],"expanded":true,"type":"button"}],"expanded":true,"type":"toolbar"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"window"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}