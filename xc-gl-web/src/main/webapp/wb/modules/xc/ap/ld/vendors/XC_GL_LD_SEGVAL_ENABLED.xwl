{"inframe":false,"title":"","hidden":false,"roles":{"default":1},"children":[{"configs":{"initScript":"com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/ap/ld/vendors/XC_GL_LD_SEGVAL_ENABLED\");","loginRequired":"false","serverScript":"var contextPath  = request.getContextPath();\nrequest.setAttribute(\"contextPath\",contextPath);","itemId":"module"},"events":{"finalize":"var segs = ['XC_AP_VENDORS','XC_AR_CUSTOMERS','XC_GL_PRODUCTS','XIP_PUB_ORGS','XIP_PUB_DEPTS','XIP_PUB_EMPS'];\nvar seg_ids = ['VENDOR_ID','CUSTOMER_ID','PRODUCT_ID','ORG_ID','DEPT_ID','EMP_ID'];\nvar ld_segs = ['XC_GL_LD_VENDORS','XC_GL_LD_CUSTOMERS','XC_GL_LD_PRODUCTS','XC_GL_LD_ORGS','XC_GL_LD_DEPTS','XC_GL_LD_EMPS'];\nvar ld_seg_ids = ['LD_VENDOR_ID','LD_CUSTOMER_ID','LD_PRODUCT_ID','LD_ORG_ID','LD_DEPT_ID','LD_EMP_ID'];\nvar seg_codes = ['VENDOR_CODE','CUSTOMER_CODE','PRODUCT_CODE','ORG_CODE','DEPT_CODE','EMP_CODE'];\nvar seg_names = ['VENDOR_NAME','CUSTOMER_NAME','PRODUCT_NAME','ORG_NAME','DEPT_NAME','EMP_NAME'];\nvar ledger_id;//获取账簿ID\nvar seg ='XC_AP_VENDORS';//获取辅助短编码\nvar seg_id='VENDOR_ID';//辅助段列名\nvar ld_seg='XC_GL_LD_VENDORS';//段值启用表名\nvar ld_seg_id='LD_VENDOR_ID';//段值启用表列名\nvar seg_code='VENDOR_CODE';//编码\nvar seg_name='VENDOR_NAME';//名称\nvar _index;//索引\nvar org_id;//组织ID\nfunction clearOtherFn(type){\n  if(type=='xip_pub_orgs'){\n    app.QUERY_ORG_NAME.ORG_NAME.setValue('');\n    app.QUERY_ORG_NAME.ORG_ID.setValue('');\n    app.QUERY_ORG_NAME.ORG_CODE.setValue('');\n    app.QUERY_ORG_NAME.LEDGER_ID.setValue('');\n  }\n}\n\nfunction returnRowFn(r,type){\n  if(type=='xip_pub_orgs'){\n    app.QUERY_ORG_NAME.ORG_NAME.setValue(r.data.ORG_NAME);\n    app.QUERY_ORG_NAME.ORG_ID.setValue(r.data.ORG_ID);\n    app.QUERY_ORG_NAME.ORG_CODE.setValue(r.data.ORG_CODE);\n    app.QUERY_ORG_NAME.LEDGER_ID.setValue(r.data.LEDGER_ID);\n    app.queryBtn.fireEvent('click');\n  }\n}","initialize":"var indexIds = [];"},"children":[{"configs":{"itemId":"folder1"},"children":[{"configs":{"itemId":"buttons"},"children":[{"configs":{"text":"{#sure#}","itemId":"sureDisBtn","iconCls":"ok_icon"},"events":{"click":"var vrec = app.grid2.getSelection();\nif(vrec.length<1){\n  Wb.toast('{#please_select_record#}');\n  return;\n}\nWb.request({\n  url:'{#contextPath#}'+'/apVendorAction.do?method=addLedgerVendor',\n  params:{'str':Wb.getData(vrec),'ledgerId':app.QUERY_ORG_NAME.LEDGER_ID.getValue(),'orgId':app.QUERY_ORG_NAME.ORG_ID.getValue()},\n  success:function(resp){\n    var rec = Wb.decode(resp.responseText);\n    if(rec.flag=='0'){\n      Wb.toast('{#distribute_success#}');\n      app.win.hide();\n      app.grid1.store.load({params:{'ledgerId':app.QUERY_ORG_NAME.LEDGER_ID.getValue()}});\n    }else if(rec.flag=='1'){\n      Wb.toast(rec.msg);\n    }\n  }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#cancel#}","itemId":"cancelBtn","iconCls":"cancel_icon"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"}],"expanded":false,"type":"folder"},{"configs":{"height":"500","width":"750","layout":"border","buttonAlign":"center","dialog":"true","itemId":"win","modal":"true"},"events":{"ok":"var recs = app.grid2.getSelection();\n\nif(recs.length === 0){\n  Wb.toast('{#please_select_record#}');\n  return;\n}\nvar ledgerId = app.QUERY_ORG_NAME.LEDGER_ID.getValue();\nvar orgId = app.QUERY_ORG_NAME.ORG_ID.getValue();\nWb.request({\n  url:'{#contextPath#}'+'/apVendorAction.do?method=addLedgerVendor',\n  params:{\n    'str':Wb.getData(recs),\n    'ledgerId':ledgerId,\n    'orgId':orgId\n  },\n  success:function(resp){\n    var rec = Wb.decode(resp.responseText);\n    if(rec.flag=='0'){\n      Wb.toast('{#distribute_success#}');\n      app.win.hide();\n      app.grid1.store.load({params:{'ledgerId':app.QUERY_ORG_NAME.LEDGER_ID.getValue()}});\n    }else if(rec.flag=='1'){\n      Wb.toast(rec.msg);\n    }\n  }\n});","show":"app.grid2.store.load({\n  params : {\n    ORG_ID\t\t: app.QUERY_ORG_NAME.ORG_ID.getValue(),\n    LEDGER_ID\t: app.QUERY_ORG_NAME.LEDGER_ID.getValue()\n  }\n});"},"children":[{"configs":{"region":"north","layout":"fit","border":"false","itemId":"winForm"},"children":[{"configs":{"layout":"column","margin":"5 0 5 0","border":"false","itemId":"panel1"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"WIN_VENDOR_NAME","fieldLabel":"{#CODE_NAME#}"},"events":{"specialkey":"if(e.getKey()===13){app.queryBtn1.fireEvent('click');}"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#queryBtn#}","itemId":"queryWinBtn","iconCls":"seek_icon","x":"30"},"events":{"click":"app.grid2.store.load();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#resetBtn#}","itemId":"resetWinBtn","iconCls":"refresh_icon","x":"50"},"events":{"click":"app.winForm.getForm().reset();\napp.queryWinBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"grid2"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/ap/ld/vendors/DB/select_notExist"},"events":{"beforeload":"operation.params = {\n  ledgerId : app.QUERY_ORG_NAME.LEDGER_ID.getValue(),\n  orgId : app.QUERY_ORG_NAME.ORG_ID.getValue(),\n  codeOrName : app.WIN_VENDOR_NAME.getValue()\n};"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#XH#}","width":"50","xtype":"rownumberer","align":"center","titleAlign":"center","itemId":"rowNum"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ID","hidden":"true","dataIndex":"VENDOR_ID","titleAlign":"center","itemId":"VENDOR_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#CODE_COL#}","width":"150","dataIndex":"VENDOR_CODE","titleAlign":"center","itemId":"VENDOR_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#NAME_COL#}","width":"300","dataIndex":"VENDOR_NAME","titleAlign":"center","itemId":"VENDOR_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#VENDOR_TYPE_COL#}","hidden":"true","dataIndex":"VENDOR_TYPE","titleAlign":"center","itemId":"VENDOR_TYPE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#ADDRESS1#}","hidden":"true","width":"200","dataIndex":"ADDRESS","titleAlign":"center","itemId":"ADDRESS_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#connect_customer#}","hidden":"true","width":"300","dataIndex":"CUSTOMER_NAME","titleAlign":"center","itemId":"CUSTOMER_NAME_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"window"},{"configs":{"layout":"border","itemId":"viewport1"},"events":{"afterrender":"var orgStore = app.QUERY_ORG_NAME.ORG_NAME.getPicker().store;\norgStore.load({\n\tcallback:function(){\n      \t\n    \tapp.QUERY_ORG_NAME.ORG_NAME.setValue(orgStore.getAt(0).get('ORG_NAME'));\n      \tapp.QUERY_ORG_NAME.ORG_ID.setValue(orgStore.getAt(0).get('ORG_ID'));\n      \tapp.QUERY_ORG_NAME.ORG_CODE.setValue(orgStore.getAt(0).get('ORG_CODE'));\n      \tapp.QUERY_ORG_NAME.LEDGER_ID.setValue(orgStore.getAt(0).get('LEDGER_ID'));\n      \tapp.grid1.store.load({'ledgerId':orgStore.getAt(0).get('LEDGER_ID')});\n    }\n});"},"children":[{"configs":{"region":"north","itemId":"queryForm"},"children":[{"configs":{"layout":"column","margin":"10 0 10 0","border":"false","itemId":"tr1"},"children":[{"configs":{"layout":"fit","columnWidth":".3","border":"false","itemId":"td1_1"},"children":[{"configs":{"file":"m?xwl=xc/com-lov/ORG_PICK/ORG_ALL_PICK","itemId":"QUERY_ORG_NAME"},"children":[],"expanded":false,"type":"xwl"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".3","border":"false","itemId":"td1_3"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"QUERY_VENDOR_NAME","fieldLabel":"{#CODE_NAME#}"},"events":{"specialkey":"if(e.getKey()===13){app.queryBtn1.fireEvent('click');}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","columnWidth":".3","border":"false","itemId":"td1_2"},"children":[{"configs":{"text":"{#queryBtn#}","margin":"0 0 0 20","itemId":"queryBtn","iconCls":"seek_icon"},"events":{"click":"app.grid1.store.load();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#resetBtn#}","margin":"0 0 0 20","itemId":"resetBtn","iconCls":"refresh_icon"},"events":{"click":"app.QUERY_VENDOR_NAME.reset();\napp.queryBtn.fireEvent('click');\n"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"grid1"},"events":{"tagEvents":"{\n  itemmouseenter:function(view, record, item, index, e, options){\n    _index = index;\n  }\n}"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/ap/ld/vendors/DB/selectOrgVendor"},"events":{"beforeload":"operation.params = {\n  ledgerId : app.QUERY_ORG_NAME.LEDGER_ID.getValue(),\n  orgId : app.QUERY_ORG_NAME.ORG_ID.getValue(),\n  vendorCodeOrName : app.QUERY_VENDOR_NAME.getValue()\n};"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#sysBtn#}","itemId":"distributeBtn","iconCls":"record_copy_icon"},"events":{"click":"var orgId = app.QUERY_ORG_NAME.ORG_ID.getValue();\nif(Wb.isEmpty(orgId)){\n  Wb.toast('{#please_select_org_first#}');\n  return;\n}\nvar win = new Ext.window.Window(app._win); //app._win指向配置对象而非实例\nwin.show();\nwin.setIconCls('record_copy_icon');\nWb.setTitle(win, '{#sysBtn#}');\n//加载数据\n// app.grid2.getStore().load({\n//   params:{\n//           orgId:app.QUERY_ORG_NAME.ORG_ID.getValue()//组织编码\n//          }\n// });\n"},"children":[],"expanded":true,"type":"button"},{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#saveBtn#}","itemId":"saveEnableBtn","iconCls":"save_icon"},"events":{"click":"var returnJson = [];\nvar vstore = app.grid1.store;\nfor(var i=0;i<indexIds.length;i++){\n  var isEnabled ;\n  var json = {'id':vstore.getAt(indexIds[i]).get('LD_VENDOR_ID'),'isEnabled':vstore.getAt(indexIds[i]).get('IS_ENABLED')};\n  returnJson.push(json);\n}\nWb.request({\n  url:'m?xwl=xc/ap/ld/vendors/DB/update_save',\n  params:{'returnJson':returnJson},\n  success:function(resp){\n    Wb.toast('{#SAVETIP#}');\n    app.queryBtn.fireEvent('click');\n  }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#delBtn#}","itemId":"delBtn","iconCls":"file_delete_icon"},"events":{"click":"var recs = app.grid1.getSelection();\nif(recs.length<1){\n  Wb.toast('{#DELTIP#}');\n  return;\n}\n\nvar ledgerId = app.QUERY_ORG_NAME.LEDGER_ID.getValue();\nvar orgId = app.QUERY_ORG_NAME.ORG_ID.getValue();\nvar vendorIds = [];\n\nfor(var i=0;i<recs.length;i++){\n  var id = {'VENDOR_ID':recs[i].data.VENDOR_ID};\n  vendorIds.push(id);\n}\nExt.Msg.confirm('{#TIP#}','{#DELOKTIP#}',function(btn){\n  if(btn=='yes'){\n    Wb.request({\n      url:'{#contextPath#}'+'/apVendorAction.do?method=deleteLedgerVendor',\n      params:{'ledgerId':ledgerId,'orgId':orgId,'vendorIds':vendorIds},\n      success:function(resp){\n        var rec = Wb.decode(resp.responseText);\n        if(rec.flag=='0'){\n          var delCount = rec.delCount;\n          if (delCount === 0) {\n            Wb.toast('{#ybywyydgysbksc#}');\n          } else {\n            Wb.toast('{#cgscl#} '+delCount+' {#tsj#}');\n          }\n          app.grid1.store.reload();\n        }else if(rec.flag=='1'){\n          Wb.toast(rec.msg);\n        }\n      }\n    });\n  }\n});\n\n"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#XH#}","width":"50","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"rownum"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#LEDGER_ID_ZH#}","hidden":"true","dataIndex":"LEDGER_ID","titleAlign":"center","itemId":"LEDGER_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#LEDGER_NAME_ZH#}","hidden":"true","dataIndex":"LEDGER_NAME","titleAlign":"center","itemId":"LEDGER_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#CODE_COL#}","dataIndex":"VENDOR_CODE","titleAlign":"center","itemId":"VENDOR_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ID","hidden":"true","dataIndex":"LD_VENDOR_ID","titleAlign":"center","itemId":"LD_VENDOR_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#NAME_COL#}","width":"230","dataIndex":"VENDOR_NAME","titleAlign":"center","itemId":"VENDOR_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#VENDOR_TYPE_COL#}","dataIndex":"VENDOR_TYPE","titleAlign":"center","itemId":"VENDOR_TYPE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#ADDRESS1#}","dataIndex":"ADDRESS","titleAlign":"center","itemId":"ADDRESS_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#CONTACT1#}","dataIndex":"CONTACT","titleAlign":"center","itemId":"CONTACT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#TEL1#}","dataIndex":"TEL","titleAlign":"center","itemId":"TEL_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#MOBILE#}","dataIndex":"MOBILE","titleAlign":"center","itemId":"MOBILE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#QQ1#}","dataIndex":"QQ","titleAlign":"center","itemId":"QQ_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#WECHAT#}","dataIndex":"WECHAT","titleAlign":"center","itemId":"WECHAT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#EMAIL1#}","dataIndex":"EMAIL","titleAlign":"center","itemId":"EMAIL_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#connect_customer#}","dataIndex":"CUSTOMER_NAME","titleAlign":"center","itemId":"CUSTOMER_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#START_DATE1#}","dataIndex":"START_DATE","format":"Y-m-d","titleAlign":"center","itemId":"START_DATE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#END_DATE#}","dataIndex":"END_DATE","titleAlign":"center","itemId":"END_DATE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#IS_ENABLED_COL#}","xtype":"checkcolumn","dataIndex":"IS_ENABLED","titleAlign":"center","itemId":"IS_ENABLED_COL"},"events":{"checkchange":"indexIds.push(rowIndex);\n"},"children":[],"expanded":false,"type":"column"}],"expanded":false,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}