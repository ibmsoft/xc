{"inframe":false,"title":"付款申请单LOV","hidden":false,"roles":{"default":1},"children":[{"configs":{"serverScript":"// 获取模块语言对应的json文件\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/ap/pay/LOV/LOV_XC_AP_PAY_REQ_H\");","itemId":"module"},"events":{"initialize":"// var ap_pay_h_id = app.AP_PAY_H_ID.getValue();\n// var ledger_id = app.LEDGER_ID_XWL.LEDGER_ID.getValue();\n// var vendor_id = app.VENDOR_ID_XWL.VENDOR_ID.getValue();\n// var ap_contract_id = app.AP_CONTRACT_ID_XWL.AP_CONTRACT_ID.getValue();\n// var ap_doc_cat_code = app.AP_DOC_CAT_CODE.getValue();\n// Wb.ap_pay_h_id = '';//付款单id\n// Wb.ap_doc_cat_code = '';//单据类型\n// Wb.ledger_id = '';//账簿id\n// Wb.vendor_id='';//供应商id\n// Wb.ap_contract_id = '';//合同id\n// Wb.project_id = '';//项目id\nExt.apply(app, {\n  initWin: function(params) {\n    Ext.apply(app, params);\n    app.lovWinN = new Ext.window.Window(app.lovWinN);\n    app.lovWinN.show();\n    \n//     Wb.ap_pay_h_id = params.AP_PAY_H_ID;\n//     Wb.ap_doc_cat_code = params.AP_DOC_CAT_CODE;\n//     Wb.ledger_id = params.LEDGER_ID;\n//     Wb.vendor_id=params.VENDOR_ID;\n//     Wb.ap_contract_id = params.AP_CONTRACT_ID;\n//     Wb.project_id = params.PROJECT_ID;\n    \n    app.LEDGER_ID.setValue(params.LEDGER_ID);\n    app.VENDOR_ID.setValue(params.VENDOR_ID);\n    app.AP_DOC_CAT_CODE.setValue(params.AP_DOC_CAT_CODE);\n    app.PROJECT_ID.setValue(params.PROJECT_ID);\n    app.AP_CONTRACT_ID.setValue(params.AP_CONTRACT_ID);\n    \n  }\n});\n"},"children":[{"configs":{"maximized":"true","layout":"border","itemId":"lovWinN","modal":"true"},"events":{"close":"app.hideFun();"},"children":[{"configs":{"region":"north","itemId":"form1"},"children":[{"configs":{"hidden":"true","itemId":"params"},"children":[{"configs":{"itemId":"LEDGER_ID"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"itemId":"VENDOR_ID"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"itemId":"PROJECT_ID"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"itemId":"AP_CONTRACT_ID"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"itemId":"AP_DOC_CAT_CODE"},"children":[],"expanded":false,"type":"hidden"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","margin":"10 10 10 0","border":"false","itemId":"tr1"},"children":[{"configs":{"hidden":"true","layout":"fit","columnWidth":".25","border":"false","itemId":"tr1_td1"},"children":[{"configs":{"labelWidth":"100","hidden":"true","labelAlign":"right","itemId":"AP_CONTRACT_NAME","fieldLabel":"{#AP_CONTRACT_NAME#}"},"events":{"specialkey":"if(Ext.EventObject.getKey()==13){\n    app.queryBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".25","border":"false","itemId":"tr1_td2"},"children":[{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"AP_PAY_REQ_H_CODE","fieldLabel":"{#AP_PAY_REQ_H_CODE#}"},"events":{"specialkey":"if(Ext.EventObject.getKey()==13){\n    app.queryBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".25","border":"false","itemId":"tr1_td3"},"children":[{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"CREATED_BY_NAME","fieldLabel":"{#CREATED_BY_NAME#}"},"events":{"specialkey":"if(Ext.EventObject.getKey()==13){\n    app.queryBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","columnWidth":".25","border":"false","itemId":"tr1_td4"},"children":[{"configs":{"width":"20","itemId":"space"},"children":[],"expanded":false,"type":"label"},{"configs":{"text":"{#queryBtn#}","itemId":"queryBtn","iconCls":"seek_icon"},"events":{"click":"Wb.reload(app.grid1);"},"children":[],"expanded":false,"type":"button"},{"configs":{"width":"20","itemId":"space1"},"children":[],"expanded":false,"type":"label"},{"configs":{"text":"{#clearBtn#}","itemId":"clearBtn","iconCls":"refresh_icon"},"events":{"click":"app.form1.getForm().reset();\napp.LEDGER_ID.setValue(Wb.ledger_id);\napp.queryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"grid1","editable":"true"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xc/ap/pay/LOV/DB/XC_AP_PAY_REQ_H_SELECT"},"events":{"beforeload":"//       Wb.ap_pay_h_id = params.AP_PAY_H_ID;\n//     Wb.ap_doc_cat_code = params.AP_DOC_CAT_CODE;\n//     Wb.ledger_id = params.LEDGER_ID;\n//     Wb.vendor_id=params.VENDOR_ID;\n//     Wb.ap_contract_id = params.AP_CONTRACT_ID;\n// operation.params = {\n//   LEDGER_ID : Wb.ledger_id,\n//   VENDOR_ID : Wb.vendor_id,\n//   AP_CONTRACT_ID : Wb.ap_contract_id,\n//   AP_DOC_CAT_CODE : Wb.ap_doc_cat_code,\n//   PROJECT_ID : Wb.project_id,\n//   AP_PAY_REQ_H_CODE : app.AP_PAY_REQ_H_CODE.getValue(),\n//   CREATED_BY_NAME : app.CREATED_BY_NAME.getValue()\n// };\noperation.params = Wb.getValue(app.form1);"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#commitBtn#}","itemId":"commitBtn"},"events":{"click":"var recs = app.grid1.getSelection();\nif (recs.length === 0) {\n  Wb.toast(\"{#qzsxzytjl#}\");//请选择至少一条记录！\n  return;\n}\nvar rows = Wb.getData(recs);\nvar isContinue = false;\nWb.each(rows, function(row) {\n  if(Wb.isEmpty(row.PAY_AMT)){\n    Wb.toast(\"{#zfjebnwk#}\");//支付金额不能为空！\n    isContinue = false;\n    return false;\n  }\n  if(row.PAY_AMT === 0){\n    Wb.toast(\"{#zfjebnwl#}\");//支付金额不能为 0 ！\n    isContinue = false;\n    return false;\n  }\n  isContinue = true;\n});\nif(isContinue){\n  Wb.confirm('{#qdyxzd#} ' + recs.length + ' {#tjlm#}', function() {//确定要选择的  条记录吗？\n    app.hideFun(recs);\n    app.lovWinN.close();\n  });\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#closeBtn#}","itemId":"closeBtn"},"events":{"click":"app.lovWinN.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#BIZ_DATE_COL#}","width":"100","dataIndex":"BIZ_DATE","titleAlign":"center","itemId":"BIZ_DATE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AP_PAY_REQ_H_CODE_COL#}","width":"150","dataIndex":"AP_PAY_REQ_H_CODE","titleAlign":"center","itemId":"AP_PAY_REQ_H_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#REQ_DESCRIPTION_COL#}","width":"150","dataIndex":"DESCRIPTION","titleAlign":"center","itemId":"REQ_DESCRIPTION_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#L_AMOUNT_COL#}","align":"right","width":"100","dataIndex":"L_AMOUNT","format":"0,000.00","titleAlign":"center","itemId":"L_AMOUNT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#L_PAID_AMT_COL#}","align":"right","dataIndex":"L_PAID_AMT","format":"0,000.00","titleAlign":"center","itemId":"L_PAID_AMT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#L_NO_PAY_AMT_COL#}","align":"right","dataIndex":"L_NO_PAY_AMT","format":"0,000.00","titleAlign":"center","itemId":"L_NO_PAY_AMT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#PAY_AMT_COL#}","align":"right","width":"100","dataIndex":"PAY_AMT","format":"0,000.00","titleAlign":"center","itemId":"PAY_AMT_COL","renderer":"metaData.style='background-color:#ffffd0';\nreturn Ext.util.Format.number(value,'0,000.00');"},"children":[{"configs":{"itemId":"editor"},"events":{"change":"var rec = app.grid1.getSelection()[0];\nvar amt = rec.data.L_NO_PAY_AMT;\nif(amt<newValue){\n\tWb.toast('{#zfjebkcgkzfje#}');//支付金额不可超过可支付金额！\n    number.setValue(amt);\n}\nif(newValue < 0 ){\n  Wb.toast('{#zfjeydyl#}');\n  number.setValue();\n  return false;\n}"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"column"},{"configs":{"text":"{#AP_INV_GL_H_CODE_COL#}","width":"150","dataIndex":"AP_INV_GL_H_CODE","titleAlign":"center","itemId":"AP_INV_GL_H_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#GL_DESCRIPTION_COL#}","width":"150","dataIndex":"INV_DESCRIPTION","titleAlign":"center","itemId":"GL_DESCRIPTION_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AP_CONTRACT_NAME_COL#}","width":"120","dataIndex":"INV_AP_CONTRACT_NAME","titleAlign":"center","itemId":"AP_CONTRACT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#DEPT_NAME_COL#}","width":"120","dataIndex":"INV_DEPT_NAME","titleAlign":"center","itemId":"DEPT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#PROJECT_NAME_COL#}","width":"120","dataIndex":"INV_PROJECT_NAME","titleAlign":"center","itemId":"PROJECT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AP_ACC_NAME_DEBT_COL#}","width":"120","dataIndex":"INV_AP_ACC_NAME_DEBT","titleAlign":"center","itemId":"AP_ACC_NAME_DEBT_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"window"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}