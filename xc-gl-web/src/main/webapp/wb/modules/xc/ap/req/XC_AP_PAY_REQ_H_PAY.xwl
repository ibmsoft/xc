{"inframe":false,"title":"付款申请单支付","hidden":false,"roles":{"default":1},"children":[{"configs":{"serverScript":"com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,'xc/ap/req/json/XC_AP_PAY_REQ_H_PAY');","itemId":"module"},"events":{"finalize":"function returnRowFn(r,type){\n  if(type==='xc_gl_ledgers'){\n     Wb.reload(app.grid1);\n  }\n}\nfunction clearOtherFn(type){\n  if(type=='xc_gl_ledgers'){\n  }\n}\n"},"children":[{"configs":{"itemId":"request"},"children":[{"configs":{"autoLoad":"true","itemId":"ldInitStore","url":"m?xwl=xc/com-lov/LEDGER_ID_PICK/DB/XC_GL_LEDGERS_SELECT_SEC"},"events":{"load":"app.LEDGER_XWL.LEDGER_ID.setValue(store.getAt(0).get('LEDGER_ID'));\napp.LEDGER_XWL.LEDGER_NAME.setValue(store.getAt(0).get('LEDGER_NAME'));\napp.grid1.getStore().load();"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"folder"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","buttonAlign":"center","itemId":"form1"},"children":[{"configs":{"layout":"column","margin":"10 0 0 0","border":"false","itemId":"tr1"},"children":[{"configs":{"layout":"form","columnWidth":".22","border":"false","itemId":"td_1_1"},"children":[{"configs":{"file":"m?xwl=xc/com-lov/LEDGER_ID_PICK/LEDGER_ID_PICK_SEC","itemId":"LEDGER_XWL"},"children":[],"expanded":false,"type":"xwl"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".22","border":"false","itemId":"td_1_2"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"VENDOR_NAME","fieldLabel":"{#vendorName#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"columnWidth":".34","border":"false","itemId":"td_1_4"},"children":[{"configs":{"layout":"column","padding":"0","border":"false","itemId":"tr_1_4_1"},"children":[{"configs":{"layout":"form","columnWidth":".55","padding":"0","border":"false","itemId":"tr_1_4_1_1"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","padding":"0","itemId":"AMOUNT_START","fieldLabel":"{#amount#}"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".1","border":"false","itemId":"tr_1_4_1_2"},"children":[{"configs":{"text":"-","labelAlign":"center","itemId":"label1"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".35","border":"false","itemId":"tr_1_4_1_3"},"children":[{"configs":{"labelWidth":"30","labelAlign":"right","itemId":"AMOUNT_END"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".22","border":"false","itemId":"td_1_3"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"AP_CONTRACT_NAME","fieldLabel":"{#contractName#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","margin":"10 0 10 0","border":"false","itemId":"tr2"},"children":[{"configs":{"layout":"form","columnWidth":".22","border":"false","itemId":"td_2_1"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"PROJECT_NAME","fieldLabel":"{#projectName#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".22","border":"false","itemId":"td_2_2"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"CREATED_BY_NAME","fieldLabel":"{#creatByName#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".34","border":"false","itemId":"td_2_3"},"children":[{"configs":{"layout":"column","border":"false","itemId":"tr_2_4_1"},"children":[{"configs":{"layout":"form","columnWidth":".55","border":"false","itemId":"td_2_4_1_1"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"BIZ_DATE_START","fieldLabel":"{#bizDate#}"},"children":[],"expanded":false,"type":"date"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".1","border":"false","itemId":"td_2_4_1_2"},"children":[{"configs":{"text":"-","labelAlign":"center","itemId":"label1"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".35","border":"false","itemId":"td_2_4_1_3"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"BIZ_DATE_END"},"children":[],"expanded":false,"type":"date"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".22","border":"false","itemId":"td_2_4"},"children":[{"configs":{"layout":"column","border":"false","itemId":"tr_3_4_1"},"children":[{"configs":{"layout":"form","columnWidth":".10","border":"false","itemId":"td_3_4_1_1"},"children":[{"configs":{"itemId":"空格"},"children":[],"expanded":true,"type":"label"},{"configs":{"hidden":"true","value":"E","itemId":"AUDIT_STATUS"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","value":"E","itemId":"SYS_AUDIT_STATUS"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","value":"N","itemId":"IS_PAY_ALL"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","value":"N","itemId":"IS_CLOSE"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".30","border":"false","itemId":"td_3_4_1_2"},"children":[{"configs":{"text":"{#query#}","itemId":"queryBtn","iconCls":"seek_icon"},"events":{"click":"Wb.reload(app.grid1);"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".30","border":"false","itemId":"td_3_4_1_3"},"children":[{"configs":{"text":"{#clear#}","itemId":"clearBtn","iconCls":"refresh_icon"},"events":{"click":"app.form1.getForm().reset();\napp.ldInitStore.load({\ncallback:function(){\n\tWb.reload(app.grid1);\n}\n});\n"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","itemId":"grid1"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xc/ap/req/DB/XC_AP_PAY_REQ_H_SELECT"},"events":{"beforeload":"operation.params = Wb.getValue(app.form1);"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#payAll#}","itemId":"payBtn"},"events":{"click":"var curGrid = app.grid1;\nvar r=curGrid.getSelectionModel().getSelection()[0];\nif (!r) {\n  Wb.toast('{#enclosureMsg#}');\n  return;\n}\n    Wb.run({\n    url: 'm?xwl=xc/ap/pay/XC_AP_PAY_H_NO_C', \n    success: function(app) {\n      app.initWin({\n          AP_PAY_H_ID:'',\n          H_AP_PAY_REQ_H_ID:r.get('AP_PAY_REQ_H_ID'),\n          IS_INSERT:'Y',\n          vGrid: app.grid1,\n          flag: 'payAll',\n          AP_DOC_CAT_CODE:'FKD_'+r.get('AP_DOC_CAT_CODE'),\n          hideFun:function(){\n            Wb.reload(curGrid.store);\n          }\n      });\n    }\n});\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#monitor#}","itemId":"monitorBtn","iconCls":"viewport_icon"},"events":{"click":"\nvar rows=app.grid1.getSelection();\nif(rows.length!=1){\n  Wb.toast('{#monitorMsg1#}');\n}else{\n  if(rows[0].data.AP_PAY_REQ_H_ID !== ''){\n      if(rows[0].data.INS_CODE === null){\n          Wb.toast('{#monitorMsg2#}');\n      }else{\n          //提交流程\n        XipWf.showMonitorPage(rows[0].data.INS_CODE);\n      }   \n  }else{\n      Wb.toast('{#monitorMsg3#}');\n  }\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#payments#}","itemId":"payListBtn"},"events":{"click":"var curGrid = app.grid1;\nvar rec = curGrid.getSelection();\nif (rec.length > 1 || rec.length === 0) {\n    Wb.toast('{#payMsg1#}');\n    return;\n}\nWb.run({\n  url: 'm?xwl=xc/ap/trans/XC_AP_REQ_TRANS_ALL', \n  success: function(app) {\n    app.initWin({\n      SOURCE_ID:rec[0].data.AP_PAY_REQ_H_ID,//来源id（付款申请单id）\n      //AP_INV_GL_H_ID:rec[0].data.AP_INV_GL_H_ID,\n      QUERY_FROM:'SQ'\n    });\n  }\n});"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#ledgerName#}","width":"200","dataIndex":"LEDGER_NAME","titleAlign":"center","itemId":"LEDGER_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#payReqCode#}","width":"200","dataIndex":"AP_PAY_REQ_H_CODE","titleAlign":"center","itemId":"AP_PAY_REQ_H_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#payType#}","width":"200","dataIndex":"AP_DOC_CAT_NAME","titleAlign":"center","itemId":"AP_DOC_CAT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#description#}","dataIndex":"DESCRIPTION","titleAlign":"center","itemId":"DESCRIPTION_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#vendorName#}","dataIndex":"VENDOR_NAME","titleAlign":"center","itemId":"VENDOR_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#applyAmount#}","dataIndex":"AMOUNT","titleAlign":"center","itemId":"AMOUNT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#paidAmt#}","dataIndex":"PAID_AMT","titleAlign":"center","itemId":"PAID_AMT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#bizDate#}","dataIndex":"BIZ_DATE","titleAlign":"center","itemId":"BIZ_DATE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#contractName#}","dataIndex":"AP_CONTRACT_NAME","titleAlign":"center","itemId":"AP_CONTRACT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#deptName#}","dataIndex":"DEPT_NAME","titleAlign":"center","itemId":"DEPT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#projectName#}","dataIndex":"PROJECT_NAME","titleAlign":"center","itemId":"PROJECT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#creatByName#}","dataIndex":"CREATED_BY_NAME","titleAlign":"center","itemId":"CREATED_BY_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#appUserName#}","dataIndex":"APP_USER_NAME","titleAlign":"center","itemId":"APP_USER_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#status#}","dataIndex":"SYS_AUDIT_STATUS_DESC","titleAlign":"center","itemId":"SYS_AUDIT_STATUS_DESC_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#isClose#}","dataIndex":"IS_CLOSE","titleAlign":"center","itemId":"IS_CLOSE_NAME_COL","renderer":"if(value==\"Y\")\n  return '{#Y#}';\nelse  \n  return '{#N#}';"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}