{"inframe":false,"title":"","hidden":false,"roles":{"default":1},"children":[{"configs":{"serverScript":"//   LEDGER_ID : Wb.ledger_id,\n//   VENDOR_ID : Wb.vendor_id,\n//   AP_DOC_CAT_CODE : Wb.ap_doc_cat_code,\n//   AP_CONTRACT_ID : Wb.ap_contract_id,\n//   PROJECT_ID : Wb.project_id,\n//   AP_PAY_H_CODE : app.AP_PAY_H_CODE.getValue(),\n//   CREATED_BY_NAME : app.CREATED_BY_NAME.getValue()\n\nvar sql = '';\nvar data = app.get();\nsql = '';\n\t\n//合同\nif (Wb.isEmpty(data.AP_CONTRACT_ID)) {\n  sql += \" and (h.AP_CONTRACT_ID is null or h.AP_CONTRACT_ID = '') \";\n}else{\n  sql += \" and h.AP_CONTRACT_ID = '\"+data.AP_CONTRACT_ID+\"'\";\n}\nif (!Wb.isEmpty(data.CREATED_BY_NAME)) {\n  sql+=  \" and CREATED_BY_NAME like '%\"+data.CREATED_BY_NAME+\"%' \";\n}\nif (!Wb.isEmpty(data.AP_PAY_H_CODE)) {\n  sql += \" and h.AP_PAY_H_CODE like '%\"+data.AP_PAY_H_CODE+\"%' \";\n}\nrequest.setAttribute('sql', sql);","itemId":"module"},"children":[{"configs":{"oracle":"SELECT\n\th.AP_PAY_H_ID AS L_AP_PAY_H_ID,\n\th.AP_PAY_H_CODE,\n\th.GL_DATE,\n\th.PROJECT_ID,\n\th.DEPT_ID,\n\th.AP_CONTRACT_ID,\n  \th.CREATED_BY,\n\tl.AP_PAY_L_ID AS L_AP_PAY_L_ID,\n\tNVL(l.AMOUNT,0) AS AMOUNT ,\n\tNVL(l.CANCEL_AMT,0) AS CANCEL_AMT,\n\tNVL(l.NO_CANCEL_AMT,0) AS NO_CANCEL_AMT,\n\tl.ACC_ID,\n\tl.CCID,\n\tl.DESCRIPTION,\n\tproject.PROJECT_NAME,\n\tdept.DEPT_NAME,\n\tcontract.AP_CONTRACT_NAME,\n\taccount.ACC_NAME,\n\tccid.CCID_NAME,\n\temp.EMP_NAME AS CREATED_BY_NAME\nFROM\n\txc_ap_pay_h h\nLEFT JOIN xc_gl_ledgers ledger ON ledger.LEDGER_ID = h.LEDGER_ID\nLEFT JOIN xc_pm_projects project ON project.PROJECT_ID = h.PROJECT_ID\nLEFT JOIN xip_pub_depts dept ON dept.DEPT_ID = h.DEPT_ID\nLEFT JOIN xc_ap_contract contract ON contract.AP_CONTRACT_ID = h.AP_CONTRACT_ID\nLEFT JOIN xip_pub_emps emp ON emp.EMP_ID = (select EMP_ID from xip_pub_users where USER_ID=h.CREATED_BY),\n xc_ap_pay_l l\nLEFT JOIN xc_gl_accounts account ON account.ACC_ID = l.ACC_ID\nLEFT JOIN xc_gl_ccid ccid ON ccid.CCID = l.CCID\nWHERE\n\th.AP_PAY_H_ID = l.AP_PAY_H_ID\nAND h.LEDGER_ID = {?LEDGER_ID?}\nAND h.VENDOR_ID = {?VENDOR_ID?}\nAND h.AP_DOC_CAT_CODE = 'FKD_YUFK'\nAND l.NO_CANCEL_AMT > 0\nAND h.V_STATUS>=3\nAND h.AP_PAY_H_CODE IS NOT NULL\nAND h.AP_PAY_H_CODE <> ''\nORDER BY\n\th.CREATION_DATE DESC","itemId":"sqlswitcher1","mysql":"SELECT\n\th.AP_PAY_H_ID AS L_AP_PAY_H_ID,\n\th.AP_PAY_H_CODE,\n\th.GL_DATE,\n\th.PROJECT_ID,\n\th.DEPT_ID,\n\th.AP_CONTRACT_ID,\n  \th.CREATED_BY,\n\tl.AP_PAY_L_ID AS L_AP_PAY_L_ID,\n\tIFNULL(l.AMOUNT,0) AS AMOUNT ,\n\tIFNULL(l.CANCEL_AMT,0) AS CANCEL_AMT,\n\tIFNULL(l.NO_CANCEL_AMT,0) AS NO_CANCEL_AMT,\n\tl.ACC_ID,\n\tl.CCID,\n\tl.DESCRIPTION,\n\tproject.PROJECT_NAME,\n\tdept.DEPT_NAME,\n\tcontract.AP_CONTRACT_NAME,\n\taccount.ACC_NAME,\n\tccid.CCID_NAME,\n\temp.EMP_NAME AS CREATED_BY_NAME\nFROM\n\txc_ap_pay_h h\nLEFT JOIN xc_gl_ledgers ledger ON ledger.LEDGER_ID = h.LEDGER_ID\nLEFT JOIN xc_pm_projects project ON project.PROJECT_ID = h.PROJECT_ID\nLEFT JOIN xip_pub_depts dept ON dept.DEPT_ID = h.DEPT_ID\nLEFT JOIN xc_ap_contract contract ON contract.AP_CONTRACT_ID = h.AP_CONTRACT_ID\nLEFT JOIN xip_pub_emps emp ON emp.EMP_ID = (select EMP_ID from xip_pub_users where USER_ID=h.CREATED_BY),\n xc_ap_pay_l l\nLEFT JOIN xc_gl_accounts account ON account.ACC_ID = l.ACC_ID\nLEFT JOIN xc_gl_ccid ccid ON ccid.CCID = l.CCID\nWHERE\n\th.AP_PAY_H_ID = l.AP_PAY_H_ID\nAND h.LEDGER_ID = {?LEDGER_ID?}\nAND h.VENDOR_ID = {?VENDOR_ID?}\nAND h.AP_DOC_CAT_CODE = 'FKD_YUFK'\nAND l.NO_CANCEL_AMT > 0\nAND h.V_STATUS>=3\nAND h.AP_PAY_H_CODE IS NOT NULL\nAND h.AP_PAY_H_CODE <> ''\nORDER BY\n\th.CREATION_DATE DESC"},"children":[],"expanded":false,"type":"sqlswitcher"},{"configs":{"sql":"{#sqlswitcher1#}","itemId":"dataprovider1"},"children":[],"expanded":false,"type":"dataprovider"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}