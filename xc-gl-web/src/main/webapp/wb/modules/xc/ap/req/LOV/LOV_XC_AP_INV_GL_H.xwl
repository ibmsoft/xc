{"inframe":false,"title":"应付单选择LOV","hidden":false,"roles":{"default":1},"children":[{"configs":{"serverScript":"com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,'xc/ap/req/json/LOV_XC_AP_INV_GL_H');","itemId":"module"},"events":{"initialize":"Wb.apPayHId = '';\nWb.ap_doc_cat_code = '';\nWb.vendor_id='';\nWb.contractId='';\nWb.deptId='';\nExt.apply(app, {\n  initWin: function(params) {\n    Ext.apply(app, params);\n    app.lovWinN = new Ext.window.Window(app.lovWinN);\n    app.lovWinN.show();\n    Wb.apPayHId = params.AP_PAY_H_ID;\n    Wb.ap_doc_cat_code = params.AP_DOC_CAT_CODE;\n    Wb.ledger_id = params.LEDGER_ID;\n    app.LEDGER_ID.setValue(Wb.ledger_id);\n    Wb.vendor_id=params.VENDOR_ID;\n    app.VENDOR_ID.setValue( Wb.vendor_id);\n    \n    Wb.contractId=params.CONTRACT_ID;\n    Wb.deptId=params.DEPT_ID;\n    app.AP_CONTRACT_ID.setValue(Wb.contractId);\n    \n    if(!Wb.isEmpty(Wb.contractId)){\n       app.AP_CONTRACT_ID.setValue( \" and AP_CONTRACT_ID= '\"+Wb.contractId+\"'\");\n  \t}else{\n       app.AP_CONTRACT_ID.setValue( 'and (AP_CONTRACT_ID is null or AP_CONTRACT_ID = \"\")');\n  \t}\n     if(!Wb.isEmpty(Wb.deptId)){\n       app.DEPT_ID.setValue( \" and DEPT_ID= '\"+Wb.deptId+\"'\");\n  \t}else{\n       app.DEPT_ID.setValue( 'and DEPT_ID is null');\n  \t}\n    \n    if((Wb.ap_doc_cat_code).indexOf('{#inv-h#}')>-1){\n      app.AP_DOC_CAT_CODE.setValue(\" and AP_DOC_CAT_CODE like '%-H' \");\n      \n    }else{\n      app.AP_DOC_CAT_CODE.setValue(\" and AP_DOC_CAT_CODE not like '%-H' \");\n    }\n  }\n});"},"children":[{"configs":{"maximized":"true","layout":"border","itemId":"lovWinN","modal":"true"},"events":{"close":"app.hideFun();"},"children":[{"configs":{"region":"north","itemId":"form1"},"children":[{"configs":{"layout":"column","margin":"10 0 10 10","border":"false","itemId":"tr1"},"children":[{"configs":{"layout":"form","columnWidth":".245","border":"false","itemId":"td_1_1"},"children":[{"configs":{"labelWidth":"120","labelAlign":"right","itemId":"AP_CONTRACT_NAME","fieldLabel":"{#contractCodeOrName#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".245","border":"false","itemId":"td_1_2"},"children":[{"configs":{"labelWidth":"120","labelAlign":"right","itemId":"AP_INV_GL_H_CODE","fieldLabel":"{#docCodeOrName#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".245","border":"false","itemId":"td_1_3"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"CREATED_BY_NAME","fieldLabel":"{#createByName#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"120","hidden":"true","labelAlign":"right","itemId":"AP_DOC_CAT_CODE"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"120","hidden":"true","labelAlign":"right","itemId":"LEDGER_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"120","hidden":"true","labelAlign":"right","itemId":"VENDOR_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"120","hidden":"true","labelAlign":"right","itemId":"AP_CONTRACT_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"120","hidden":"true","labelAlign":"right","itemId":"DEPT_ID"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".245","border":"false","itemId":"td_3_2"},"children":[{"configs":{"layout":"column","border":"false","itemId":"tr_3_2_1"},"children":[{"configs":{"layout":"form","columnWidth":".02","border":"false","itemId":"td_3_2_1_1"},"children":[{"configs":{"itemId":"空格"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".25","border":"false","itemId":"td_3_2_1_2"},"children":[{"configs":{"text":"{#query#}","itemId":"queryBtn","iconCls":"seek_icon"},"events":{"click":"Wb.reload(app.grid1);"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".2","border":"false","itemId":"td_3_2_1_3"},"children":[{"configs":{"text":"{#reset#}","itemId":"clearBtn","iconCls":"refresh_icon"},"events":{"click":"app.form1.getForm().reset();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":false,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"grid1","editable":"true"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xc/ap/req/LOV/DB/XC_AP_INV_GL_H_SELECT"},"events":{"beforeload":"operation.params = Wb.getValue(app.form1);"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#ok#}","itemId":"commitBtn","iconCls":"ok_icon"},"events":{"click":" var recs = app.grid1.getSelection();\nif (!recs.length) {\n  Wb.toast('{#okMsg1#}');\n  return;\n}\nvar rows = Wb.getData(recs);\nvar isContinue = false;\nWb.each(rows, function(row) {\n  if(Wb.isEmpty(row.PAY_AMT)){\n    Wb.toast('{#okMsg2#}');\n    isContinue = false;\n    return false;\n  }\n  if(row.PAY_AMT>row.PAYABLE_AMT){\n    Wb.toast('{#okMsg5#}');\n    isContinue = false;\n    return false;\n  }\n  isContinue = true;\n});\nif(isContinue){\n  Wb.confirm('{#okMsg3#}' + recs.length + '{#okMsg4#}', function() {\n    app.hideFun(recs);\n    app.lovWinN.close();\n  });\n}\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#cancel#}","itemId":"closeBtn","iconCls":"cancel_icon"},"events":{"click":"app.lovWinN.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#glDate#}","dataIndex":"GL_DATE","titleAlign":"center","itemId":"GL_DATE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#invType#}","dataIndex":"AP_DOC_CAT_NAME","titleAlign":"center","itemId":"AP_DOC_CAT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#invCode#}","width":"120","dataIndex":"AP_INV_GL_H_CODE","titleAlign":"center","itemId":"AP_INV_GL_H_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#contract#}","dataIndex":"AP_CONTRACT_NAME","titleAlign":"center","itemId":"AP_CONTRACT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#deptName#}","dataIndex":"DEPT_NAME","titleAlign":"center","itemId":"DEPT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#projectName#}","dataIndex":"PROJECT_NAME","titleAlign":"center","itemId":"PROJECT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#accName#}","dataIndex":"AP_ACC_NAME_DEBT","titleAlign":"center","itemId":"AP_ACC_NAME_DEBT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#payableAmt#}","align":"right","dataIndex":"PAYABLE_AMT","titleAlign":"center","itemId":"PAYABLE_AMT_COL","renderer":"return Wb.format(value,'0,000.00');"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#payAmt#}","align":"right","dataIndex":"PAY_AMT","titleAlign":"center","itemId":"PAY_AMT_COL","renderer":"metaData.style='background-color:#ffffd0';\nreturn Wb.format(value,'0,000.00');;"},"children":[{"configs":{"itemId":"editor"},"events":{"change":"var rec = app.grid1.getSelection()[0];\nvar amt = rec.data.PAYABLE_AMT;\nif(amt<newValue){\n\tWb.toast('{#okMsg5#}');\n    number.setValue(amt);\n}"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"column"},{"configs":{"text":"{#description#}","dataIndex":"DESCRIPTION","titleAlign":"center","itemId":"DESCRIPTION_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"window"}],"expanded":true,"type":"module"}],"pageLink":"{container:false}","iconCls":""}