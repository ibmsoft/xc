{"inframe":false,"title":"应付单选择LOV","hidden":false,"roles":{"default":1},"children":[{"configs":{"serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/ap/gl/json/LOV_XC_AP_INV_GL_H\");","itemId":"module"},"events":{"initialize":"Wb.apPayHId = '';\nWb.ap_doc_cat_code = '';\n\nExt.apply(app, {\n  initWin: function(params) {\n    Ext.apply(app, params);\n    app.lovWinN = new Ext.window.Window(app.lovWinN);\n    app.lovWinN.show();\n    Wb.apPayHId = params.AP_PAY_H_ID;\n    Wb.ap_doc_cat_code = params.AP_DOC_CAT_CODE;\n    Wb.ledger_id = params.LEDGER_ID;\n    app.LEDGER_ID.setValue(Wb.ledger_id);\n    if((Wb.ap_doc_cat_code).indexOf('应付单红字')>-1){\n      app.AP_DOC_CAT_CODE.setValue(\" and AP_DOC_CAT_CODE like '%-H' \");\n    }else{\n      app.AP_DOC_CAT_CODE.setValue(\" and AP_DOC_CAT_CODE not like '%-H' \");\n    }\n  }\n});"},"children":[{"configs":{"maximized":"true","layout":"border","itemId":"lovWinN","modal":"true"},"events":{"close":"app.hideFun();"},"children":[{"configs":{"region":"north","itemId":"form1"},"children":[{"configs":{"layout":"column","border":"false","itemId":"tr1"},"children":[{"configs":{"layout":"form","columnWidth":".245","border":"false","itemId":"td_1_1"},"children":[{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"AP_CONTRACT_NAME","fieldLabel":"{#AP_CONTRACT_NAME#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".245","border":"false","itemId":"td_1_2"},"children":[{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"AP_INV_GL_H_CODE","fieldLabel":"{#AP_INV_GL_H_CODE#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".245","border":"false","itemId":"td_1_3"},"children":[{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"CREATED_BY_NAME","fieldLabel":"{#CREATED_BY_NAME#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"100","hidden":"true","labelAlign":"right","itemId":"AP_DOC_CAT_CODE"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"100","hidden":"true","labelAlign":"right","itemId":"LEDGER_ID"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".245","border":"false","itemId":"td_3_2"},"children":[{"configs":{"layout":"column","border":"false","itemId":"tr_3_2_1"},"children":[{"configs":{"layout":"form","columnWidth":".02","border":"false","itemId":"td_3_2_1_1"},"children":[{"configs":{"itemId":"空格"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".20","border":"false","itemId":"td_3_2_1_2"},"children":[{"configs":{"text":"{#queryBtn#}","itemId":"queryBtn","iconCls":"seek_icon"},"events":{"click":"Wb.reload(app.grid1);"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".20","border":"false","itemId":"td_3_2_1_3"},"children":[{"configs":{"text":"{#clearBtn#}","itemId":"clearBtn","iconCls":"refresh_icon"},"events":{"click":"app.form1.getForm().reset();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","itemId":"grid1","editable":"true"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xc/ap/gl/LOV/DB/XC_AP_PAY_GL_H_SELECT"},"events":{"beforeload":"operation.params = Wb.getValue(app.form1);"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#commitBtn#}","itemId":"commitBtn"},"events":{"click":"var recs = app.grid1.getSelection();\nif (!recs.length) {\n  Wb.toast(\"请选择至少一条记录！\");\n  return;\n}\nvar rows = Wb.getData(recs);\nvar isContinue = false;\nWb.each(rows, function(row) {\n  if(Wb.isEmpty(row.PAY_AMT)){\n    Wb.toast(\"支付金额不能为空！\");\n    isContinue = false;\n    return false;\n  }\n  if(row.PAY_AMT>row.NO_REQ_AMT){\n    Wb.toast(\"支付金额不能大于可支付金额！\");\n    isContinue = false;\n    return false;\n  }\n  isContinue = true;\n});\nif(isContinue){\n  Wb.confirm('确定要选择的 ' + recs.length + ' 条记录吗？', function() {\n    app.hideFun(recs);\n    app.lovWinN.close();\n  });\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#closeBtn#}","itemId":"closeBtn"},"events":{"click":"app.lovWinN.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#order#}","align":"center","xtype":"rownumberer","width":"50","titleAlign":"center","itemId":"ORDERBY"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#GL_DATE#}","dataIndex":"GL_DATE","itemId":"GL_DATE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AP_DOC_CAT_NAME#}","dataIndex":"AP_DOC_CAT_NAME","itemId":"AP_DOC_CAT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AP_INV_GL_H_CODE#}","dataIndex":"AP_INV_GL_H_CODE","itemId":"AP_INV_GL_H_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#DESCRIPTION#}","hidden":"true","dataIndex":"DESCRIPTION","itemId":"DESCRIPTION_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#NO_REQ_AMT#}","align":"right","dataIndex":"NO_REQ_AMT","format":"0,000.00","itemId":"NO_REQ_AMT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#PAY_AMT#}","align":"right","dataIndex":"PAY_AMT","format":"0,000.00","itemId":"PAY_AMT_COL","renderer":"metaData.style='background-color:#ffffd0';\nreturn value;"},"children":[{"configs":{"itemId":"editor"},"events":{"change":"var rec = app.grid1.getSelection()[0];\nvar amt = rec.data.NO_REQ_AMT;\nif(amt<newValue){\n\tWb.toast('支付金额超过可支付金额');\n    number.setValue(amt);\n}"},"children":[],"expanded":false,"type":"number"}],"expanded":false,"type":"column"},{"configs":{"text":"{#AP_CONTRACT_NAME_COL#}","dataIndex":"AP_CONTRACT_NAME","itemId":"AP_CONTRACT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#DEPT_NAME#}","dataIndex":"DEPT_NAME","itemId":"DEPT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#PROJECT_NAME#}","dataIndex":"PROJECT_NAME","itemId":"PROJECT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AP_ACC_NAME_DEBT#}","dataIndex":"AP_ACC_NAME_DEBT","itemId":"AP_ACC_NAME_DEBT_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"window"}],"expanded":true,"type":"module"}],"pageLink":"{container:false}","iconCls":""}