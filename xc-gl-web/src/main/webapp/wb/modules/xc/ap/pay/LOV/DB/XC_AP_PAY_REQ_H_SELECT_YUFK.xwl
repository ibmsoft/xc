{"inframe":false,"title":"","hidden":false,"roles":{"default":1},"children":[{"configs":{"serverScript":"var sql = \"\";\nvar data = app.get();\n\n//合同\nif (!Wb.isEmpty(data.AP_CONTRACT_ID)) {\n  sql += \" and h.AP_CONTRACT_ID = '\"+data.AP_CONTRACT_ID+\"'\";\n}else{\n  sql += \" and (h.AP_CONTRACT_ID is null or h.AP_CONTRACT_ID = '') \";\n}\n//项目\nif( !Wb.isEmpty(data.PROJECT_ID)){\n  sql += \" and h.PROJECT_ID = '\"+data.PROJECT_ID+\"'\";\n}\n//申请单编码\nif (!Wb.isEmpty(data.AP_PAY_REQ_H_CODE)) {\n    sql+=\" and (h.AP_PAY_REQ_H_CODE like '%\"+data.AP_PAY_REQ_H_CODE+\"%' or h.DESCRIPTION like '%\"+data.AP_PAY_REQ_H_CODE+\"%' )\";\n}\n//制单人\nif (!Wb.isEmpty(data.CREATED_BY_NAME)) {\n  sql+=\" and h.CREATED_BY_NAME like '%\"+data.CREATED_BY_NAME+\"%' \";\n}\n\n\nrequest.setAttribute('sql', sql);","itemId":"module"},"children":[{"configs":{"sql":"SELECT\n\th.*,\n    project.PROJECT_NAME,\n    dept.DEPT_NAME,\n    contract.AP_CONTRACT_NAME\nFROM\n\txc_ap_pay_req_h h\n\t\tLEFT JOIN xc_pm_projects project on project.PROJECT_ID = h.PROJECT_ID\n\t\tLEFT JOIN xip_pub_depts dept on dept.DEPT_ID = h.DEPT_ID\n\t\tLEFT JOIN xc_ap_contract contract on contract.AP_CONTRACT_ID = h.AP_CONTRACT_ID\nWHERE h.AP_DOC_CAT_CODE = 'YUFK'\n  AND h.LEDGER_ID = {?varchar.LEDGER_ID?}\n  AND h.VENDOR_ID = {?varchar.VENDOR_ID?}\n  AND h.AUDIT_STATUS = 'E'\n  AND h.IS_CLOSE = 'N'\n  AND h.NO_PAY_AMT > 0\n{#sql#}\nORDER BY h.CREATION_DATE DESC","itemId":"dataprovider1"},"children":[],"expanded":false,"type":"dataprovider"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}