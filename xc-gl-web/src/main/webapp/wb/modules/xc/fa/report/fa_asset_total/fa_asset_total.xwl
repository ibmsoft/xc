{"inframe":false,"title":"","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"//三方语言,引入对应的json文件\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,'xc/fa/report/fa_asset_total/fa_asset_total');\nrequest.setAttribute('contextPath',request.getContextPath());\nvar sessionVars = request.getSession().getAttribute(com.xzsoft.xip.framework.common.SessionVariable.XZ_SESSION_VARS);\nvar la_system_language = sessionVars.get(com.xzsoft.xip.framework.common.SessionVariable.language);\nrequest.setAttribute('la_system_language',la_system_language);","itemId":"module"},"events":{"initialize":"var codeArray = [];\nvar codeStr = '';\nfunction getChild(node){\n  var childNodes = node.childNodes;\n  for(var i=0;i<childNodes.length;i++){\n  \tvar rootNodes = childNodes[i];\n    codeArray[i] = [];\n    if(rootNodes.get('leaf')=='1'){\n      codeArray[i][0] = rootNodes.get('CAT_CODE');\n    }else if(rootNodes.get('leaf')=='0'){\n    \tfor(var j=0;j<rootNodes.childNodes.length;j++){\n           codeArray[i][j+1] = rootNodes.childNodes[j].get('CAT_CODE');\n        }\n    }\n}\n}"},"children":[{"configs":{"layout":"border","border":"false","itemId":"viewport1"},"children":[{"configs":{"region":"north","layout":"form","border":"false","itemId":"queryForm"},"children":[{"configs":{"layout":"column","border":"false","itemId":"tr1"},"children":[{"configs":{"columnWidth":"0.25","border":"false","itemId":"td1_1"},"children":[{"configs":{"labelWidth":"100","displayField":"LEDGER_NAME","valueField":"LEDGER_ID","labelAlign":"right","itemId":"ledgerCombo","fieldLabel":"{#ledger#}"},"events":{"change":"app.deptCombo.reset();\napp.periodComStart.reset();\napp.periodComEnd.reset();\napp.CAT_CODE_NAME.reset();\napp.CAT_CODE.setValue('');\n"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/fa/report/fa_asset_total/data/getLedger"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"columnWidth":"0.25","border":"false","itemId":"td1_2"},"children":[{"configs":{"labelWidth":"100","displayField":"PERIOD_CODE","valueField":"PERIOD_CODE","labelAlign":"right","itemId":"periodComStart","fieldLabel":"{#period#}"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/fa/report/fa_asset_total/data/getPeriod"},"events":{"beforeload":"var ledgerId = app.ledgerCombo.getValue();\nif(ledgerId==''||ledgerId==null){\n  Wb.toast('{#msg1#}');\n  return;\n}\nstore.proxy.extraParams.ledgerId = ledgerId;"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"columnWidth":"0.25","border":"false","itemId":"td1_4"},"children":[{"configs":{"labelWidth":"15","displayField":"PERIOD_CODE","valueField":"PERIOD_CODE","labelAlign":"right","itemId":"periodComEnd","fieldLabel":"{#to#}"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/fa/report/fa_asset_total/data/getPeriod"},"events":{"beforeload":"var ledgerId = app.ledgerCombo.getValue();\nif(ledgerId==''||ledgerId==null){\n  Wb.toast('{#msg1#}');\n  return;\n}\nstore.proxy.extraParams.ledgerId = ledgerId;"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"columnWidth":"0.25","border":"false","itemId":"td2_1"},"children":[{"configs":{"labelWidth":"80","displayField":"DEPT_NAME","valueField":"DEPT_ID","labelAlign":"right","itemId":"deptCombo","fieldLabel":"{#dept#}"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/fa/report/fa_asset_total/data/getDept"},"events":{"beforeload":"var ledgerId = app.ledgerCombo.getValue();\nif(ledgerId==''||ledgerId==null){\n  Wb.toast('{#msg1#}');\n  return;\n}\nstore.proxy.extraParams.ledgerId = ledgerId; "},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","border":"false","itemId":"tr2"},"children":[{"configs":{"columnWidth":"0.25","border":"false","itemId":"td1_3"},"children":[{"configs":{"labelWidth":"100","displayField":"VAL_NAME","valueField":"VAL_CODE","labelAlign":"right","itemId":"propertyCom","fieldLabel":"{#property#}"},"events":{"change":"app.CAT_CODE_NAME.reset();\napp.CAT_CODE.setValue('');\napp.CAT_CODE_NAME.getPicker().store.load();\n"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/fa/report/fa_asset_total/data/getProperty"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"columnWidth":"0.25","border":"false","itemId":"td1_2"},"children":[{"configs":{"itemId":"CAT_CODE"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"tagConfigs":"{\n   columnWidth : 1\n}","labelWidth":"100","labelAlign":"right","itemId":"CAT_CODE_NAME","fieldLabel":"{#type#}"},"children":[{"configs":{"rootVisible":"false","tagConfigs":"{\n  minWidth : 300,\n  maxHeight : 500\n}","multiSelect":"true","itemId":"pickComp"},"events":{"itemdblclick":"var catCode = record.data.CAT_CODE;\nvar catName = record.data.text;\napp.CAT_CODE.setValue(catCode);\napp.CAT_CODE_NAME.setValue(catName);\napp.CAT_CODE_NAME.collapse();\ngetChild(record);\nif(codeArray.length==0){\n  codeStr = '=\"'+catCode+'\"';\n  return;\n}\ncodeStr = 'in (';\nfor(var i=0;i<codeArray.length;i++){\n  var arr = codeArray[i];\n  for(var j=0;j<arr.length;j++){\n    var code = arr[j];\n    codeStr = codeStr + '\"'+code+'\",';\n    if(i==codeArray.length-1&&j==arr.length-1){\n      \tcodeStr = codeStr + '\" \"'+')';\n    }\n  }\n}\n"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/fa/report/xc_fa_zcmxz/DB/getFaCats"},"events":{"load":"app.CAT_CODE_NAME.getPicker().expandAll(function(){});","beforeload":"var property = app.propertyCom.getValue();\nif(Wb.isEmpty(property)){\n  Wb.toast(\"{#msg4#}\");\n  return false;\n}\n\nvar node = operation.node;\noperation.params.UP_CODE = node.isRoot() ? (property+\"_ROOT\") : operation.node.data.CAT_CODE;\n"},"children":[],"expanded":false,"type":"treestore"}],"expanded":true,"type":"tree"}],"expanded":true,"type":"picker"}],"expanded":true,"type":"panel"},{"configs":{"columnWidth":"0.08","margin":"0 0 0 10","border":"false","itemId":"td1_41"},"children":[{"configs":{"text":"{#query#}","itemId":"queryBtn","iconCls":"seek_icon"},"events":{"click":"var v_ledgerId = app.ledgerCombo.getValue();\nvar v_deptId = app.deptCombo.getValue();\nvar v_periodCode_start = app.periodComStart.getValue();\nvar v_periodCode_end = app.periodComEnd.getValue();\nvar v_property = app.propertyCom.getValue();\nif(Wb.isEmpty(v_ledgerId)){\n  Wb.toast('{#msg1#}');\n  return;\n}\nif(Wb.isEmpty(v_periodCode_start) && Wb.isEmpty(v_periodCode_end )){\n  Wb.toast('{#msg2#}');\n  return;\n}\nif(Wb.isEmpty(v_property)){\n  Wb.toast('{#msg4#}');\n  return;\n}\nvar map = new Ext.util.HashMap();\nvar catValue = app.CAT_CODE.getValue();\nif(catValue==null){\n  catValue = '';\n}\nif(v_deptId==null){\n  v_deptId = '';\n}\n//账簿\nmap.add('LEDGER_ID',v_ledgerId);\nmap.add('CBZX',v_deptId);\nmap.add('startPeriod',v_periodCode_start);\nmap.add('endPeriod',v_periodCode_end);\nmap.add('property',v_property);\nmap.add('codeStr',codeStr);\nvar targetUrl = '{#contextPath#}/ReportServer?reportlet=xc_fa/assetTotal.cpt&__bypagesize__=false';\nvar reportFrame = document.getElementById('assetTotal');\nvar params = '';\nmap.each(function(key, value, length){\n    params +='&'+key+'='+value;\n});\nparams = targetUrl+params;\nreportFrame.src = params;"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"columnWidth":"0.08","border":"false","itemId":"td1_411"},"children":[{"configs":{"text":"{#reset#}","itemId":"resetBtn","iconCls":"refresh_icon"},"events":{"click":"codeStr = '';\napp.queryForm.getForm().reset();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","layout":"fit","html":"<iframe  scrolling=no  frameborder=0 width=100% height=100% id=assetTotal src='{#contextPath#}/ReportServer?reportlet=xc_fa/assetTotal.cpt&language={#la_system_language#}&__bypagesize__=false'><\/iframe>\n","itemId":"reportPanel"},"children":[],"expanded":false,"type":"panel"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}