{"inframe":false,"title":"关闭前校验","hidden":false,"roles":{"default":1},"children":[{"configs":{"initScript":"com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/fa/ld-base/fa-ld-period/XC_FA_LD_PERIOD\");","serverScript":"var ledgerId = request.getParameter(\"LEDGER_ID\");\nvar periodCode = request.getParameter(\"PERIOD_CODE\");\n\n/* \n  期间关闭校验规则\n    1、没有未计提折旧的资产\n    2、本期间的凭证接口的数据都已经生成凭证\n    3、本期间调整单都已经提交\n*/\n\n/* 1、没有未计提折旧的资产 */\napp.run(\n  \"select 1 from xc_fa_additions where where jz>0 and QLQJ is null and SFZJ = 'Y' and LEDGER_ID = '\"+ledgerId+\"' and JTQJ != '\"+periodCode+\"' and '\"+periodCode+\"' between KSJTQJ and TYQJ\", \n  {errorText: '{#additionHasJt#}'\n});\n\n/* 2、本期间的凭证接口的数据都已经生成凭证 */\napp.run(\n  \"select 1 from xc_gl_v_interface_heads where (V_HEAD_ID is null or V_HEAD_ID = '') and PERIOD_CODE = '\"+periodCode+\"'\", \n  {errorText: 'interfaceNotGenerate'}\n);\n\n/* 3、本期间调整单都已经提交 */\napp.run(\n  \"select 1 from xc_fa_adj_h where ADJ_DATE >= DATE_FORMAT('\"+periodCode+\"-01'\"+\", '%Y-%m-%d') and ADJ_DATE <= DATE_FORMAT('\"+periodCode+\"-31'\"+\", '%Y-%m-%d') and AUDIT_STATUS = 'C'\", \n  {errorText: '{#adjsNotSubmit#}'}\n);","itemId":"module"},"children":[],"expanded":false,"type":"module"}],"pageLink":"","iconCls":""}