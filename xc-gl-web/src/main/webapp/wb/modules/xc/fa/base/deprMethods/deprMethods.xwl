{"inframe":false,"title":"","hidden":false,"roles":{"default":1},"children":[{"configs":{"serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/fa/base/deprMethods/deprMethods\");","itemId":"module"},"children":[{"configs":{"layout":"border","itemId":"viewport"},"children":[{"configs":{"region":"north","height":"45","layout":"column","bodyPadding":"10 0 0 20","itemId":"queryPanel"},"children":[{"configs":{"labelWidth":"120","width":"300","labelAlign":"right","itemId":"methodCodeName","fieldLabel":"{#methodCodeName#}"},"events":{"specialkey":"app.queryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#queryBtn#}","width":"60","itemId":"queryBtn","iconCls":"seek_icon","x":"20"},"events":{"click":"var methodCodeName = app.methodCodeName.getValue();\napp.grid.store.load({params:{methodCodeName:methodCodeName}});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#resetBtn#}","width":"60","itemId":"resetBtn","iconCls":"refresh_icon","x":"40"},"events":{"click":"app.methodCodeName.setValue('');\napp.queryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"grid","editable":"true"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#addBtn#}","itemId":"addBtn","iconCls":"file_add_icon"},"events":{"click":"Wb.addEdit(app.grid, {ENABLE_FLAG:'Y'});"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"-","itemId":"sp1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#delBtn#}","itemId":"delBtn","iconCls":"file_delete_icon"},"events":{"click":"Wb.remove(app.grid);\n\napp.saveBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"-","itemId":"sp2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#saveBtn#}","itemId":"saveBtn","iconCls":"save_icon"},"events":{"click":"if (!Wb.verifyGrid(app.grid)){return;} //验证数据是否合法\n\n//判断编码是否存在\nvar modifiedRecords = app.store.getModifiedRecords();\nfor(var i=0; i<modifiedRecords.length; i++){\n  var record = modifiedRecords[i];\n  \n  for(var j=0; j<app.store.getCount(); j++){\n    var compareRecord = app.store.getAt(j);\n    if(record!=compareRecord){\n      if(record.get('METHOD_CODE') == compareRecord.get('METHOD_CODE')){\n        app.grid.getSelectionModel().deselectAll();\n        app.grid.getSelectionModel().select(record);\n        Wb.info(\"{#codeExistBeforeMsg#}\" + record.get('METHOD_CODE') + \"{#codeExistAfterMsg#}\");\n        return;\n      }\n    }\n  }\n}\n\nWb.sync({\n  grid: app.grid,\n  url: 'm?xwl=xc/fa/base/deprMethods/data/save',\n  message: '{#saveWaitMsg#}',\n  success: function(resp) {\n    Wb.info('{#successMsg#}');\n    //ID_FIELD值在后台生成，把返回的ID_FIELD值列表同步到表格中\n    Wb.syncCreate(app.grid, Wb.decode(resp.responseText));\n  }\n});"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"-","itemId":"sp3"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#impBtn#}","itemId":"impBtn","iconCls":"db_import_icon"},"events":{"click":"Xip.importExcel('XC_FA_DEPR_METHODS', function(){\n  app.store.load();\n});"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"-","itemId":"sp4"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#expBtn#}","itemId":"expBtn","iconCls":"db_export_icon"},"events":{"click":"Xip.exportExcel('XC_FA_DEPR_METHODS', {}, '折旧方法');"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xc/fa/base/deprMethods/data/getDeprMethods"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"width":"40","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"rowCol"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#methodCodeCol#}<font color=\"red\">*<\/font>","width":"180","dataIndex":"METHOD_CODE","itemId":"methodCodeCol"},"children":[{"configs":{"allowBlank":"false","itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"},{"configs":{"text":"{#methodNameCol#}<font color=\"red\">*<\/font>","width":"180","dataIndex":"METHOD_NAME","itemId":"methodNameCol"},"children":[{"configs":{"allowBlank":"false","itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"},{"configs":{"text":"{#deprClassCol#}","width":"180","dataIndex":"DEPR_CLASS","itemId":"deprClassCol"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"},{"configs":{"text":"{#methodDescCol#}","dataIndex":"METHOD_DESC","itemId":"methodDescCol","flex":"1"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"},{"configs":{"text":"{#enableFlagCol#}","align":"center","width":"80","dataIndex":"ENABLE_FLAG","titleAlign":"center","itemId":"enableFlagCol","renderer":"if(value=='Y'){\n  return '{#enableFlag#}';\n}else{\n  return '<font color=\"red\">{#disableFlag#}<\/font>';\n}"},"children":[{"configs":{"pickList":"[['Y','{#enableFlag#}'],['N','{#disableFlag#}']]","itemId":"editor"},"children":[],"expanded":false,"type":"combo"}],"expanded":true,"type":"column"},{"configs":{"text":"{#methodIdCol#}","hidden":"true","dataIndex":"METHOD_ID","itemId":"methodIdCol"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}