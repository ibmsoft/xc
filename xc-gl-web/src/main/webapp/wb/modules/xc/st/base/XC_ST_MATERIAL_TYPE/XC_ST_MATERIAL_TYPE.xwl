{"inframe":false,"title":"物料分类维护","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/st/base/XC_ST_MATERIAL_TYPE/json/XC_ST_MATERIAL_TYPE\");","itemId":"module"},"events":{"finalize":"var MAT_TYPE_SET_ID = null;\nvar MAT_TYPE_SET_NAME = null;\nvar UPPER_ID = null;\nvar MATERIAL_TYPE_NAME = null;\nvar opType = null;\nvar upIdStr = '';"},"children":[{"configs":{"itemId":"tools"},"children":[{"configs":{"height":"250","width":"280","layout":"column","closeAction":"hide","buttonAlign":"center","border":"false","itemId":"editWindow","modal":"true"},"children":[{"configs":{"itemId":"buttons"},"children":[{"configs":{"text":"{#XC_ST_MATERIAL_TYPE_topSaveBtn#}","itemId":"saveBtn","iconCls":"save_icon"},"events":{"click":"if(!Wb.verify(app.editWindow)){\n    Wb.toast('{#XC_ST_MATERIAL_TYPE_qsrsybsx#}');//请输入所有必输项！\n\treturn;\n}\nvar url = null;\nif(opType == 'Add'){\n    url = 'm?xwl=xc/st/base/XC_ST_MATERIAL_TYPE/data/stMaterialTypeAdd';\n}\nif(opType == 'Update'){\n    url = 'm?xwl=xc/st/base/XC_ST_MATERIAL_TYPE/data/stMaterialTypeUpdate';\n}\nWb.request({\n    url : url,\n    out : app.editWindow,\n    success : function(resp) {\n        Wb.toast('{#XC_ST_MATERIAL_TYPE_sjbccg#}');\n        app.editWindow.hide();\n\t\tapp.bottomQueryBtn.fireEvent('click');\n        app.treeQueryBtn.fireEvent('click');\n        app.tree.expandAll(function(){});\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_MATERIAL_TYPE_cancelBtn#}","itemId":"cancelBtn","iconCls":"cancel_icon"},"events":{"click":"app.editWindow.hide();"},"children":[],"expanded":false,"type":"button"}],"expanded":false,"type":"array"},{"configs":{"tagConfigs":"baseCls : 'my-panel-no-border'","margin":"25 0 0 0","border":"false","itemId":"tr1"},"children":[{"configs":{"labelWidth":"100","allowBlank":"false","labelAlign":"right","itemId":"MATERIAL_TYPE_CODE","fieldLabel":"<font color='red'>*<\/font>{#XC_ST_MATERIAL_TYPE_MATERIAL_TYPE_CODE_COL#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"100","hidden":"true","labelAlign":"right","itemId":"MATERIAL_TYPE_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"100","hidden":"true","labelAlign":"right","itemId":"UPPER_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"100","hidden":"true","labelAlign":"right","itemId":"MAT_TYPE_SET_ID"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls : 'my-panel-no-border'","margin":"5 0 0 0","border":"false","itemId":"tr2"},"children":[{"configs":{"labelWidth":"100","allowBlank":"false","labelAlign":"right","itemId":"MATERIAL_TYPE_NAME","fieldLabel":"<font color='red'>*<\/font>{#XC_ST_MATERIAL_TYPE_MATERIAL_TYPE_NAME_COL#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls : 'my-panel-no-border'","margin":"5 0 0 0","border":"false","itemId":"tr3"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"UP_TYPE","fieldLabel":"{#XC_ST_MATERIAL_TYPE_UP_TYPE_COL#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls : 'my-panel-no-border'","margin":"5 0 5 0","border":"false","itemId":"tr4"},"children":[{"configs":{"labelWidth":"100","allowBlank":"false","labelAlign":"right","pickList":"[['Y','启用'],['N','不启用']]","itemId":"STATUS","fieldLabel":"{#XC_ST_MATERIAL_TYPE_STATUS_COL#}"},"children":[],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"window"},{"configs":{"title":"{#XC_ST_MATERIAL_TYPE_windowTitle#}","height":"350","width":"500","layout":"border","closeAction":"hide","border":"false","itemId":"window","modal":"true"},"children":[{"configs":{"region":"center","selType":"checkboxmodel","barExportButtons":"false","barExportAllButtons":"false","itemId":"topGrid","editable":"true"},"events":{"tagEvents":"cellclick:function(view, td, cellIndex, record, tr, rowIndex, event, options){\n  if(cellIndex == 3){\n      if(record.get('OP_TYPE')=='Add'){\n          app.MAT_TYPE_SET_CODE_COL.getEditor().setReadOnly(false);\n      }else{\n          app.MAT_TYPE_SET_CODE_COL.getEditor().setReadOnly(true);\n      }\n  }\n}"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/common/data/stMatTypeSetSelect"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#XC_ST_MATERIAL_TYPE_topAddBtn#}","itemId":"topAddBtn","iconCls":"file_add_icon"},"events":{"click":"Wb.addEdit(app.topGrid,[{MAT_TYPE_SET_ID : Xip.getId(),OP_TYPE : \"Add\"}]);"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_MATERIAL_TYPE_topSaveBtn#}","itemId":"topSaveBtn","iconCls":"save_icon"},"events":{"click":"var rec = app.topGrid.getSelection();//选择一行信息\nvar modify = app.topGrid.store.getModifiedRecords();\nif(modify === '' || modify.length === 0){\n    Wb.toast('{#XC_ST_MATERIAL_TYPE_mysjxybc#}');//没有数据需要保存！\n\treturn;\n}\nif(!Wb.verifyGrid(app.topGrid))//验证数据是否合法\n\treturn;\nWb.sync({\n    grid : app.topGrid,\n    url : 'm?xwl=xc/st/base/XC_ST_MATERIAL_TYPE/data/stMatTypeSetUpdate',\n    success : function(resp) {\n        Wb.toast('{#XC_ST_MATERIAL_TYPE_sjbccg#}');//数据保存成功\n\t\tapp.topQueryBtn.fireEvent('click');\n        app.window.hide();\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_MATERIAL_TYPE_topDeleteBtn#}","itemId":"topDeleteBtn","iconCls":"file_delete_icon"},"events":{"click":"var recs = app.topGrid.getSelection();//获得选中数据\nif (!recs.length) {//选中的数据条数\n\tWb.toast('{#XC_ST_MATERIAL_TYPE_qxzxyscdjl#}');//请选择需要删除的记录\n\treturn;\n}\nWb.confirm('{#XC_ST_MATERIAL_TYPE_qdyscxzd#} ' + recs.length + ' {#XC_ST_MATERIAL_TYPE_tjlm#}',function() {//确定要删除选择的\n    Wb.request({\n        url : 'm?xwl=xc/st/base/XC_ST_MATERIAL_TYPE/data/stMatTypeSetDelete',\n        params : {'infoArray' : Wb.encode(Wb.getData(recs))},//传参\n        success: function(resp){\n            Wb.toast('{#XC_ST_MATERIAL_TYPE_wlfljsccg#}');//物料分类集删除成功！\n            Wb.remove(app.topGrid,recs);\n        }\n    });\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"查询","hidden":"true","itemId":"topQueryBtn","iconCls":"seek_icon"},"events":{"click":"app.topGrid.store.load();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#XC_ST_MATERIAL_TYPE_NUMBER_COL#}","xtype":"rownumberer","width":"50","align":"center","titleAlign":"center","itemId":"NUMBER_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ID","hidden":"true","dataIndex":"MAT_TYPE_SET_ID","titleAlign":"center","itemId":"MAT_TYPE_SET_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>{#XC_ST_MATERIAL_TYPE_MAT_TYPE_SET_CODE_COL#}","width":"200","dataIndex":"MAT_TYPE_SET_CODE","titleAlign":"center","itemId":"MAT_TYPE_SET_CODE_COL"},"children":[{"configs":{"allowBlank":"false","itemId":"editor"},"events":{"change":"var rec = app.topGrid.getSelection();//获得选中数据\nvar row = app.topGrid.store.indexOf(rec[0]);//获得选中行号\nfor(var i = 0;i < app.topGrid.store.getCount();i++){\n    var data = app.topGrid.store.getAt(i);\n    if(newValue == data.get(\"MAT_TYPE_SET_CODE\") && row != i && !Wb.isEmpty(newValue)){\n\t\tWb.toast('{#XC_ST_MATERIAL_TYPE_MAT_TYPE_SET_CODE_COL#} \"' + newValue + '\" {#XC_ST_MATERIAL_TYPE_yjcz#}');\n        text.setValue(null);\n        return;\n    }\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>{#XC_ST_MATERIAL_TYPE_MAT_TYPE_SET_NAME_COL#}","width":"200","dataIndex":"MAT_TYPE_SET_NAME","titleAlign":"center","itemId":"MAT_TYPE_SET_NAME_COL"},"children":[{"configs":{"allowBlank":"false","itemId":"editor"},"events":{"change":"var rec = app.topGrid.getSelection();//获得选中数据\nvar row = app.topGrid.store.indexOf(rec[0]);//获得选中行号\nfor(var i = 0;i < app.topGrid.store.getCount();i++){\n    var data = app.topGrid.store.getAt(i);\n    if(newValue == data.get(\"MAT_TYPE_SET_NAME\") && row != i && !Wb.isEmpty(newValue)){\n\t\tWb.toast('{#XC_ST_MATERIAL_TYPE_MAT_TYPE_SET_NAME_COL#} \"' + newValue + '\" {#XC_ST_MATERIAL_TYPE_yjcz#}');\n        text.setValue(null);\n        return;\n    }\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"window"}],"expanded":true,"type":"folder"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","layout":"form","itemId":"search_form"},"children":[{"configs":{"layout":"column","margin":"5 0 5 0","itemId":"row1","border":"false"},"children":[{"configs":{"layout":"form","columnWidth":".33","border":"false","itemId":"row1_1"},"children":[{"configs":{"labelWidth":"80","displayField":"MAT_TYPE_SET_NAME","valueField":"MAT_TYPE_SET_NAME","labelAlign":"right","itemId":"MAT_TYPE_SET_NAME","fieldLabel":"{#XC_ST_MATERIAL_TYPE_MAT_TYPE_SET_NAME#}"},"events":{"select":"MAT_TYPE_SET_ID = records[0].data.MAT_TYPE_SET_ID;\nMAT_TYPE_SET_NAME = records[0].data.MAT_TYPE_SET_NAME;\nUPPER_ID = 1;\nupIdStr = '';\napp.treeQueryBtn.fireEvent('click');\napp.bottomQueryBtn.fireEvent('click');\napp.tree.expandAll(function(){});"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/common/data/stMatTypeSetSelect"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","border":"false","itemId":"row1_2"},"children":[{"configs":{"text":"{#XC_ST_MATERIAL_TYPE_maintainBtn#}","margin":"2 0 0 0","itemId":"maintainBtn","iconCls":"settings1_icon"},"events":{"click":"var win = new Ext.window.Window(app._window);\napp.topGrid.store.load();\nwin.show();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","title":"{#XC_ST_MATERIAL_TYPE_bottomPanelTitle#}","layout":"border","border":"false","itemId":"bottomPanel"},"children":[{"configs":{"region":"west","width":"280","layout":"form","border":"false","itemId":"treePanel"},"children":[{"configs":{"rootVisible":"false","root":"{id:'root',text:'root',expanded:true}","border":"false","itemId":"tree"},"events":{"itemclick":"UPPER_ID = record.data.id;\nMATERIAL_TYPE_NAME = record.data.text;\nupIdStr = '';\nif(record.data.parent_id != '1parent_id'){\n    var flag = true;\n    //cascadeby 遍历该节点下的所有节点（包括自己）\n    record.cascadeBy(function(node){\n        if(node.isLeaf()){\n            if(flag){\n                upIdStr += \"'\"+node.data.id+\"'\";\n                flag = false;\n            }\n            else{\n                upIdStr += \",'\"+node.data.id+\"'\";\n            }\n        }\n        else{\n            upIdStr += \"'\"+node.data.id+\"',\";\n        }\n    });\n    if(!Wb.isEmpty(upIdStr)){\n        upIdStr = \"IN (\"+upIdStr+\")\";\n    }\n}\napp.bottomQueryBtn.fireEvent('click');","tagEvents":"itemcontextmenu: function(view, record, item, index, event, options) {\n    event.preventDefault();\n    event.stopEvent();\n    var MATERIAL_TYPE_ID = record.get('id');\n    var UPPER_ID = record.get('parent_id');\n    var MAT_TYPE_SET_ID = record.get('set_id');\n    var MATERIAL_TYPE_CODE = record.get('code');\n    var MATERIAL_TYPE_NAME = record.get('text');\n    var UP_TYPE = record.get('UP_TYPE');\n    var STATUS = record.get('status');\n    var leaf = record.get(\"leaf\");\n    var nodemenu;\n    if(MATERIAL_TYPE_ID == '1') {\n        nodemenu = new Ext.menu.Menu({\n            items: [{\n                text: '{#XC_ST_MATERIAL_TYPE_topAddBtn#}{#XC_ST_MATERIAL_TYPE_xjwlfl#}',//新增下级物料分类\n                iconCls: 'file_add_icon',\n                handler: function() {\n                    var win = new Ext.window.Window(app._editWindow);\n                    app.MATERIAL_TYPE_ID.setValue(Xip.getId());\n                    app.UPPER_ID.setValue(MATERIAL_TYPE_ID);\n                    app.MAT_TYPE_SET_ID.setValue(MAT_TYPE_SET_ID);\n                    app.UP_TYPE.setValue(MATERIAL_TYPE_NAME);\n                    app.STATUS.setValue('Y');\n                    opType = 'Add';\n                    win.setTitle('{#XC_ST_MATERIAL_TYPE_topAddBtn#}[' + record.get('text') + ']{#XC_ST_MATERIAL_TYPE_xjwlfl#}');//新增[' + record.get('text') + ']下级菜单\n                    win.show();\n                    win.setIconCls('file_add_icon');\n                }\n            }]\n        });\n        nodemenu.showAt(event.getPoint());\n    }\n    else{\n        //判断是否被引用\n        Wb.request({\n            url: 'm?xwl=xc/st/common/data/stMaterialSelect',\n            params: {MATERIAL_TYPE_ID : MATERIAL_TYPE_ID},\n            success: function(resp) {\n                var rec = Wb.decode(resp.responseText);\n                if(rec.total !== 0){\n                    nodemenu = new Ext.menu.Menu({\n                        items: [{\n                            text: '{#XC_ST_MATERIAL_TYPE_topAddBtn#}{#XC_ST_MATERIAL_TYPE_tjwlfl#}',//新增同级物料分类\n                            iconCls: 'file_add_icon',\n                            handler: function() {\n                                var win = new Ext.window.Window(app._editWindow);\n                                app.MATERIAL_TYPE_ID.setValue(Xip.getId());\n                                app.UPPER_ID.setValue(UPPER_ID);\n                                app.MAT_TYPE_SET_ID.setValue(MAT_TYPE_SET_ID);\n                                app.UP_TYPE.setValue(Wb.isEmpty(UP_TYPE) ? MAT_TYPE_SET_NAME : UP_TYPE);\n                                app.STATUS.setValue('Y');\n                                opType = 'Add';\n                                win.setTitle('{#XC_ST_MATERIAL_TYPE_topAddBtn#}[' + record.get('text') + ']{#XC_ST_MATERIAL_TYPE_tjwlfl#}');//新增[' + record.get('text') + ']同级菜单\n                                win.show();\n                                win.setIconCls('file_add_icon');\n                            }\n                        },{\n                            text: '{#XC_ST_MATERIAL_TYPE_xgwlfl#}',//修改物料分类\n                            iconCls: 'file_edit_icon',\n                            handler: function() {\n                                var win = new Ext.window.Window(app._editWindow); //app._win指向配置对象而非实例\n                                app.MATERIAL_TYPE_ID.setValue(MATERIAL_TYPE_ID);\n                                app.MATERIAL_TYPE_CODE.setValue(MATERIAL_TYPE_CODE);\n                                app.MATERIAL_TYPE_NAME.setValue(MATERIAL_TYPE_NAME);\n                                app.MAT_TYPE_SET_ID.setValue(MAT_TYPE_SET_ID);\n                                app.UP_TYPE.setValue(Wb.isEmpty(UP_TYPE) ? MAT_TYPE_SET_NAME : UP_TYPE);\n                                app.UPPER_ID.setValue(UPPER_ID);\n                                app.STATUS.setValue(STATUS);\n                                opType = 'Update';\n                                Wb.setTitle(win, '{#XC_ST_MATERIAL_TYPE_xgwlfl#}[' + record.get('text') + ']');\n                                win.show();\n                                app.MATERIAL_TYPE_CODE.setReadOnly(true);\n                                win.setIconCls('file_edit_icon');\n                            }\n                        }]\n                    });\n                    nodemenu.showAt(event.getPoint());\n                }\n                else {\n                    nodemenu = new Ext.menu.Menu({\n                        items: [{\n                            text: '{#XC_ST_MATERIAL_TYPE_topAddBtn#}{#XC_ST_MATERIAL_TYPE_tjwlfl#}',//新增同级物料分类\n                            iconCls: 'file_add_icon',\n                            handler: function() {\n                                var win = new Ext.window.Window(app._editWindow);\n                                app.MATERIAL_TYPE_ID.setValue(Xip.getId());\n                                app.UPPER_ID.setValue(UPPER_ID);\n                                app.MAT_TYPE_SET_ID.setValue(MAT_TYPE_SET_ID);\n                                app.UP_TYPE.setValue(Wb.isEmpty(UP_TYPE) ? MAT_TYPE_SET_NAME : UP_TYPE);\n                                app.STATUS.setValue('Y');\n                                opType = 'Add';\n                                win.setTitle('{#XC_ST_MATERIAL_TYPE_topAddBtn#}[' + record.get('text') + ']{#XC_ST_MATERIAL_TYPE_tjwlfl#}');//新增[' + record.get('text') + ']同级菜单\n                                win.show();\n                                win.setIconCls('file_add_icon');\n                            }\n                        },{\n                            text: '{#XC_ST_MATERIAL_TYPE_topAddBtn#}{#XC_ST_MATERIAL_TYPE_xjwlfl#}',//新增下级物料分类\n                            iconCls: 'file_add_icon',\n                            handler: function() {\n                                var win = new Ext.window.Window(app._editWindow);\n                                app.MATERIAL_TYPE_ID.setValue(Xip.getId());\n                                app.UPPER_ID.setValue(MATERIAL_TYPE_ID);\n                                app.MAT_TYPE_SET_ID.setValue(MAT_TYPE_SET_ID);\n                                app.UP_TYPE.setValue(MATERIAL_TYPE_NAME);\n                                app.STATUS.setValue('Y');\n                                opType = 'Add';\n                                win.setTitle('{#XC_ST_MATERIAL_TYPE_topAddBtn#}[' + record.get('text') + ']{#XC_ST_MATERIAL_TYPE_xjwlfl#}');//新增[' + record.get('text') + ']下级菜单\n                                win.show();\n                                win.setIconCls('file_add_icon');\n                            }\n                        },{\n                            text: '{#XC_ST_MATERIAL_TYPE_xgwlfl#}',//修改物料分类\n                            iconCls: 'file_edit_icon',\n                            handler: function() {\n                                var win = new Ext.window.Window(app._editWindow); //app._win指向配置对象而非实例\n                                app.MATERIAL_TYPE_ID.setValue(MATERIAL_TYPE_ID);\n                                app.MATERIAL_TYPE_CODE.setValue(MATERIAL_TYPE_CODE);\n                                app.MATERIAL_TYPE_NAME.setValue(MATERIAL_TYPE_NAME);\n                                app.MAT_TYPE_SET_ID.setValue(MAT_TYPE_SET_ID);\n                                app.UP_TYPE.setValue(Wb.isEmpty(UP_TYPE) ? MAT_TYPE_SET_NAME : UP_TYPE);\n                                app.UPPER_ID.setValue(UPPER_ID);\n                                app.STATUS.setValue(STATUS);\n                                opType = 'Update';\n                                Wb.setTitle(win, '{#XC_ST_MATERIAL_TYPE_xgwlfl#}[' + record.get('text') + ']');\n                                win.show();\n                                app.MATERIAL_TYPE_CODE.setReadOnly(true);\n                                win.setIconCls('file_edit_icon');\n                            }\n                        },{\n                            text: '{#XC_ST_MATERIAL_TYPE_topDeleteBtn#}',\n                            iconCls: 'file_delete_icon',\n                            handler: function() {\n                                if (leaf === false) {\n                                    //Wb.toast('物料分类 ' + MATERIAL_TYPE_NAME + ' 存在下级，不能删除！');\n                                    Wb.toast('{#XC_ST_MATERIAL_TYPE_bottomPanelTitle#} \"' + MATERIAL_TYPE_NAME + '\" {#XC_ST_MATERIAL_TYPE_czxjbnsc#}');\n                                    return false;\n                                }\n                                Wb.confirm('{#XC_ST_MATERIAL_TYPE_qdyscxzd#}' + MATERIAL_TYPE_NAME + '{#XC_ST_MATERIAL_TYPE_jlm#}',function() {\n                                    Wb.request({\n                                        url: 'm?xwl=xc/st/base/XC_ST_MATERIAL_TYPE/data/stMaterialTypeDelete',\n                                        params: {'MATERIAL_TYPE_ID': MATERIAL_TYPE_ID},\n                                        success: function() {\n                                            app.bottomQueryBtn.fireEvent('click');\n                                            app.treeQueryBtn.fireEvent('click');\n                                            app.tree.expandAll(function(){});\n                                        }\n                                    });\n                                });\n                            }\n                        }]\n                    });\n                    nodemenu.showAt(event.getPoint());\n                }\n            }\n        });\n    }\n}"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/base/XC_ST_MATERIAL_TYPE/data/stMaterialTypeTreeSelect"},"events":{"beforeload":"var node = operation.node;\noperation.params.parent_id = operation.node.get('id');\noperation.params.MAT_TYPE_SET_ID = MAT_TYPE_SET_ID;\nvar whereSql= ' AND 1 = 1';\nif(!Wb.isEmpty(MAT_TYPE_SET_ID)){\n    if(node.isRoot()){\n        whereSql = \"UNION SELECT '1' AS 'id','' AS 'code',smts.MAT_TYPE_SET_NAME AS 'text','1' 'parent_id',smts.MAT_TYPE_SET_ID 'set_id','' AS 'status','false' AS 'leaf','' AS 'UP_TYPE' FROM xc_st_mat_type_set smts WHERE smts.MAT_TYPE_SET_ID = '\"+MAT_TYPE_SET_ID+\"'\";\n    }\n}\nstore.getProxy().extraParams.whereSql = whereSql;"},"children":[],"expanded":false,"type":"treestore"}],"expanded":true,"type":"tree"},{"configs":{"text":"查询","hidden":"true","itemId":"treeQueryBtn","iconCls":"seek_icon"},"events":{"click":"app.tree.store.load({params : {MAT_TYPE_SET_ID : MAT_TYPE_SET_ID}});"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"region":"center","layout":"border","border":"false","itemId":"bottomGridPanel"},"children":[{"configs":{"region":"center","barExportButtons":"false","barExportAllButtons":"false","itemId":"bottomGrid"},"events":{"itemdblclick":"var win = new Ext.window.Window(app._editWindow); //app._win指向配置对象而非实例\napp.MATERIAL_TYPE_ID.setValue(record.data.MATERIAL_TYPE_ID);\napp.MATERIAL_TYPE_CODE.setValue(record.data.MATERIAL_TYPE_CODE);\napp.MATERIAL_TYPE_NAME.setValue(record.data.MATERIAL_TYPE_NAME);\napp.MAT_TYPE_SET_ID.setValue(record.data.MAT_TYPE_SET_ID);\napp.UP_TYPE.setValue(Wb.isEmpty(record.data.UP_TYPE) ? MAT_TYPE_SET_NAME : record.data.UP_TYPE);\napp.UPPER_ID.setValue(record.data.UPPER_ID);\napp.STATUS.setValue(record.data.STATUS);\nopType = 'Update';\nWb.setTitle(win, '{#XC_ST_MATERIAL_TYPE_xgwlfl#}[' + record.get('MATERIAL_TYPE_NAME') + ']');\nwin.show();\napp.MATERIAL_TYPE_CODE.setReadOnly(true);\nwin.setIconCls('file_edit_icon');"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/base/XC_ST_MATERIAL_TYPE/data/stMaterialTypeSelect"},"events":{"load":"Wb.each(records, function(rec){\n    if(Wb.isEmpty(rec.data.UP_TYPE))\n        rec.set('UP_TYPE',MAT_TYPE_SET_NAME);\n});\nstore.commitChanges();"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#XC_ST_MATERIAL_TYPE_importButton#}","itemId":"importButton","iconCls":"import_icon"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_MATERIAL_TYPE_exportButton#}","itemId":"exportButton","iconCls":"export_icon"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"查询","hidden":"true","itemId":"bottomQueryBtn","iconCls":"seek_icon"},"events":{"click":"app.bottomGrid.store.load({params : {upIdStr : upIdStr,MAT_TYPE_SET_ID : MAT_TYPE_SET_ID}});"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#XC_ST_MATERIAL_TYPE_NUMBER_COL#}","xtype":"rownumberer","width":"50","align":"center","titleAlign":"center","itemId":"NUMBER_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ID","hidden":"true","dataIndex":"MATERIAL_TYPE_ID","titleAlign":"center","itemId":"MATERIAL_TYPE_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_TYPE_MATERIAL_TYPE_CODE_COL#}","width":"120","dataIndex":"MATERIAL_TYPE_CODE","titleAlign":"center","itemId":"MATERIAL_TYPE_CODE_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_TYPE_MATERIAL_TYPE_NAME_COL#}","width":"150","dataIndex":"MATERIAL_TYPE_NAME","titleAlign":"center","itemId":"MATERIAL_TYPE_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_TYPE_STATUS_COL#}","width":"80","dataIndex":"STATUS","titleAlign":"center","itemId":"STATUS_COL","renderer":"if(value == 'Y')\n  return '{#XC_ST_MATERIAL_TYPE_Y#}';\nif(value == 'N')\n  return '{#XC_ST_MATERIAL_TYPE_N#}';"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_TYPE_UP_TYPE_COL#}","width":"120","dataIndex":"UP_TYPE","titleAlign":"center","itemId":"UP_TYPE_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}