{"inframe":false,"title":"成本中心调整","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/st/st_business/XC_ST_COST_CHANGE/json/XC_ST_COST_CHANGE\");\nvar ctxPath = request.getContextPath() ;\nrequest.setAttribute('contextPath',ctxPath);","itemId":"module"},"events":{"finalize":"function returnRowFn(r,type){\n    if(type==='xip_pub_orgs'){\n        app.LEDGER_ID.setValue(r.data.LEDGER_ID);\n        app.ORG_ID.setValue(r.data.ORG_ID);\n        app.WAREHOUSE_XWL.WAREHOUSE_ID.setValue(null);\n        app.WAREHOUSE_XWL.WAREHOUSE_NAME.setValue(null);\n        app.WAREHOUSE_XWL.QUERY_ORG_ID.setValue(r.data.ORG_ID);\n        app.WAREHOUSE_XWL.LEDGER_ID.setValue(r.data.LEDGER_ID);\n        app.searchButton.fireEvent('click');\n        setButtonStatus(false);\n    }\n    if(type==='xc_st_warehouse'){\n        app.searchButton.fireEvent('click');\n        if(r.data.IS_INIT == 'Y' && r.data.STATUS == 'Y'){\n            setButtonStatus(false);\n        }\n        else{\n            setButtonStatus(true);\n        }\n    }\n}\nfunction clearOtherFn(type){\n    if(type=='xip_pub_orgs'){\n    }\n    if(type=='xc_st_warehouse'){\n        app.searchButton.fireEvent('click');\n        setButtonStatus(false);\n    }\n}\nfunction setButtonStatus(flag){\n    app.addBtn.setDisabled(flag);\n    app.editBtn.setDisabled(flag);\n    app.deleteBtn.setDisabled(flag);\n    app.submitBtn.setDisabled(flag);\n}"},"children":[{"configs":{"itemId":"tools"},"children":[{"configs":{"autoLoad":"true","itemId":"orgInitStore","url":"m?xwl=xc/com-lov/ORG_PICK/DB/ORG_SELECT_BY_LEDGER"},"events":{"load":"if(store.getCount() > 0){\n    app.LEDGER_ID.setValue(store.getAt(0).get('LEDGER_ID'));\n    app.ORG_ID.setValue(store.getAt(0).get('ORG_ID'));\n    app.ORG_XWL.LEDGER_ID.setValue(store.getAt(0).get('LEDGER_ID'));\n    app.ORG_XWL.ORG_ID.setValue(store.getAt(0).get('ORG_ID'));\n    app.ORG_XWL.ORG_NAME.setValue(store.getAt(0).get('ORG_NAME'));\n    app.WAREHOUSE_XWL.QUERY_ORG_ID.setValue(store.getAt(0).get('ORG_ID'));\n    app.WAREHOUSE_XWL.LEDGER_ID.setValue(store.getAt(0).get('LEDGER_ID'));\n    app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"folder"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","itemId":"search_form"},"children":[{"configs":{"layout":"column","margin":"5 0 5 0","itemId":"row1","border":"false"},"children":[{"configs":{"layout":"form","columnWidth":".249","itemId":"row1_1","border":"false"},"children":[{"configs":{"file":"m?xwl=xc/com-lov/ORG_PICK/ORG_ALL_PICK","itemId":"ORG_XWL"},"children":[],"expanded":false,"type":"xwl"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","itemId":"row1_2","border":"false"},"children":[{"configs":{"file":"m?xwl=xc/st/common/st_com_lov/XC_ST_WAREHOUSE_LOV/XC_ST_WAREHOUSE_LOV","itemId":"WAREHOUSE_XWL"},"children":[],"expanded":false,"type":"xwl"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","itemId":"row1_3","border":"false"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"ADJUST_REASON","fieldLabel":"{#XC_ST_COST_CHANGE_ADJUST_REASON#}"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","itemId":"row1_4","border":"false"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"ADJUST_PERSON","fieldLabel":"{#XC_ST_COST_CHANGE_ADJUST_PERSON#}"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","margin":"0 0 5 0","itemId":"row2","border":"false"},"children":[{"configs":{"layout":"form","columnWidth":".249","itemId":"row2_1","border":"false"},"children":[{"configs":{"labelWidth":"80","pickList":"[['1','{#XC_ST_COST_CHANGE_STATUS_1#}'],['2','{#XC_ST_COST_CHANGE_STATUS_2#}'],['3','{#XC_ST_COST_CHANGE_STATUS_3#}']]","labelAlign":"right","itemId":"STATUS","fieldLabel":"{#XC_ST_COST_CHANGE_STATUS#}"},"events":{"select":"app.searchButton.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","itemId":"row2_2","border":"false"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"BIZ_DATE_START","fieldLabel":"{#XC_ST_COST_CHANGE_BIZ_DATE#}"},"events":{"select":"app.searchButton.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"date"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","itemId":"row2_3","border":"false"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"BIZ_DATE_END","fieldLabel":"{#XC_ST_COST_CHANGE_TO#}"},"events":{"select":"app.searchButton.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"date"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","border":"false","itemId":"row2_4"},"children":[{"configs":{"layout":"column","border":"false","itemId":"row2_4_1"},"children":[{"configs":{"labelWidth":"80","readOnly":"true","hidden":"true","labelAlign":"right","itemId":"LEDGER_ID","fieldLabel":"账簿ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","readOnly":"true","hidden":"true","labelAlign":"right","itemId":"ORG_ID","fieldLabel":"组织ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#XC_ST_COST_CHANGE_searchButton#}","itemId":"searchButton","iconCls":"seek_icon"},"events":{"click":"app.grid.store.load({params : Wb.getValue(app.search_form)});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_COST_CHANGE_resetButton#}","itemId":"resetButton","iconCls":"refresh_icon"},"events":{"click":"app.search_form.getForm().reset();\napp.searchButton.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","barExportAllButtons":"false","barExportButtons":"false","itemId":"grid","editable":"true"},"events":{"itemdblclick":"if(app.editBtn.disabled === true)\n    app.seekBtn.fireEvent('click');\nelse\n    app.editBtn.fireEvent('click');"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/st_business/XC_ST_COST_CHANGE/data/stCostChangeHSelect"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#XC_ST_COST_CHANGE_addBtn#}","itemId":"addBtn","iconCls":"file_add_icon"},"events":{"click":"Wb.run({\n  url: 'm?xwl=xc/st/st_business/XC_ST_COST_CHANGE/XC_ST_COST_CHANGE_WIN', \n  success: function(apps) {\n      apps.initWin({\n          IS_INSERT : 'Add',\n          COST_CHANGE_H_ID : Xip.getId(),\n          LEDGER_ID : app.LEDGER_ID.getValue(),\n          ORG_ID : app.ORG_XWL.ORG_ID.getValue(),\n          ORG_NAME : app.ORG_XWL.ORG_NAME.getValue(),\n          WAREHOUSE_ID : app.WAREHOUSE_XWL.WAREHOUSE_ID.getValue(),\n          WAREHOUSE_NAME : app.WAREHOUSE_XWL.WAREHOUSE_NAME.getValue(),\n          hideFun:function(){\n              app.searchButton.fireEvent('click');\n          }\n      });\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_COST_CHANGE_editBtn#}","itemId":"editBtn","iconCls":"file_edit_icon"},"events":{"click":"var recs = app.grid.getSelection();//获得选中数据\nif(recs.length != 1){//选中的数据条数\n\tWb.toast('{#XC_ST_COST_CHANGE_qxzytxyxgdjl#}');\n\treturn;\n}\nWb.run({\n  url: 'm?xwl=xc/st/st_business/XC_ST_COST_CHANGE/XC_ST_COST_CHANGE_WIN', \n  success: function(apps) {\n      apps.initWin({\n          IS_INSERT : 'Update',\n          COST_CHANGE_H_ID : recs[0].data.COST_CHANGE_H_ID,\n          hideFun:function(){\n              app.searchButton.fireEvent('click');\n          }\n      });\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_COST_CHANGE_deleteBtn#}","itemId":"deleteBtn","iconCls":"file_delete_icon"},"events":{"click":"var recs = app.grid.getSelection();//获得选中数据\nif (!recs.length) {//选中的数据条数\n\tWb.toast('{#XC_ST_COST_CHANGE_qxzxyscdjl#}');//请选择需要删除的记录！\n\treturn;\n}\nvar deleteArray = [] ;\nfor(var i = 0;i < recs.length;i++){\n    if(recs[i].data.STATUS == '1'){\n        var deleteData =  {stDocId : recs[i].data.COST_CHANGE_H_ID};\n        deleteArray.push(deleteData);\n    }\n}\nif(deleteArray.length === 0){\n    Wb.toast('{#XC_ST_COST_CHANGE_sxdjfcgztbnsc#}');//所选单据非草稿状态，不能删除！\n    return;\n}\nWb.confirm('{#XC_ST_COST_CHANGE_qdyscxzd#} ' + recs.length + ' {#XC_ST_COST_CHANGE_tjlm#}',function() {\n    Wb.request({\n        url : '{#contextPath#}' + '/xcStDocsAction.do?method=deleteXcStDocs',\n        params: Wb.apply({hIds : deleteArray,docClassCode : 'CBTZD'}),\n        success: function(resp){\n            Wb.toast('{#XC_ST_COST_CHANGE_sccg#}');\n            app.searchButton.fireEvent('click');\n        }\n    });\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_COST_CHANGE_submitBtn#}","itemId":"submitBtn","iconCls":"check_icon"},"events":{"click":"var rows = app.grid.getSelection();\nif(rows.length != 1){\n    Wb.toast(\"{#XC_ST_COST_CHANGE_qxzxytjdjl#}\");//请选择需要提交的记录！\n    return;\n}\nelse{\n    if(rows[0].data.STATUS != '1'){\n        Wb.toast('{#XC_ST_COST_CHANGE_sxdjfcgztbntj#}');\n        return;\n    }\n    Wb.request({\n        url: '{#contextPath#}'+'/xcStCommonAction.do?method=updateXcStDocStatus',\n        params: Wb.apply({stDocId : rows[0].data.COST_CHANGE_H_ID,docClassCode : 'CBTZD'}),\n        success: function(resp) {\n            var record = Wb.decode(resp.responseText);\n            if(record.flag == '0')\n                Wb.toast('{#XC_ST_COST_CHANGE_tjcg#');\n            else\n                Wb.toast(record.msg);\n            app.searchButton.fireEvent('click');\n        }\n\t});\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_COST_CHANGE_seekBtn#}","itemId":"seekBtn","iconCls":"seek_icon"},"events":{"click":"var recs = app.grid.getSelection();//获得选中数据\nif(recs.length != 1){//选中的数据条数\n\tWb.toast('{#XC_ST_COST_CHANGE_qxzytxyckdjl#}');//请选择一条需要查看的记录！\n\treturn;\n}\nWb.run({\n  url: 'm?xwl=xc/st/st_business/XC_ST_COST_CHANGE/XC_ST_COST_CHANGE_WIN', \n  success: function(apps) {\n      apps.initWin({\n          IS_INSERT : 'Seek',\n          COST_CHANGE_H_ID : recs[0].data.COST_CHANGE_H_ID,\n          hideFun:function(){\n              app.searchButton.fireEvent('click');\n          }\n      });\n    }\n});"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#XC_ST_COST_CHANGE_NUMBER_COL#}","align":"center","width":"50","xtype":"rownumberer","titleAlign":"center","itemId":"NUMBER_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_COST_CHANGE_COST_CHANGE_H_CODE#}","width":"150","dataIndex":"COST_CHANGE_H_CODE","titleAlign":"center","itemId":"COST_CHANGE_H_CODE_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_COST_CHANGE_BIZ_DATE#}","width":"100","xtype":"datecolumn","dataIndex":"BIZ_DATE","titleAlign":"center","itemId":"BIZ_DATE_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_COST_CHANGE_COST_CHANGE_H_NAME#}","width":"150","dataIndex":"COST_CHANGE_H_NAME","titleAlign":"center","itemId":"COST_CHANGE_H_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_COST_CHANGE_BUSINESS_TYPE_NAME#}","width":"140","dataIndex":"BUSINESS_TYPE_NAME","titleAlign":"center","itemId":"BUSINESS_TYPE_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_COST_CHANGE_ADJUST_REASON#}","width":"180","dataIndex":"ADJUST_REASON","titleAlign":"center","itemId":"ADJUST_REASON_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_COST_CHANGE_ADJUST_PERSON#}","width":"100","dataIndex":"ADJUST_PERSON","titleAlign":"center","itemId":"ADJUST_PERSON_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_COST_CHANGE_WAREHOUSE#}","width":"150","dataIndex":"WAREHOUSE_NAME","titleAlign":"center","itemId":"WAREHOUSE_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_COST_CHANGE_STATUS#}","width":"100","dataIndex":"STATUS","titleAlign":"center","itemId":"STATUS_COL","renderer":"if(value == '1')\n    return '{#XC_ST_COST_CHANGE_STATUS_1#}';\nif(value == '2')\n    return '{#XC_ST_COST_CHANGE_STATUS_2#}';\nif(value == '3')\n    return '{#XC_ST_COST_CHANGE_STATUS_3#}';"},"children":[],"expanded":true,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}