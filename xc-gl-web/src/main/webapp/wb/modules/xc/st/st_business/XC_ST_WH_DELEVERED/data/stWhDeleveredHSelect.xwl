{"inframe":false,"title":"出库及退库主表查询","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"var sql,data = app.get();\nsql = ' WHERE 1 = 1';\nsql+=' AND swdh.LEDGER_ID = {?LEDGER_ID?}';\nsql+=' AND sw.WAREHOUSE_ID = {?WAREHOUSE_ID?}';\n\nif (!Wb.isEmpty(data.DOC_CAT_CODE)) {\n    if(data.DOC_CAT_CODE == 'OTHER')\n        sql+=' AND swdh.DOC_CAT_CODE IN (\"QTCK\",\"QTCK-H\")';\n    if(data.DOC_CAT_CODE == 'XS')\n        sql+=' AND swdh.DOC_CAT_CODE IN (\"XSCK\",\"XSTK\")';\n    if(data.DOC_CAT_CODE == 'LY')\n        sql+=' AND swdh.DOC_CAT_CODE IN (\"LYCK\",\"LYTK\")';\n}\nif (!Wb.isEmpty(data.DELEVERED_H_CODE)) {\n    sql+=' AND (swdh.DELEVERED_H_CODE LIKE \"%'+data.DELEVERED_H_CODE+'%\" OR swdh.DELEVERED_H_NAME LIKE \"%'+data.DELEVERED_H_CODE+'%\")';\n}\nif (!Wb.isEmpty(data.BUSINESS_TYPE_NAME)) {\n    sql+=' AND sbt.BUSINESS_TYPE_NAME \"%'+data.BUSINESS_TYPE_NAME+'%\"';\n}\nif (!Wb.isEmpty(data.BIZ_DATE_START)) {\n    if (!Wb.isEmpty(data.BIZ_DATE_END)) \n        sql+=' and swdh.BIZ_DATE BETWEEN {?BIZ_DATE_START?} and {?BIZ_DATE_END?} ';\n    else\n        sql+=' and swdh.BIZ_DATE >= {?BIZ_DATE_START?}';\n}\nelse{\n    if (!Wb.isEmpty(data.BIZ_DATE_END))\n        sql+=' and swdh.BIZ_DATE <= {?BIZ_DATE_END?}';\n}\nif (!Wb.isEmpty(data.STATUS)) {\n    if(data.STATUS != 'ALL')\n        sql+=' and swdh.STATUS={?STATUS?}';\n}\nif (!Wb.isEmpty(data.CUSTOMER_NAME)) {\n    sql+=' AND av.CUSTOMER_NAME LIKE \"%'+data.CUSTOMER_NAME+'%\"';\n}\nif (!Wb.isEmpty(data.CONTRACT_NAME)) {\n    sql+=' AND ac.AR_CONTRACT_NAME LIKE \"%'+data.CONTRACT_NAME+'%\"';\n}\nif (!Wb.isEmpty(data.SALE_H_NAME)) {\n}\nif (!Wb.isEmpty(data.DELIVERY_H_CODE)) {\n}\nif (!Wb.isEmpty(data.DEPT_NAME)) {\n    sql+=' AND pd.DEPT_NAME LIKE \"%'+data.DEPT_NAME+'%\"';\n}\nif (!Wb.isEmpty(data.PROJECT_NAME)) {\n    sql+=' AND pp.PROJECT_NAME LIKE \"%'+data.PROJECT_NAME+'%\"';\n}\nif (!Wb.isEmpty(data.USE_APPLY_H_CODE)) {\n    sql+=' AND (suap.USE_APPLY_H_CODE LIKE \"%'+data.USE_APPLY_H_CODE+'%\" OR suap.USE_APPLY_H_NAME LIKE \"%'+data.USE_APPLY_H_CODE+'%\")';\n}\nrequest.setAttribute('sql', sql);","itemId":"module"},"children":[{"configs":{"sql":"SELECT\n\tswdh.*,\n\tgl.LEDGER_NAME,\n\tpo.ORG_NAME,\n\tsbt.BUSINESS_TYPE_CODE,\n\tsbt.BUSINESS_TYPE_NAME,\n\tsdc.ST_CAT_NAME,\n\tsuap.USE_APPLY_H_CODE,\n\tsuap.USE_APPLY_H_NAME,\n\tprh.RETURN_H_CODE,\n\tprh.RETURN_H_NAME,\n\tsw.WAREHOUSE_CODE,\n\tsw.WAREHOUSE_NAME,\n\t(SELECT pe.EMP_NAME FROM xip_pub_emps pe,xip_pub_users pu WHERE pe.EMP_ID = pu.EMP_ID AND pu.USER_ID = swdh.CREATED_BY) AS \"EMP_NAME\",\n\t(SELECT pe.EMP_NAME FROM xip_pub_emps pe,xip_pub_users pu WHERE pe.EMP_ID = pu.EMP_ID AND pu.USER_ID = swdh.BUYER_ID) AS \"SALESMAN\",\n\t(SELECT pe.EMP_NAME FROM xip_pub_emps pe,xip_pub_users pu WHERE pe.EMP_ID = pu.EMP_ID AND pu.USER_ID = swdh.RECEIVER_ID) AS \"RECEIVER\",\n    (SELECT DELEVERED_H_CODE FROM xc_st_wh_delevered_h a WHERE swdh.RE_DELEVERED_H_ID = a.DELEVERED_H_ID) RE_DELEVERED_H_CODE,\n\tpd.DEPT_NAME,\n\tpp.PROJECT_NAME,\n\tav.CUSTOMER_NAME,\n\tac.AR_CONTRACT_NAME\nFROM\n\txc_st_wh_delevered_h swdh\nLEFT JOIN xc_gl_ledgers gl ON swdh.LEDGER_ID = gl.LEDGER_ID\nLEFT JOIN xip_pub_orgs po ON swdh.ORG_ID = po.ORG_ID\nLEFT JOIN xc_st_business_type sbt ON swdh.BUSINESS_TYPE_ID = sbt.BUSINESS_TYPE_ID\nLEFT JOIN xc_st_doc_cats sdc ON swdh.DOC_CAT_CODE = sdc.ST_CAT_CODE\nLEFT JOIN xc_st_use_apply_h suap ON swdh.NOTICE_H_ID = suap.USE_APPLY_H_ID\nLEFT JOIN xc_po_return_h prh ON swdh.NOTICE_H_ID = prh.RETURN_H_ID\nLEFT JOIN xc_st_warehouse sw ON swdh.WAREHOUSE_ID = sw.WAREHOUSE_ID\nLEFT JOIN xip_pub_depts pd ON swdh.DEPT_ID = pd.DEPT_ID\nLEFT JOIN xc_pm_projects pp ON swdh.PROJECT_ID = pp.PROJECT_ID\nLEFT JOIN xc_ar_customers av ON swdh.CUSTOMER_ID = av.CUSTOMER_ID\nLEFT JOIN xc_ar_contract ac ON swdh.AR_CONTRACT_ID = ac.AR_CONTRACT_ID\n{#sql#}\nORDER BY swdh.DELEVERED_H_CODE DESC","itemId":"dataprovider1"},"children":[],"expanded":false,"type":"dataprovider"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}