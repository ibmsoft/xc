{"title":"选择物料信息查询（入库、初始化）","inframe":false,"hidden":false,"roles":{"default":1},"pageLink":"","children":[{"configs":{"loginRequired":"false","initScript":"var lang = request.getSession().getAttribute(\"XzSessionVars\").get('language');\nrequest.setAttribute(\"language\",lang);","serverScript":"var sql,data = app.get();\nsql = ' WHERE 1 = 1';\nsql+=' AND smp.LEDGER_ID = {?LEDGER_ID?}';\nif (!Wb.isEmpty(data.MATERIAL_CODE_NAME)) {\n    sql+=' AND (sm.MATERIAL_CODE LIKE \"%'+data.MATERIAL_CODE_NAME+'%\" OR sm.MATERIAL_NAME LIKE \"%'+data.MATERIAL_CODE_NAME+'%\")';\n}\nif (!Wb.isEmpty(data.MATERIAL_TYPE_NAME)) {\n    sql+=' AND smt.MATERIAL_TYPE_NAME LIKE \"%'+data.MATERIAL_TYPE_NAME+'%\"';\n}\nif (!Wb.isEmpty(data.MATERIAL_PARMS_ID)) {\n    sql+=' AND smp.MATERIAL_PARMS_ID = {?MATERIAL_PARMS_ID?}';\n}\nif (!Wb.isEmpty(data.MATERIAL_ID)) {\n    sql+=' AND smp.MATERIAL_ID = {?MATERIAL_ID?}';\n}\nif (!Wb.isEmpty(data.MATERIAL_PRO)) {\n    sql+=' AND sm.MATERIAL_PRO = {?MATERIAL_PRO?}';\n}\nif (!Wb.isEmpty(data.PURCHASE_SALE)) {\n    if(data.PURCHASE_SALE == 'PURCHASE')\n\t\tsql+=' AND smp.IS_PURCHASE = \"Y\"';\n    if(data.PURCHASE_SALE == 'SALE')\n\t\tsql+=' AND smp.IS_SALE = \"Y\"';\n}\nrequest.setAttribute('sql', sql);","itemId":"module"},"children":[{"configs":{"sql":"SELECT\n\tsmp.*,\n\tsm.MATERIAL_CODE,\n\tsm.MATERIAL_NAME,\n\tCONCAT(sm.MATERIAL_CODE,'/',sm.MATERIAL_NAME) MATERIAL_CODE_NAME,\n\tsm.SPECIFICATION,\n\tsm.IMAGES,\n\t(SELECT\n       CASE WHEN l.VAL_NAME IS NULL OR l.VAL_NAME = '' THEN d.VAL_NAME ELSE l.VAL_NAME END DESCRIPTION\n     FROM\n       xip_pub_val_set_dtl d\n     LEFT JOIN XIP_PUB_VAL_SET_DTL_LANG l ON d.VAL_SET_CODE = l.VAL_SET_CODE\n     AND d.VAL_CODE = l.VAL_CODE\n     AND l.VAL_SET_LANG = '{#language#}'\n     WHERE\n       d.VAL_SET_CODE = 'XC_ST_MATERIAL_PROPERTY'\n     AND d.ENABLE_FLAG = 'Y'\n     AND d.VAL_CODE = sm.MATERIAL_PRO) AS MATERIAL_PRO_NAME,\n\tapt.AP_PUR_TYPE_NAME,\n\tgd.DIM_ID,\n\tgd.DIM_NAME,\n    ast.AR_SALE_TYPE_NAME,\n    smt.MATERIAL_TYPE_NAME,\n\tCASE WHEN (smp.IS_BATCH = 'Y')\n    THEN\n\t\t'PC'\n\tWHEN (smp.IS_SERIAL = 'Y')\n\tTHEN\n\t\t'XLH'\n\tELSE\n\t\t'NO'\n    END AS \"BATCH_SERIAL\"\nFROM\n\txc_st_material_parms smp\nLEFT JOIN xc_st_material sm ON smp.MATERIAL_ID = sm.MATERIAL_ID\nLEFT JOIN xc_ap_pur_type apt ON smp.FINACE_TYPE_ID = apt.AP_PUR_TYPE_ID\nLEFT JOIN xc_ar_sale_type ast ON smp.SALE_TYPE_ID = ast.AR_SALE_TYPE_ID\nLEFT JOIN xc_gl_dimensions gd ON smp.DIM_ID = gd.DIM_ID\nLEFT JOIN xc_st_material_type smt ON smp.MATERIAL_TYPE_ID = smt.MATERIAL_TYPE_ID\n{#sql#}\nORDER BY sm.MATERIAL_CODE","itemId":"dataprovider1"},"children":[],"type":"dataprovider","expanded":false}],"type":"module","expanded":true}],"iconCls":""}