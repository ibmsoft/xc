{"inframe":false,"title":"物料编码分配参数设置","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/st/base/XC_ST_MATERIAL/json/XC_ST_MATERIAL\");\nvar contextPath = request.getContextPath();\nrequest.setAttribute(\"contextPath\",contextPath);","itemId":"module"},"events":{"finalize":"var upIdStr = '';","initialize":"function returnRowFn(r,type){\n    if(type==='xip_pub_orgs'){\n        app.LEDGER_NAME.setValue(r.data.LEDGER_NAME);\n        app.LEDGER_ID.setValue(r.data.LEDGER_ID);\n        app.MAT_TYPE_SET_ID.setValue(r.data.MAT_TYPE_SET_ID);\n        app.ORG_ID.setValue(r.data.ORG_ID);\n        app.queryBtn.fireEvent('click');\n    }\n}\nfunction clearOtherFn(type){\n    if(type=='xip_pub_orgs'){\n    }\n}"},"children":[{"configs":{"itemId":"tools"},"children":[{"configs":{"itemId":"orgInitStore","autoLoad":"true","url":"m?xwl=xc/com-lov/ORG_PICK/DB/ORG_SELECT_BY_LEDGER"},"events":{"load":"if(store.getCount() > 0){\n    app.LEDGER_ID.setValue(store.getAt(0).get('LEDGER_ID'));\n    app.LEDGER_NAME.setValue(store.getAt(0).get('LEDGER_NAME'));\n    app.MAT_TYPE_SET_ID.setValue(store.getAt(0).get('MAT_TYPE_SET_ID'));\n    app.ORG_ID.setValue(store.getAt(0).get('ORG_ID'));\n    app.ORG_XWL.ORG_ID.setValue(store.getAt(0).get('ORG_ID'));\n    app.ORG_XWL.ORG_NAME.setValue(store.getAt(0).get('ORG_NAME'));\n    app.queryBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"store"},{"configs":{"title":"{#XC_ST_MATERIAL_syncBtn#}","height":"500","layout":"border","width":"1000","closeAction":"hide","buttonAlign":"center","border":"false","dialog":"false","itemId":"syncWindow","modal":"true"},"children":[{"configs":{"region":"north","itemId":"syncForm"},"children":[{"configs":{"layout":"column","margin":"5 0 5 0","border":"false","itemId":"row1"},"children":[{"configs":{"layout":"form","columnWidth":".249","border":"false","itemId":"row1_1"},"children":[{"configs":{"labelWidth":"80","readOnly":"true","labelAlign":"right","itemId":"SYNC_ORG_NAME","fieldLabel":"{#XC_ST_MATERIAL_SYNC_ORG_NAME#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","border":"false","itemId":"row1_2"},"children":[{"configs":{"labelWidth":"80","readOnly":"true","hidden":"true","labelAlign":"right","itemId":"SYNC_LEDGER_NAME","fieldLabel":"{#XC_ST_MATERIAL_SYNC_LEDGER_NAME#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","border":"false","itemId":"row1_3"},"children":[{"configs":{"labelWidth":"80","readOnly":"true","displayField":"MAT_TYPE_SET_NAME","valueField":"MAT_TYPE_SET_ID","labelAlign":"right","itemId":"MAT_TYPE_SET_ID","fieldLabel":"{#XC_ST_MATERIAL_MAT_TYPE_SET_NAME#}"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xc/st/common/data/stMatTypeSetSelect"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","title":"{#XC_ST_MATERIAL_bottomPanelTitle#}","layout":"border","border":"false","itemId":"syncPanel"},"children":[{"configs":{"region":"west","width":"280","layout":"form","border":"false","itemId":"treePanel"},"children":[{"configs":{"rootVisible":"false","root":"{id:'root',text:'root',expanded:true}","border":"false","itemId":"tree"},"events":{"itemclick":"MATERIAL_TYPE_ID = record.data.id;\nMATERIAL_TYPE_NAME = record.data.text;//物料分类名称\nMAT_TYPE_SET_ID = record.data.set_id;\nupIdStr = '';\nif(record.data.parent_id != '1parent_id'){\n    var flag = true;\n    //cascadeby 遍历该节点下的所有节点（包括自己）\n    record.cascadeBy(function(node){\n        if(node.isLeaf()){\n            if(flag){\n                upIdStr += \"'\"+node.data.id+\"'\";\n                flag = false;\n            }\n            else{\n                upIdStr += \",'\"+node.data.id+\"'\";\n            }\n        }\n        else{\n            upIdStr += \"'\"+node.data.id+\"',\";\n        }\n    });\n    if(!Wb.isEmpty(upIdStr)){\n        upIdStr = \"IN (\"+upIdStr+\")\";\n    }\n}\napp.bottomQueryBtn.fireEvent('click');"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/base/XC_ST_MATERIAL_TYPE/data/stMaterialTypeTreeSelect"},"events":{"beforeload":"var node = operation.node;\noperation.params.parent_id = operation.node.get('id');\noperation.params.MAT_TYPE_SET_ID = app.MAT_TYPE_SET_ID.getValue();\nvar whereSql= ' AND 1 = 1';\nif(!Wb.isEmpty(app.MAT_TYPE_SET_ID.getValue())){\n    if(node.isRoot()){\n        whereSql = \"UNION SELECT '1' AS 'id','' AS 'code',smts.MAT_TYPE_SET_NAME AS 'text','1' 'parent_id',smts.MAT_TYPE_SET_ID 'set_id','' AS 'status','false' AS 'leaf','1' AS 'LEVEL' FROM xc_st_mat_type_set smts WHERE smts.MAT_TYPE_SET_ID = '\"+app.MAT_TYPE_SET_ID.getValue()+\"'\";\n    }\n}\nstore.getProxy().extraParams.whereSql = whereSql;"},"children":[],"expanded":false,"type":"treestore"}],"expanded":true,"type":"tree"},{"configs":{"hidden":"true","itemId":"treeQueryBtn","iconCls":"seek_icon"},"events":{"click":"app.tree.store.load({params : {MAT_TYPE_SET_ID : app.MAT_TYPE_SET_ID.getValue()}});"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"region":"center","layout":"border","border":"false","itemId":"syncGridPanel"},"children":[{"configs":{"region":"center","selType":"checkboxmodel","barExportButtons":"false","barExportAllButtons":"false","itemId":"syncGrid","editable":"true"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/common/data/stMaterialSelect"},"events":{"beforeload":"store.proxy.extraParams.MAT_TYPE_SET_IDS = \"filter\";"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#XC_ST_MATERIAL_selectBtn#}","itemId":"selectBtn","iconCls":"select_all_icon"},"events":{"click":"var rec = app.syncGrid.getSelection();\nif(rec.length === 0){\n    Wb.toast('{#XC_ST_MATERIAL_qxzxytbdsj#}');//请选择需要同步的数据！\n    return;\n}\nWb.request({\n    url : 'm?xwl=xc/st/ld_base/XC_ST_MATERIAL_PARMS/data/stMaterialParamsInsert', \n    params : {ORG_ID : app.ORG_ID.getValue(),\"LEDGER_ID\" : app.LEDGER_ID.getValue(),'infoArray' : Wb.encode(Wb.getData(rec))},\n    success: function(resp) {\n        app.bottomQueryBtn.fireEvent('click');\n        app.queryBtn.fireEvent('click');\n        Wb.toast('{#XC_ST_MATERIAL_tbcg#}');\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"hidden":"true","itemId":"bottomQueryBtn","iconCls":"seek_icon"},"events":{"click":"app.syncGrid.store.load({params : {LEDGER_ID : app.LEDGER_ID.getValue(),upIdStr : upIdStr,MAT_TYPE_SET_ID : app.MAT_TYPE_SET_ID.getValue()}});"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#XC_ST_MATERIAL_NUMBER#}","xtype":"rownumberer","width":"50","align":"center","titleAlign":"center","itemId":"NUMBER_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_MATERIAL_CODE#}","width":"120","dataIndex":"MATERIAL_CODE","titleAlign":"center","itemId":"MATERIAL_CODE_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_MATERIAL_NAME#}","width":"150","dataIndex":"MATERIAL_NAME","titleAlign":"center","itemId":"MATERIAL_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_MATERIAL_PRO#}","width":"120","dataIndex":"MATERIAL_PRO_NAME","titleAlign":"center","itemId":"MATERIAL_PRO_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_bottomPanelTitle#}","width":"120","dataIndex":"MATERIAL_TYPE_NAME","titleAlign":"center","itemId":"MATERIAL_TYPE_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_AP_PUR_TYPE_NAME#}","width":"120","dataIndex":"AP_PUR_TYPE_NAME","titleAlign":"center","itemId":"AP_PUR_TYPE_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_SPECIFICATION#}","width":"120","dataIndex":"SPECIFICATION","titleAlign":"center","itemId":"SPECIFICATION_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_DIM_NAME#}","width":"80","dataIndex":"DIM_NAME","titleAlign":"center","itemId":"DIM_NAME_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":false,"type":"window"},{"configs":{"title":"{#XC_ST_MATERIAL_batchEditBtn#}","height":"300","width":"300","layout":"column","closeAction":"hide","buttonAlign":"center","dialog":"true","border":"false","itemId":"editWindow","modal":"true"},"children":[{"configs":{"itemId":"buttons"},"children":[{"configs":{"text":"{#XC_ST_MATERIAL_saveButton#}","itemId":"saveBtn","iconCls":"save_icon"},"events":{"click":"if(!Wb.verify(app.editWindow)){//验证数据是否合法\n    Wb.toast('{#XC_ST_MATERIAL_qsrsybsx#}');\n\treturn;\n}\nvar recs = app.grid.getSelection();\nvar IS_UPDATE_BATCH_CHCEK = 0;\nvar IS_UPDATE_PURCHASE_CHCEK = 0;\nvar IS_UPDATE_SALE_CHCEK = 0;\nvar IS_UPDATE_PURCHASE_EXCESS_CHCEK = 0;\nvar IS_UPDATE_SALE_EXCESS_CHCEK = 0;\n\nvar IS_BATCH_CHCEK = 'N';\nvar IS_SERIAL_CHCEK = 'N';\nvar IS_PURCHASE_CHCEK = 'N';\nvar IS_SALE_CHCEK = 'N';\nvar IS_PURCHASE_EXCESS_CHCEK = 'N';\nvar IS_SALE_EXCESS_CHCEK = 'N';\n//是否修改\nif(app.IS_UPDATE_BATCH_CHCEK.getValue() === true){\n  IS_UPDATE_BATCH_CHCEK = 1;\n  if(app.IS_BATCH_CHCEK.getValue() === true)\n      IS_BATCH_CHCEK = 'Y';\n  if(app.IS_SERIAL_CHCEK.getValue() === true)\n      IS_SERIAL_CHCEK = 'Y';\n}\nif(app.IS_UPDATE_PURCHASE_CHCEK.getValue() === true){\n    IS_UPDATE_PURCHASE_CHCEK = 1;\n    if(app.IS_PURCHASE_CHCEK.getValue() === true)\n        IS_PURCHASE_CHCEK = 'Y';\n}\nif(app.IS_UPDATE_SALE_CHCEK.getValue() === true){\n    IS_UPDATE_SALE_CHCEK = 1;\n    if(app.IS_SALE_CHCEK.getValue() === true)\n        IS_SALE_CHCEK = 'Y';\n}\nif(app.IS_UPDATE_PURCHASE_EXCESS_CHCEK.getValue() === true){\n    IS_UPDATE_PURCHASE_EXCESS_CHCEK = 1;\n    if(app.IS_PURCHASE_EXCESS_CHCEK.getValue() === true)\n        IS_PURCHASE_EXCESS_CHCEK = 'Y';\n}\nif(app.IS_UPDATE_SALE_EXCESS_CHCEK.getValue() === true){\n    IS_UPDATE_SALE_EXCESS_CHCEK = 1;\n    if(app.IS_SALE_EXCESS_CHCEK.getValue() === true)\n        IS_SALE_EXCESS_CHCEK = 'Y';\n}\n\nWb.request({\n    url: 'm?xwl=xc/st/ld_base/XC_ST_MATERIAL_PARMS/data/stMaterialParamsBatchEdit',\n    params:{IS_UPDATE_BATCH_CHCEK : IS_UPDATE_BATCH_CHCEK,\n            IS_UPDATE_PURCHASE_CHCEK : IS_UPDATE_PURCHASE_CHCEK,\n            IS_UPDATE_SALE_CHCEK : IS_UPDATE_SALE_CHCEK,\n            IS_UPDATE_PURCHASE_EXCESS_CHCEK : IS_UPDATE_PURCHASE_EXCESS_CHCEK,\n            IS_UPDATE_SALE_EXCESS_CHCEK : IS_UPDATE_SALE_EXCESS_CHCEK,\n\n            IS_BATCH_CHCEK : IS_BATCH_CHCEK,\n            IS_SERIAL_CHCEK : IS_SERIAL_CHCEK,\n            IS_PURCHASE_CHCEK : IS_PURCHASE_CHCEK,\n            IS_SALE_CHCEK : IS_SALE_CHCEK,\n            IS_PURCHASE_EXCESS_CHCEK : IS_PURCHASE_EXCESS_CHCEK,\n            IS_SALE_EXCESS_CHCEK : IS_SALE_EXCESS_CHCEK,\n            UPDATE_PURCHASE_PRICE : app.PURCHASE_PRICE.getValue(),\n            UPDATE_SALE_PRICE : app.SALE_PRICE.getValue(),\n\n            'infoArray' : Wb.encode(Wb.getData(recs))},\n    success: function(resp) {\n        app.queryBtn.fireEvent('click');\n        Wb.toast('{#XC_ST_MATERIAL_sjbccg#}');//数据保存成功！\n        app.editWindow.hide();\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_MATERIAL_cancelBtn#}","itemId":"cancelBtn","iconCls":"cancel_icon"},"events":{"click":"app.editWindow.hide();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"rowOp","border":"false"},"children":[{"configs":{"text":"{#XC_ST_MATERIAL_IS_UPDATE#}","margin":"0 0 0 30","itemId":"IS_UPDATE"},"children":[],"expanded":false,"type":"label"},{"configs":{"text":"{#XC_ST_MATERIAL_UPDATE_ITEM#}","margin":"0 0 0 70","itemId":"UPDATE_ITEM"},"children":[],"expanded":false,"type":"label"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row1","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.10","margin":"0 0 0 40","itemId":"IS_UPDATE_BATCH_CHCEK"},"events":{"change":"if(check.getValue() === true){\n\tapp.IS_BATCH_CHCEK.setReadOnly(false);\n    app.IS_SERIAL_CHCEK.setReadOnly(false);\n}\nif(check.getValue() === false){\n\tapp.IS_BATCH_CHCEK.setReadOnly(true);\n    app.IS_SERIAL_CHCEK.setReadOnly(true);\n    app.IS_BATCH_CHCEK.reset();\n    app.IS_SERIAL_CHCEK.reset();\n}"},"children":[],"expanded":false,"type":"check"},{"configs":{"labelWidth":"120","readOnly":"true","margin":"0 0 0 20","labelAlign":"right","itemId":"IS_BATCH_CHCEK","fieldLabel":"{#XC_ST_MATERIAL_IS_BATCH#}"},"events":{"change":"if(newValue === true){\n    app.IS_SERIAL_CHCEK.reset();\n}"},"children":[],"expanded":false,"type":"check"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row2","border":"false"},"children":[{"configs":{"labelWidth":"120","readOnly":"true","margin":"0 0 0 73","labelAlign":"right","itemId":"IS_SERIAL_CHCEK","fieldLabel":"{#XC_ST_MATERIAL_IS_SERIAL#}"},"events":{"change":"if(newValue === true){\n    app.IS_BATCH_CHCEK.reset();\n}"},"children":[],"expanded":false,"type":"check"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row3","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.10","margin":"0 0 0 40","itemId":"IS_UPDATE_PURCHASE_CHCEK"},"events":{"change":"if(check.getValue() === true){\n\tapp.IS_PURCHASE_CHCEK.setReadOnly(false);\n}\nif(check.getValue() === false){\n    app.IS_PURCHASE_CHCEK.setReadOnly(true);\n    app.IS_PURCHASE_CHCEK.reset();\n}"},"children":[],"expanded":false,"type":"check"},{"configs":{"labelWidth":"120","readOnly":"true","margin":"0 0 0 20","labelAlign":"right","itemId":"IS_PURCHASE_CHCEK","fieldLabel":"{#XC_ST_MATERIAL_IS_PURCHASE#}"},"events":{"change":"if(check.getValue() === true){\n\tapp.PURCHASE_PRICE.setReadOnly(false);\n    app.PURCHASE_PRICE.allowBlank = false;\n}\nif(check.getValue() === false){\n\tapp.PURCHASE_PRICE.setReadOnly(true);\n    app.PURCHASE_PRICE.allowBlank = true;\n    app.PURCHASE_PRICE.reset();\n}"},"children":[],"expanded":false,"type":"check"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row3_1","border":"false"},"children":[{"configs":{"labelWidth":"120","readOnly":"true","width":"200","margin":"0 0 0 73","labelAlign":"right","itemId":"PURCHASE_PRICE","fieldLabel":"{#XC_ST_MATERIAL_PURCHASE_PRICE#}"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row4","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.10","margin":"0 0 0 40","itemId":"IS_UPDATE_SALE_CHCEK"},"events":{"change":"if(check.getValue() === true){\n\tapp.IS_SALE_CHCEK.setReadOnly(false);\n}\nif(check.getValue() === false){\n    app.IS_SALE_CHCEK.setReadOnly(true);\n    app.IS_SALE_CHCEK.reset();\n}"},"children":[],"expanded":false,"type":"check"},{"configs":{"labelWidth":"120","readOnly":"true","margin":"0 0 0 20","labelAlign":"right","itemId":"IS_SALE_CHCEK","fieldLabel":"{#XC_ST_MATERIAL_IS_SALE#}"},"events":{"change":"if(newValue === true){\n\tapp.SALE_PRICE.setReadOnly(false);\n    app.SALE_PRICE.allowBlank = false;\n}\nif(newValue === false){\n\tapp.SALE_PRICE.setReadOnly(true);\n    app.SALE_PRICE.allowBlank = true;\n    app.SALE_PRICE.reset();\n}"},"children":[],"expanded":false,"type":"check"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 10 0","itemId":"row4_1","border":"false"},"children":[{"configs":{"labelWidth":"120","readOnly":"true","width":"200","margin":"0 0 0 73","labelAlign":"right","itemId":"SALE_PRICE","fieldLabel":"{#XC_ST_MATERIAL_SALE_PRICE#}"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","hidden":"true","layout":"column","margin":"10 0 0 0","itemId":"row5","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.10","margin":"0 0 0 40","itemId":"IS_UPDATE_PURCHASE_EXCESS_CHCEK"},"events":{"change":"if(check.getValue() === true){\n\tapp.IS_PURCHASE_EXCESS_CHCEK.setReadOnly(false);\n}\nif(check.getValue() === false){\n    app.IS_PURCHASE_EXCESS_CHCEK.setReadOnly(true);\n    app.IS_PURCHASE_EXCESS_CHCEK.reset();\n}"},"children":[],"expanded":false,"type":"check"},{"configs":{"labelWidth":"120","readOnly":"true","margin":"0 0 0 20","labelAlign":"right","itemId":"IS_PURCHASE_EXCESS_CHCEK","fieldLabel":"{#XC_ST_MATERIAL_IS_PURCHASE_EXCESS#}"},"children":[],"expanded":false,"type":"check"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","hidden":"true","layout":"column","margin":"10 0 10 0","itemId":"row6","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.10","margin":"0 0 0 40","itemId":"IS_UPDATE_SALE_EXCESS_CHCEK"},"events":{"change":"if(check.getValue() === true){\n\tapp.IS_SALE_EXCESS_CHCEK.setReadOnly(false);\n}\nif(check.getValue() === false){\n    app.IS_SALE_EXCESS_CHCEK.setReadOnly(true);\n    app.IS_SALE_EXCESS_CHCEK.reset();\n}"},"children":[],"expanded":false,"type":"check"},{"configs":{"labelWidth":"120","readOnly":"true","margin":"0 0 0 20","labelAlign":"right","itemId":"IS_SALE_EXCESS_CHCEK","fieldLabel":"{#XC_ST_MATERIAL_IS_SALE_EXCESS#}"},"children":[],"expanded":false,"type":"check"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"window"}],"expanded":true,"type":"folder"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","itemId":"search_form"},"children":[{"configs":{"layout":"column","margin":"5 0 5 0","border":"false","itemId":"row1"},"children":[{"configs":{"layout":"form","columnWidth":".249","border":"false","itemId":"row1_1"},"children":[{"configs":{"file":"m?xwl=xc/com-lov/ORG_PICK/ORG_ALL_PICK","itemId":"ORG_XWL"},"children":[],"expanded":false,"type":"xwl"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","border":"false","itemId":"row1_2"},"children":[{"configs":{"labelWidth":"80","readOnly":"true","hidden":"true","labelAlign":"right","itemId":"LEDGER_NAME","fieldLabel":"账簿"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","readOnly":"true","hidden":"true","labelAlign":"right","itemId":"LEDGER_ID","fieldLabel":"账簿ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","readOnly":"true","hidden":"true","labelAlign":"right","itemId":"ORG_ID","fieldLabel":"组织ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"MATERIAL_CODE_NAME","fieldLabel":"{#XC_ST_MATERIAL_MATERIAL_CODE_NAME#}"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.queryBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","border":"false","itemId":"row1_4"},"children":[{"configs":{"layout":"column","border":"false","itemId":"row1_3_1"},"children":[{"configs":{"text":"{#XC_ST_MATERIAL_queryBtn#}","itemId":"queryBtn","iconCls":"seek_icon"},"events":{"click":"app.grid.store.load({params : {LEDGER_ID : app.LEDGER_ID.getValue(),\n                               MATERIAL_CODE_NAME : app.MATERIAL_CODE_NAME.getValue(),\n                               MAT_TYPE_SET_ID : app.MAT_TYPE_SET_ID.getValue()}});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_MATERIAL_resetBtn#}","itemId":"clearBtn","iconCls":"refresh_icon"},"events":{"click":"app.search_form.getForm().reset();\napp.queryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","barExportButtons":"false","barExportAllButtons":"false","itemId":"grid","editable":"true"},"events":{"itemdblclick":"app.setButton.fireEvent('click');"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/ld_base/XC_ST_MATERIAL_PARMS/data/stMaterialParamsSelect"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#XC_ST_MATERIAL_syncBtn#}","itemId":"syncBtn","iconCls":"record_copy_icon"},"events":{"click":"if(Wb.isEmpty(app.ORG_XWL.ORG_NAME.getValue())){\n\tWb.toast('{#XC_ST_MATERIAL_qxxzzzzjxtbcz#}');//请先选择组织，在进行同步操作！\n    return;\n}\napp.SYNC_ORG_NAME.setValue(app.ORG_XWL.ORG_NAME.getValue());\napp.SYNC_LEDGER_NAME.setValue(app.LEDGER_NAME.getValue());\napp.treeQueryBtn.fireEvent('click');\napp.bottomQueryBtn.fireEvent('click');\napp.tree.expandAll(function(){});\napp.syncWindow.show();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_MATERIAL_bottomEditBtn#}","itemId":"setButton","iconCls":"file_edit_icon"},"events":{"click":"var recs = app.grid.getSelection();//获得选中数据\nif (recs.length != 1) {//选中的数据条数\n\tWb.toast('{#XC_ST_MATERIAL_qxzytxyxgdjl#}');\n\treturn;\n}\nWb.run({\n  url: 'm?xwl=xc/st/ld_base/XC_ST_MATERIAL_PARMS/XC_ST_MATERIAL_PARAMS_WIN', \n  success: function(apps) {\n      apps.initWin({\n          IS_INSERT : 'Update',\n          LEDGER_ID : recs[0].data.LEDGER_ID,\n          MATERIAL_ID : recs[0].data.MATERIAL_ID,\n          MATERIAL_PARMS_ID : recs[0].data.MATERIAL_PARMS_ID,\n          hideFun:function(){\n              app.queryBtn.fireEvent('click');\n          }\n      });\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_MATERIAL_bottomDeleteBtn#}","itemId":"deleteButton","iconCls":"file_delete_icon"},"events":{"click":"var recs = app.grid.getSelection();//获得选中数据\nif (!recs.length) {//选中的数据条数\n\tWb.toast('{#XC_ST_MATERIAL_qxzxyscdjl#}');//请选择需要删除的记录！\n\treturn;\n}\nWb.confirm('{#XC_ST_MATERIAL_qdyscxzd#} ' + recs.length + ' {#XC_ST_MATERIAL_tjlm#}',function() {\n    Wb.request({\n        url : '{#contextPath#}' + '/xcStMaterialAction.do?method=deleteXcStMaterialParams',\n        params : {'materialParamsIds' : Wb.encode(Wb.getData(recs))},//传参\n        success: function(resp){\n            var record = Wb.decode(resp.responseText);\n            if(record.flag === '0'){\n                Wb.toast('{#XC_ST_MATERIAL_wlsccg#}');\n                app.queryBtn.fireEvent('click');\n            }\n            else\n                Wb.toast(record.msg);\n        }\n    });\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_MATERIAL_batchEditBtn#}","itemId":"batchEditBtn","iconCls":"check_group_icon"},"events":{"click":"var recs = app.grid.getSelection();//获得选中数据\nif (recs.length === 0) {//选中的数据条数\n\tWb.toast('{#XC_ST_MATERIAL_qxzxyplxgdjl#}');\n\treturn;\n}\nvar materialIds = null;\nfor(var i = 0;i < recs.length;i++){\n    materialIds += \",'\"+recs[i].data.MATERIAL_ID+\"'\";\n}\nif(!Wb.isEmpty(materialIds)){\n    materialIds = \"IN (\"+materialIds+\")\";\n}\nvar win = new Ext.window.Window(app._editWindow); //app._win指向配置对象而非实例\nwin.show();\n//判断当前物料是否被引用\nWb.request({\n    url : 'm?xwl=xc/st/ld_base/XC_ST_MATERIAL_PARMS/data/stMaterialParamsWeatherUse',\n    params : {LEDGER_ID : app.LEDGER_ID.getValue(),materialIds : materialIds},\n    async : false,\n    success : function(resp){\n        var rec = Wb.decode(resp.responseText);\n        if(rec.total > 0){//被引用，则启用序列号或者批次不能修改\n          app.IS_UPDATE_BATCH_CHCEK.setReadOnly(true);\n            app.IS_BATCH_CHCEK.setReadOnly(true);\n            app.IS_SERIAL_CHCEK.setReadOnly(true);\n        }\n    }\n});\nwin.setIconCls('check_group_icon');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#XC_ST_MATERIAL_NUMBER#}","xtype":"rownumberer","width":"50","align":"center","titleAlign":"center","itemId":"NUMBER_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_MAT_TYPE_SET_NAME#}","width":"150","dataIndex":"MAT_TYPE_SET_NAME","titleAlign":"center","itemId":"MAT_TYPE_SET_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_MATERIAL_CODE#}","width":"120","dataIndex":"MATERIAL_CODE","titleAlign":"center","itemId":"MATERIAL_CODE_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_MATERIAL_NAME#}","width":"150","dataIndex":"MATERIAL_NAME","titleAlign":"center","itemId":"MATERIAL_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_MATERIAL_PRO#}","width":"120","dataIndex":"MATERIAL_PRO_NAME","titleAlign":"center","itemId":"MATERIAL_PRO_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_bottomPanelTitle#}","width":"120","dataIndex":"MATERIAL_TYPE_NAME","titleAlign":"center","itemId":"MATERIAL_TYPE_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_AP_PUR_TYPE_NAME#}","width":"120","dataIndex":"AP_PUR_TYPE_NAME","titleAlign":"center","itemId":"AP_PUR_TYPE_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_SPECIFICATION#}","width":"120","dataIndex":"SPECIFICATION","titleAlign":"center","itemId":"SPECIFICATION_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_DIM_NAME#}","width":"80","dataIndex":"DIM_NAME","titleAlign":"center","itemId":"DIM_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_IS_BATCH#}","width":"100","dataIndex":"IS_BATCH","titleAlign":"center","itemId":"IS_BATCH_COL","renderer":"if(value == 'Y')\n  return '{#XC_ST_MATERIAL_Y#}';\nif(value == 'N')\n  return '{#XC_ST_MATERIAL_N#}';"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_IS_SERIAL#}","width":"120","dataIndex":"IS_SERIAL","titleAlign":"center","itemId":"IS_SERIAL_COL","renderer":"if(value == 'Y')\n  return '{#XC_ST_MATERIAL_Y#}';\nif(value == 'N')\n  return '{#XC_ST_MATERIAL_N#}';"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_IS_PURCHASE#}","width":"100","dataIndex":"IS_PURCHASE","titleAlign":"center","itemId":"IS_PURCHASE_COL","renderer":"if(value == 'Y')\n  return '{#XC_ST_MATERIAL_YES#}';\nif(value == 'N')\n  return '{#XC_ST_MATERIAL_NO#}';"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_PURCHASE_PRICE#}","align":"right","width":"100","dataIndex":"PURCHASE_PRICE","format":"0,000.00","titleAlign":"center","itemId":"PURCHASE_PRICE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_IS_SALE#}","width":"100","dataIndex":"IS_SALE","titleAlign":"center","itemId":"IS_SALE_COL","renderer":"if(value == 'Y')\n  return '{#XC_ST_MATERIAL_YES#}';\nif(value == 'N')\n  return '{#XC_ST_MATERIAL_NO#}';"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_SALE_PRICE#}","align":"right","width":"100","dataIndex":"SALE_PRICE","format":"0,000.00","titleAlign":"center","itemId":"SALE_PRICE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_MATERIAL_DESCRIPTION#}","width":"150","dataIndex":"DESCRIPTION","titleAlign":"center","itemId":"DESCRIPTION_COL"},"children":[],"expanded":true,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}