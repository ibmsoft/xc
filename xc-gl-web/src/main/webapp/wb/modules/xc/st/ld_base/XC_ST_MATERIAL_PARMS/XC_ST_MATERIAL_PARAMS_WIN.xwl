{"inframe":false,"title":"物料编码维护窗口","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/st/base/XC_ST_MATERIAL/json/XC_ST_MATERIAL\");\nvar userId = request.getSession().getAttribute(\"XzSessionVars\").get('userId');\n\nvar protocol = request.getProtocol() ;\nvar ipAddr = request.getServerName();\nvar port = request.getServerPort() ;\nvar ctxPath = request.getContextPath() ;\n\nvar pp = protocol.substr(0,5) ;\nprotocol = (pp.indexOf(\"https\") == -1 ? \"http\" : \"https\") ;\n\nvar url = protocol + \"://\" + ipAddr +\":\" + port + ctxPath ;\n\nrequest.setAttribute('contextPath',ctxPath);\nrequest.setAttribute(\"userId\",userId);\nrequest.setAttribute(\"appIP\",url);\nvar appId = request.getSession().getAttribute(\"XzSessionVars\").get('appId');\nrequest.setAttribute(\"funId\",request.getParameter('funId'));\nrequest.setAttribute(\"appId\",request.getParameter('appId'));\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,'xc/ap/req/json/XC_AP_PAY_REQ_H_MY');","itemId":"module"},"events":{"initialize":"Wb.isInsert = null;\nExt.apply(app, {\n    initWin: function(params) {\n        Ext.apply(app, params);\n        app.editWinN = new Ext.window.Window(app.editWinN);\n        app.editWinN.show();\n        Wb.isInsert = params.IS_INSERT;\n        if (Wb.isInsert == 'Update') {//修改操作\n            //判断当前物料是否被引用\n            Wb.request({\n                url : 'm?xwl=xc/st/ld_base/XC_ST_MATERIAL_PARMS/data/stMaterialParamsWeatherUse',\n                params : {LEDGER_ID : params.LEDGER_ID,materialIds : \"IN ('\"+params.MATERIAL_ID+\"')\"},\n                async : false,\n                success : function(resp){\n                    var rec = Wb.decode(resp.responseText);\n                    if(rec.total > 0){//被引用，则启用序列号或者批次不能修改\n                        app.IS_BATCH_CHCEK.setDisabled(true);\n                        app.IS_SERIAL_CHCEK.setDisabled(true);\n                    }\n                }\n            });\n            Wb.request({\n                url : 'm?xwl=xc/st/ld_base/XC_ST_MATERIAL_PARMS/data/stMaterialParamsSelect',\n                params : {MATERIAL_PARMS_ID : params.MATERIAL_PARMS_ID,LEDGER_ID : params.LEDGER_ID},\n                async : false,\n                success : function(resp){\n                    var rec = Wb.decode(resp.responseText).rows[0];\n                    app.IMAGE.setSrc(rec.IMAGES);\n                    setRadioValue(rec);\n                    Wb.setValue(app.editWinN,rec);\n                }\n            });\n            app.editWinN.setTitle('{#XC_ST_MATERIAL_bottomEditBtn#}');\n            app.editWinN.setIconCls('file_edit_icon');\n        }\n    }\n});\n//给每个单选按钮对应的赋值\nfunction setComponentValue(){\n    //是否启用批次管理：\n\tif(app.IS_BATCH_CHCEK.getValue() === true)\n        app.IS_BATCH.setValue('Y');\n\tif(app.IS_BATCH_CHCEK.getValue() === false)\n        app.IS_BATCH.setValue('N');\n    //是否启用序列号管理：\n    if(app.IS_SERIAL_CHCEK.getValue() === true)\n        app.IS_SERIAL.setValue('Y');\n    if(app.IS_SERIAL_CHCEK.getValue() === false)\n        app.IS_SERIAL.setValue('N');\n    //是否可采购：\n    if(app.IS_PURCHASE_CHCEK.getValue() === true)\n        app.IS_PURCHASE.setValue('Y');\n    if(app.IS_PURCHASE_CHCEK.getValue() === false)\n        app.IS_PURCHASE.setValue('N');\n    //是否允许超量接收：\n    if(app.IS_PURCHASE_EXCESS_CHCEK.getValue() === true)\n        app.IS_PURCHASE_EXCESS.setValue('Y');\n    if(app.IS_PURCHASE_EXCESS_CHCEK.getValue() === false)\n        app.IS_PURCHASE_EXCESS.setValue('N');\n    //是否可销售：\n    if(app.IS_SALE_CHCEK.getValue() === true)\n        app.IS_SALE.setValue('Y');\n    if(app.IS_SALE_CHCEK.getValue() === false)\n        app.IS_SALE.setValue('N');\n    //是否允许超量发货：\n    if(app.IS_SALE_EXCESS_CHCEK.getValue() === true)\n        app.IS_SALE_EXCESS.setValue('Y');\n    if(app.IS_SALE_EXCESS_CHCEK.getValue() === false)\n        app.IS_SALE_EXCESS.setValue('N');\n}\n//给单选按钮赋值\nfunction setRadioValue(rec){\n    if(rec.IS_BATCH == 'Y')\n        app.IS_BATCH_CHCEK.setValue(true);\n    else\n        app.IS_BATCH_CHCEK.setValue(false);\n    if(rec.IS_SERIAL == 'Y')\n        app.IS_SERIAL_CHCEK.setValue(true);\n    else\n        app.IS_SERIAL_CHCEK.setValue(false);\n    if(rec.IS_PURCHASE == 'Y')\n        app.IS_PURCHASE_CHCEK.setValue(true);\n    else{\n        app.IS_PURCHASE_CHCEK.setValue(false);\n        app.PURCHASE_PRICE.setReadOnly(true);\n    }\n    if(rec.IS_PURCHASE_EXCESS == 'Y')\n        app.IS_PURCHASE_EXCESS_CHCEK.setValue(true);\n    else\n        app.IS_PURCHASE_EXCESS_CHCEK.setValue(false);\n    if(rec.IS_SALE == 'Y')\n        app.IS_SALE_CHCEK.setValue(true);\n    else{\n        app.IS_SALE_CHCEK.setValue(false);\n        app.SALE_PRICE.setReadOnly(true);\n    }\n    if(rec.IS_SALE_EXCESS == 'Y')\n        app.IS_SALE_EXCESS_CHCEK.setValue(true);\n    else\n        app.IS_SALE_EXCESS_CHCEK.setValue(false);\n}"},"children":[{"configs":{"height":"560","width":"800","layout":"border","closeAction":"hide","border":"false","itemId":"editWinN","modal":"true"},"events":{"hide":"app.hideFun();"},"children":[{"configs":{"region":"north","frame":"false","border":"false","bodyPadding":"0 0 0 0","itemId":"form1"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#XC_ST_MATERIAL_saveButton#}","itemId":"okButton","iconCls":"save_icon"},"events":{"click":"if(!Wb.verify(app.editWinN)){//验证数据是否合法\n    Wb.toast('{#XC_ST_MATERIAL_qsrsybsx#}');\n\treturn;\n}\nsetComponentValue();\nWb.request({\n    url: 'm?xwl=xc/st/ld_base/XC_ST_MATERIAL_PARMS/data/stMaterialParamsUpdate',\n    out : app.editWinN,\n    success: function(resp) {\n        Wb.toast('{#XC_ST_MATERIAL_sjbccg#}');\n    }\n});\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_MATERIAL_enclosureBtn#}","itemId":"enclosureBtn","iconCls":"attach_icon"},"events":{"click":"var temp_id = app.MATERIAL_PARMS_ID.getValue();\nvar temp_code = \"\";\nXip.showAttachmentManager('{#XIP.userId#}',temp_id,'','XC_ST_CAT',temp_code,'Y','Y','Y',function(){},10); "},"children":[],"expanded":false,"type":"button"}],"expanded":false,"type":"toolbar"},{"configs":{"region":"center","border":"false","itemId":"lookTab"},"children":[{"configs":{"title":"{#XC_ST_MATERIAL_set_1Title#}","border":"false","itemId":"tab01"},"children":[{"configs":{"border":"false","itemId":"leftPanel"},"children":[{"configs":{"frame":"false","layout":"column","margin":"5 0 0 0","border":"false","itemId":"tr_1"},"children":[{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".49","border":"false","itemId":"td_1_1"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"ORG_NAME","fieldLabel":"{#XC_ST_MATERIAL_SYNC_ORG_NAME#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".49","border":"false","itemId":"td_1_2"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"LEDGER_NAME","fieldLabel":"{#XC_ST_MATERIAL_SYNC_LEDGER_NAME#}"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","layout":"column","margin":"5 0 0 0","border":"false","itemId":"tr_2"},"children":[{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".49","border":"false","itemId":"td_2_1"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"MATERIAL_CODE","fieldLabel":"{#XC_ST_MATERIAL_MATERIAL_CODE#}"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"panel"},{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".49","border":"false","itemId":"td_2_2"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"MATERIAL_NAME","fieldLabel":"{#XC_ST_MATERIAL_MATERIAL_NAME#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","layout":"column","margin":"5 0 0 0","border":"false","itemId":"tr_3"},"children":[{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".49","border":"false","itemId":"td_3_1"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"MAT_TYPE_SET_NAME","fieldLabel":"{#XC_ST_MATERIAL_MAT_TYPE_SET_NAME#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".49","border":"false","itemId":"td_3_2"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"MATERIAL_TYPE_NAME","fieldLabel":"{#XC_ST_MATERIAL_bottomPanelTitle#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","layout":"column","margin":"5 0 0 0","border":"false","itemId":"tr_4"},"children":[{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".49","border":"false","itemId":"td_4_1"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"MATERIAL_PRO_NAME","fieldLabel":"{#XC_ST_MATERIAL_MATERIAL_PRO#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".49","border":"false","itemId":"td_4_2"},"children":[{"configs":{"labelWidth":"100","displayField":"AP_PUR_TYPE_NAME","valueField":"AP_PUR_TYPE_NAME","labelAlign":"right","itemId":"AP_PUR_TYPE_NAME","fieldLabel":"{#XC_ST_MATERIAL_AP_PUR_TYPE_NAME#}","editable":"false"},"events":{"select":"app.FINACE_TYPE_ID.setValue(records[0].data.AP_PUR_TYPE_ID);"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/common/data/apLdPurTypeSelect"},"events":{"beforeload":"store.proxy.extraParams.LEDGER_ID = app.LEDGER_ID.getValue();\nstore.proxy.extraParams.PUR_OBJECT = 'WZ';"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","layout":"column","margin":"5 0 5 0","border":"false","itemId":"tr_5"},"children":[{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".49","border":"false","itemId":"td_5_1"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"DIM_NAME","fieldLabel":"{#XC_ST_MATERIAL_DIM_NAME#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".49","border":"false","itemId":"td_5_2"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","labelAlign":"right","itemId":"SPECIFICATION","fieldLabel":"{#XC_ST_MATERIAL_SPECIFICATION#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":false,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"title":"{#XC_ST_MATERIAL_picturePanel#}","height":"310","width":"400","layout":"fit","border":"false","itemId":"picturePpanel","y":"0","x":"40"},"children":[{"configs":{"title":"{#XC_ST_MATERIAL_picturePanel#}","itemId":"IMAGE"},"children":[],"expanded":false,"type":"image"}],"expanded":false,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"title":"{#XC_ST_MATERIAL_set_2Title#}","border":"false","itemId":"tab02"},"children":[{"configs":{"border":"false","itemId":"leftPanel1"},"children":[{"configs":{"frame":"false","layout":"column","margin":"5 0 0 0","border":"false","itemId":"tr_8"},"children":[{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".33","border":"false","itemId":"td_8_1"},"children":[{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"IS_BATCH_CHCEK","fieldLabel":"{#XC_ST_MATERIAL_IS_BATCH#}"},"events":{"change":"if(newValue === true){\n    app.IS_SERIAL_CHCEK.reset();\n    app.IS_SERIAL.reset();\n}"},"children":[],"expanded":false,"type":"check"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".33","border":"false","itemId":"td_8_2"},"children":[{"configs":{"labelWidth":"120","labelAlign":"right","itemId":"IS_SERIAL_CHCEK","fieldLabel":"{#XC_ST_MATERIAL_IS_SERIAL#}"},"events":{"change":"if(newValue === true){\n    app.IS_BATCH_CHCEK.reset();\n    app.IS_BATCH.reset();\n}"},"children":[],"expanded":false,"type":"check"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","layout":"column","margin":"5 0 0 0","border":"false","itemId":"tr_6"},"children":[{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".33","border":"false","itemId":"td_6_1"},"children":[{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"IS_PURCHASE_CHCEK","fieldLabel":"{#XC_ST_MATERIAL_IS_PURCHASE#}"},"events":{"change":"if(check.getValue() === true){\n\tapp.PURCHASE_PRICE.setReadOnly(false);\n    app.PURCHASE_PRICE.allowBlank = false;\n    app.PURCHASE_PRICE.setFieldLabel(\"<font color='red'>*<\/font>{#XC_ST_MATERIAL_PURCHASE_PRICE#}\");\n}\nif(check.getValue() === false){\n\tapp.PURCHASE_PRICE.setReadOnly(true);\n    app.PURCHASE_PRICE.allowBlank = true;\n    app.PURCHASE_PRICE.setFieldLabel('{#XC_ST_MATERIAL_PURCHASE_PRICE#}');\n    app.PURCHASE_PRICE.reset();\n}"},"children":[],"expanded":false,"type":"check"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".33","border":"false","itemId":"td_6_2"},"children":[{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"PURCHASE_PRICE","fieldLabel":"{#XC_ST_MATERIAL_PURCHASE_PRICE#}"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","layout":"column","margin":"5 0 0 0","border":"false","itemId":"tr_7"},"children":[{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".33","border":"false","itemId":"td_7_1"},"children":[{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"IS_SALE_CHCEK","fieldLabel":"{#XC_ST_MATERIAL_IS_SALE#}"},"events":{"change":"if(newValue === true){\n\tapp.SALE_PRICE.setReadOnly(false);\n    app.SALE_PRICE.allowBlank = false;\n    app.SALE_PRICE.setFieldLabel(\"<font color='red'>*<\/font>{#XC_ST_MATERIAL_SALE_PRICE#}\");\n}\nif(newValue === false){\n\tapp.SALE_PRICE.setReadOnly(true);\n    app.SALE_PRICE.allowBlank = true;\n    app.SALE_PRICE.setFieldLabel(\"{#XC_ST_MATERIAL_SALE_PRICE#}\");\n    app.SALE_PRICE.reset();\n}"},"children":[],"expanded":false,"type":"check"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".33","border":"false","itemId":"td_7_2"},"children":[{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"SALE_PRICE","fieldLabel":"{#XC_ST_MATERIAL_SALE_PRICE#}"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","style":"border-width:0px","layout":"form","columnWidth":".33","border":"false","itemId":"td_7_3"},"children":[{"configs":{"labelWidth":"100","displayField":"AR_SALE_TYPE_NAME","valueField":"AR_SALE_TYPE_ID","labelAlign":"right","itemId":"AR_SALE_TYPE_NAME","fieldLabel":"{#XC_ST_MATERIAL_AR_SALE_TYPE_NAME#}"},"events":{"select":"app.SALE_TYPE_ID.setValue(records[0].data.AR_SALE_TYPE_ID);"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/common/data/arLdSaleTypeSelect"},"events":{"beforeload":"store.proxy.extraParams.LEDGER_ID = app.LEDGER_ID.getValue();"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","layout":"column","margin":"5 0 0 0","border":"false","itemId":"tr_9"},"children":[{"configs":{"frame":"false","style":"border-width:0px","hidden":"true","layout":"form","columnWidth":".33","border":"false","itemId":"td_9_1"},"children":[{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"IS_PURCHASE_EXCESS_CHCEK","fieldLabel":"{#XC_ST_MATERIAL_IS_PURCHASE_EXCESS#}"},"children":[],"expanded":false,"type":"check"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","style":"border-width:0px","hidden":"true","layout":"form","columnWidth":".33","border":"false","itemId":"td_9_2"},"children":[{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"IS_SALE_EXCESS_CHCEK","fieldLabel":"{#XC_ST_MATERIAL_IS_SALE_EXCESS#}"},"children":[],"expanded":false,"type":"check"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","layout":"column","margin":"5 0 5 0","border":"false","itemId":"tr_10"},"children":[{"configs":{"frame":"false","layout":"form","columnWidth":".66","itemId":"tr_10_1","border":"false"},"children":[{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"DESCRIPTION","fieldLabel":"{#XC_ST_MATERIAL_DESCRIPTION#}"},"children":[],"expanded":false,"type":"textarea"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"height":"300","layout":"fit","border":"false","itemId":"panel"},"children":[],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"tab"},{"configs":{"frame":"false","hidden":"true","layout":"column","border":"false","itemId":"hidePanel"},"children":[{"configs":{"itemId":"LEDGER_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"FINACE_TYPE_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"itemId":"MATERIAL_TYPE_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"DEFUALT_WH_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"DEFUALT_LO_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"DIM_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"SALE_TYPE_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"IS_SALE_EXCESS"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"IS_SALE"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"IS_PURCHASE_EXCESS"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"IS_PURCHASE"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"IS_SERIAL"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"IS_BATCH"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"MATERIAL_PARMS_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"MAT_TYPE_SET_ID"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"panel"}],"expanded":true,"type":"form"}],"expanded":true,"type":"window"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}