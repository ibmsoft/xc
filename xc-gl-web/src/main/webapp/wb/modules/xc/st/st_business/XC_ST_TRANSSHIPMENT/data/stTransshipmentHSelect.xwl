{"inframe":false,"title":"物资调拨单主表查询","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"var sql,data = app.get();\nsql = ' WHERE 1 = 1';\nsql+=' AND sth.LEDGER_ID = {?LEDGER_ID?}';\nif (!Wb.isEmpty(data.TR_H_CODE)) {\n    sql+=' AND (sth.TR_H_CODE LIKE \"%'+data.TR_H_CODE+'%\" OR sth.TR_H_NAME LIKE \"%'+data.TR_H_CODE+'%\")';\n}\nif (!Wb.isEmpty(data.BIZ_DATE_START)) {\n    if (!Wb.isEmpty(data.BIZ_DATE_END)) \n        sql+=' and sth.BIZ_DATE BETWEEN {?BIZ_DATE_START?} and {?BIZ_DATE_END?} ';\n    else\n        sql+=' and sth.BIZ_DATE >= {?BIZ_DATE_START?}';\n}\nelse{\n    if (!Wb.isEmpty(data.BIZ_DATE_END))\n        sql+=' and sth.BIZ_DATE <= {?BIZ_DATE_END?}';\n}\nif (!Wb.isEmpty(data.OUT_WH_ID)) {\n    sql+=' and sth.OUT_WH_ID={?OUT_WH_ID?}';\n}\nif (!Wb.isEmpty(data.IN_WH_ID)) {\n    sql+=' and sth.IN_WH_ID={?IN_WH_ID?}';\n}\nif (!Wb.isEmpty(data.STATUS)) {\n    sql+=' and sth.STATUS IN '+data.STATUS+'';\n}\nrequest.setAttribute('sql', sql);","itemId":"module"},"children":[{"configs":{"sql":"SELECT\n\tsth.*,\n\tsbt.BUSINESS_TYPE_CODE,\n\tsbt.BUSINESS_TYPE_NAME,\n\tgl.LEDGER_NAME,\n\tpo.ORG_NAME,\n\tout_sw.WAREHOUSE_CODE AS \"OUT_WAREHOUSE_CODE\",\n\tout_sw.WAREHOUSE_NAME AS \"OUT_WAREHOUSE_NAME\",\n\tin_sw.WAREHOUSE_CODE AS \"IN_WAREHOUSE_CODE\",\n\tin_sw.WAREHOUSE_NAME AS \"IN_WAREHOUSE_NAME\",\n\t(SELECT pe.EMP_NAME FROM xip_pub_emps pe,xip_pub_users pu WHERE pe.EMP_ID = pu.EMP_ID AND pu.USER_ID = out_swk.EMP_ID) AS \"OUT_EMP_NAME\",\n\t(SELECT pe.EMP_NAME FROM xip_pub_emps pe,xip_pub_users pu WHERE pe.EMP_ID = pu.EMP_ID AND pu.USER_ID = in_swk.EMP_ID) AS \"IN_EMP_NAME\",\n\tpd.DEPT_NAME\nFROM\n\txc_st_transshipment_h sth\nLEFT JOIN xc_gl_ledgers gl ON sth.LEDGER_ID = gl.LEDGER_ID\nLEFT JOIN xip_pub_orgs po ON sth.ORG_ID = po.ORG_ID\nLEFT JOIN xc_st_business_type sbt ON sth.BUSINESS_TYPE_ID = sbt.BUSINESS_TYPE_ID\nLEFT JOIN xc_st_warehouse out_sw ON sth.OUT_WH_ID = out_sw.WAREHOUSE_ID\nLEFT JOIN xc_st_warehouse in_sw ON sth.IN_WH_ID = in_sw.WAREHOUSE_ID\nLEFT JOIN xc_st_warehouse_keeper out_swk ON sth.OUT_WH_KEEPER_ID = out_swk.WAREHOUSE_KEEPER_ID\nLEFT JOIN xc_st_warehouse_keeper in_swk ON sth.IN_WH_KEEPER_ID = in_swk.WAREHOUSE_KEEPER_ID\nLEFT JOIN xip_pub_depts pd ON sth.DEPT_ID = pd.DEPT_ID\n{#sql#}\nORDER BY sth.TR_H_CODE DESC","itemId":"dataprovider1"},"children":[],"expanded":false,"type":"dataprovider"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}