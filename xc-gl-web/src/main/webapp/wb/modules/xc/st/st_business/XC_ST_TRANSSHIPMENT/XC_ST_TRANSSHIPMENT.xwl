{"inframe":false,"title":"","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/st/st_business/XC_ST_TRANSSHIPMENT/json/XC_ST_TRANSSHIPMENT\");\nvar ctxPath = request.getContextPath() ;\nrequest.setAttribute('contextPath',ctxPath);","itemId":"module"},"events":{"finalize":"var stDocCatCode = '{#opType#}';\nif(stDocCatCode == 'In'){\n\tapp.addBtn.hide();\n    app.editBtn.hide();\n    app.seekBtn.hide();\n    app.deleteBtn.hide();\n    app.submitBtn.hide();\n    app.inBtn.show();\n    app.STATUS.setValue(\"('2','3')\");\n}\nfunction returnRowFn(r,type){\n    if(type==='xip_pub_orgs'){\n        app.LEDGER_ID.setValue(r.data.LEDGER_ID);\n        app.ORG_ID.setValue(r.data.ORG_ID);\n        app.OUT_WAREHOUSE_XWL.OUT_WH_ID.setValue(null);\n        app.OUT_WAREHOUSE_XWL.OUT_WAREHOUSE_NAME.setValue(null);\n        app.OUT_WAREHOUSE_XWL.QUERY_ORG_ID.setValue(r.data.ORG_ID);\n        app.OUT_WAREHOUSE_XWL.LEDGER_ID.setValue(r.data.LEDGER_ID);\n        app.IN_WAREHOUSE_XWL.IN_WH_ID.setValue(null);\n        app.IN_WAREHOUSE_XWL.IN_WAREHOUSE_NAME.setValue(null);\n        app.IN_WAREHOUSE_XWL.QUERY_ORG_ID.setValue(r.data.ORG_ID);\n        app.IN_WAREHOUSE_XWL.LEDGER_ID.setValue(r.data.LEDGER_ID);\n        setButtonStatus(false);\n        app.searchButton.fireEvent('click');\n    }\n    if(type==='xc_st_warehouse_out' || type==='xc_st_warehouse_in'){\n        app.searchButton.fireEvent('click');\n        if(r.data.IS_INIT == 'Y' && r.data.STATUS == 'Y'){\n            setButtonStatus(false);\n        }\n        else{\n            setButtonStatus(true);\n        }\n    }\n}\nfunction clearOtherFn(type){\n    if(type=='xip_pub_orgs'){\n    }\n    if(type==='xc_st_warehouse_out' || type==='xc_st_warehouse_in'){\n        app.searchButton.fireEvent('click');\n        setButtonStatus(false);\n    }\n}\nfunction setButtonStatus(flag){\n    app.addBtn.setDisabled(flag);\n    app.editBtn.setDisabled(flag);\n    app.deleteBtn.setDisabled(flag);\n    app.submitBtn.setDisabled(flag);\n    app.inBtn.setDisabled(flag);\n}"},"children":[{"configs":{"itemId":"tools"},"children":[{"configs":{"itemId":"orgInitStore","autoLoad":"true","url":"m?xwl=xc/com-lov/ORG_PICK/DB/ORG_SELECT_BY_LEDGER"},"events":{"load":"if(store.getCount() > 0){\n    app.LEDGER_ID.setValue(store.getAt(0).get('LEDGER_ID'));\n    app.ORG_ID.setValue(store.getAt(0).get('ORG_ID'));\n    app.ORG_XWL.LEDGER_ID.setValue(store.getAt(0).get('LEDGER_ID'));\n    app.ORG_XWL.ORG_ID.setValue(store.getAt(0).get('ORG_ID'));\n    app.ORG_XWL.ORG_NAME.setValue(store.getAt(0).get('ORG_NAME'));\n    app.OUT_WAREHOUSE_XWL.QUERY_ORG_ID.setValue(store.getAt(0).get('ORG_ID'));\n    app.OUT_WAREHOUSE_XWL.LEDGER_ID.setValue(store.getAt(0).get('LEDGER_ID'));\n    app.IN_WAREHOUSE_XWL.QUERY_ORG_ID.setValue(store.getAt(0).get('ORG_ID'));\n    app.IN_WAREHOUSE_XWL.LEDGER_ID.setValue(store.getAt(0).get('LEDGER_ID'));\n    app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"folder"},{"configs":{"layout":"border","itemId":"viewport1"},"events":{"afterrender":"app.OUT_WAREHOUSE_XWL.OUT_WAREHOUSE_NAME.allowBlank = true;\napp.IN_WAREHOUSE_XWL.IN_WAREHOUSE_NAME.allowBlank = true;\napp.OUT_WAREHOUSE_XWL.OUT_WAREHOUSE_NAME.setFieldLabel('{#XC_ST_TRANSSHIPMENT_OUT_WAREHOUSE#}');\napp.IN_WAREHOUSE_XWL.IN_WAREHOUSE_NAME.setFieldLabel('{#XC_ST_TRANSSHIPMENT_IN_WAREHOUSE#}');"},"children":[{"configs":{"region":"north","itemId":"search_form"},"children":[{"configs":{"layout":"column","margin":"5 0 0 0","border":"false","itemId":"row1"},"children":[{"configs":{"layout":"form","columnWidth":".249","border":"false","itemId":"row1_1"},"children":[{"configs":{"file":"m?xwl=xc/com-lov/ORG_PICK/ORG_ALL_PICK","itemId":"ORG_XWL"},"children":[],"expanded":false,"type":"xwl"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","border":"false","itemId":"row1_2"},"children":[{"configs":{"file":"m?xwl=xc/st/common/st_com_lov/XC_ST_WAREHOUSE_LOV/XC_ST_WAREHOUSE_LOV_OUT","itemId":"OUT_WAREHOUSE_XWL"},"children":[],"expanded":false,"type":"xwl"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","border":"false","itemId":"row1_3"},"children":[{"configs":{"file":"m?xwl=xc/st/common/st_com_lov/XC_ST_WAREHOUSE_LOV/XC_ST_WAREHOUSE_LOV_IN","itemId":"IN_WAREHOUSE_XWL"},"children":[],"expanded":false,"type":"xwl"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","border":"false","itemId":"row1_4"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"TR_H_CODE","fieldLabel":"{#XC_ST_TRANSSHIPMENT_TR_H_CODE#}"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","margin":"5 0 5 0","border":"false","itemId":"row2"},"children":[{"configs":{"layout":"form","columnWidth":".249","border":"false","itemId":"row2_1"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"BIZ_DATE_START","fieldLabel":"{#XC_ST_TRANSSHIPMENT_BIZ_DATE#}"},"events":{"select":"app.searchButton.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"date"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","border":"false","itemId":"row2_2"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"BIZ_DATE_END","fieldLabel":"{#XC_ST_TRANSSHIPMENT_TO#}"},"events":{"select":"app.searchButton.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"date"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","border":"false","itemId":"row2_4"},"children":[{"configs":{"layout":"column","border":"false","itemId":"row3_4_1"},"children":[{"configs":{"labelWidth":"80","readOnly":"true","hidden":"true","labelAlign":"right","itemId":"LEDGER_ID","fieldLabel":"账簿ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","readOnly":"true","hidden":"true","labelAlign":"right","itemId":"ORG_ID","fieldLabel":"组织ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","readOnly":"true","hidden":"true","labelAlign":"right","itemId":"STATUS","fieldLabel":"状态"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_searchButton#}","itemId":"searchButton","iconCls":"seek_icon"},"events":{"click":"app.grid.store.load({params : Wb.getValue(app.search_form)});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_resetButton#}","itemId":"resetButton","iconCls":"refresh_icon"},"events":{"click":"app.search_form.getForm().reset();\napp.searchButton.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","barExportButtons":"false","barExportAllButtons":"false","itemId":"grid","editable":"true"},"events":{"itemdblclick":"if(app.editBtn.disabled === true)\n    app.seekBtn.fireEvent('click');\nelse\n    app.editBtn.fireEvent('click');"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/st_business/XC_ST_TRANSSHIPMENT/data/stTransshipmentHSelect"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_addBtn#}","itemId":"addBtn","iconCls":"file_add_icon"},"events":{"click":"Wb.run({\n  url: 'm?xwl=xc/st/st_business/XC_ST_TRANSSHIPMENT/XC_ST_TRANSSHIPMENT_WIN', \n  success: function(apps) {\n      apps.initWin({\n          IS_INSERT : 'Add',\n          TR_H_ID : Xip.getId(),\n          LEDGER_ID : app.LEDGER_ID.getValue(),\n          ORG_ID : app.ORG_XWL.ORG_ID.getValue(),\n          ORG_NAME : app.ORG_XWL.ORG_NAME.getValue(),\n          stDocCatCode : (Wb.isEmpty(stDocCatCode) ? 'Out' : 'In'),\n          OUT_WH_ID : app.OUT_WAREHOUSE_XWL.OUT_WH_ID.getValue(),\n          OUT_WAREHOUSE_NAME : app.OUT_WAREHOUSE_XWL.OUT_WAREHOUSE_NAME.getValue(),\n          IN_WH_ID : app.IN_WAREHOUSE_XWL.IN_WH_ID.getValue(),\n          IN_WAREHOUSE_NAME : app.IN_WAREHOUSE_XWL.IN_WAREHOUSE_NAME.getValue(),\n          hideFun:function(){\n              app.searchButton.fireEvent('click');\n          }\n      });\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_editBtn#}","itemId":"editBtn","iconCls":"file_edit_icon"},"events":{"click":"var recs = app.grid.getSelection();//获得选中数据\nif(recs.length != 1){//选中的数据条数\n\tWb.toast('{#XC_ST_TRANSSHIPMENT_qxzytxyxgdjl#}');//请选择一条需要修改的记录！\n\treturn;\n}\nWb.run({\n  url: 'm?xwl=xc/st/st_business/XC_ST_TRANSSHIPMENT/XC_ST_TRANSSHIPMENT_WIN', \n  success: function(apps) {\n      apps.initWin({\n          IS_INSERT : 'Update',\n          TR_H_ID : recs[0].data.TR_H_ID,\n          stDocCatCode : (Wb.isEmpty(stDocCatCode) ? 'Out' : 'In'),\n          hideFun:function(){\n              app.searchButton.fireEvent('click');\n          }\n      });\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_deleteBtn#}","itemId":"deleteBtn","iconCls":"file_delete_icon"},"events":{"click":"var recs = app.grid.getSelection();//获得选中数据\nif (!recs.length) {//选中的数据条数\n\tWb.toast('{#XC_ST_TRANSSHIPMENT_qxzxyscdjl#}');//请选择需要删除的记录！\n\treturn;\n}\nvar deleteArray = [] ;\nfor(var i = 0;i < recs.length;i++){\n    if(recs[i].data.STATUS == '1'){\n        var deleteData =  {stDocId : recs[i].data.TR_H_ID};\n        deleteArray.push(deleteData);\n    }\n}\nif(deleteArray.length === 0){\n    Wb.toast('{#XC_ST_TRANSSHIPMENT_sxdjfcgztbnsc#}');//所选单据非草稿状态，不能删除！\n    return;\n}\nWb.confirm('{#XC_ST_TRANSSHIPMENT_qdyscxzd#} ' + recs.length + ' {#XC_ST_TRANSSHIPMENT_tjlm#}',function() {\n    Wb.request({\n        url : '{#contextPath#}' + '/xcStDocsAction.do?method=deleteXcStDocs',\n        params: Wb.apply({hIds : deleteArray,docClassCode : 'WZDBD'}),\n        success: function(resp){\n            Wb.toast('{#XC_ST_TRANSSHIPMENT_sccg#}');\n            app.searchButton.fireEvent('click');\n        }\n    });\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_submitBtn#}","itemId":"submitBtn","iconCls":"check_icon"},"events":{"click":"var rows = app.grid.getSelection();\nif(rows.length != 1){\n    Wb.toast(\"{#XC_ST_TRANSSHIPMENT_qxzxytjdjl#}\");//请选择需要提交的记录！\n    return;\n}\nelse{\n    if(rows[0].data.STATUS != '1'){\n        Wb.toast('{#XC_ST_TRANSSHIPMENT_sxdjfcgztbntj#}');\n        return;\n    }\n    Wb.request({\n        url: '{#contextPath#}'+'/xcStCommonAction.do?method=updateXcStDocStatus',\n        params: Wb.apply({stDocId : rows[0].data.TR_H_ID,docClassCode : 'WZDBD'}),\n        success: function(resp) {\n            var record = Wb.decode(resp.responseText);\n            if(record.flag == '0')\n                Wb.toast('{#XC_ST_TRANSSHIPMENT_tjcg#}');\n            else\n                Wb.toast(record.msg);\n            app.searchButton.fireEvent('click');\n        }\n\t});\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_seekBtn#}","itemId":"seekBtn","iconCls":"seek_icon"},"events":{"click":"var recs = app.grid.getSelection();//获得选中数据\nif(recs.length != 1){//选中的数据条数\n\tWb.toast('{#XC_ST_TRANSSHIPMENT_qxzytxyckdjl#}');//请选择一条需要查看的记录！\n\treturn;\n}\nWb.run({\n  url: 'm?xwl=xc/st/st_business/XC_ST_TRANSSHIPMENT/XC_ST_TRANSSHIPMENT_WIN', \n  success: function(apps) {\n      apps.initWin({\n          IS_INSERT : 'Seek',\n          TR_H_ID : recs[0].data.TR_H_ID,\n          hideFun:function(){\n              app.searchButton.fireEvent('click');\n          }\n      });\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_inBtn#}","hidden":"true","itemId":"inBtn","iconCls":"accept_icon"},"events":{"click":"var recs = app.grid.getSelection();//获得选中数据\nif(recs.length != 1){//选中的数据条数\n\tWb.toast('{#XC_ST_TRANSSHIPMENT_qxzytxydrdjl#}');//请选择一条需要调入的记录！\n\treturn;\n}\nelse{\n    Wb.request({\n        url: '{#contextPath#}'+'/xcStDocsAction.do?method=acceptDoc',\n        params: Wb.apply({TR_H_ID : recs[0].data.TR_H_ID}),\n        success: function(resp) {\n            var record = Wb.decode(resp.responseText);\n            if(record.flag == '0')\n                Wb.toast('接收成功！');\n            else\n                Wb.toast(record.msg);\n            app.searchButton.fireEvent('click');\n        }\n\t});\n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_NUMBER_COL#}","xtype":"rownumberer","width":"50","align":"center","titleAlign":"center","itemId":"NUMBER_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_TR_H_CODE#}","width":"150","dataIndex":"TR_H_CODE","titleAlign":"center","itemId":"TR_H_CODE_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_BIZ_DATE#}","xtype":"datecolumn","width":"100","dataIndex":"BIZ_DATE","titleAlign":"center","itemId":"BIZ_DATE_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_TR_H_NAME#}","width":"180","dataIndex":"TR_H_NAME","titleAlign":"center","itemId":"TR_H_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_BUSINESS_TYPE_NAME#}","width":"140","dataIndex":"BUSINESS_TYPE_NAME","titleAlign":"center","itemId":"BUSINESS_TYPE_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_YWBM#}","width":"150","dataIndex":"DEPT_NAME","titleAlign":"center","itemId":"DEPT_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_OUT_WAREHOUSE#}","width":"150","dataIndex":"OUT_WAREHOUSE_NAME","titleAlign":"center","itemId":"OUT_WAREHOUSE_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_OUT_EMP_NAME#}","width":"100","dataIndex":"OUT_EMP_NAME","titleAlign":"center","itemId":"OUT_EMP_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_IN_WAREHOUSE#}","width":"150","dataIndex":"IN_WAREHOUSE_NAME","titleAlign":"center","itemId":"IN_WAREHOUSE_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_IN_EMP_NAME#}","width":"100","dataIndex":"IN_EMP_NAME","titleAlign":"center","itemId":"IN_EMP_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_TRANSSHIPMENT_STATUS#}","width":"100","dataIndex":"STATUS","titleAlign":"center","itemId":"STATUS_COL","renderer":"if(value == '1')\n    return '{#XC_ST_TRANSSHIPMENT_STATUS_1#}';\nif(value == '2')\n    return '{#XC_ST_TRANSSHIPMENT_STATUS_2#}';\nif(value == '3')\n    return '{#XC_ST_TRANSSHIPMENT_STATUS_3#}';\nif(value == '4')\n    return '{#XC_ST_TRANSSHIPMENT_STATUS_4#}';"},"children":[],"expanded":true,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}