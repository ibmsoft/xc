{"inframe":false,"title":"库存业务类型","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/st/base/XC_ST_BUSINESS_TYPE/json/XC_ST_BUSINESS_TYPE\");","itemId":"module"},"children":[{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","itemId":"search_form"},"children":[{"configs":{"layout":"column","margin":"5 0 5 0","itemId":"row1","border":"false"},"children":[{"configs":{"layout":"form","columnWidth":".33","itemId":"row1_1","border":"false"},"children":[{"configs":{"labelWidth":"120","labelAlign":"right","itemId":"BUSINESS_TYPE_CODE_NAME","fieldLabel":"{#XC_ST_BUSINESS_TYPE_BUSINESS_TYPE_CODE_NAME#}"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","columnWidth":".33","margin":"2","itemId":"row1_3","border":"false"},"children":[{"configs":{"text":"{#XC_ST_BUSINESS_TYPE_searchButton#}","itemId":"searchButton","iconCls":"seek_icon"},"events":{"click":"app.grid.store.load({params : Wb.getValue(app.search_form)});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_BUSINESS_TYPE_resetButton#}","itemId":"resetButton","iconCls":"refresh_icon"},"events":{"click":"app.search_form.getForm().reset();\napp.searchButton.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":false,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","barExportAllButtons":"false","barExportButtons":"false","itemId":"grid","editable":"true"},"events":{"tagEvents":"cellclick:function(view, td, cellIndex, record, tr, rowIndex, event, options){\n  if(cellIndex == 3){\n      if(record.get('OP_TYPE')=='Add'){\n          app.BUSINESS_TYPE_CODE_COL.getEditor().setReadOnly(false);\n      }else{\n          app.BUSINESS_TYPE_CODE_COL.getEditor().setReadOnly(true);\n      }\n  }\n}"},"children":[{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=xc/st/base/XC_ST_BUSINESS_TYPE/data/stBusinessTypeSelect"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#XC_ST_BUSINESS_TYPE_addBtn#}","itemId":"addBtn","iconCls":"file_add_icon"},"events":{"click":"Wb.addEdit(app.grid,[{BUSINESS_TYPE_ID : Xip.getId(),STATUS : 'Y',OP_TYPE : \"Add\"}]);"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_BUSINESS_TYPE_saveBtn#}","itemId":"saveBtn","iconCls":"save_icon"},"events":{"click":"var rec = app.grid.getSelection();//选择一行信息\nvar modify = app.grid.store.getModifiedRecords();\nif(modify === '' || modify.length === 0){\n    Wb.toast('{#XC_ST_BUSINESS_TYPE_mysjxybc#}');\n\treturn;\n}\nif(!Wb.verifyGrid(app.grid))//验证数据是否合法\n\treturn;\nWb.sync({\n    grid : app.grid,\n    url : 'm?xwl=xc/st/base/XC_ST_BUSINESS_TYPE/data/stBusinessTypeUpdate',\n    success : function(resp) {\n        Wb.toast('{#XC_ST_BUSINESS_TYPE_sjbccg#}');\n\t\tapp.searchButton.fireEvent('click');\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_BUSINESS_TYPE_deleteBtn#}","itemId":"deleteBtn","iconCls":"file_delete_icon"},"events":{"click":"var recs = app.grid.getSelection();//获得选中数据\nif (!recs.length) {//选中的数据条数\n\tWb.toast('{#XC_ST_BUSINESS_TYPE_qxzxyscdjl#}');\n\treturn;\n}\nWb.confirm('{#XC_ST_BUSINESS_TYPE_qdyscxzd#} ' + recs.length + ' {#XC_ST_BUSINESS_TYPE_tjlm#}',function() {\n    Wb.request({\n        url : 'm?xwl=xc/st/base/XC_ST_BUSINESS_TYPE/data/stBusinessTypeDelete',\n        params : {'infoArray' : Wb.encode(Wb.getData(recs))},//传参\n        success: function(resp){\n            Wb.toast('{#XC_ST_BUSINESS_TYPE_kcywlxsccg#}');\n            Wb.remove(app.grid,recs);\n        }\n    });\n});"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#XC_ST_BUSINESS_TYPE_NUMBER_COL#}","align":"center","width":"50","xtype":"rownumberer","titleAlign":"center","itemId":"NUMBER_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ID","hidden":"true","dataIndex":"BUSINESS_TYPE_ID","titleAlign":"center","itemId":"BUSINESS_TYPE_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>{#XC_ST_BUSINESS_TYPE_BUSINESS_TYPE_CODE#}","width":"150","dataIndex":"BUSINESS_TYPE_CODE","titleAlign":"center","itemId":"BUSINESS_TYPE_CODE_COL"},"children":[{"configs":{"allowBlank":"false","itemId":"editor"},"events":{"change":"var rec = app.grid.getSelection();//获得选中数据\nvar row = app.grid.store.indexOf(rec[0]);//获得选中行号\nfor(var i = 0;i < app.grid.store.getCount();i++){\n    var data = app.grid.store.getAt(i);\n    if(newValue == data.get(\"BUSINESS_TYPE_CODE\") && row != i && !Wb.isEmpty(newValue)){\n\t\tWb.toast('{#XC_ST_BUSINESS_TYPE_BUSINESS_TYPE_CODE#} \"' + newValue + '\" {#XC_ST_BUSINESS_TYPE_yjcz#}');\n        text.setValue(null);\n        return;\n    }\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>{#XC_ST_BUSINESS_TYPE_BUSINESS_TYPE_NAME#}","width":"150","dataIndex":"BUSINESS_TYPE_NAME","titleAlign":"center","itemId":"BUSINESS_TYPE_NAME_COL"},"children":[{"configs":{"allowBlank":"false","itemId":"editor"},"events":{"change":"var rec = app.grid.getSelection();//获得选中数据\nvar row = app.grid.store.indexOf(rec[0]);//获得选中行号\nfor(var i = 0;i < app.grid.store.getCount();i++){\n    var data = app.grid.store.getAt(i);\n    if(newValue == data.get(\"BUSINESS_TYPE_NAME\") && row != i && !Wb.isEmpty(newValue)){\n\t\tWb.toast('{#XC_ST_BUSINESS_TYPE_BUSINESS_TYPE_NAME#} \"' + newValue + '\" {#XC_ST_BUSINESS_TYPE_yjcz#}');\n        text.setValue(null);\n        return;\n    }\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>{#XC_ST_BUSINESS_TYPE_ST_CAT_NAME#}","width":"120","dataIndex":"ST_CAT_NAME","titleAlign":"center","itemId":"ST_CAT_NAME_COL"},"children":[{"configs":{"allowBlank":"false","displayField":"ST_CAT_NAME","valueField":"ST_CAT_NAME","itemId":"editor","editable":"false"},"events":{"select":"var rec = app.grid.getSelection();\nrec[0].set('DOC_CAT_CODE',records[0].data.ST_CAT_CODE);"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/common/data/stDocCatsSelect"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_BUSINESS_TYPE_STATUS#}","width":"100","dataIndex":"STATUS","titleAlign":"center","itemId":"STATUS_COL","renderer":"if(value == 'Y')\n    return '{#XC_ST_BUSINESS_TYPE_Y#}';\nif(value == 'N')\n    return '{#XC_ST_BUSINESS_TYPE_N#}';"},"children":[{"configs":{"displayField":"MAT_TYPE_SET_NAME","valueField":"MAT_TYPE_SET_NAME","pickList":"[['Y','{#XC_ST_BUSINESS_TYPE_Y#}'],['N','{#XC_ST_BUSINESS_TYPE_N#}']]","itemId":"editor"},"children":[],"expanded":true,"type":"combo"}],"expanded":true,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}