{"inframe":false,"title":"账簿参数管理","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/st/ld_base/XC_ST_LD_PARMS/json/XC_ST_LD_PARMS\");","itemId":"module"},"events":{"finalize":"function returnRowFn(r,type){\n    if(type==='xip_pub_orgs'){\n        var ledgerId = r.data.LEDGER_ID;\n        setFormValue(ledgerId);\n    }\n}\nfunction clearOtherFn(type){\n    if(type=='xip_pub_orgs'){\n    }\n}\nfunction setFormValue(ledgerId){\n    Wb.request({\n        url : 'm?xwl=xc/st/common/data/xcGlLedgerSelectByLedgerId',\n        params : {LEDGER_ID : ledgerId},\n        async : false,\n        success : function(resp){\n            var res = Wb.decode(resp.responseText).rows[0];\n            Wb.setValue(app.form1,res);\n            app.ST_ACC_ID_ZG_NAME.QUERY_LEDGER_ID.setValue(ledgerId);\n            app.ST_ACC_ID_DIFF_NAME.QUERY_LEDGER_ID.setValue(ledgerId);\n        }\n    });\n    //根据当前账簿和所对应的开始会计期，如果库存会计期打开了，则开始会计期不能修改\n    Wb.request({\n        url : 'm?xwl=xc/st/common/data/stLdPeriodSelect',\n        params : {LEDGER_ID : ledgerId,ST_PERIODS : app.ST_PERIOD_CODE.getValue()},\n        async : false,\n        success : function(resp){\n            var res = Wb.decode(resp.responseText);\n            if(res.total > 0 && res.rows[0].PERIODS_STATUS == '1')\n                app.ST_PERIOD_CODE.setReadOnly(true);\n            else\n                app.ST_PERIOD_CODE.setReadOnly(false);\n        }\n    });\n    //根据当前账簿判断物料是否已经同步到账簿下，已经同步则不能修改\n    Wb.request({\n        url : 'm?xwl=xc/st/ld_base/XC_ST_MATERIAL_PARMS/data/stMaterialParamsSelect',\n        params : {LEDGER_ID : ledgerId},\n        async : false,\n        success : function(resp){\n            var res = Wb.decode(resp.responseText);\n            if(res.total > 0)\n                app.MAT_TYPE_SET_NAME.setReadOnly(true);\n            else\n                app.MAT_TYPE_SET_NAME.setReadOnly(false);\n        }\n    });\n}"},"children":[{"configs":{"itemId":"tools"},"children":[{"configs":{"autoLoad":"true","itemId":"orgInitStore","url":"m?xwl=xc/com-lov/ORG_PICK/DB/ORG_SELECT_BY_LEDGER"},"events":{"load":"if(store.getCount() > 0){\n    app.ORG_ID.setValue(store.getAt(0).get('ORG_ID'));\n    app.ORG_XWL.ORG_ID.setValue(store.getAt(0).get('ORG_ID'));\n    app.ORG_XWL.ORG_NAME.setValue(store.getAt(0).get('ORG_NAME'));\n    setFormValue(store.getAt(0).get('LEDGER_ID'));\n}"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#XC_ST_LD_PARMS_saveBtn#}","itemId":"saveBtn","iconCls":"save_icon"},"events":{"click":"if (!Wb.verify(app.form1)) {\n    Wb.toast('{#XC_ST_LD_PARMS_qsrsybsx#}');\n    return false;\n}\nWb.request({\n    url: 'm?xwl=xc/st/ld_base/XC_ST_LD_PARMS/data/xcGlLedgerUpdate',\n    params: Wb.getValue(app.form1),\n    success: function(resp) {\n        Wb.toast('{#XC_ST_LD_PARMS_sjbccg#}');\n    }\n});"},"children":[],"expanded":false,"type":"button"}],"expanded":false,"type":"toolbar"}],"expanded":true,"type":"folder"},{"configs":{"itemId":"viewport1"},"events":{"beforerender":"app.ORG_XWL.ORG_NAME.labelWidth = 100;"},"children":[{"configs":{"tbar":"app.tbar","itemId":"form1","border":"false"},"children":[{"configs":{"title":"{#XC_ST_LD_PARMS_fieldset1#}","margin":"10","itemId":"fieldset1"},"children":[{"configs":{"frame":"false","layout":"column","margin":"5 0 5 0","border":"false","itemId":"tr_1"},"children":[{"configs":{"frame":"false","layout":"form","columnWidth":".33","border":"false","itemId":"tr_1_1"},"children":[{"configs":{"file":"m?xwl=xc/com-lov/ORG_PICK/ORG_ALL_PICK","itemId":"ORG_XWL"},"children":[],"expanded":false,"type":"xwl"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","layout":"form","columnWidth":".33","border":"false","itemId":"tr_1_2"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","columnWidth":".33","labelAlign":"right","itemId":"LEDGER_NAME","fieldLabel":"{#XC_ST_LD_PARMS_LEDGER_NAME#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"fieldset"},{"configs":{"title":"{#XC_ST_LD_PARMS_fieldset2#}","margin":"10","itemId":"fieldset2"},"children":[{"configs":{"frame":"false","layout":"column","margin":"5 0 5 0","border":"false","itemId":"tr_2"},"children":[{"configs":{"frame":"false","layout":"form","columnWidth":".33","border":"false","itemId":"tr_2_1"},"children":[{"configs":{"labelWidth":"100","allowBlank":"false","displayField":"PERIOD_CODE","valueField":"PERIOD_CODE","columnWidth":".33","labelAlign":"right","itemId":"ST_PERIOD_CODE","fieldLabel":"<font color='red'>*<\/font>{#XC_ST_LD_PARMS_ST_PERIOD_CODE#}"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/ld_base/XC_ST_LD_PARMS/data/periodSelectByLedgerId"},"events":{"beforeload":"store.proxy.extraParams.LEDGER_ID = app.LEDGER_ID.getValue();"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","hidden":"true","layout":"form","columnWidth":".33","border":"false","itemId":"tr_2_2"},"children":[{"configs":{"labelWidth":"100","displayField":"VAL_NAME","valueField":"VAL_NAME","columnWidth":".33","labelAlign":"right","itemId":"ST_COST_METHOD_NAME","fieldLabel":"{#XC_ST_LD_PARMS_ST_COST_METHOD_NAME#}"},"events":{"select":"app.ST_COST_METHOD.setValue(records[0].data.VAL_CODE);"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/ld_base/XC_ST_LD_PARMS/data/stCostMethodSelect"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","layout":"form","columnWidth":".33","border":"false","itemId":"tr_2_3"},"children":[{"configs":{"labelWidth":"100","allowBlank":"false","displayField":"MAT_TYPE_SET_NAME","valueField":"MAT_TYPE_SET_NAME","columnWidth":".33","labelAlign":"right","itemId":"MAT_TYPE_SET_NAME","fieldLabel":"<font color='red'>*<\/font>{#XC_ST_LD_PARMS_MAT_TYPE_SET_NAME#}"},"events":{"select":"app.MAT_TYPE_SET_ID.setValue(records[0].data.MAT_TYPE_SET_ID);"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/common/data/stMatTypeSetSelect"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","hidden":"true","layout":"column","margin":"5 0 5 0","border":"false","itemId":"tr_3"},"children":[{"configs":{"frame":"false","layout":"form","columnWidth":".33","border":"false","itemId":"tr_3_1"},"children":[{"configs":{"file":"m?xwl=xc/st/common/st_com_lov/XC_ST_ACC_ID/ST_ACC_ID_DIFF","itemId":"ST_ACC_ID_DIFF_NAME"},"children":[],"expanded":false,"type":"xwl"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","layout":"form","columnWidth":".33","border":"false","itemId":"tr_3_2"},"children":[{"configs":{"file":"m?xwl=xc/st/common/st_com_lov/XC_ST_ACC_ID/ST_ACC_ID_ZG","itemId":"ST_ACC_ID_ZG_NAME"},"children":[],"expanded":false,"type":"xwl"}],"expanded":true,"type":"panel"},{"configs":{"frame":"false","layout":"form","columnWidth":".33","border":"false","itemId":"tr_3_3"},"children":[{"configs":{"labelWidth":"100","columnWidth":".33","labelAlign":"right","itemId":"ST_PROCESS_METHOD_NAME","fieldLabel":"{#XC_ST_LD_PARMS_ST_PROCESS_METHOD_NAME#}"},"children":[],"expanded":true,"type":"combo"}],"expanded":false,"type":"panel"}],"expanded":false,"type":"panel"},{"configs":{"frame":"false","layout":"column","border":"false","itemId":"tr_hide"},"children":[{"configs":{"hidden":"true","itemId":"LEDGER_ID","fieldLabel":"账簿ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"ORG_ID","fieldLabel":"组织ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"MAT_TYPE_SET_ID","fieldLabel":"物资分类集ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"ST_COST_METHOD","fieldLabel":"成本核算方法"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"ST_PROCESS_METHOD","fieldLabel":"移动加权平均法下的差异处理方式"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"panel"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}