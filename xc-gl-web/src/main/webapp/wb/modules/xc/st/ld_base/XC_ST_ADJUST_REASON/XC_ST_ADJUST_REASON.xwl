{"inframe":false,"title":"调整原因","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/st/ld_base/XC_ST_ADJUST_REASON/json/XC_ST_ADJUST_REASON\");","itemId":"module"},"events":{"finalize":"function returnRowFn(r,type){\n    if(type==='xip_pub_orgs'){\n        app.LEDGER_ID.setValue(r.data.LEDGER_ID);\n        app.LEDGER_NAME.setValue(r.data.LEDGER_NAME);\n        app.queryBtn.fireEvent('click');\n    }\n}\nfunction clearOtherFn(type){\n    if(type=='xip_pub_orgs'){\n        app.queryBtn.fireEvent('click');\n    }\n}"},"children":[{"configs":{"itemId":"tools"},"children":[{"configs":{"autoLoad":"true","itemId":"orgInitStore","url":"m?xwl=xc/com-lov/ORG_PICK/DB/ORG_SELECT_BY_LEDGER"},"events":{"load":"if(store.getCount() > 0){\n    app.LEDGER_ID.setValue(store.getAt(0).get('LEDGER_ID'));\n    app.LEDGER_NAME.setValue(store.getAt(0).get('LEDGER_NAME'));\n    app.ORG_ID.setValue(store.getAt(0).get('ORG_ID'));\n    app.ORG_XWL.ORG_ID.setValue(store.getAt(0).get('ORG_ID'));\n    app.ORG_XWL.ORG_NAME.setValue(store.getAt(0).get('ORG_NAME'));\n    app.queryBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"folder"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","itemId":"search_form"},"children":[{"configs":{"layout":"column","margin":"5 0 5 0","itemId":"row1","border":"false"},"children":[{"configs":{"layout":"form","columnWidth":".249","itemId":"row1_1","border":"false"},"children":[{"configs":{"file":"m?xwl=xc/com-lov/ORG_PICK/ORG_ALL_PICK","itemId":"ORG_XWL"},"children":[],"expanded":false,"type":"xwl"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","itemId":"row1_2","border":"false"},"children":[{"configs":{"labelWidth":"80","readOnly":"true","labelAlign":"right","itemId":"LEDGER_NAME","fieldLabel":"{#XC_ST_ADJUST_REASON_LEDGER_NAME#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","readOnly":"true","hidden":"true","labelAlign":"right","itemId":"LEDGER_ID","fieldLabel":"账簿ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","readOnly":"true","hidden":"true","labelAlign":"right","itemId":"ORG_ID","fieldLabel":"组织ID"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".249","itemId":"row1_3","border":"false"},"children":[{"configs":{"layout":"column","columnWidth":".249","itemId":"row1_3_1","border":"false"},"children":[{"configs":{"text":"{#XC_ST_ADJUST_REASON_searchButton#}","itemId":"queryBtn","iconCls":"seek_icon"},"events":{"click":"app.grid.store.load({params : {LEDGER_ID: app.LEDGER_ID.getValue()}});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_ADJUST_REASON_resetButton#}","itemId":"clearBtn","iconCls":"refresh_icon"},"events":{"click":"app.search_form.getForm().reset();\napp.queryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","barExportAllButtons":"false","barExportButtons":"false","itemId":"grid","editable":"true"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/st/ld_base/XC_ST_ADJUST_REASON/data/stAdjustReasonSelect"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#XC_ST_ADJUST_REASON_addBtn#}","itemId":"addBtn","iconCls":"file_add_icon"},"events":{"click":"if(Wb.isEmpty(app.ORG_XWL.ORG_NAME.getValue())){\n\tWb.toast('{#XC_ST_ADJUST_REASON_qxxzzzzjxxzcz#}');//请先选择组织，在进行新增操作！\n    return;\n}\nWb.addEdit(app.grid,[{ORG_ID : app.ORG_XWL.ORG_ID.getValue(),\n                      LEDGER_ID : app.LEDGER_ID.getValue(),\n                      ORG_NAME : app.ORG_XWL.ORG_NAME.getValue(),\n                      LEDGER_NAME : app.LEDGER_NAME.getValue(),\n                      ADJUST_REASON_ID : Xip.getId()}]);"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_ADJUST_REASON_saveBtn#}","itemId":"saveBtn","iconCls":"save_icon"},"events":{"click":"var rec = app.grid.getSelection();//选择一行信息\nvar modify = app.grid.store.getModifiedRecords();\nif(modify === '' || modify.length === 0){\n    Wb.toast('{#XC_ST_ADJUST_REASON_mysjxybc#}');\n\treturn;\n}\nif(!Wb.verifyGrid(app.grid))//验证数据是否合法\n\treturn;\nWb.sync({\n    grid : app.grid,\n    url : 'm?xwl=xc/st/ld_base/XC_ST_ADJUST_REASON/data/stAdjustReasonUpdate',\n    success : function(resp) {\n        Wb.toast('{#XC_ST_ADJUST_REASON_sjbccg#}');\n\t\tapp.queryBtn.fireEvent('click');\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#XC_ST_ADJUST_REASON_deleteBtn#}","itemId":"deleteBtn","iconCls":"file_delete_icon"},"events":{"click":"var recs = app.grid.getSelection();//获得选中数据\nif (!recs.length) {//选中的数据条数\n\tWb.toast('{#XC_ST_ADJUST_REASON_qxzxyscdjl#}');\n\treturn;\n}\nWb.confirm('{#XC_ST_ADJUST_REASON_qdyscxzd#} ' + recs.length + ' {#XC_ST_ADJUST_REASON_tjlm#}',function() {\n    Wb.request({\n        url : 'm?xwl=xc/st/ld_base/XC_ST_ADJUST_REASON/data/stAdjustReasonDelete',\n        params : {'infoArray' : Wb.encode(Wb.getData(recs))},//传参\n        success: function(resp){\n            Wb.toast('{#XC_ST_ADJUST_REASON_sccg#}');\n            Wb.remove(app.grid,recs);\n        }\n    });\n});"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#XC_ST_ADJUST_REASON_NUMBER_COL#}","align":"center","width":"50","xtype":"rownumberer","titleAlign":"center","itemId":"NUMBER_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>{#XC_ST_ADJUST_REASON_ADJUST_REASON#}","width":"200","dataIndex":"ADJUST_REASON","titleAlign":"center","itemId":"ADJUST_REASON_COL"},"children":[{"configs":{"height":"40","allowBlank":"false","itemId":"editor"},"events":{"change":"var rec = app.grid.getSelection();//获得选中数据\nvar row = app.grid.store.indexOf(rec[0]);//获得选中行号\nfor(var i = 0;i < app.grid.store.getCount();i++){\n    var data = app.grid.store.getAt(i);\n    if(newValue == data.get(\"ADJUST_REASON\") && row != i && !Wb.isEmpty(newValue)){\n\t\tWb.toast('{#XC_ST_ADJUST_REASON_ADJUST_REASON#} \"' + newValue + '\" {#XC_ST_ADJUST_REASON_yjcz#}');\n        textarea.setValue(null);\n        return;\n    }\n}"},"children":[],"expanded":false,"type":"textarea"}],"expanded":true,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>{#XC_ST_ADJUST_REASON_ACC_NAME#}","width":"200","dataIndex":"ACC_NAME","titleAlign":"center","itemId":"ACC_NAME_COL"},"children":[{"configs":{"labelWidth":"80","allowBlank":"false","labelAlign":"right","normalName":"ACC_NAME_PICK","itemId":"editor"},"events":{"expand":"picker.getPicker().getStore().load();","collapse":"app.QUERY_CODE_NAME.reset();"},"children":[{"configs":{"tagConfigs":"minWidth:400","height":"300","barExportButtons":"false","barExportAllButtons":"false","itemId":"pickComp"},"events":{"itemdblclick":"var picker = this.ownerCmp;\nvar rec = app.grid.getSelection();\nrec[0].set('ACC_ID',record.data.ACC_ID);\nrec[0].set('ACC_NAME',record.data.ACC_NAME);\napp.QUERY_CODE_NAME.reset(); \napp.ACC_NAME_PICK.setValue(record.data.ACC_NAME);\npicker.collapse();"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/com-lov/ACC_ID_PICK/DB/XC_BG_LD_ACCOUNTS_SELECT_LD"},"events":{"beforeload":"var rec = app.grid.getSelection();\nstore.proxy.extraParams.QUERY_LEDGER_ID = rec[0].data.LEDGER_ID;\nstore.proxy.extraParams.QUERY_CODE_NAME = app.QUERY_CODE_NAME.getValue();"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#XC_ST_ADJUST_REASON_ACC_CODE#}","dataIndex":"ACC_CODE","titleAlign":"center","itemId":"ACC_CODE_COL","flex":"1"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#XC_ST_ADJUST_REASON_ACC_NAMES#}","dataIndex":"ACC_NAME","titleAlign":"center","itemId":"ACC_NAME_COL","flex":"1"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"labelWidth":"100","labelAlign":"right","itemId":"QUERY_CODE_NAME","fieldLabel":"{#XC_ST_ADJUST_REASON_ACC_CODE_NAME#}"},"events":{"specialkey":"if(Ext.EventObject.getKey()==13){\n\tapp.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"itemId":"searchButton","iconCls":"seek_icon"},"events":{"click":"app.pickComp.getStore().load();"},"children":[],"expanded":false,"type":"button"},{"configs":{"itemId":"cancelBtn","iconCls":"delete_icon"},"events":{"click":"var rec = app.grid.getSelection();\nrec[0].set('ACC_ID',null);\nrec[0].set('ACC_NAME',null);\napp.ACC_NAME_PICK.setValue('');\napp.ACC_NAME_PICK.getPicker().hide();"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"picker"}],"expanded":true,"type":"column"},{"configs":{"text":"{#XC_ST_ADJUST_REASON_DESCRIPTION#}","width":"200","dataIndex":"DESCRIPTION","titleAlign":"center","itemId":"DESCRIPTION_COL"},"children":[{"configs":{"height":"40","itemId":"editor"},"children":[],"expanded":false,"type":"textarea"}],"expanded":true,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}