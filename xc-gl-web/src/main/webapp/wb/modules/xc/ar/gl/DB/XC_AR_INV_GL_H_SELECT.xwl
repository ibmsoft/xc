{"inframe":false,"title":"应收单查询","hidden":false,"roles":{"default":1},"children":[{"configs":{"initScript":"var lang = request.getSession().getAttribute(\"XzSessionVars\").get('language');\nrequest.setAttribute(\"language\",lang);","serverScript":"var sql, data = app.get();\nsql = ' where 1=1 ';\nsql+=' and LEDGER_ID={?LEDGER_ID?}';\nif (!Wb.isEmpty(data.AR_DOC_CAT_CODE)) {\n    if(data.AR_DOC_CAT_CODE != 'All'){\n        sql+=' and AR_DOC_CAT_CODE={?AR_DOC_CAT_CODE?}';\n    }\n}\nif (!Wb.isEmpty(data.AR_INV_GL_H_CODE)) {\n    sql+=' and (AR_INV_GL_H_CODE like \\'%'+data.AR_INV_GL_H_CODE+'%\\' or AR_CONTRACT_CODE like \\'%'+data.AR_INV_GL_H_CODE+'%\\' or AR_CONTRACT_NAME like \\'%'+data.AR_INV_GL_H_CODE+'%\\')';\n}\nif (!Wb.isEmpty(data.INV_AMOUNT_START)) {\n    sql+=' and INV_AMOUNT >='+data.INV_AMOUNT_START;\n}\nif (!Wb.isEmpty(data.INV_AMOUNT_END)) {\n    sql+=' and INV_AMOUNT <='+data.INV_AMOUNT_END;\n}\nif (!Wb.isEmpty(data.CUSTOMER_NAME)) {\n    sql+=' and CUSTOMER_NAME like \\'%'+data.CUSTOMER_NAME+'%\\' ';\n}\nif (!Wb.isEmpty(data.PROJECT_NAME)) {\n    sql+=' and PROJECT_NAME like \\'%'+data.PROJECT_NAME+'%\\' ';\n}\nif (!Wb.isEmpty(data.DEPT_NAME)) {\n    sql+=' and DEPT_NAME like \\'%'+data.DEPT_NAME+'%\\' ';\n}\nif (!Wb.isEmpty(data.BIZ_DATE_START)) {\n    if (!Wb.isEmpty(data.BIZ_DATE_END)) {\n        sql+=' and GL_DATE BETWEEN {?BIZ_DATE_START?} and {?BIZ_DATE_END?} ';\n    }else{\n        sql+=' and GL_DATE >= {?BIZ_DATE_START?}';\n    }\n}\nelse{\n    if (!Wb.isEmpty(data.BIZ_DATE_END)) {\n        sql+=' and GL_DATE <= {?BIZ_DATE_END?}';\n    }\n}\nif (!Wb.isEmpty(data.ACC_NAME)) {\n    sql+=' and AR_ACC_NAME_DEBT like \\'%'+data.ACC_NAME+'%\\' ';\n}\nif (!Wb.isEmpty(data.SOURCE)) {\n    if(data.SOURCE != 'ALL'){\n        sql+=' and SOURCE={?SOURCE?}';\n    }\n}\nif (!Wb.isEmpty(data.CREATED_BY)) {\n    sql+=' and CREATED_BY={?CREATED_BY?}';\n}\nif (!Wb.isEmpty(data.CREATED_NAME)) {\n    sql+=' and CREATED_BY_NAME like \\'%'+data.CREATED_NAME+'%\\' ';\n}\nif (!Wb.isEmpty(data.V_STATUS)) {\n    if(data.V_STATUS != 'ALL')\n        sql+=' and V_STATUS={?V_STATUS?}';\n}\nif (!Wb.isEmpty(data.INIT)) {\n    sql+=' and INIT={?INIT?}';\n}\nrequest.setAttribute('sql', sql);","itemId":"module"},"children":[{"configs":{"sql":"SELECT * FROM (\nSELECT \n\ta.*,\n\ta.SOURCE SOURCE_NAME,\n  (SELECT\n     CASE WHEN l.VAL_NAME IS NULL OR l.VAL_NAME = '' THEN d.VAL_NAME ELSE l.VAL_NAME END VAL_NAME\n   FROM\n     xip_pub_val_set_dtl d\n   LEFT JOIN XIP_PUB_VAL_SET_DTL_LANG l ON d.VAL_SET_CODE = l.VAL_SET_CODE\n   AND d.VAL_CODE = l.VAL_CODE\n   AND l.VAL_SET_LANG = '{#language#}'\n   WHERE\n     d.VAL_SET_CODE = 'XC_GL_V_STATUS'\n   AND d.ENABLE_FLAG = 'Y'\n   AND d.VAL_CODE = a.V_STATUS) AS V_STATUS_NAME,\n  (SELECT AR_INV_H_CODE FROM xc_ar_invoice_h b WHERE b.AR_INV_H_ID=a.AR_INV_H_ID) AR_INV_H_CODE,\n  (SELECT CANCEL_AMT FROM xc_ar_invoice_h b WHERE b.AR_INV_H_ID=a.AR_INV_H_ID) INV_CANCEL_AMT,\n  (SELECT INS_CODE FROM xc_ar_invoice_h b WHERE b.AR_INV_H_ID=a.AR_INV_H_ID) INS_CODE,\n  (SELECT\n       CASE WHEN l.VAL_NAME IS NULL OR l.VAL_NAME = '' THEN d.VAL_NAME ELSE l.VAL_NAME END VAL_NAME\n     FROM\n       xip_pub_val_set_dtl d\n     LEFT JOIN XIP_PUB_VAL_SET_DTL_LANG l ON d.VAL_SET_CODE = l.VAL_SET_CODE\n     AND d.VAL_CODE = l.VAL_CODE\n     AND l.VAL_SET_LANG = '{#language#}'\n     WHERE\n       d.VAL_SET_CODE = 'XC_AR_YSD_CLASS'\n     AND d.ENABLE_FLAG = 'Y'\n     AND d.VAL_CODE = a.AR_DOC_CAT_CODE) AR_CAT_NAME,\n  (SELECT LEDGER_NAME FROM xc_gl_ledgers b WHERE b.LEDGER_ID=a.LEDGER_ID) LEDGER_NAME,\n  (SELECT CUSTOMER_NAME FROM xc_ar_customers b WHERE b.CUSTOMER_ID = a.CUSTOMER_ID) CUSTOMER_NAME,\n  (SELECT PROJECT_NAME FROM xc_pm_projects b WHERE b.PROJECT_ID=a.PROJECT_ID) PROJECT_NAME,\n  (SELECT DEPT_NAME FROM xip_pub_depts b WHERE b.DEPT_ID=a.DEPT_ID) DEPT_NAME,\n  (SELECT AR_CONTRACT_NAME FROM xc_ar_contract b WHERE b.AR_CONTRACT_ID=a.AR_CONTRACT_ID) AR_CONTRACT_NAME,\n  (SELECT AR_CONTRACT_CODE FROM xc_ar_contract b WHERE b.AR_CONTRACT_ID=a.AR_CONTRACT_ID) AR_CONTRACT_CODE,\n  (SELECT ACC_NAME FROM xc_gl_accounts b WHERE b.acc_id=a.AR_ACC_ID_DEBT) AR_ACC_NAME_DEBT,\n  (SELECT ACC_NAME FROM xc_gl_accounts b WHERE b.acc_id=a.AR_ACC_ID_TAX) AR_ACC_NAME_TAX,\n  (SELECT CCID_NAME FROM xc_gl_ccid b WHERE b.CCID=a.AR_CCID_DEBT) AR_CCID_DEBT_NAME, \n  (SELECT CCID_NAME FROM xc_gl_ccid b WHERE b.CCID=a.AR_CCID_TAX) AR_CCID_TAX_NAME, \n  (SELECT EMP_NAME FROM xip_pub_emps WHERE EMP_ID=(SELECT EMP_ID FROM xip_pub_users b WHERE b.USER_ID=a.CREATED_BY)) CREATED_BY_NAME,\n  (SELECT EMP_NAME FROM xip_pub_emps WHERE EMP_ID=(SELECT EMP_ID FROM xip_pub_users b,xc_ar_invoice_h arih WHERE b.USER_ID = arih.FIN_USER_ID AND a.AR_INV_H_ID = arih.AR_INV_H_ID)) FIN_USER_NAME,\n  (SELECT EMP_NAME FROM xip_pub_emps WHERE EMP_ID=(SELECT EMP_ID FROM xip_pub_users b,xc_ar_invoice_h arih WHERE b.USER_ID = arih.PRINT_USER_ID AND a.AR_INV_H_ID = arih.AR_INV_H_ID)) PRINT_USER_NAME\nFROM\n  xc_ar_inv_gl_h a\n) t {#sql#}\nORDER BY t.AR_INV_GL_H_CODE DESC","itemId":"dataprovider1"},"children":[],"expanded":false,"type":"dataprovider"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}