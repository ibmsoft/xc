{"inframe":false,"title":"选择应收单","hidden":false,"roles":{"default":1},"children":[{"configs":{"serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/ar/pay/LOV/LOV_SELECT_INV_WIN\");","itemId":"module"},"events":{"finalize":"Wb.ledger_id = '';//账簿\nWb.customer_id = '';//客户\nWb.project_id = '';//项目\nWb.ar_contract_id = '';//合同\nWb.ar_cat_doc_code = '';//收款单单据类型\n\nExt.apply(app,{\n  initWin:function(params){\n    \n    Ext.apply(app, params);\n    \n    //参数赋值\n    Wb.ledger_id = params.LEDGER_ID;\n    Wb.customer_id = params.CUSTOMER_ID;\n    Wb.project_id = params.PROJECT_ID;\n    Wb.ar_contract_id = params.AR_CONTRACT_ID;\n    Wb.ar_cat_doc_code = params.AR_CAT_DOC_CODE;\n    \n    //显示窗口\n    app.lovWin = new Ext.window.Window(app.lovWin);\n    app.lovWin.show();\n    \n    //加载数据\n    app.queryBtn.fireEvent('click');\n  }\n});\n"},"children":[{"configs":{"maximized":"true","layout":"border","itemId":"lovWin","modal":"true"},"events":{"close":"//app.hideFun();"},"children":[{"configs":{"region":"north","border":"false","itemId":"form1"},"children":[{"configs":{"title":"{#FIELDSET1_TITLE#}","itemId":"fieldset1"},"children":[{"configs":{"layout":"column","border":"false","itemId":"f1_tr1"},"children":[{"configs":{"layout":"fit","columnWidth":".33","border":"false","itemId":"f1_tr1_td1"},"children":[{"configs":{"labelWidth":"80","emptyText":"{#CONTRACT_EMPTY_TEXT#}","labelAlign":"right","itemId":"CONTRACT","fieldLabel":"{#CONTRACT#}"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.queryBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".33","border":"false","itemId":"f1_tr1_td2"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"DEPT","fieldLabel":"{#DEPT#}"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.queryBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".33","border":"false","itemId":"f1_tr1_td3"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"PROJECT","fieldLabel":"{#PROJECT#}"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.queryBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","margin":"10 0 10 0","border":"false","itemId":"f1_tr2"},"children":[{"configs":{"layout":"column","columnWidth":".33","border":"false","itemId":"f1_tr2_td1"},"children":[{"configs":{"text":"{#GL_DATE#}：","width":"80","margin":"3 5 0 0","labelAlign":"right","itemId":"label2"},"children":[],"expanded":false,"type":"label"},{"configs":{"tagConfigs":"{\n  columnWidth:.5\n}","itemId":"GL_DATE1"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.queryBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"date"},{"configs":{"text":"-","width":"20","labelAlign":"center","itemId":"label1"},"children":[],"expanded":false,"type":"label"},{"configs":{"tagConfigs":"{\n  columnWidth:.5\n}","itemId":"GL_DATE2"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.queryBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"date"}],"expanded":true,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".33","border":"false","itemId":"f1_tr2_td2"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"DESCRIPTION","fieldLabel":"{#DESCRIPTION#}"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.queryBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","columnWidth":".33","border":"false","itemId":"f1_tr2_td3"},"children":[{"configs":{"width":"85","itemId":"space1"},"children":[],"expanded":false,"type":"label"},{"configs":{"text":"{#queryBtn#}","itemId":"queryBtn","iconCls":"seek_icon"},"events":{"click":"app.grid1.store.load();"},"children":[],"expanded":false,"type":"button"},{"configs":{"width":"20","itemId":"space2"},"children":[],"expanded":false,"type":"label"},{"configs":{"text":"{#resetBtn#}","itemId":"resetBtn","iconCls":"refresh_icon"},"events":{"click":"app.form1.getForm().reset();\napp.queryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"},{"configs":{"region":"center","multiSelect":"true","selType":"checkboxmodel","itemId":"grid1","editable":"true"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/ar/pay/LOV/DB/lov_select_ar_inv"},"events":{"beforeload":"operation.params = {\n  LEDGER_ID : Wb.ledger_id,\n  CUSTOMER_ID : Wb.customer_id,\n  PROJECT_ID : Wb.project_id,\n  AR_CONTRACT_ID : Wb.ar_contract_id,\n  CONTRACT : app.CONTRACT.getValue(),\n  DESCRIPTION : app.DESCRIPTION.getValue(),\n  GL_DATE1 : app.GL_DATE1.getValue(),\n  GL_DATE2 : app.GL_DATE2.getValue(),\n  DEPT : app.DEPT.getValue(),\n  PROJECT : app.PROJECT.getValue(),\n  AR_CAT_DOC_CODE : Wb.ar_cat_doc_code\n};\n"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#okBtn#}","itemId":"okBtn","iconCls":"check_icon"},"events":{"click":"var recs = app.grid1.getSelection();\nif(recs.length < 1){\n  Wb.toast('{#qzsxzytjl#}');\n  return ;\n}\nvar go = true;//验证是否合格\n//验证\nWb.each(recs,function(rec){\n  if(Wb.isEmpty(rec.data.JS_AMOUNT)){\n    Wb.toast('{#jsjebyxwk#}');\n    go = false;\n    return ;\n  }\n  if(rec.data.JS_AMOUNT === 0){\n    Wb.toast('{#jsjebyxwl#}');\n    go = false;\n    return ;\n  }\n});\nif(go){\n  Wb.confirm('{#qdyxzd#} ' + recs.length + ' {#tjlm#}', function() {\n    app.hideFun(recs);\n    app.lovWin.close();\n  });\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#cancelBtn#}","itemId":"cancelBtn","iconCls":"cancel_icon"},"events":{"click":"app.lovWin.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#rownum#}","xtype":"rownumberer","titleAlign":"center","itemId":"rownum"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AR_INV_GL_H_CODE_COL#}","width":"150","dataIndex":"AR_INV_GL_H_CODE","titleAlign":"center","itemId":"AR_INV_GL_H_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#GL_DATE_COL#}","width":"100","dataIndex":"GL_DATE","titleAlign":"center","itemId":"GL_DATE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#DESCRIPTION_COL#}","width":"300","dataIndex":"DESCRIPTION","titleAlign":"center","itemId":"DESCRIPTION_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#INV_AMOUNT_COL#}","width":"100","align":"right","dataIndex":"INV_AMOUNT","format":"0,000.00","titleAlign":"center","itemId":"INV_AMOUNT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#NO_PAY_AMT_COL#}","width":"100","align":"right","dataIndex":"NO_PAY_AMT","format":"0,000.00","titleAlign":"center","itemId":"NO_PAY_AMT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"<font color = 'red'>*<\/font>{#JS_AMOUNT_COL#}","width":"100","align":"right","dataIndex":"JS_AMOUNT","format":"0,000.00","titleAlign":"center","itemId":"JS_AMOUNT_COL"},"children":[{"configs":{"normalName":"JS_AMOUNT","itemId":"editor"},"events":{"change":"var rec = app.grid1.getSelection()[0];\n\nvar yue = rec.data.NO_PAY_AMT;\n\n\nif(Wb.ar_cat_doc_code == 'SKD_JSK'){\n  if(newValue < 0){\n    Wb.toast('{#jsjebkxyl#}');\n    number.setValue();\n  }else{\n    if(newValue > yue){\n      Wb.toast('{#jsjebkcgysye#}');\n      number.setValue(yue);\n    }\n  }\n}else if(Wb.ar_cat_doc_code == 'SKD_JSK-H'){\n  if(newValue > 0){\n    Wb.toast('{#jsjebkdyl#}');\n    number.setValue();\n  }else{\n    if(Math.abs(newValue) > Math.abs(yue)){\n      Wb.toast('{#jsjebkcgysye#}');\n      number.setValue(yue);\n    }\n  }\n}\n","focus":"if(number.getValue() === 0){\n  number.setValue();\n}"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"column"},{"configs":{"text":"{#AR_CONTRACT_NAME_COL#}","width":"200","dataIndex":"AR_CONTRACT_NAME","titleAlign":"center","itemId":"AR_CONTRACT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#DEPT_NAME_COL#}","width":"200","dataIndex":"DEPT_NAME","titleAlign":"center","itemId":"DEPT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#PROJECT_NAME_COL#}","width":"200","dataIndex":"PROJECT_NAME","titleAlign":"center","itemId":"PROJECT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AR_ACC_NAME_DEBT_COL#}","width":"200","align":"center","dataIndex":"AR_ACC_NAME_DEBT","itemId":"AR_ACC_NAME_DEBT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AR_CCID_NAME_DEBT_COL#}","width":"200","align":"center","dataIndex":"AR_CCID_NAME_DEBT","itemId":"AR_CCID_NAME_DEBT_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"window"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}