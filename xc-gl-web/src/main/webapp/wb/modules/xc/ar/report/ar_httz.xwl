{"inframe":false,"title":"合同台帐主信息","hidden":false,"roles":{"default":1},"children":[{"configs":{"serverScript":"// 获取模块语言对应的json文件\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/ar/report/ar_httz\");\nrequest.setAttribute('contextPath',request.getContextPath());\nvar pDbtype = com.xzsoft.xip.platform.util.PlatformUtil.getDbType() ;\nvar pLanguage = request.getSession().getAttribute(\"XzSessionVars\").get(\"language\");\nrequest.setAttribute('pDbtype',pDbtype);\nrequest.setAttribute('pLanguage',pLanguage);","itemId":"module"},"children":[{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","itemId":"queryForm"},"children":[{"configs":{"layout":"column","itemId":"tr1","border":"false"},"children":[{"configs":{"layout":"form","columnWidth":".33","itemId":"td_1_1","border":"false"},"children":[{"configs":{"labelWidth":"40","displayField":"NAME","valueField":"CODE","labelAlign":"right","itemId":"QUERY_LEDGER_ID","fieldLabel":"账簿"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}","select":"\n//清空form中其他已经选择的条件\napp.QUERY_CUSTOMER_ID_START.clearValue();\napp.QUERY_CUSTOMER_ID_END.clearValue();\napp.QUERY_PROJECT_ID_START.clearValue();\napp.QUERY_PROJECT_ID_END.clearValue();\napp.QUERY_DEPT_ID_START.clearValue();\napp.QUERY_DEPT_ID_END.clearValue();"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/ar/report/DB/getAllLedger"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".33","itemId":"td_1_2","border":"false"},"children":[{"configs":{"layout":"column","itemId":"tr_1_2","border":"false"},"children":[{"configs":{"layout":"form","columnWidth":".6","itemId":"td_1_2_1","border":"false"},"children":[{"configs":{"labelWidth":"80","displayField":"NAME","valueField":"CODE","labelAlign":"right","itemId":"QUERY_CUSTOMER_ID_START","fieldLabel":"客户"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/ar/report/DB/getCustomers"},"events":{"beforeload":"var v_ledgerId = app.QUERY_LEDGER_ID.getValue();\nif(Wb.isEmpty(v_ledgerId)){\n  Wb.toast('请先选择账簿！');\n  return;\n}\nstore.proxy.extraParams.ledgerId = v_ledgerId;"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".4","itemId":"td_1_2_2","border":"false"},"children":[{"configs":{"labelWidth":"20","displayField":"NAME","valueField":"CODE","labelAlign":"right","itemId":"QUERY_CUSTOMER_ID_END","fieldLabel":"至"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/ar/report/DB/getCustomers"},"events":{"beforeload":"var v_ledgerId = app.QUERY_LEDGER_ID.getValue();\nif(Wb.isEmpty(v_ledgerId)){\n  Wb.toast('请先选择账簿！');\n  return;\n}\nstore.proxy.extraParams.ledgerId = v_ledgerId;"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".33","itemId":"td_1_3","border":"false"},"children":[{"configs":{"layout":"column","itemId":"tr_1_3","border":"false"},"children":[{"configs":{"layout":"form","columnWidth":".6","itemId":"td_1_3_1","border":"false"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"QUERY_BIZ_DATE_START","fieldLabel":"合同日期"},"children":[],"expanded":false,"type":"date"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".4","itemId":"td_1_3_2","border":"false"},"children":[{"configs":{"labelWidth":"20","labelAlign":"right","itemId":"QUERY_BIZ_DATE_END","fieldLabel":"至"},"children":[],"expanded":false,"type":"date"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","itemId":"tr2","border":"false"},"children":[{"configs":{"layout":"form","columnWidth":".33","itemId":"td_1_2","border":"false"},"children":[{"configs":{"layout":"column","itemId":"tr_1_2","border":"false"},"children":[{"configs":{"layout":"form","columnWidth":".6","itemId":"td_1_2_1","border":"false"},"children":[{"configs":{"labelWidth":"40","displayField":"NAME","valueField":"CODE","labelAlign":"right","itemId":"QUERY_PROJECT_ID_START","fieldLabel":"项目"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/ar/report/DB/getProject"},"events":{"beforeload":"var v_ledgerId = app.QUERY_LEDGER_ID.getValue();\nif(Wb.isEmpty(v_ledgerId)){\n  Wb.toast('请先选择账簿！');\n  return;\n}\nstore.proxy.extraParams.ledgerId = v_ledgerId;"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".4","itemId":"td_1_2_2","border":"false"},"children":[{"configs":{"labelWidth":"20","displayField":"NAME","valueField":"CODE","labelAlign":"right","itemId":"QUERY_PROJECT_ID_END","fieldLabel":"至"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/ar/report/DB/getProject"},"events":{"beforeload":"var v_ledgerId = app.QUERY_LEDGER_ID.getValue();\nif(Wb.isEmpty(v_ledgerId)){\n  Wb.toast('请先选择账簿！');\n  return;\n}\nstore.proxy.extraParams.ledgerId = v_ledgerId;"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".33","itemId":"td_1_3","border":"false"},"children":[{"configs":{"layout":"column","itemId":"tr_1_3","border":"false"},"children":[{"configs":{"layout":"form","columnWidth":".6","itemId":"td_1_3_1","border":"false"},"children":[{"configs":{"labelWidth":"80","displayField":"NAME","valueField":"CODE","labelAlign":"right","itemId":"QUERY_DEPT_ID_START","fieldLabel":"成本中心"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/ar/report/DB/getDept"},"events":{"beforeload":"\nvar v_ledgerId = app.QUERY_LEDGER_ID.getValue();\nif(Wb.isEmpty(v_ledgerId)){\n  Wb.toast('请先选择账簿！');\n  return;\n}\nstore.proxy.extraParams.ledgerId = v_ledgerId;"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".4","itemId":"td_1_3_2","border":"false"},"children":[{"configs":{"labelWidth":"20","displayField":"NAME","valueField":"CODE","labelAlign":"right","itemId":"QUERY_DEPT_ID_END","fieldLabel":"至"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/ar/report/DB/getDept"},"events":{"beforeload":"var v_ledgerId = app.QUERY_LEDGER_ID.getValue();\nif(Wb.isEmpty(v_ledgerId)){\n  Wb.toast('请先选择账簿！');\n  return;\n}\nstore.proxy.extraParams.ledgerId = v_ledgerId;"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".1","itemId":"td_1_4","border":"false"},"children":[{"configs":{"layout":"column","itemId":"tr_1_4","border":"false","x":"10"},"children":[{"configs":{"layout":"form","columnWidth":".5","itemId":"td_1_4_1","border":"false"},"children":[{"configs":{"text":"查询","itemId":"queryBtn"},"events":{"click":"\nvar v_ledgerId = app.QUERY_LEDGER_ID.getValue();\nvar V_CUSTOMER_ID_START = app.QUERY_CUSTOMER_ID_START.getValue();\nvar V_CUSTOMER_ID_END = app.QUERY_CUSTOMER_ID_END.getValue();\nvar v_bizDateStart = Wb.dateToStr(app.QUERY_BIZ_DATE_START.getValue());\nvar v_bizDateEnd = Wb.dateToStr(app.QUERY_BIZ_DATE_END.getValue());\nvar v_projectIdStart = app.QUERY_PROJECT_ID_START.getValue();\nvar v_projectIdEnd = app.QUERY_PROJECT_ID_END.getValue();\nvar v_deptIdStart = Wb.dateToStr(app.QUERY_DEPT_ID_START.getValue());\nvar v_deptIdEnd = Wb.dateToStr(app.QUERY_DEPT_ID_END.getValue());\n\nif(Wb.isEmpty(v_ledgerId)){\n  Wb.toast('请先选择账簿！');\n  return;\n}\nif(Wb.isEmpty(v_bizDateStart) && Wb.isEmpty(v_bizDateEnd)){\n  Wb.toast('请先选择合同日期！');\n  return;\n}\nif(Wb.isEmpty(V_CUSTOMER_ID_START) && Wb.isEmpty(V_CUSTOMER_ID_END)){\n  Wb.toast('请选择客户！');\n  return;\n}\nvar map = new Ext.util.HashMap();\n//账簿\nmap.add('ledgerId',app.QUERY_LEDGER_ID.getValue());\nmap.add('V_CUSTOMER_ID_START',V_CUSTOMER_ID_START);\nmap.add('V_CUSTOMER_ID_END',V_CUSTOMER_ID_END);\nmap.add('bizDateStart',v_bizDateStart);\nmap.add('bizDateEnd',v_bizDateEnd);\nmap.add('projectIdStart',v_projectIdStart);\nmap.add('projectIdEnd',v_projectIdEnd);\nmap.add('deptIdStart',v_deptIdStart);\nmap.add('deptIdEnd',v_deptIdEnd);\nmap.add('pDbtype',\"{#pDbtype#}\");\nmap.add('pLanguage',\"{#pLanguage#}\");\n\nvar targetUrl = '{#contextPath#}/ReportServer?reportlet=xc_ar/AR_HTTZ.cpt&__bypagesize__=false';\nvar reportFrame = document.getElementById('reportIframe');\nvar params = '';\nmap.each(function(key, value, length){\n    params +='&'+key+'='+value;\n});\nparams = targetUrl+params;\nreportFrame.src = params;"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".5","itemId":"td_1_4_2","border":"false"},"children":[{"configs":{"text":"重置","itemId":"clearBtn"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","html":"<iframe  scrolling=no  frameborder=0 width=100% height=100% id=reportIframe src='{#contextPath#}/ReportServer?reportlet=xc_ar/AR_HTTZ.cpt&__bypagesize__=false'><\/iframe>\n","itemId":"reportForm"},"children":[],"expanded":false,"type":"panel"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}