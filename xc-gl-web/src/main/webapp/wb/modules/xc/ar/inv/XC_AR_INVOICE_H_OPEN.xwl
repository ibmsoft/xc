{"inframe":false,"title":"开票界面","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/ar/inv/json/XC_AR_INVOICE_H_MY\");\nvar contextPath = request.getContextPath();\nrequest.setAttribute(\"contextPath\",contextPath);","itemId":"module"},"events":{"finalize":"function returnRowFn(r,type){\n    if(type==='xc_gl_ledgers'){\n        app.LEDGER_XWL.LEDGER_ID.setValue(r.data.LEDGER_ID);\n        app.LEDGER_XWL.LEDGER_NAME.setValue(r.data.LEDGER_NAME);\n        app.NO_LEDGER_XWL.LEDGER_ID.setValue(r.data.LEDGER_ID);\n        app.NO_LEDGER_XWL.LEDGER_NAME.setValue(r.data.LEDGER_NAME);\n        app.searchButton.fireEvent('click');\n        app.no_searchButton.fireEvent('click');\n    }\n}\nfunction clearOtherFn(type){\n    //清空账薄时清空面板中所有信息\n    if(type=='xc_gl_ledgers'){\n        app.LEDGER_XWL.LEDGER_ID.setValue(null);\n        app.LEDGER_XWL.LEDGER_NAME.setValue(null);\n        app.NO_LEDGER_XWL.LEDGER_ID.setValue(null);\n        app.NO_LEDGER_XWL.LEDGER_NAME.setValue(null);\n        app.searchButton.fireEvent('click');\n        app.no_searchButton.fireEvent('click');\n    }\n}"},"children":[{"configs":{"itemId":"request"},"children":[{"configs":{"autoLoad":"true","itemId":"ldInitStore","url":"m?xwl=xc/com-lov/LEDGER_ID_PICK/DB/XC_GL_LEDGERS_SELECT_SEC"},"events":{"load":"if(store.getCount() > 0){\n    app.LEDGER_XWL.LEDGER_ID.setValue(store.getAt(0).get('LEDGER_ID'));\n    app.LEDGER_XWL.LEDGER_NAME.setValue(store.getAt(0).get('LEDGER_NAME'));\n    app.NO_LEDGER_XWL.LEDGER_ID.setValue(store.getAt(0).get('LEDGER_ID'));\n    app.NO_LEDGER_XWL.LEDGER_NAME.setValue(store.getAt(0).get('LEDGER_NAME'));\n    app.searchButton.fireEvent('click');\n    app.no_searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"folder"},{"configs":{"layout":"fit","itemId":"viewport1"},"children":[{"configs":{"itemId":"tab1"},"children":[{"configs":{"title":"{#NoProcessed#}","layout":"border","itemId":"no_panel"},"children":[{"configs":{"region":"north","itemId":"no_search_form"},"children":[{"configs":{"layout":"column","margin":"10 0 0 0","border":"false","itemId":"row1"},"children":[{"configs":{"layout":"form","columnWidth":".33","border":"false","itemId":"row1_1"},"children":[{"configs":{"file":"m?xwl=xc/com-lov/LEDGER_ID_PICK/LEDGER_ID_PICK_SEC","itemId":"NO_LEDGER_XWL"},"children":[],"expanded":false,"type":"xwl"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".33","border":"false","itemId":"row1_2"},"children":[{"configs":{"labelWidth":"80","value":"All","pickList":"[\n  ['All','{#all#}'],\n  ['ZZS','{#zzs#}'],\n  ['ZZSPT','{#zzspt#}'],\n  ['ZZS-HZ','{#zzsH#}'],\n  ['ZZSPT-HZ','{#zzsptH#}']\n]","labelAlign":"right","itemId":"AR_DOC_CAT_CODE","fieldLabel":"{#AR_DOC_CAT_CODE#}"},"events":{"select":"app.no_searchButton.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.no_searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"combo"},{"configs":{"labelWidth":"80","displayField":"VAL_NAME","hidden":"true","valueField":"VAL_CODE","labelAlign":"right","itemId":"AR_DOC_CAT_CODE1","fieldLabel":"{#AR_DOC_CAT_CODE#}"},"events":{"select":"app.no_searchButton.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.no_searchButton.fireEvent('click');\n}"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xc/ar/inv/DB/XC_AR_XSFP_CLASS_SELECT"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".33","border":"false","itemId":"row1_3"},"children":[{"configs":{"labelWidth":"80","emptyText":"{#CONTRACT_CODE#}","labelAlign":"right","itemId":"AR_INV_H_CODE","fieldLabel":"{#AR_INV_H_CODE#}"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.no_searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","margin":"10 0 10 0","border":"false","itemId":"row3"},"children":[{"configs":{"layout":"form","columnWidth":".33","border":"false","itemId":"row3_2"},"children":[{"configs":{"layout":"column","border":"false","itemId":"row3_3_1"},"children":[{"configs":{"text":"{#BIZ_DATE_START#}：","width":"80","margin":"0 3 0 0","labelAlign":"right","itemId":"label"},"children":[],"expanded":false,"type":"label"},{"configs":{"tagConfigs":"columnWidth : 0.5","labelWidth":"80","labelAlign":"right","itemId":"BIZ_DATE_START"},"events":{"select":"app.no_searchButton.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.no_searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"date"},{"configs":{"text":"--","itemId":"label1"},"children":[],"expanded":false,"type":"label"},{"configs":{"tagConfigs":"columnWidth : 0.5","labelWidth":"20","itemId":"BIZ_DATE_END"},"events":{"select":"app.no_searchButton.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.no_searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"date"}],"expanded":false,"type":"panel"}],"expanded":false,"type":"panel"},{"configs":{"layout":"fit","columnWidth":".33","border":"false","itemId":"row3_3"},"children":[{"configs":{"layout":"column","margin":"5 0 0 0","border":"false","itemId":"row3_3_1"},"children":[{"configs":{"tagConfigs":"columnWidth : 1","labelWidth":"80","labelAlign":"right","itemId":"CREATED_NAME","fieldLabel":"{#CREATED_BY_NAME#}"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.no_searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","hidden":"true","value":"0","labelAlign":"right","itemId":"PRINT_STATUS","fieldLabel":"{#PRINT_STATUS#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","hidden":"true","value":"E","labelAlign":"right","itemId":"AUDIT_STATUS","fieldLabel":"{#AUDIT_STATUS#}"},"events":{"select":"app.searchButton.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":true,"type":"combo"},{"configs":{"text":"{#searchButton#}","itemId":"no_searchButton","iconCls":"seek_icon"},"events":{"click":"app.no_grid.store.load({params : Wb.getValue(app.no_search_form)});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#resetButton#}","itemId":"no_resetButton","iconCls":"refresh_icon"},"events":{"click":"app.no_search_form.getForm().reset();\napp.no_searchButton.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","columns":"app.columns","itemId":"no_grid"},"events":{"itemdblclick":"app.no_lookDtlBtn.fireEvent('click');"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#seekBtn#}","itemId":"no_lookDtlBtn","iconCls":"seek_icon"},"events":{"click":"var curGrid = app.no_grid;\nvar recs = curGrid.getSelection();\nif (recs.length > 1 || recs.length === 0) {//大于一条或没选择会警告\n    Wb.toast('{#seekRec#}');\n    return;\n}\nWb.run({\n    url : 'm?xwl=xc/ar/inv/XC_AR_INVOICE_H_NO_C', \n    success : function(apps) {\n        apps.initWin({\n            AR_INV_H_ID : recs[0].data.AR_INV_H_ID,\n            IS_INSERT : 'K',\n            AR_DOC_CAT_CODE : recs[0].data.AR_DOC_CAT_CODE,\n            hideFun : function(){\n                app.searchButton.fireEvent('click');\n                app.no_searchButton.fireEvent('click');\n            }\n        });\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#openBtn#}","itemId":"no_openBtn","iconCls":"open_icon"},"events":{"click":"var recs = app.no_grid.getSelection();\nif (!recs.length) {\n    Wb.toast('{#signRec#}');\n    return;\n}\nWb.confirm('{#confirm1#} ' + recs.length + ' {#confirm#}？', function() {\n    var invoiceArray = [] ;\n    for(var i = 0;i < recs.length;i++){\n        var deleteData =  {AR_INV_H_ID : recs[i].data.AR_INV_H_ID};\n        invoiceArray.push(deleteData);\n    }\n    //调用删除销售发票的后台程序\n    Wb.request({\n        url : '{#contextPath#}' + '/arInvoiceAction.do?method=printArInvoice',\n        params : Wb.apply({invoiceId: invoiceArray,opType : '0'}),\n        success : function(resp){\n            var record = Wb.decode(resp.responseText);\n            var msg = record.msg;\n            if(record.flag === '0'){\n                Wb.toast('{#signRec1#}');\n            }\n            else{\n                Wb.toast(msg);\n            }\n            app.no_searchButton.fireEvent('click');\n            app.searchButton.fireEvent('click');\n        }\n    });\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#exportBtn#}","itemId":"no_exportBtn","iconCls":"export_icon"},"events":{"click":"window.location.href = '{#contextPath#}/glDataTransgerManageAction.do?method=exportBaseDataByModel&templateCode=XC_AR_INVOICE';"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#enclosureBtn#}","itemId":"no_enclosureBtn","iconCls":"attach_icon"},"events":{"click":"var rows = app.no_grid.getSelection();\nif (rows.length > 1 || rows.length === 0) {\n    Wb.toast('{#enclosureRec#}');\n    return;\n}\nelse{\n    var temp_id = rows[0].data.AR_INV_H_ID;\n    var temp_code = rows[0].data.AR_INV_H_CODE;\n    Wb.request({\n        url : '{#contextPath#}' + '/arInvoiceAction.do?method=getArAttCatCode',\n        params : {LEDGER_ID : rows[0].data.LEDGER_ID,AR_DOC_CAT_CODE : rows[0].data.AR_DOC_CAT_CODE},\n        success : function(resp){\n            var temp = Wb.decode(resp.responseText);\n            if(temp.flag == '0'){\n                var attCatCode = temp.attCatCode;\n                Xip.showAttachmentManager('{#XIP.userId#}',temp_id,'',attCatCode,temp_code,'Y','Y','Y',function(){},10); \n            }\n            else{\n                Wb.toast(temp.msg);\n            }\n        }\n    });\n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"store","url":"m?xwl=xc/ar/inv/DB/XC_AR_INVOICE_H_SELECT"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#order#}","align":"center","xtype":"rownumberer","width":"50","titleAlign":"center","itemId":"ORDERBY"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#LEDGER_NAME#}","hidden":"true","width":"150","dataIndex":"LEDGER_NAME","titleAlign":"center","itemId":"LEDGER_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AR_CAT_NAME#}","width":"160","dataIndex":"AR_CAT_NAME","titleAlign":"center","itemId":"AR_CAT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AR_INV_H_CODE#}","width":"200","dataIndex":"AR_INV_H_CODE","titleAlign":"center","itemId":"AR_INV_H_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#BIZ_DATE#}","width":"100","xtype":"datecolumn","dataIndex":"BIZ_DATE","titleAlign":"center","itemId":"BIZ_DATE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#CUSTOMER_NAME#}","width":"200","dataIndex":"CUSTOMER_NAME","titleAlign":"center","itemId":"CUSTOMER_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AR_CONTRACT_NAME#}","width":"150","dataIndex":"AR_CONTRACT_NAME","titleAlign":"center","itemId":"AR_CONTRACT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#DEPT_NAME#}","width":"150","dataIndex":"DEPT_NAME","titleAlign":"center","itemId":"DEPT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#PROJECT_NAME#}","width":"150","dataIndex":"PROJECT_NAME","titleAlign":"center","itemId":"PROJECT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#INV_AMOUNT#}","width":"120","align":"right","dataIndex":"INV_AMOUNT","format":"0,000.00","titleAlign":"center","itemId":"INV_AMOUNT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#NO_PAY_AMT#}","width":"120","align":"right","dataIndex":"NO_PAY_AMT","format":"0,000.00","titleAlign":"center","itemId":"NO_PAY_AMT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#TAX_RATE#}","width":"100","align":"right","dataIndex":"TAX_RATE","titleAlign":"center","itemId":"TAX_RATE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#TAX_AMT#}","width":"120","align":"right","dataIndex":"TAX_AMT","format":"0,000.00","titleAlign":"center","itemId":"TAX_AMT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#DESCRIPTION#}","width":"150","dataIndex":"DESCRIPTION","titleAlign":"center","itemId":"DESCRIPTION_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#CREATED_BY_NAME#}","hidden":"true","width":"100","dataIndex":"CREATED_BY_NAME","titleAlign":"center","itemId":"CREATED_BY_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#FIN_USER_NAME#}","width":"100","dataIndex":"FIN_USER_NAME","titleAlign":"center","itemId":"FIN_USER_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#PRINT_USER_NAME#}","hidden":"true","width":"100","dataIndex":"PRINT_USER_NAME","titleAlign":"center","itemId":"PRINT_USER_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#INS_CODE#}","hidden":"true","dataIndex":"INS_CODE","titleAlign":"center","itemId":"INS_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AUDIT_STATUS#}","hidden":"true","dataIndex":"AUDIT_STATUS","titleAlign":"center","itemId":"AUDIT_STATUS_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#SYS_AUDIT_STATUS_DESC#}","dataIndex":"XC_AP_SYS_AUDIT_STATUS","titleAlign":"center","itemId":"SYS_AUDIT_STATUS_DESC_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ID","hidden":"true","dataIndex":"AR_INV_H_ID","titleAlign":"center","itemId":"AR_INV_H_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"应收单ID","hidden":"true","dataIndex":"AR_INV_GL_H_ID","titleAlign":"center","itemId":"AR_INV_GL_H_ID_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"},{"configs":{"title":"{#Processed#}","layout":"border","itemId":"yes_panel"},"children":[{"configs":{"region":"north","itemId":"search_form"},"children":[{"configs":{"layout":"column","margin":"10 0 0 0","border":"false","itemId":"row1"},"children":[{"configs":{"layout":"form","columnWidth":".33","border":"false","itemId":"row1_1"},"children":[{"configs":{"file":"m?xwl=xc/com-lov/LEDGER_ID_PICK/LEDGER_ID_PICK_SEC","itemId":"LEDGER_XWL"},"children":[],"expanded":false,"type":"xwl"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".33","border":"false","itemId":"row1_2"},"children":[{"configs":{"labelWidth":"80","value":"All","pickList":"[\n  ['All','{#all#}'],\n  ['ZZS','{#zzs#}'],\n  ['ZZSPT','{#zzspt#}'],\n  ['ZZS-HZ','{#zzsH#}'],\n  ['ZZSPT-HZ','{#zzsptH#}']\n]","labelAlign":"right","itemId":"AR_DOC_CAT_CODE","fieldLabel":"{#AR_DOC_CAT_CODE#}"},"events":{"select":"app.searchButton.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"combo"},{"configs":{"labelWidth":"80","displayField":"VAL_NAME","hidden":"true","valueField":"VAL_CODE","labelAlign":"right","itemId":"AR_DOC_CAT_CODE1","fieldLabel":"{#AR_DOC_CAT_CODE#}"},"events":{"select":"app.searchButton.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xc/ar/inv/DB/XC_AR_XSFP_CLASS_SELECT"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".33","border":"false","itemId":"row1_3"},"children":[{"configs":{"labelWidth":"80","emptyText":"{#CONTRACT_CODE#}","labelAlign":"right","itemId":"AR_INV_H_CODE","fieldLabel":"{#AR_INV_H_CODE#}"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","margin":"10 0 10 0","border":"false","itemId":"row3"},"children":[{"configs":{"layout":"form","columnWidth":".33","border":"false","itemId":"row3_1"},"children":[{"configs":{"layout":"column","border":"false","itemId":"row3_3_1"},"children":[{"configs":{"text":"{#BIZ_DATE_START#}：","width":"80","margin":"0 3 0 0","labelAlign":"right","itemId":"label"},"children":[],"expanded":false,"type":"label"},{"configs":{"tagConfigs":"columnWidth : 0.5","labelWidth":"80","labelAlign":"right","itemId":"BIZ_DATE_START"},"events":{"select":"app.searchButton.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"date"},{"configs":{"text":"--","itemId":"label1"},"children":[],"expanded":false,"type":"label"},{"configs":{"tagConfigs":"columnWidth : 0.5","labelWidth":"20","itemId":"BIZ_DATE_END"},"events":{"select":"app.searchButton.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"date"}],"expanded":false,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"layout":"form","columnWidth":".33","border":"false","itemId":"row3_2"},"children":[{"configs":{"labelWidth":"80","labelAlign":"right","itemId":"CREATED_NAME","fieldLabel":"{#CREATED_BY_NAME#}"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","hidden":"true","value":"1","labelAlign":"right","itemId":"PRINT_STATUS","fieldLabel":"{#PRINT_STATUS#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","hidden":"true","value":"E","labelAlign":"right","itemId":"AUDIT_STATUS","fieldLabel":"{#AUDIT_STATUS#}"},"events":{"select":"app.searchButton.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"layout":"column","columnWidth":".33","border":"false","itemId":"row3_3"},"children":[{"configs":{"layout":"column","border":"false","itemId":"row3_3_1"},"children":[{"configs":{"tagConfigs":"columnWidth : 1","labelWidth":"80","labelAlign":"right","itemId":"voidCheck","fieldLabel":"{#voidCheck#}"},"events":{"change":"app.searchButton.fireEvent('click');"},"children":[],"expanded":false,"type":"check"},{"configs":{"text":"{#searchButton#}","itemId":"searchButton","iconCls":"seek_icon"},"events":{"click":"app.grid.store.load({params : Wb.getValue(app.search_form)});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#resetButton#}","itemId":"resetButton","iconCls":"refresh_icon"},"events":{"click":"app.search_form.getForm().reset();\napp.searchButton.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","itemId":"grid"},"events":{"itemdblclick":"app.lookDtlBtn.fireEvent('click');"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#seekBtn#}","itemId":"lookDtlBtn","iconCls":"seek_icon"},"events":{"click":"var curGrid = app.grid;\nvar recs = curGrid.getSelection();\nif (recs.length > 1 || recs.length === 0) {//大于一条或没选择会警告\n    Wb.toast('{#seekRec#}');\n    return;\n}\nWb.run({\n    url : 'm?xwl=xc/ar/inv/XC_AR_INVOICE_H_NO_C', \n    success : function(apps) {\n        apps.initWin({\n            AR_INV_H_ID : recs[0].data.AR_INV_H_ID,\n            IS_INSERT : 'S',\n            flag : 'update',\n            AR_DOC_CAT_CODE : recs[0].data.AR_DOC_CAT_CODE,\n            hideFun : function(){\n                app.searchButton.fireEvent('click');\n            }\n        });\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#voidBtn#}","itemId":"cancelBtn","iconCls":"trash_icon"},"events":{"click":"var recs = app.grid.getSelection();\nif (!recs.length) {\n    Wb.toast('{#cancelSignRec#}');\n    return;\n}\nvar invoiceArray = [];\nvar j = 0;\nfor(var i = 0;i < recs.length;i++){\n    if(recs[i].data.PRINT_STATUS == '1'){\n        var deleteData =  {AR_INV_H_ID : recs[i].data.AR_INV_H_ID};\n        invoiceArray.push(deleteData);\n    }\n    if(recs[i].data.PRINT_STATUS == '2'){\n        j++;\n    }\n}\nif(j > 0){\n    Wb.toast('{#cancelSignRec3#}');\n    return;\n}\nif(invoiceArray.length === 0){\n    Wb.toast('{#cancelSignRec1#}');\n    return;\n}\nWb.confirm('{#confirm4#} ' + recs.length + ' {#confirm#}', function() {\n    //调用作废销售发票的后台程序\n    Wb.request({\n        url : '{#contextPath#}' + '/arInvoiceAction.do?method=printArInvoice',\n        params : Wb.apply({invoiceId: invoiceArray,opType : '2'}),\n        success : function(resp){\n            var record = Wb.decode(resp.responseText);\n            var msg = record.msg;\n            if(record.flag === '0'){\n                Wb.toast('{#cancelSignRec2#}');\n            }\n            else{\n                Wb.toast(msg);\n            }\n            app.searchButton.fireEvent('click');\n            app.no_searchButton.fireEvent('click');\n        }\n    });\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#enclosureBtn#}","itemId":"enclosureBtn","iconCls":"attach_icon"},"events":{"click":"var rows = app.grid.getSelection();\nif (rows.length > 1 || rows.length === 0) {\n    Wb.toast('{#enclosureRec#}');\n    return;\n}\nelse{\n    var temp_id = rows[0].data.AR_INV_H_ID;\n    var temp_code = rows[0].data.AR_INV_H_CODE;\n    Wb.request({\n        url : '{#contextPath#}' + '/arInvoiceAction.do?method=getArAttCatCode',\n        params : {LEDGER_ID : rows[0].data.LEDGER_ID,AR_DOC_CAT_CODE : rows[0].data.AR_DOC_CAT_CODE},\n        success : function(resp){\n            var temp = Wb.decode(resp.responseText);\n            if(temp.flag == '0'){\n                var attCatCode = temp.attCatCode;\n                Xip.showAttachmentManager('{#XIP.userId#}',temp_id,'',attCatCode,temp_code,'Y','Y','Y',function(){},10); \n            }\n            else{\n                Wb.toast(temp.msg);\n            }\n        }\n    });\n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"store","url":"m?xwl=xc/ar/inv/DB/XC_AR_INVOICE_H_SELECT"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#order#}","align":"center","xtype":"rownumberer","width":"50","titleAlign":"center","itemId":"ORDERBY"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#LEDGER_NAME#}","hidden":"true","width":"150","dataIndex":"LEDGER_NAME","titleAlign":"center","itemId":"LEDGER_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AR_CAT_NAME#}","width":"160","dataIndex":"AR_CAT_NAME","titleAlign":"center","itemId":"AR_CAT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AR_INV_H_CODE#}","width":"200","dataIndex":"AR_INV_H_CODE","titleAlign":"center","itemId":"AR_INV_H_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#BIZ_DATE#}","width":"100","xtype":"datecolumn","dataIndex":"BIZ_DATE","titleAlign":"center","itemId":"BIZ_DATE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#CUSTOMER_NAME#}","width":"200","dataIndex":"CUSTOMER_NAME","titleAlign":"center","itemId":"CUSTOMER_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AR_CONTRACT_NAME#}","width":"150","dataIndex":"AR_CONTRACT_NAME","titleAlign":"center","itemId":"AR_CONTRACT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#DEPT_NAME#}","width":"150","dataIndex":"DEPT_NAME","titleAlign":"center","itemId":"DEPT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#PROJECT_NAME#}","width":"150","dataIndex":"PROJECT_NAME","titleAlign":"center","itemId":"PROJECT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#INV_AMOUNT#}","width":"120","align":"right","dataIndex":"INV_AMOUNT","format":"0,000.00","titleAlign":"center","itemId":"INV_AMOUNT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#NO_PAY_AMT#}","width":"120","align":"right","dataIndex":"NO_PAY_AMT","format":"0,000.00","titleAlign":"center","itemId":"NO_PAY_AMT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#TAX_RATE#}","width":"100","align":"right","dataIndex":"TAX_RATE","titleAlign":"center","itemId":"TAX_RATE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#TAX_AMT#}","width":"120","align":"right","dataIndex":"TAX_AMT","format":"0,000.00","titleAlign":"center","itemId":"TAX_AMT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#DESCRIPTION#}","width":"150","dataIndex":"DESCRIPTION","titleAlign":"center","itemId":"DESCRIPTION_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#CREATED_BY_NAME#}","hidden":"true","width":"100","dataIndex":"CREATED_BY_NAME","titleAlign":"center","itemId":"CREATED_BY_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#FIN_USER_NAME#}","width":"100","dataIndex":"FIN_USER_NAME","titleAlign":"center","itemId":"FIN_USER_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#PRINT_USER_NAME#}","width":"100","dataIndex":"PRINT_USER_NAME","titleAlign":"center","itemId":"PRINT_USER_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#INS_CODE#}","hidden":"true","dataIndex":"INS_CODE","titleAlign":"center","itemId":"INS_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#AUDIT_STATUS#}","hidden":"true","dataIndex":"AUDIT_STATUS","titleAlign":"center","itemId":"AUDIT_STATUS_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#SYS_AUDIT_STATUS_DESC#}","dataIndex":"XC_AP_SYS_AUDIT_STATUS","titleAlign":"center","itemId":"SYS_AUDIT_STATUS_DESC_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ID","hidden":"true","dataIndex":"AR_INV_H_ID","titleAlign":"center","itemId":"AR_INV_H_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"应收单ID","hidden":"true","dataIndex":"AR_INV_GL_H_ID","titleAlign":"center","itemId":"AR_INV_GL_H_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#PRINT_STATUS_COL#}","width":"100","dataIndex":"PRINT_STATUS_NAME","titleAlign":"center","itemId":"PRINT_STATUS_COL","renderer":"if(value == '待开票')\n    return '{#0_PRINT_STATUS#}';\nif(value == '已开票')\n    return '{#1_PRINT_STATUS#}';\nif(value == '已作废')\n    return '{#2_PRINT_STATUS#}';"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"tab"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}