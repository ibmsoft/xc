{"inframe":false,"title":"收款单查询","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"var sql, data = app.get();\nsql = ' where 1=1 AND LEDGER_ID={?LEDGER_ID?} AND AR_DOC_CAT_CODE={?AR_DOC_CAT_CODE?} AND V_STATUS>=3';\nif (!Wb.isEmpty(data.AR_CONTRACT_NAME)) {\n    sql+=' and (AR_CONTRACT_NAME like \\'%'+data.AR_CONTRACT_NAME+'%\\' or AR_CONTRACT_CODE like \\'%'+data.AR_CONTRACT_NAME+'%\\')';\n}\nif (!Wb.isEmpty(data.CREATED_BY_NAME)) {\n    sql+=' and CREATED_BY_NAME like \\'%'+data.CREATED_BY_NAME+'%\\' ';\n}\nsql+=' and CUSTOMER_ID = {?CUSTOMER_ID?} ';\nsql+=' and AR_CONTRACT_ID = {?AR_CONTRACT_ID?} ';\nif (!Wb.isEmpty(data.AR_PAY_H_CODE)) {\n    sql+=' and (AR_PAY_H_CODE like \\'%'+data.AR_PAY_H_CODE+'%\\' ';\n    sql+=' or DESCRIPTION like \\'%'+data.AR_PAY_H_CODE+'%\\' )';\n}\nrequest.setAttribute('sql', sql);","itemId":"module"},"children":[{"configs":{"sql":"select * from (\nSELECT \n   a.*,\n   (SELECT AR_CAT_NAME FROM xc_ar_doc_cats b WHERE b.AR_CAT_CODE=a.AR_DOC_CAT_CODE) AR_DOC_CAT_NAME,\n   (SELECT AR_CONTRACT_CODE FROM xc_ar_contract b WHERE b.AR_CONTRACT_ID=a.AR_CONTRACT_ID) AR_CONTRACT_CODE,\n   (SELECT AR_CONTRACT_NAME FROM xc_ar_contract b WHERE b.AR_CONTRACT_ID=a.AR_CONTRACT_ID) AR_CONTRACT_NAME,\n   (SELECT DEPT_NAME FROM xip_pub_depts b WHERE b.DEPT_ID=a.DEPT_ID) DEPT_NAME,\n   (SELECT PROJECT_NAME FROM xc_pm_projects b WHERE b.PROJECT_ID=a.PROJECT_ID) PROJECT_NAME,\n   (SELECT IFNULL(SUM(TARGET_AMT),0) FROM xc_ar_cancel_l b WHERE b.TARGET_ID = a.AR_PAY_H_ID)+\n   (SELECT IFNULL(SUM(CANCEL_AMT),0) FROM xc_ar_inv_pre b WHERE b.AR_PAY_H_ID = a.AR_PAY_H_ID) TARGET_AMT,\n    (AMOUNT-(SELECT IFNULL(SUM(TARGET_AMT),0) FROM xc_ar_cancel_l b WHERE b.TARGET_ID = a.AR_PAY_H_ID)-\n   (SELECT IFNULL(SUM(CANCEL_AMT),0) FROM xc_ar_inv_pre b WHERE b.AR_PAY_H_ID = a.AR_PAY_H_ID))\n   NO_TARGET_AMT,\n    AMOUNT - (SELECT IFNULL(SUM(CANCEL_AMT),0) FROM xc_ar_inv_pre b WHERE b.AR_PAY_H_ID = a.AR_PAY_H_ID) AS CAN_TARGET_AMT,\n   (SELECT EMP_NAME FROM XIP_PUB_EMPS WHERE EMP_ID=(SELECT EMP_ID FROM XIP_PUB_USERS b WHERE b.USER_ID=a.CREATED_BY)) CREATED_BY_NAME\nFROM\n  xc_ar_pay_h  a \n) t {#sql#}\nORDER BY t.AR_PAY_H_CODE","itemId":"dataprovider1"},"children":[],"expanded":false,"type":"dataprovider"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}