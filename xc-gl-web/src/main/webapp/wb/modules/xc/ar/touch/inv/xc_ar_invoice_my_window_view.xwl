{"inframe":true,"title":"我的销售发票查看","hidden":false,"roles":{"default":1},"children":[{"configs":{"serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/ar/touch/inv/json/XC_AR_INVOICE_H_NO_C\");\nvar arInvHId = request.getParameter('businessId');\nrequest.setAttribute('arInvHId',arInvHId);","itemId":"module","head":"<style type=\"text/css\">    \n.x-hidebar .x-toolbar{display:none !important;}\n<\/style>"},"events":{"initialize":"Wb.apply(app,{\n\tmainNav : null,\n\tloadList : null,\n    flashStore:function(list){\n        loadList = list;\n    },\n\tinit : function(x){\n\t\t//接受导航栏\n\t\tmainNav = x;\n\t}\n});\n//创建一个采购发票明细对象\nfunction createInvoiceDtl(){\n    var toolBar = new Ext.Toolbar({\n\t\tstyle : {'background':'#F7F7F7','border-bottom':'1px solid #DDDDDD'},\n\t\titems : [{\n            xtype : \"label\",\n            html : \"\"\n\t\t},{\n            xtype : \"spacer\"\n\t\t}]\n\t});\n\tvar container = Ext.create('Ext.Container',{\n        xtype : 'container',\n        items :[{\n          name : \"fieldSet\",\n          xtype : \"fieldset\",\n          items:[\n            toolBar,\n            {\n              hidden : true,\n              name : \"invoiceDtl\",\n              xtype : \"textfield\"\n            },{\n              name : \"AR_SALE_TYPE_NAME\",\n              label : \"{#AR_SALE_TYPE_NAME#}\",\n              labelWidth : 100,\n              readOnly: true,\n              xtype : \"textfield\"\n            },{\n              name : \"PRODUCT_ID\",\n              label : \"产品ID\",\n              labelWidth : 100,\n              hidden : true,\n              readOnly : true,\n              xtype : \"textfield\"\n            },{\n              name : \"PRODUCT_NAME\",\n              label : \"{#PRODUCT_NAME#}\",\n              labelWidth : 100,\n              readOnly : true,\n              xtype : \"textfield\"\n            },{\n              name : \"QTY\",\n              label : \"{#QTY#}\",\n              labelWidth : 100,\n              readOnly: true,\n              xtype : \"numberfield\"\n            },{\n              name : \"DIM_NAME\",\n              label : \"{#DIM_NAME#}\",\n              labelWidth : 100,\n              readOnly: true,\n              xtype : \"textfield\"\n            },{\n              name : \"AMOUNT\",\n              label : \"{#AMOUNT#}\",\n              labelWidth : 100,\n              readOnly: true,\n              xtype : \"numberfield\"\n            },{\n              name : \"TAX\",\n              label : \"{#TAX_RATE#}\",\n              labelWidth : 100,\n              readOnly: true,\n              xtype : \"numberfield\"\n            },{\n              name : \"TAX_AMT\",\n              label : \"{#TAX_AMT#}\",\n              labelWidth : 100,\n              readOnly: true,\n              xtype : \"numberfield\"\n            },{\n              name : \"INV_AMOUNT\",\n              label : \"{#INV_AMOUNT#}\",\n              labelWidth : 100,\n              readOnly: true,\n              xtype : \"numberfield\"\n            }]\n        }]\n    });\n\treturn container;\n}\n//设置采购发票明细\nfunction setDtlsTitle(){\n\tvar count = app.rowContainer.items.length;\n\tfor(var i = 0;i < count;i++){\n        var dtlContainer = app.rowContainer.getAt(i);//明细容器\n        var fieldset = dtlContainer.getAt(0);\n        var toolbar = fieldset.getAt(0);\n        var label = toolbar.getAt(0);\n        label.setHtml('<span style=\"color:gray;font-size:14px\">{#saveDtlWarn1#}'+(i+1)+'<\/span>');\n\t}\n}\n//给采购明细赋值\nfunction setInvoiceDtlsDatas(dtlData){\n    var count = dtlData.length;\n    //获取明细数据\n    for(var i = 0;i < count;i++){\n        var container = createInvoiceDtl();\n        app.rowContainer.add(container);\n        setDtlsTitle();\n        var dtl = app.rowContainer.getAt(i);//获取明细容器\n        var fieldset = dtl.getAt(0);//获取fieldset\n        var dtlDatas = dtlData[i];//单条明细数据\n        fieldset.getAt(2).setValue(dtlDatas.AR_SALE_TYPE_NAME);//AR_SALE_TYPE_ID\n        fieldset.getAt(3).setValue(dtlDatas.PRODUCT_ID);//BG_ITEM_ID\n        fieldset.getAt(5).setValue(dtlDatas.QTY);//QTY\n        fieldset.getAt(6).setValue(dtlDatas.DIM_CODE);//DIM_CODE\n        fieldset.getAt(7).setValue(dtlDatas.AMOUNT);//AMOUNT\n        fieldset.getAt(8).setValue(dtlDatas.TAX);//TAX\n        fieldset.getAt(9).setValue(dtlDatas.TAX_AMT);//TAX_AMT\n        fieldset.getAt(10).setValue(dtlDatas.INV_AMOUNT);//INV_AMOUNT\n    }\n}"},"children":[{"configs":{"layout":"fit","itemId":"viewport"},"children":[{"configs":{"scrollable":"true","itemId":"container"},"events":{"initialize":"Wb.request({\n    url : 'm?xwl=xc/ar/touch/inv/xc_ar_invoice_myDB/ar_invoiceHSelectById',\n    params : {AR_INV_H_ID : '{#arInvHId#}'},\n    success : function(resp){\n        var data = Wb.decode(resp.responseText).rows[0];\n        Wb.setValue(app.mainFieldset,data);\n        Wb.request({\n            url : 'm?xwl=xc/ar/touch/inv/xc_ar_invoice_myDB/ar_invoiceLSelectById',\n            params : {AR_INV_H_ID : '{#arInvHId#}'},\n            success : function(resp){\n                var temp = Wb.decode(resp.responseText);\n                setInvoiceDtlsDatas(temp.rows);\n            }\n        });\n    }\n});"},"children":[{"configs":{"itemId":"mainContainer"},"children":[{"configs":{"itemId":"mainFieldset"},"children":[{"configs":{"labelWidth":"100","readOnly":"true","label":"{#LEDGER#}","labelAlign":"left","itemId":"LEDGER_NAME"},"children":[],"expanded":false,"type":"ttext"},{"configs":{"labelWidth":"100","readOnly":"true","label":"{#AR_DOC_CAT_CODE#}","labelAlign":"left","itemId":"AR_CAT_NAME"},"children":[],"expanded":false,"type":"ttext"},{"configs":{"labelWidth":"100","readOnly":"true","label":"{#CUSTOMER_NAME#}","labelAlign":"left","itemId":"CUSTOMER_NAME"},"children":[],"expanded":false,"type":"ttext"},{"configs":{"labelWidth":"100","readOnly":"true","label":"{#AR_CONTRACT_NAME#}","labelAlign":"left","itemId":"AR_CONTRACT_NAME"},"children":[],"expanded":false,"type":"ttext"},{"configs":{"labelWidth":"100","readOnly":"true","label":"{#DEPT_NAME#}","labelAlign":"left","itemId":"DEPT_NAME"},"children":[],"expanded":false,"type":"ttext"},{"configs":{"labelWidth":"100","readOnly":"true","label":"{#PROJECT_NAME#}","labelAlign":"left","itemId":"PROJECT_NAME"},"children":[],"expanded":false,"type":"ttext"},{"configs":{"labelWidth":"100","readOnly":"true","label":"{#INV_AMOUNT#}","labelAlign":"left","itemId":"INV_AMOUNT"},"children":[],"expanded":false,"type":"tnumber"},{"configs":{"labelWidth":"100","readOnly":"true","hidden":"true","label":"{#TAX_AMT#}","labelAlign":"left","itemId":"TAX_AMT"},"children":[],"expanded":false,"type":"tnumber"},{"configs":{"labelWidth":"100","readOnly":"true","hidden":"true","label":"{#TAX_RATE#}","labelAlign":"left","itemId":"TAX_RATE"},"children":[],"expanded":false,"type":"tnumber"},{"configs":{"labelWidth":"100","readOnly":"true","label":"{#CANCEL_AMT#}","labelAlign":"left","itemId":"CANCEL_AMT"},"children":[],"expanded":false,"type":"tnumber"},{"configs":{"labelWidth":"100","readOnly":"true","label":"{#DESCRIPTION#}","labelAlign":"left","itemId":"DESCRIPTION"},"children":[],"expanded":false,"type":"ttext"}],"expanded":true,"type":"tfieldset"}],"expanded":true,"type":"tcontainer"},{"configs":{"itemId":"rowContainer"},"children":[],"expanded":false,"type":"tcontainer"}],"expanded":true,"type":"tcontainer"}],"expanded":true,"type":"tviewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}