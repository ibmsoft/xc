{"inframe":false,"title":"","hidden":false,"roles":{"default":1},"children":[{"configs":{"title":"预算单类型设置","loginRequired":"false","serverScript":"//引入对应的json文件\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,'xc/bg/base/bg-ld-cat/json/bg-ld-cat');","itemId":"module"},"children":[{"configs":{"title":"{#addWindow#}","height":"300","layout":"border","width":"500","closeAction":"hide","border":"false","itemId":"addWin","dialog":"true","draggable":"false"},"events":{"ok":"// 所选数据\nvar lines = Wb.getData(app.grid2.getSelection()) ;\nif(lines.length === 0){\n  Wb.toast('{#qxzxytjdxmd#}') ;\n  return false ;\n  \n}else{\n  // 提交请求\n  Wb.request({\n    url: 'm?xwl=xc/bg/base/bg-ld-cat/bg-ld-catDB/save-ld-bg-cat',\n    timeout : 3600000,\n    params: {\n      'ledgerId'  : app.ledgerName.getValue() ,\n      'lineArray' : Wb.encode(lines) \n    },\n    success: function(resp) {\n      var response = Wb.decode(resp.responseText) ;\n      if(response.flag === \"0\"){\n        app.grid1.getStore().load();\n        app.addWin.hide() ;\n        Wb.toast('{#cgtj#}') ;\n      }else{\n        Wb.toast('{#tbsb#}') ;\n      }\n    }\n  });\n}\n"},"children":[{"configs":{"region":"center","multiSelect":"true","selType":"checkboxmodel","barPageButton":"false","barExportButtons":"false","barExportAllButtons":"false","forceFit":"true","itemId":"grid2","simpleSelect":"true"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/bg/base/bg-ld-cat/bg-ld-catDB/select-exclude-bg-cat"},"events":{"beforeload":"store.proxy.extraParams.LEDGER_ID = app.ledgerName.getValue() ;"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#number#}","align":"center","xtype":"rownumberer","width":"55","itemId":"rownum"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#BG_CAT_CODE_COL1#}","cls":"my_custom_grid","width":"150","dataIndex":"BG_CAT_CODE","titleAlign":"center","itemId":"BG_CAT_CODE_COL","renderer":"metaData.style = 'overflow:auto;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:20px;';   \nreturn value;"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#BG_CAT_NAME_COL1#}","width":"220","dataIndex":"BG_CAT_NAME","titleAlign":"center","itemId":"BG_CAT_NAME_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":false,"type":"grid"}],"expanded":true,"type":"window"},{"configs":{"title":"{#editWindow#}","height":"160","autoScroll":"false","layout":"fit","width":"600","closeAction":"hide","border":"false","itemId":"editWin","dialog":"true","modal":"true","draggable":"false"},"events":{"ok":"var _params = Wb.getValue(app.form2) ;\n\nWb.request({\n  url: 'm?xwl=xc/bg/base/bg-ld-cat/bg-ld-catDB/update-ld-bg-cat',\n  timeout : 3600000,\n  params: _params,\n  success: function(resp) {\n    var response = Wb.decode(resp.responseText) ;\n    if(response.flag === \"0\"){\n      app.grid1.getStore().load() ;\n      app.editWin.hide() ;\n      Wb.toast('{#bccg#}') ;\n    }else{\n      Wb.toast() ;\n    }\n  }\n});"},"children":[{"configs":{"style":"border-width:0px","layout":"form","border":"false","itemId":"form2"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 10 0","border":"false","itemId":"tr1"},"children":[{"configs":{"itemId":"BG_LD_CAT_ID"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"tagConfigs":"columnWidth:0.49","labelWidth":"80","readOnly":"true","labelAlign":"right","itemId":"BG_CAT_CODE","fieldLabel":"{#BG_CAT_CODE#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"columnWidth:0.49","labelWidth":"80","readOnly":"true","labelAlign":"right","itemId":"BG_CAT_NAME","fieldLabel":"{#BG_CAT_NAME#}"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","border":"false","itemId":"tr2"},"children":[{"configs":{"itemId":"PROCESS_ID"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"tagConfigs":"columnWidth:0.49\n","labelWidth":"80","triggerCls":"x-form-search-trigger","labelAlign":"right","itemId":"PROCESS_NAME","fieldLabel":"{#PROCESS_NAME#}"},"children":[{"configs":{"tagConfigs":"{\n  minWidth:500,\n  features: [{ftype:'grouping'}]\n}\n","pagingBar":"false","height":"350","forceFit":"true","normalName":"procPickComp","itemId":"pickComp"},"events":{"itemclick":"var procId = record.data.PROCESS_ID ;\nvar procName = record.data.PROCESS_NAME ;\n\napp.PROCESS_ID.setValue(procId) ;\napp.PROCESS_NAME.setValue(procName) ;\n\napp.procPickComp.hide() ;"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"emptyText":"{#win2_code_name#}","itemId":"win2_code_name"},"events":{"specialkey":"// 支持回车事件\nif(Ext.EventObject.getKey() == 13){\n  app.win2_query_btn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"itemId":"win2_query_btn","iconCls":"seek_icon","tooltip":"查询"},"events":{"click":"app.procPickComp.getStore().load() ;\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"itemId":"win2_reset_btn","iconCls":"cancel_icon","tooltip":"清空已选择的数据"},"events":{"click":"app.PROCESS_ID.setValue() ;\napp.PROCESS_NAME.setValue();\n"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"groupField":"CAT_NAME","autoLoad":"true","itemId":"store","url":"m?xwl=xc/com-qry/xip-wf/select-processes-by-entitycode"},"events":{"beforeload":"// 取得组织ID\nvar ldId = app.ledgerName.getValue() ;\nvar ldStore = app.ledgerName.getStore() ;\nvar idx = ldStore.find('LEDGER_ID',ldId) ;\nvar r = ldStore.getAt(idx) ;\nvar orgId = r.get('ORG_ID') ;\n\n// 参数\nstore.proxy.extraParams.ecode = 'XC_BG_DOCS' ;\nstore.proxy.extraParams.orgId = orgId ;\nstore.proxy.extraParams.textStr = app.win2_code_name.getValue() ;\n"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#rownum#}","align":"center","width":"50","xtype":"rownumberer","titleAlign":"center","itemId":"rownum"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#processId#}","hidden":"true","align":"center","dataIndex":"PROCESS_ID","titleAlign":"center","itemId":"processId"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#processCode#}","dataIndex":"PROCESS_CODE","titleAlign":"center","itemId":"processCode"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#processName#}","dataIndex":"PROCESS_NAME","titleAlign":"center","itemId":"processName"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#CAT_NAME#}","hidden":"true","dataIndex":"CAT_NAME","titleAlign":"center","itemId":"CAT_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":false,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"picker"},{"configs":{"itemId":"RULE_CODE"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"tagConfigs":"columnWidth:0.49","labelWidth":"80","readOnly":"true","labelAlign":"right","itemId":"RULE_DESC","fieldLabel":"{#RULE_CODE#}"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"}],"expanded":true,"type":"window"},{"configs":{"layout":"border","border":"false","itemId":"viewport1"},"children":[{"configs":{"region":"center","selType":"rowmodel","forceFit":"true","itemId":"grid1"},"events":{"itemdblclick":"app.setBtn.fireEvent('click');"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/bg/base/bg-ld-cat/bg-ld-catDB/select-bg-ld-cat"},"events":{"beforeload":"store.proxy.extraParams.LEDGER_ID = app.ledgerName.getValue() ;"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"labelWidth":"50","displayField":"LEDGER_NAME","width":"350","valueField":"LEDGER_ID","labelAlign":"right","itemId":"ledgerName","fieldLabel":"{#ledgerName#}","editable":"false"},"events":{"select":"app.queryBtn.fireEvent('click') ;"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/com-qry/gl-ledgers/select-sec-fd-ledgers"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"},{"configs":{"itemId":"queryBtn","iconCls":"seek_icon"},"events":{"click":"var ledgerId = app.ledgerName.getValue();\nif(!Wb.isEmpty(ledgerId)){\n  app.grid1.getStore().load();\n}\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"->","itemId":"sepItem"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#addBtn#}","itemId":"addBtn","iconCls":"file_add_icon"},"events":{"click":"var ledgerId = app.ledgerName.getValue() ;\nif(Wb.isEmpty(ledgerId)){\n  Wb.toast('{#qxzzb#}') ;\n  return false ;\n  \n}else{\n  app.grid2.getStore().load() ;\n  app.addWin.show() ;\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#setBtn#}","margin":"0 20 0 0","itemId":"setBtn","iconCls":"settings2_icon"},"events":{"click":"var records = app.grid1.getSelection();\nif (records.length === 0) {\n  Wb.toast('{#qxzytxyxgdjl#}');//请选择 1 条需要设置的记录！\n  return false ;\n}else{\n  Wb.setValue(app.form2,records[0].data) ;\n  app.editWin.show() ;\n}\n"},"children":[],"expanded":false,"type":"button"}],"expanded":false,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#number#}","xtype":"rownumberer","width":"55","align":"center","itemId":"rownum"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"预算单按设置ID","hidden":"true","dataIndex":"BG_LD_CAT_ID","itemId":"BG_LD_CAT_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#BG_CAT_CODE_COL#}","cls":"my_custom_grid","width":"120","dataIndex":"BG_CAT_CODE","titleAlign":"center","itemId":"BG_CAT_CODE_COL","renderer":"metaData.style = 'overflow:auto;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:20px;';   \nreturn value;"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#BG_CAT_NAME_COL#}","width":"180","dataIndex":"BG_CAT_NAME","titleAlign":"center","itemId":"BG_CAT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#PROCESS_NAME_COL#}","width":"180","dataIndex":"PROCESS_NAME","titleAlign":"center","itemId":"PROCESS_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#RULE_DESC_COL#}","dataIndex":"RULE_DESC","titleAlign":"center","itemId":"RULE_DESC_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#BG_CAT_DESC_COL#}","width":"260","dataIndex":"BG_CAT_DESC","titleAlign":"center","itemId":"BG_CAT_DESC_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#PROCESS_ID_COL#}","hidden":"true","dataIndex":"PROCESS_ID","titleAlign":"center","itemId":"PROCESS_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#RULE_CODE_COL#}","hidden":"true","width":"120","dataIndex":"RULE_CODE","titleAlign":"center","itemId":"RULE_CODE_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":false,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}