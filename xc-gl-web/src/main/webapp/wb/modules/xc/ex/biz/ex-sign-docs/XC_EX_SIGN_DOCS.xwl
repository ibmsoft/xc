{"inframe":false,"title":"出纳签字","hidden":false,"roles":{"default":1},"children":[{"configs":{"title":"出纳签字","loginRequired":"false","serverScript":"//---------------------获取当前模块语言对应的.json文件，放到request中----------------\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/ex/biz/ex-sign-docs/XC_EX_SIGN_DOCS\");\n// TODO: 模板类型: normal-金额式, amount-数量金额式, foreign-外币金额式\nrequest.setAttribute(\"vtype\",\"normal\") ;\n// 凭证模式：view-查看模式,其他-编辑模式\nrequest.setAttribute(\"opmode\",\"view\") ;\n// 系统根目录\nrequest.setAttribute(\"contextPath\", request.getContextPath()) ;\n","itemId":"module"},"children":[{"configs":{"itemId":"storeFile"},"children":[{"configs":{"pageSize":"-1","autoLoad":"false","itemId":"query_pay_sign_dtl_store","url":"m?xwl=xc/ex/biz/ex-sign-docs/ex_sign_docs_db/select_pay_sign_dtl"},"children":[],"expanded":false,"type":"store"},{"configs":{"pageSize":"-1","autoLoad":"false","itemId":"query_v_head_line_store","url":"m?xwl=xc/ex/biz/ex-sign-docs/ex_sign_docs_db/select_v_head_line"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"folder"},{"configs":{"layout":"fit","itemId":"viewport1"},"children":[{"configs":{"border":"false","itemId":"pay_panel"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","title":"未签字","layout":"border","border":"false","itemId":"no_pay_panel"},"children":[{"configs":{"region":"north","border":"false","itemId":"query_is_pay_form"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","frame":"true","layout":"column","padding":"10","border":"false","itemId":"tr1"},"children":[{"configs":{"tagConfigs":"columnWidth:0.25","labelWidth":"40","displayField":"LEDGER_NAME","valueField":"LEDGER_ID","emptyText":"{#ledger_empty_text#}","margin":"10 10 10 0","labelAlign":"right","itemId":"query_is_pay_ledger","fieldLabel":"{#query_is_pay_ledger#}","editable":"false"},"events":{"select":"app.query_is_pay_no.reset();\napp.query_is_pay_create_by.reset();\napp.queryIsPayBtn.fireEvent('click');\n\n//为已经签字的部分进行筛选\napp.query_no_pay_ledger.setValue(app.query_is_pay_ledger.getValue());\napp.query_no_pay_no.reset();\napp.query_no_pay_create_by.reset();\napp.queryNoPayBtn.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.queryIsPayBtn.fireEvent('click');\n  \n  //为已经签字的部分进行筛选\n  app.query_no_pay_ledger.setValue(app.query_is_pay_ledger.getValue());\n  app.query_no_pay_no.reset();\n  app.query_no_pay_create_by.reset();\n  app.queryNoPayBtn.fireEvent('click');\n}\n  "},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xc/com-qry/gl-ledgers/select-sec-fd-ledgers"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"},{"configs":{"tagConfigs":"columnWidth:0.25","labelWidth":"120","margin":"10 10 10 0","labelAlign":"right","itemId":"query_is_pay_no","fieldLabel":"{#query_is_pay_no#}"},"events":{"specialkey":"if(e.getKey()===13)\n  app.queryIsPayBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"columnWidth:0.2","labelWidth":"60","margin":"10 10 10 0","labelAlign":"right","itemId":"query_is_pay_create_by","fieldLabel":"{#query_is_pay_create_by#}"},"events":{"specialkey":"if(e.getKey()===13)\n  app.queryIsPayBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"columnWidth:0.08","text":"{#queryIsPayBtn#}","margin":"10 10 10 10","textAlign":"center","itemId":"queryIsPayBtn","iconCls":"seek_icon"},"events":{"click":"var temp_ledger_id = app.query_is_pay_ledger.getValue();\nvar temp_code = app.query_is_pay_no.getValue();\nvar temp_name = app.query_is_pay_create_by.getValue();\n\nif(temp_ledger_id===null || temp_ledger_id===''){\n   Wb.toast('请先选择账薄信息进行查询!');\n   return;\n}\nelse{\n   app.is_pay_grid.getStore().load({\n       params:{\n         ledger_id:temp_ledger_id,\n         pay_code:temp_code,\n         emp_name:temp_name\n       }\n   });\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"tagConfigs":"columnWidth:0.08","text":"{#resetIsPayBtn#}","margin":"10 10 10 10","textAlign":"center","itemId":"resetIsPayBtn","iconCls":"refresh_icon"},"events":{"click":"app.query_is_pay_ledger.reset();\napp.query_is_pay_no.reset();\napp.query_is_pay_create_by.reset();\n\n\napp.is_pay_grid.getStore().load();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","itemId":"is_pay_grid"},"events":{"itemdblclick":"app.seekBtn.fireEvent('click');"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#row_num_col#}","align":"center","width":"50","xtype":"rownumberer","titleAlign":"center","itemId":"row_num_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#ex_pay_code_col#}","width":"120","dataIndex":"EX_PAY_CODE","titleAlign":"center","itemId":"ex_pay_code_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#ex_pay_desc_col#}","width":"220","dataIndex":"EX_PAY_DESC","titleAlign":"center","itemId":"ex_pay_desc_col","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value;"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#created_by_col#}","width":"80","dataIndex":"CREATED_NAME","titleAlign":"center","itemId":"created_by_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#bank_account_col#}","width":"150","dataIndex":"BANK_ACCOUNT","titleAlign":"center","itemId":"bank_account_col","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value;"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#ex_pay_date_col#}","width":"100","dataIndex":"EX_PAY_DATE","titleAlign":"center","itemId":"ex_pay_date_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#ex_pay_t_mat_col#}","align":"right","width":"80","dataIndex":"EX_PAY_T_AMT","format":"0,000.00","titleAlign":"center","itemId":"ex_pay_t_mat_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#pay_status_col#}","hidden":"true","width":"80","dataIndex":"PAY_STATUS","titleAlign":"center","itemId":"pay_status_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#signatory_col#}","width":"80","dataIndex":"SIGNATORY","titleAlign":"center","itemId":"signatory_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#v_head_id#}","hidden":"true","dataIndex":"V_HEAD_ID","itemId":"v_head_id"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#seekBtn#}","itemId":"seekBtn","iconCls":"seek_icon"},"events":{"click":"var temp = app.is_pay_grid.getSelection();\nif(temp.length===0){\n   Wb.toast('请先选择单据查');\n   return;\n  \n}else{\n  //将参数修改为未签收状态\n  app.confim_btn.setText('确认签字');\n  app.confim_btn.setIconCls('check_icon');\n  // 凭证头ID\n  var headId = temp[0].data.V_HEAD_ID ;\n  app.view_v_xwl.v_head_id.setValue(headId) ;\n  \n  var temp_pay_id = temp[0].data.EX_PAY_ID;\n  app.query_pay_sign_dtl_store.load({\n       params:{EX_PAY_ID:temp_pay_id}\n  });\n  \n  app.query_v_head_line_store.load({\n       params:{EX_PAY_ID:temp_pay_id}\n  });\n  \n  app.see_details_win.show();\n  app.see_details_win.setTitle('出纳详情');\n  Wb.setValue(app.see_details_win,temp[0].data);  \n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#confimBtn#}","itemId":"confimBtn","iconCls":"check_icon"},"events":{"click":"var temp = app.is_pay_grid.getSelection();\nif(temp.length<1){\n   Wb.toast('请先选择一条需要确认签字的单据!');\n   return;\n}\n\n//已签字\nif(temp[0].data.SIGNATORY!==null && temp[0].data.SIGNATORY!==''){\n   Wb.toast('此单据已签字，请不要重复签字!');\n   return;\n}\n\nelse{\n   Ext.MessageBox.confirm('提示','是否确认签单据：'+temp[0].data.EX_PAY_CODE+'?',function(btn){\n       if(btn == 'yes') {\n         Wb.request({\n           url:'m?xwl=xc/ex/biz/ex-sign-docs/ex_sign_docs_db/confim_sign',\n           params:{\n             EX_PAY_ID:temp[0].data.EX_PAY_ID,\n             V_HEAD_ID:temp[0].data.V_HEAD_ID\n           },\n           success:function(){\n             Wb.toast('单据确认签字成功!');\n             app.queryIsPayBtn.fireEvent('click');\n             app.queryNoPayBtn.fireEvent('click');\n           },\n           failure:function(){\n             Wb.toast('单据签字失败!');\n           }\n         });\n       }\n   });\n   \n   \n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"pageSize":"-1","autoLoad":"false","itemId":"store","url":"m?xwl=xc/ex/biz/ex-sign-docs/ex_sign_docs_db/select_no_pay"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","title":"已签字","layout":"border","border":"false","itemId":"is_pay_panel"},"children":[{"configs":{"region":"north","border":"false","itemId":"query_no_pay_form"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","frame":"true","layout":"column","padding":"10","border":"false","itemId":"tr1"},"children":[{"configs":{"tagConfigs":"columnWidth:0.25","labelWidth":"40","displayField":"LEDGER_NAME","valueField":"LEDGER_ID","emptyText":"{#ledger_empty_text#}","margin":"10 10 10 0","labelAlign":"right","itemId":"query_no_pay_ledger","fieldLabel":"{#query_no_pay_ledger#}","editable":"false"},"events":{"select":"app.query_no_pay_no.reset();\napp.query_no_pay_create_by.reset();\napp.queryNoPayBtn.fireEvent('click');\n\n//为未签字的部分进行筛选\napp.query_is_pay_ledger.setValue(app.query_no_pay_ledger.getValue());\napp.query_is_pay_no.reset();\napp.query_is_pay_create_by.reset();\napp.queryIsPayBtn.fireEvent('click');","specialkey":"if(e.getKey()===13) {\n  app.queryNoPayBtn.fireEvent('click');\n  \n  //为未签字的部分进行筛选\n  app.query_is_pay_ledger.setValue(app.query_no_pay_ledger.getValue());\n  app.query_is_pay_no.reset();\n  app.query_is_pay_create_by.reset();\n  app.queryIsPayBtn.fireEvent('click');\n}"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xc/com-qry/gl-ledgers/select-sec-fd-ledgers"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"},{"configs":{"tagConfigs":"columnWidth:0.25","labelWidth":"120","margin":"10 10 10 0","labelAlign":"right","itemId":"query_no_pay_no","fieldLabel":"{#query_no_pay_no#}"},"events":{"specialkey":"if(e.getKey()===13)\n  app.queryNoPayBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"columnWidth:0.2","labelWidth":"60","margin":"10 10 10 0","labelAlign":"right","itemId":"query_no_pay_create_by","fieldLabel":"{#query_no_pay_create_by#}"},"events":{"specialkey":"if(e.getKey()===13)\n  app.queryNoPayBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"columnWidth:0.08","text":"{#queryNoPayBtn#}","margin":"10 10 10 10","textAlign":"center","itemId":"queryNoPayBtn","iconCls":"seek_icon"},"events":{"click":"var temp_ledger_id = app.query_no_pay_ledger.getValue();\nvar temp_code = app.query_no_pay_no.getValue();\nvar temp_name = app.query_no_pay_create_by.getValue();\n\nif(temp_ledger_id===null || temp_ledger_id===''){\n   Wb.toast('请先选择账薄信息进行查询!');\n   return;\n}\nelse{\n   app.no_pay_grid.getStore().load({\n       params:{\n         ledger_id:temp_ledger_id,\n         pay_code:temp_code,\n         emp_name:temp_name\n       }\n   });\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"tagConfigs":"columnWidth:0.08","text":"{#resetNoPayBtn#}","margin":"10 10 10 10","textAlign":"center","itemId":"resetNoPayBtn","iconCls":"refresh_icon"},"events":{"click":"app.query_no_pay_ledger.reset();\napp.query_no_pay_no.reset();\napp.query_no_pay_create_by.reset();\n\n\napp.no_pay_grid.getStore().load();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","itemId":"no_pay_grid"},"events":{"itemdblclick":"app.seekNoPayBtn.fireEvent('click');"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#row_num_col#}","align":"center","width":"50","xtype":"rownumberer","titleAlign":"center","itemId":"row_num_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#ex_pay_code_col#}","width":"120","dataIndex":"EX_PAY_CODE","titleAlign":"center","itemId":"ex_pay_code_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#ex_pay_desc_col#}","width":"220","dataIndex":"EX_PAY_DESC","titleAlign":"center","itemId":"ex_pay_desc_col","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value;"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#created_by_col#}","width":"80","dataIndex":"CREATED_NAME","titleAlign":"center","itemId":"created_by_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#bank_account_col#}","width":"150","dataIndex":"BANK_ACCOUNT","titleAlign":"center","itemId":"bank_account_col","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value;"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#ex_pay_date_col#}","width":"100","dataIndex":"EX_PAY_DATE","titleAlign":"center","itemId":"ex_pay_date_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#ex_pay_t_mat_col#}","align":"right","width":"80","dataIndex":"EX_PAY_T_AMT","format":"0,000.00","titleAlign":"center","itemId":"ex_pay_t_mat_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#pay_status_col#}","hidden":"true","width":"80","dataIndex":"PAY_STATUS","titleAlign":"center","itemId":"pay_status_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#signatory_col#}","width":"80","dataIndex":"SIGNATORY","titleAlign":"center","itemId":"signatory_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#v_head_id#}","hidden":"true","dataIndex":"V_HEAD_ID","itemId":"v_head_id"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#seekNoPayBtn#}","itemId":"seekNoPayBtn","iconCls":"seek_icon"},"events":{"click":"var temp = app.no_pay_grid.getSelection();\nif(temp.length===0){\n   Wb.toast('请先选择单据!');\n   return;\n  \n}else{\n  //将参数修改为已签收状态\n  app.confim_btn.setText('取消签字');\n  app.confim_btn.setIconCls('write_icon');\n  \n  // 凭证头ID\n  var headId = temp[0].data.V_HEAD_ID ;\n  app.view_v_xwl.v_head_id.setValue(headId) ;\n  \n  var temp_pay_id = temp[0].data.EX_PAY_ID;\n  app.query_pay_sign_dtl_store.load({\n       params:{EX_PAY_ID:temp_pay_id}\n  });\n  \n  app.query_v_head_line_store.load({\n       params:{EX_PAY_ID:temp_pay_id}\n  });\n  \n  app.see_details_win.show();\n  app.see_details_win.setTitle('出纳详情');\n  Wb.setValue(app.see_details_win,temp[0].data);\n  \n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#noPayBtn#}","itemId":"noPayBtn","iconCls":"write_icon"},"events":{"click":"var temp = app.no_pay_grid.getSelection();\nif(temp.length<1){\n   Wb.toast('请先选择一条需要取消签字的单据!');\n   return;\n}\n\n//已取消签字\nif(temp[0].data.SIGNATORY===null && temp[0].data.SIGNATORY===''){\n   Wb.toast('此单据未签字，无法取消签字!');\n   return;\n}\n\nelse{\n   Ext.MessageBox.confirm('提示','是否取消签字单据：'+temp[0].data.EX_PAY_CODE+'?',function(btn){\n       if(btn == 'yes') {\n         Wb.request({\n           url:'m?xwl=xc/ex/biz/ex-sign-docs/ex_sign_docs_db/no_pay_sign',\n           params:{\n             EX_PAY_ID:temp[0].data.EX_PAY_ID,\n             V_HEAD_ID:temp[0].data.V_HEAD_ID\n           },\n           success:function(){\n             Wb.toast('单据取消签字成功!');\n             app.queryNoPayBtn.fireEvent('click');\n             app.queryIsPayBtn.fireEvent('click');\n           },\n           failure:function(){\n             Wb.toast('单据取消签字失败!');\n           }\n         });\n       }\n   });\n   \n   \n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"pageSize":"-1","autoLoad":"false","itemId":"store","url":"m?xwl=xc/ex/biz/ex-sign-docs/ex_sign_docs_db/select_is_pay"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"tab"}],"expanded":true,"type":"viewport"},{"configs":{"maximized":"true","title":"出纳详情","autoShow":"false","frame":"true","height":"450","layout":"fit","width":"700","closeAction":"hide","itemId":"see_details_win","modal":"true","draggable":"false"},"events":{"show":"app.details_panel.setActiveTab(0);//默认显示的就是第一个面板"},"children":[{"configs":{"border":"false","itemId":"details_panel"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","title":"付款单","layout":"border","border":"false","itemId":"pay_panel"},"children":[{"configs":{"region":"north","border":"false","itemId":"query_pay_panel"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","frame":"true","layout":"column","margin":"10 0 10 0","border":"false","itemId":"tr1"},"children":[{"configs":{"tagConfigs":"columnWidth:0.38","labelWidth":"80","readOnly":"true","displayField":"LEDGER_NAME","valueField":"LEDGER_ID","labelAlign":"right","itemId":"LEDGER_NAME","fieldLabel":"账薄"},"children":[],"expanded":false,"type":"combo"},{"configs":{"tagConfigs":"columnWidth:0.32","labelWidth":"80","readOnly":"true","labelAlign":"right","itemId":"EX_PAY_CODE","fieldLabel":"支付单号"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"columnWidth:0.28","labelWidth":"80","readOnly":"true","labelAlign":"right","itemId":"CREATED_NAME","fieldLabel":"制单人"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","frame":"true","layout":"column","margin":"0 0 10 0","border":"false","itemId":"tr2"},"children":[{"configs":{"tagConfigs":"columnWidth:0.38","labelWidth":"80","readOnly":"true","displayField":"MODE_NAME","labelAlign":"right","itemId":"MODE_NAME","fieldLabel":"付款方式"},"children":[],"expanded":false,"type":"combo"},{"configs":{"tagConfigs":"columnWidth:0.32","labelWidth":"80","readOnly":"true","labelAlign":"right","itemId":"DEPOSIT_BANK_NAME","fieldLabel":"付款账号"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"columnWidth:0.28","labelWidth":"80","readOnly":"true","labelAlign":"right","itemId":"EX_PAY_T_AMT","fieldLabel":"付款金额"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","frame":"true","layout":"column","margin":"0 0 10 0","border":"false","itemId":"tr3"},"children":[{"configs":{"tagConfigs":"columnWidth:0.70","labelWidth":"80","readOnly":"true","labelAlign":"right","itemId":"EX_PAY_DESC","fieldLabel":"付款说明"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"columnWidth:0.28","labelWidth":"80","readOnly":"true","labelAlign":"right","itemId":"EX_PAY_DATE","fieldLabel":"支付日期"},"children":[],"expanded":false,"type":"date"}],"expanded":false,"type":"panel"}],"expanded":false,"type":"form"},{"configs":{"region":"center","store":"app.query_pay_sign_dtl_store","barExportButtons":"false","barRefreshButton":"false","buttonAlign":"center","itemId":"query_pay_grid"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"序号","align":"center","width":"50","xtype":"rownumberer","titleAlign":"center","itemId":"pay_row_num"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"单据号","width":"120","dataIndex":"EX_DOC_CODE","titleAlign":"center","itemId":"dtl_ex_doc_code_col","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value;"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"员工姓名","width":"70","dataIndex":"ACCOUNT_NAME","titleAlign":"center","itemId":"account_name_col","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value;"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"开户行","width":"100","dataIndex":"DEPOSIT_BANK_NAME","titleAlign":"center","itemId":"deposit_bank_name_col","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value;"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"银行账号","width":"120","dataIndex":"BANK_ACCOUNT","titleAlign":"center","itemId":"bank_account_col","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value;"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"单据金额","align":"right","width":"70","dataIndex":"AMOUNT","titleAlign":"center","itemId":"amount_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"核销金额","align":"right","width":"70","dataIndex":"CANCEL_AMT","titleAlign":"center","itemId":"cancel_amt_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"本次付款金额","align":"right","width":"100","dataIndex":"PAY_AMT","titleAlign":"center","itemId":"pay_amt_col"},"children":[],"expanded":false,"type":"column"}],"expanded":false,"type":"array"},{"configs":{"itemId":"buttons"},"children":[{"configs":{"itemId":"confim_btn"},"events":{"click":"\n  \n  //判断是需要确认签字还是取消签字:未签字状态\n  if(app.confim_btn.getText()=='确认签字') {\n    \n      var temp = app.is_pay_grid.getSelection();\n    \n      //已签字\n      if(temp[0].data.SIGNATORY!==null && temp[0].data.SIGNATORY!==''){\n        Wb.toast('此单据已签字，请不要重复签字!');\n        return;\n      }\n    \n      Ext.MessageBox.confirm('提示','是否确认签单据：'+temp[0].data.EX_PAY_CODE+'?',function(btn){\n      if(btn == 'yes') {\n         Wb.request({\n             url:'m?xwl=xc/ex/biz/ex-sign-docs/ex_sign_docs_db/confim_sign',\n             params:{\n               EX_PAY_ID:temp[0].data.EX_PAY_ID,\n               V_HEAD_ID:temp[0].data.V_HEAD_ID\n             },\n             success:function(){\n                Wb.toast('单据确认签字成功!');\n                app.is_pay_grid.getStore().reload();\n                app.no_pay_grid.getStore().reload();\n                app.see_details_win.close();\n             },\n             failure:function(){\n                Wb.toast('单据签字失败!');\n             }\n         });\n      }\n    });\n  }\n //已签字状态，取消签字\n  else{\n    \n      var temp = app.no_pay_grid.getSelection();\n      if(temp[0].data.SIGNATORY===null && temp[0].data.SIGNATORY===''){\n        Wb.toast('此单据未签字，无法取消签字!');\n        return;\n      }\n    \n      Ext.MessageBox.confirm('提示','是否取消单据：'+temp[0].data.EX_PAY_CODE+'的签字?',function(btn){\n      if(btn == 'yes') {\n         Wb.request({\n             url:'m?xwl=xc/ex/biz/ex-sign-docs/ex_sign_docs_db/no_pay_sign',\n             params:{\n               EX_PAY_ID:temp[0].data.EX_PAY_ID,\n               V_HEAD_ID:temp[0].data.V_HEAD_ID\n             },\n             success:function(){\n                Wb.toast('单据取消签字成功!');\n                app.is_pay_grid.getStore().reload();\n                app.no_pay_grid.getStore().reload();\n                app.see_details_win.close();\n             },\n             failure:function(){\n                Wb.toast('单据取消签字失败!');\n             }\n         });\n      }\n    });\n  } \n  \n  \n  \n//   Ext.MessageBox.confirm('提示','是否确认签单据：'+temp[0].data.EX_PAY_CODE+'?',function(btn){\n//     if(btn == 'yes') {\n//        Wb.request({\n//            url:'m?xwl=xc/ex/biz/ex-sign-docs/ex_sign_docs_db/confim_sign',\n//            params:{\n//              EX_PAY_ID:temp[0].data.EX_PAY_ID,\n//              V_HEAD_ID:temp[0].data.V_HEAD_ID\n//            },\n//            success:function(){\n//               Wb.toast('单据确认签字成功!');\n//               app.is_pay_grid.getStore().reload();\n// //               var temp_ledger_id = app.query_is_pay_ledger.getValue();\n// //               var temp_code = app.query_is_pay_no.getValue();\n// //               var temp_name = app.query_is_pay_create_by.getValue();\n// //               var temp_desc = app.query_is_pay_desc.getValue();\n\n// //               app.is_pay_grid.getStore().load({\n// //                 params:{\n// //                   ledger_id:temp_ledger_id,\n// //                   pay_code:temp_code,\n// //                   emp_name:temp_name,\n// //                   desc:temp_desc\n// //                 }\n// //               });\n//               app.see_details_win.close();\n//            },\n//            failure:function(){\n//               Wb.toast('单据签字失败!');\n//            }\n//        });\n//     }\n//   });"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"取消","itemId":"cancel_btn","iconCls":"cancel_icon"},"events":{"click":"app.see_details_win.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"},{"configs":{"file":"m?xwl=xc/gl/journal/v-windows/new-xwl-voucher","itemId":"view_v_xwl"},"children":[],"expanded":false,"type":"xwl"}],"expanded":true,"type":"tab"}],"expanded":false,"type":"window"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}