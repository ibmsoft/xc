{"inframe":false,"title":"查询所有单据信息","hidden":false,"roles":{"default":1},"children":[{"configs":{"itemId":"module"},"children":[{"configs":{"itemId":"sqlswitcher1","oracle":"SELECT \n  doc.INS_CODE,\n  doc.AUDIT_STATUS,\n  doc.AUDIT_STATUS_DESC, \n  doc.LEDGER_ID,\n  doc.EX_DOC_ID,\n  doc.EX_DOC_CODE,\n  doc.EX_REASON,\n  doc.AMOUNT,\n  doc.V_HEAD_ID,\n  pay.PAY_STATUS,\n  doc.CREATED_BY,\n  doc.EX_CAT_CODE,\n  pay.PAY_TYPE,\n  doc.LEDGER_ID,\n  doc.CANCEL_AMT, \n  doc.PAY_METHOD,\n  decode(pay.PAY_STATUS,'Y',0,doc.AMOUNT) AS NO_AMOUNT,\n  cat.EX_CAT_NAME,\n  createEmp.EMP_NAME AS CREATED_NAME,\n  doc.V_STATUS,\n  dtl.VAL_NAME AS V_STATUS_NAME,\n  dept.DEPT_NAME,\n  to_char(doc.CREATION_DATE,'yyyy-mm-dd') AS CREATION_DATE,\n  project.PROJECT_NAME,\n  finEmp.EMP_NAME AS FIN_USER_NAME,\n  to_char(doc.AUDIT_DATE,'yyyy-mm-dd') AS AUDIT_DATE,\n  doc.ADUIT_USERS VERIFIER_NAME,\n  xpf.FORM_URL PC_A_FORM_URL,\n  wpf.FORM_URL PC_W_FORM_URL,\n  ppf.FORM_URL PC_P_FORM_URL,\n  (case doc.AUDIT_STATUS when 'E' then 'xip_wf_arch_task' else 'xip_wf_ins_task' end) TASK_TAB\n  \nFROM  xip_pub_users createUser,\n      xip_pub_emps createEmp ,\n      xc_ex_cat cat \n      left join xip_wf_process_forms xpf on xpf.FORM_ID = cat.PC_A_FORM_ID\n      left join xip_wf_process_forms wpf on wpf.form_id = cat.pc_w_form_id\n      left join xip_wf_process_forms ppf on ppf.form_id = cat.pc_p_form_id,\n      \n      xc_ex_docs doc \n      LEFT JOIN xc_ex_pay pay ON doc.EX_PAY_ID = pay.EX_PAY_ID\n      LEFT JOIN xip_pub_depts dept ON doc.DEPT_ID = dept.DEPT_ID\n      LEFT JOIN xc_pm_projects project ON doc.PROJECT_ID = project.PROJECT_ID\n      left join (select xu.USER_ID,xe.EMP_ID,xe.EMP_NAME from xip_pub_users xu,xip_pub_emps xe \n       \t\twhere xu.EMP_ID = xe.EMP_ID ) finEmp on finEmp.USER_ID = doc.FIN_USER_ID\n      LEFT JOIN xip_pub_val_set_dtl dtl ON doc.V_STATUS = dtl.VAL_CODE AND dtl.VAL_SET_CODE='XC_EX_V_STATUS' AND dtl.ENABLE_FLAG = 'Y'\n\n WHERE doc.EX_CAT_CODE = cat.EX_CAT_CODE\n   AND doc.CREATED_BY = createUser.USER_ID\n   AND createUser.EMP_ID = createEmp.EMP_ID\n   AND doc.LEDGER_ID = {?ledger_id?}\n   AND (nvl(doc.EX_DOC_CODE,'%') like '%{#doc_code#}%'  OR nvl(doc.EX_REASON,'%') like '%{#doc_code#}%')\n   AND nvl(createEmp.EMP_NAME,'%') like '%{#create_name#}%'\n   AND nvl(dept.DEPT_NAME,'%') like '%{#dept_id#}%'\n   AND nvl(project.PROJECT_NAME,'%') like '%{#project_id#}%' \nORDER BY doc.CREATION_DATE DESC","mysql":"SELECT \n  doc.INS_CODE,\n  doc.AUDIT_STATUS,\n  doc.AUDIT_STATUS_DESC, \n  doc.LEDGER_ID,\n  doc.EX_DOC_ID,\n  doc.EX_DOC_CODE,\n  doc.EX_REASON,\n  doc.AMOUNT,\n  doc.V_HEAD_ID,\n  pay.PAY_STATUS,\n  doc.CREATED_BY,\n  doc.EX_CAT_CODE,\n  pay.PAY_TYPE,\n  doc.LEDGER_ID,\n  doc.CANCEL_AMT, \n  doc.PAY_METHOD,\n  IF(pay.PAY_STATUS='Y',0,doc.AMOUNT) AS NO_AMOUNT,\n  cat.EX_CAT_NAME,\n  createEmp.EMP_NAME AS CREATED_NAME,\n  doc.V_STATUS,\n  dtl.VAL_NAME AS V_STATUS_NAME,\n  dept.DEPT_NAME,\n  DATE_FORMAT(doc.CREATION_DATE,'%Y-%m-%d') AS CREATION_DATE,\n  project.PROJECT_NAME,\n  finEmp.EMP_NAME AS FIN_USER_NAME,\n  DATE_FORMAT(doc.AUDIT_DATE,'%Y-%m-%d') AS AUDIT_DATE,\n  doc.ADUIT_USERS VERIFIER_NAME,\n  xpf.FORM_URL PC_A_FORM_URL,\n  wpf.FORM_URL PC_W_FORM_URL,\n  ppf.FORM_URL PC_P_FORM_URL,\n  (case doc.AUDIT_STATUS when 'E' then 'xip_wf_arch_task' else 'xip_wf_ins_task' end) TASK_TAB\n  \nFROM  xip_pub_users createUser,\n\t  xip_pub_emps createEmp ,\n\t  xc_ex_cat cat \n      left join xip_wf_process_forms xpf on xpf.FORM_ID = cat.PC_A_FORM_ID\n      left join xip_wf_process_forms wpf on wpf.form_id = cat.pc_w_form_id\n      left join xip_wf_process_forms ppf on ppf.form_id = cat.pc_p_form_id,\n\t\t\t\n      xc_ex_docs doc \n      LEFT JOIN xc_ex_pay pay ON doc.EX_PAY_ID = pay.EX_PAY_ID\n      LEFT JOIN xip_pub_depts dept ON doc.DEPT_ID = dept.DEPT_ID\n      LEFT JOIN xc_pm_projects project ON doc.PROJECT_ID = project.PROJECT_ID\n      left join (select xu.USER_ID,xe.EMP_ID,xe.EMP_NAME\n                 from xip_pub_users xu,xip_pub_emps xe \n                 where xu.EMP_ID = xe.EMP_ID ) finEmp on finEmp.USER_ID = doc.FIN_USER_ID\n      LEFT JOIN xip_pub_val_set_dtl dtl ON doc.V_STATUS = dtl.VAL_CODE AND dtl.VAL_SET_CODE='XC_EX_V_STATUS' AND dtl.ENABLE_FLAG = 'Y'\n\n WHERE doc.EX_CAT_CODE = cat.EX_CAT_CODE\n   AND doc.CREATED_BY = createUser.USER_ID\n   AND createUser.EMP_ID = createEmp.EMP_ID\n   AND doc.LEDGER_ID = {?ledger_id?}\n   AND (IFNULL(doc.EX_DOC_CODE,'%') like '%{#doc_code#}%' OR IFNULL(doc.EX_REASON,'%') like '%{#doc_code#}%')\n   AND IFNULL(createEmp.EMP_NAME,'%') like '%{#create_name#}%'\n   AND IFNULL(dept.DEPT_NAME,'%') like '%{#dept_id#}%'\n   AND IFNULL(project.PROJECT_NAME,'%') like '%{#project_id#}%' \nORDER BY doc.CREATION_DATE DESC"},"children":[],"expanded":false,"type":"sqlswitcher"},{"configs":{"sql":"{#sqlswitcher1#}","itemId":"dataprovider1"},"children":[],"expanded":false,"type":"dataprovider"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":"seek_icon"}