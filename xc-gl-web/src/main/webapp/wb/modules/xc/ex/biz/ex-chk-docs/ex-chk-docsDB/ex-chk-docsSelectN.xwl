{"inframe":false,"title":"单据信息查询未处理","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","itemId":"module"},"children":[{"configs":{"oracle":"SELECT\n\ted.LEDGER_ID,\t\t\t\t-- 账簿ID\n\ted.EX_DOC_ID,\t\t\t\t-- 费用单据ID\n\ted.EX_DOC_CODE,\t\t\t\t-- 单据编号\n\ted.EX_CAT_CODE,\t\t\t\t-- 单据分类 \n\ted.BIZ_DATE,\t\t\t\t-- 业务日期\n\ted.EX_REASON,\t\t\t\t-- 申请事由（摘要）\n\ted.EX_ITEM_ID,\t\t\t\t-- 预算项\n\ted.AMOUNT,\t\t\t\t\t-- 单据金额\n\ted.APPLY_EX_DOC_ID,\t\t\t-- 费用申请单号\n\ted.CANCEL_AMT,\t\t\t\t-- 核销金额\n\ted.V_HEAD_ID,\t\t\t\t-- 凭证头ID\n\ted.INS_CODE,\t\t\t\t-- 流程实例编码\n\ted.AUDIT_STATUS,\t\t\t-- 审批状态\n\ted.AUDIT_STATUS_DESC, \t\t-- 审批状态描述\n\ted.AUDIT_DATE,\t\t\t\t-- 审批通过日期\n\ted.ADUIT_USERS,\t\t\t\t-- 当前审批人（当前节点的所有待办所有者）\n\tNVL(ed.V_STATUS,'1') V_STATUS,\t\t\t\t-- 凭证状态\n\ted.FIN_DATE,\t\t\t\t-- 复核日期\n\ted.FIN_USER_ID,\t\t\t\t-- 复核人（凭证制单人）\n\t(SELECT xip_pub_emps.EMP_NAME FROM xip_pub_users,xip_pub_emps\n         WHERE xip_pub_users.EMP_ID = xip_pub_emps.EMP_ID\n         AND xip_pub_users.USER_ID = ed.FIN_USER_ID) AS \"CREATED_NAME\",-- 复核人（凭证制单人）\n  ed.VERIFIER_ID,        -- 审核人（凭证提交人）\n  (SELECT xip_pub_emps.EMP_NAME FROM xip_pub_users,xip_pub_emps\n         WHERE xip_pub_users.EMP_ID = xip_pub_emps.EMP_ID\n         AND xip_pub_users.USER_ID = ed.VERIFIER_ID) AS \"VERIFIER\",-- 复核人（凭证制单人）\n  ed.VERFY_DATE,        -- 审核日期\n  ed.SIGN_DATE,        -- 原始单据签收日期\n  ed.SIGN_STATUS,        -- 签收状态：1-待签收，2-已签收，3-拒签\n  ed.SIGN_USER_ID,      -- 原始单据签收人\n  ed.PAY_METHOD,        -- 支付方式：1-立即支付，2-挂账支付\n  ed.CREATION_DATE,      -- 创建日期\n  ed.CREATED_BY,        -- 报销人\n  (SELECT xip_pub_emps.EMP_NAME FROM xip_pub_users,xip_pub_emps\n         WHERE xip_pub_users.EMP_ID = xip_pub_emps.EMP_ID\n         AND xip_pub_users.USER_ID = ed.CREATED_BY) AS \"CLAIMSPEOPER\",-- 报销人\n  pd.DEPT_NAME,        -- 成本中心\n  pp.PROJECT_NAME,      -- 项目名\n  ec.EX_CAT_NAME,        -- 单击分类名称\n  ep.PAY_TYPE,         -- 付款类型\n  gpm.MODE_NAME,      -- 付款方式\n  ep.PAY_STATUS,        -- 付款状态\n  ep.EX_PAY_ID        -- 支付单ID\n  ,xpf.form_url PC_A_FORM_URL\n  \nFROM xip_pub_users pu,\n     xip_pub_emps pe ,\n     xc_ex_cat ec \n     LEFT JOIN XIP_WF_PROCESS_FORMS xpf on xpf.form_id = ec.pc_a_form_id ,\n     xc_ex_docs ed\n     LEFT JOIN xc_pm_projects pp ON ed.PROJECT_ID = pp.PROJECT_ID\n     LEFT JOIN xip_pub_depts pd ON ed.DEPT_ID = pd.DEPT_ID\n     LEFT JOIN xc_ex_pay ep ON ed.EX_PAY_ID = ep.EX_PAY_ID\n     LEFT JOIN xc_gl_pr_modes gpm ON ep.PAY_TYPE = gpm.MODE_ID\n\nWHERE ed.EX_CAT_CODE = ec.EX_CAT_CODE\n  AND ed.CREATED_BY = pu.USER_ID \n  AND pu.EMP_ID = pe.EMP_ID\n  AND ec.EX_CAT_CODE IN ('EX02','EX03','EX05','EX04') -- 单据复核列表只列示借款单、还款单、费用报销单和差旅报销单\n  AND ed.SIGN_STATUS = '2' -- 签收状态--已签收\n  AND ec.IS_SIGN = 'Y' -- 已记账\n  AND (ed.V_STATUS IN ('1','2','4') OR ed.V_STATUS IS NULL) -- 凭证状态\n  AND ed.LEDGER_ID = {?LEDGER_ID?}\n  AND ed.AUDIT_STATUS = 'E' -- 审批通过\n  AND ed.EX_DOC_CODE LIKE '%{#EX_DOC_CODE#}%'\n  AND ed.DEPT_ID LIKE '%{#DEPT_ID#}%'\n  AND ed.PROJECT_ID LIKE '%{#PROJECT_ID#}%'\n  AND (SELECT xip_pub_emps.EMP_NAME FROM xip_pub_users,xip_pub_emps\n       WHERE xip_pub_users.EMP_ID = xip_pub_emps.EMP_ID\n       AND xip_pub_users.USER_ID = ed.CREATED_BY) LIKE '%{#CREATED_BY#}%'\nORDER BY ed.CREATION_DATE DESC","itemId":"sqlswitcher1","mysql":"SELECT\n\ted.LEDGER_ID,\t\t\t\t-- 账簿ID\n\ted.EX_DOC_ID,\t\t\t\t-- 费用单据ID\n\ted.EX_DOC_CODE,\t\t\t\t-- 单据编号\n\ted.EX_CAT_CODE,\t\t\t\t-- 单据分类 \n\ted.BIZ_DATE,\t\t\t\t-- 业务日期\n\ted.EX_REASON,\t\t\t\t-- 申请事由（摘要）\n\ted.EX_ITEM_ID,\t\t\t\t-- 预算项\n\ted.AMOUNT,\t\t\t\t\t-- 单据金额\n\ted.APPLY_EX_DOC_ID,\t\t\t-- 费用申请单号\n\ted.CANCEL_AMT,\t\t\t\t-- 核销金额\n\ted.V_HEAD_ID,\t\t\t\t-- 凭证头ID\n\ted.INS_CODE,\t\t\t\t-- 流程实例编码\n\ted.AUDIT_STATUS,\t\t\t-- 审批状态\n\ted.AUDIT_STATUS_DESC, \t\t-- 审批状态描述\n\ted.AUDIT_DATE,\t\t\t\t-- 审批通过日期\n\ted.ADUIT_USERS,\t\t\t\t-- 当前审批人（当前节点的所有待办所有者）\n\tIFNULL(ed.V_STATUS,'1') V_STATUS,\t\t\t\t-- 凭证状态\n\ted.FIN_DATE,\t\t\t\t-- 复核日期\n\ted.FIN_USER_ID,\t\t\t\t-- 复核人（凭证制单人）\n\t(SELECT xip_pub_emps.EMP_NAME FROM xip_pub_users,xip_pub_emps\n         WHERE xip_pub_users.EMP_ID = xip_pub_emps.EMP_ID\n         AND xip_pub_users.USER_ID = ed.FIN_USER_ID) AS \"CREATED_NAME\",-- 复核人（凭证制单人）\n\ted.VERIFIER_ID,\t\t\t\t-- 审核人（凭证提交人）\n\t(SELECT xip_pub_emps.EMP_NAME FROM xip_pub_users,xip_pub_emps\n         WHERE xip_pub_users.EMP_ID = xip_pub_emps.EMP_ID\n         AND xip_pub_users.USER_ID = ed.VERIFIER_ID) AS \"VERIFIER\",-- 复核人（凭证制单人）\n\ted.VERFY_DATE,\t\t\t\t-- 审核日期\n\ted.SIGN_DATE,\t\t\t\t-- 原始单据签收日期\n\ted.SIGN_STATUS,\t\t\t\t-- 签收状态：1-待签收，2-已签收，3-拒签\n\ted.SIGN_USER_ID,\t\t\t-- 原始单据签收人\n\ted.PAY_METHOD,\t\t\t\t-- 支付方式：1-立即支付，2-挂账支付\n\ted.CREATION_DATE,\t\t\t-- 创建日期\n\ted.CREATED_BY,\t\t\t\t-- 报销人\n\t(SELECT xip_pub_emps.EMP_NAME FROM xip_pub_users,xip_pub_emps\n         WHERE xip_pub_users.EMP_ID = xip_pub_emps.EMP_ID\n         AND xip_pub_users.USER_ID = ed.CREATED_BY) AS \"CLAIMSPEOPER\",-- 报销人\n    (  select a.bank_name from  xc_ex_ext_emps a,xip_pub_users b\n         where a.emp_id = b.emp_id\n           and b.user_id = ed.CREATED_BY\n    ) as BANK_NAME ,\n    (  select a.bank_no from  xc_ex_ext_emps a,xip_pub_users b\n         where a.emp_id = b.emp_id\n           and b.user_id = ed.CREATED_BY\n    ) as BANK_NO,\n\tpd.DEPT_NAME,\t\t\t\t-- 成本中心\n\tpp.PROJECT_NAME,\t\t\t-- 项目名\n\tec.EX_CAT_NAME,\t\t\t\t-- 单击分类名称\n\tep.PAY_TYPE, \t\t\t\t-- 付款类型\n\tep.PAY_STATUS,\t\t\t\t-- 付款状态\n\tep.EX_PAY_ID\t\t\t\t-- 支付单ID\n    ,xpf.form_url PC_A_FORM_URL\n\nFROM xip_pub_users pu, \n     xip_pub_emps pe, \n     xc_ex_cat ec\n     left join xip_wf_process_forms xpf on ec.pc_a_form_id = xpf.form_id,\n     xc_ex_docs ed\n     LEFT JOIN xc_pm_projects pp ON ed.PROJECT_ID = pp.PROJECT_ID\n     LEFT JOIN xip_pub_depts pd ON ed.DEPT_ID = pd.DEPT_ID\n     LEFT JOIN xc_ex_pay ep ON ed.EX_PAY_ID = ep.EX_PAY_ID\n\nWHERE ed.EX_CAT_CODE = ec.EX_CAT_CODE\n  AND ed.CREATED_BY = pu.USER_ID\n  AND pu.EMP_ID = pe.EMP_ID\n  AND ec.EX_CAT_CODE IN ('EX02','EX03','EX05','EX04') -- 单据复核列表只列示借款单、还款单、费用报销单和差旅报销单\n  AND IF((SELECT xc_ex_cat.IS_SIGN FROM xc_ex_cat WHERE xc_ex_cat.EX_CAT_CODE = ed.EX_CAT_CODE) <> 'Y',ed.SIGN_STATUS = '1' OR ed.SIGN_STATUS = '2',ed.SIGN_STATUS = '2') -- 是否记账，是否签收\n  AND (ed.V_STATUS IN ('1','2','4') OR ed.V_STATUS IS NULL) -- 凭证状态\n  AND ed.LEDGER_ID = {?LEDGER_ID?}\n  AND ed.AUDIT_STATUS = 'E' -- 审批通过\n  AND ed.EX_DOC_CODE LIKE '%{#EX_DOC_CODE#}%'\n  AND IFNULL(pd.DEPT_NAME,'%%') LIKE '%{#DEPT_ID#}%'\n  AND IFNULL(pp.PROJECT_NAME,'%%') LIKE '%{#PROJECT_ID#}%'\n  AND (SELECT xip_pub_emps.EMP_NAME FROM xip_pub_users,xip_pub_emps\n       WHERE xip_pub_users.EMP_ID = xip_pub_emps.EMP_ID\n       AND xip_pub_users.USER_ID = ed.CREATED_BY) LIKE '%{#CREATED_BY#}%'\nORDER BY ed.CREATION_DATE DESC"},"children":[],"expanded":false,"type":"sqlswitcher"},{"configs":{"sql":"{#sqlswitcher1#}","itemId":"dataprovider1"},"children":[],"expanded":false,"type":"dataprovider"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":"seek_icon"}