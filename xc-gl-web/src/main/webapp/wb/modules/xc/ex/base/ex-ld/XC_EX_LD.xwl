{"inframe":false,"title":"费用参数设置","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"//引入对应的json文件\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,'xc/ex/base/ex-ld/json/XC_EX_LD');","itemId":"module"},"children":[{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","border":"false","itemId":"query_from"},"children":[{"configs":{"layout":"column","border":"false","itemId":"query_panel"},"children":[{"configs":{"tagConfigs":"columnWidth:0.25","labelWidth":"40","displayField":"LEDGER_NAME","valueField":"LEDGER_ID","emptyText":"{#queryLedger#}","labelAlign":"right","padding":"10","itemId":"query_ledger","fieldLabel":"{#ledger#}","editable":"false"},"events":{"beforequery":"var combo = plan.combo ;\nif(!plan.forceAll){\n  var flag = false;\n  var value = plan.query;\n  combo.store.filterBy(function(record,id){\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value)!=-1);\n  });\n  combo.expand();\n  return false;\n}","select":"app.ex_grid.getStore().load({\n   params:{ledger_id:app.query_ledger.getValue()}\n});"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/com-qry/gl-ledgers/select-sec-fd-ledgers"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"},{"configs":{"tagConfigs":"columnWidth:0.08","text":"{#seek#}","margin":"0 0 0 20","itemId":"queryBtn","y":"10","iconCls":"seek_icon"},"events":{"click":"if(app.query_ledger.getValue()==='' ||app.query_ledger.getValue()===null) {\n  Wb.toast('{#seekMsg1#}');\n  //Ext.MessageBox.alert('提示','请先选择账薄信息');\n  return;\n}\n\napp.ex_grid.getStore().load({\n   params:{ledger_id:app.query_ledger.getValue()}\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"tagConfigs":"columnWidth:0.08","text":"{#reset#}","margin":"0 0 0 20","itemId":"resetBtn","y":"10","iconCls":"refresh_icon"},"events":{"click":"app.query_ledger.reset();\napp.ex_grid.getStore().load();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":false,"type":"form"},{"configs":{"region":"center","itemId":"ex_grid"},"events":{"itemdblclick":"app.updateBtn.fireEvent('click');"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#set#}","itemId":"updateBtn","iconCls":"file_edit_icon"},"events":{"click":"var rows = app.ex_grid.getSelection();\nif(rows.length<1) {\n   Wb.toast('请先选择一条需要修改的账薄信息!');\n   return;\n}\n\napp.EX_IA_ACC_NAME.getPicker().getStore().load();\napp.EX_CR_ACC_NAME.getPicker().getStore().load();\n\n\n// //重新查询数据库获取数据\n// Ext.Ajax.request({\n//    url:'m?xwl=xc/ex/base/ex-ld/ex_ld_db/select_ledger_by_id',\n//    params:{ledger_id:rows[0].data.LEDGER_ID},\n//    success:function(response){\n//      app.update_ex_win.show();\n//      Wb.setValue(app.update_ex_win,Wb.decode(response.responseText).rows[0]);\n//    }\n// });\n\napp.update_ex_win.show();\nWb.setValue(app.update_ex_win,rows[0].data);"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#rowNum#}","align":"center","width":"50","xtype":"rownumberer","itemId":"row_num_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#ledgerId#}","hidden":"true","dataIndex":"LEDGER_ID","titleAlign":"center","itemId":"ledger_id_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#ledgerCode#}","width":"70","dataIndex":"LEDGER_CODE","titleAlign":"center","itemId":"ledger_code_col"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#ledgerName#}","width":"150","dataIndex":"LEDGER_NAME","titleAlign":"center","itemId":"ledger_name_col","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value;"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#hrcyName#}","width":"150","dataIndex":"EX_HRCY_NAME","titleAlign":"center","itemId":"ex_hrcy_name_col","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value;"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#iaAccName#}","width":"100","dataIndex":"EX_IA_ACC_NAME","titleAlign":"center","itemId":"ex_ia_acc_name_col","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value;"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#isCrPay#}","width":"70","dataIndex":"IS_CR_PAY_NAME","titleAlign":"center","itemId":"is_cr_pay_name_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#exCrAcc#}","width":"100","dataIndex":"EX_CR_ACC_NAME","titleAlign":"center","itemId":"ex_cr_acc_name_col","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value;"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xc/ex/base/ex-ld/ex_ld_db/select_ledger_dtl"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"grid"}],"expanded":true,"type":"viewport"},{"configs":{"title":"{#title1#}","autoShow":"false","height":"250","layout":"fit","width":"500","closeAction":"hide","buttonAlign":"center","border":"true","itemId":"update_ex_win","modal":"true","draggable":"false"},"children":[{"configs":{"itemId":"buttons"},"children":[{"configs":{"text":"{#save#}","width":"80","itemId":"saveBtn","iconCls":"save_icon"},"events":{"click":"var temp_leID = app.LEDGER_ID.getValue();//账薄ID\n\n\n//界面中的保存校验\n\n//如果选择了可以挂账，则必须选择挂账科目\nif(app.IS_CR_PAY.getValue()==='Y') {\n  if(app.EX_CR_ACC_ID.getValue()===null || app.EX_CR_ACC_ID.getValue()==='') {\n      Wb.toast('{#saveMsg1#}');\n      return;\n  }\n  if(app.EX_CR_ACC_NAME.getValue()===null || app.EX_CR_ACC_NAME.getValue()==='') {\n    Wb.toast('{#saveMsg1#}');\n    return;\n  }\n}\n\n//验证并保存\nWb.request({\n  url:'m?xwl=xc/ex/base/ex-ld/ex_ld_db/update_ledgers',\n  out:app.update_ex_win,\n  success:function() {\n    Wb.toast('{#saveMsg2#}');\n    app.ex_grid.getStore().reload();\n    app.update_ex_win.close();\n  },\n  failure:function(){\n    Wb.toast('{#saveMsg3#}');\n  }\n});\n\n"},"children":[],"expanded":true,"type":"button"},{"configs":{"text":"{#cancel#}","itemId":"cancelBtn","iconCls":"cancel_icon"},"events":{"click":"app.update_ex_win.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"},{"configs":{"layout":"column","itemId":"ex_panel"},"children":[{"configs":{"tagConfigs":"columnWidth:0.9","labelWidth":"140","readOnly":"true","hidden":"true","labelAlign":"right","padding":"5","itemId":"LEDGER_ID","fieldLabel":"{#ledgerId#}"},"children":[],"expanded":true,"type":"text"},{"configs":{"tagConfigs":"columnWidth:0.9","labelWidth":"140","readOnly":"true","labelAlign":"right","padding":"10 0 5 0","itemId":"LEDGER_NAME","fieldLabel":"{#ledgerName#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"columnWidth:0.9","labelWidth":"140","readOnly":"true","hidden":"true","labelAlign":"right","itemId":"EX_HRCY_ID","fieldLabel":"{#exHrcyId#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"columnWidth:0.9","labelWidth":"140","labelAlign":"right","padding":"5 0 5 0","itemId":"EX_HRCY_NAME","fieldLabel":"{#hrcyName#}"},"events":{"expand":"app.EX_HRCY_NAME.getPicker().getStore().load();//还原为原选项","collapse":"//如果为空，则清空EX_IA_ACC_ID\nif(picker.getValue()==='' || picker.getValue()===null) {\n  app.EX_HRCY_ID.setValue();\n}\napp.query_ex_hrcy_name.reset();\n"},"children":[{"configs":{"tagConfigs":"minWidth:400","height":"350","barPageButton":"true","barExportButtons":"false","width":"400","barRefreshButton":"false","barNavigateButtons":"true","itemId":"pickComp"},"events":{"itemclick":"var picker = this.ownerCmp;\npicker.setValue(record.data.EX_HRCY_NAME);\napp.EX_HRCY_ID.setValue(record.data.EX_HRCY_ID);//把记录ACC_ID存放到隐藏域，可方便被提交到后台\npicker.collapse();//隐藏picker"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"emptyText":"{#msg1#}","itemId":"query_ex_hrcy_name"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.queryExHrcyBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"itemId":"queryExHrcyBtn","iconCls":"seek_icon"},"events":{"click":"app.EX_HRCY_NAME.getPicker().getStore().load({\n   params:{ex_hrcy_name:app.query_ex_hrcy_name.getValue()}});"},"children":[],"expanded":false,"type":"item"},{"configs":{"itemId":"deleteExHrcyBtn","iconCls":"delete_icon"},"events":{"click":"app.EX_HRCY_ID.reset();\napp.EX_HRCY_NAME.reset();\n\napp.EX_HRCY_NAME.getPicker().hide();"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#rowNum#}","hidden":"true","align":"center","width":"50","xtype":"rownumberer","titleAlign":"center","itemId":"ex_hrcy_row_num"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#id#}","hidden":"true","width":"80","dataIndex":"EX_HRCY_ID","titleAlign":"center","itemId":"ex_hrcy_id_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#code#}","width":"120","dataIndex":"EX_HRCY_CODE","titleAlign":"center","itemId":"ex_hrcy_code_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#name#}","width":"220","dataIndex":"EX_HRCY_NAME","titleAlign":"center","itemId":"ex_hrcy_name_col","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:18px;';   \nreturn value;"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"pageSize":"10","autoLoad":"true","itemId":"store","url":"m?xwl=xc/ex/base/ex-ld/ex_ld_db/select_ex_hrcy"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"picker"},{"configs":{"tagConfigs":"columnWidth:0.9","labelWidth":"140","readOnly":"true","hidden":"true","labelAlign":"right","itemId":"EX_IA_ACC_ID","fieldLabel":"{#exIaAccId#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"columnWidth:0.9","labelWidth":"140","labelAlign":"right","padding":"5 0 5 0","itemId":"EX_IA_ACC_NAME","fieldLabel":"{#iaAccName#}"},"events":{"expand":"app.EX_IA_ACC_NAME.getPicker().getStore().load();","collapse":"//如果为空，则清空EX_IA_ACC_ID\nif(picker.getValue()==='' || picker.getValue()===null) {\n  app.EX_IA_ACC_ID.setValue();\n}\napp.query_ia_acc_name.reset();\n"},"children":[{"configs":{"tagConfigs":"minWidth:400","height":"350","barPageButton":"true","barExportButtons":"false","width":"400","barRefreshButton":"false","barNavigateButtons":"true","itemId":"pickComp"},"events":{"itemclick":"var picker = this.ownerCmp;\npicker.setValue(record.data.ACC_NAME);\napp.EX_IA_ACC_ID.setValue(record.data.ACC_ID);//把记录ACC_ID存放到隐藏域，可方便被提交到后台\npicker.collapse();//隐藏picker"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"emptyText":"{#msg1#}","itemId":"query_ia_acc_name"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.queryIaBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"itemId":"queryIaBtn","iconCls":"seek_icon"},"events":{"click":"app.EX_IA_ACC_NAME.getPicker().getStore().load({\n   params:{acc_name:app.query_ia_acc_name.getValue()}});"},"children":[],"expanded":false,"type":"item"},{"configs":{"itemId":"deleteIaBtn","iconCls":"delete_icon"},"events":{"click":"app.EX_IA_ACC_ID.reset();\napp.EX_IA_ACC_NAME.reset();\n\napp.EX_IA_ACC_NAME.getPicker().hide();"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#rowNum#}","hidden":"true","align":"center","width":"50","xtype":"rownumberer","titleAlign":"center","itemId":"ia_row_num"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#accId#}","hidden":"true","width":"80","dataIndex":"ACC_ID","titleAlign":"center","itemId":"ia_acc_id_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#code#}","width":"80","dataIndex":"ACC_CODE","titleAlign":"center","itemId":"ia_acc_code_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#name#}","width":"230","dataIndex":"ACC_NAME","titleAlign":"center","itemId":"ia_acc_name_col"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"pageSize":"10","autoLoad":"false","itemId":"store","url":"m?xwl=xc/ex/base/ex-ld/ex_ld_db/select_accounts"},"events":{"beforeload":"var temp = app.ex_grid.getSelection()[0].data.LEDGER_ID;\nstore.proxy.extraParams.LEDGER_ID = temp;"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"picker"},{"configs":{"tagConfigs":"columnWidth:0.9","labelWidth":"140","displayField":"VAL_NAME","valueField":"VAL_CODE","labelAlign":"right","padding":"5 0 5 0","itemId":"IS_CR_PAY","forceSelection":"true","fieldLabel":"{#isCrPay1#}"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xc/ex/base/ex-ld/ex_ld_db/select_val_set_dtl_YN"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"},{"configs":{"tagConfigs":"columnWidth:0.9","labelWidth":"140","readOnly":"true","hidden":"true","labelAlign":"right","itemId":"EX_CR_ACC_ID","fieldLabel":"{#exCrAccId#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"columnWidth:0.9","labelWidth":"140","labelAlign":"right","padding":"5 0 5 0","itemId":"EX_CR_ACC_NAME","fieldLabel":"{#exCrAcc#}"},"events":{"expand":"app.EX_CR_ACC_NAME.getPicker().getStore().load();","collapse":"//如果为空，则清空EX_IA_ACC_ID\nif(picker.getValue()==='' || picker.getValue()===null) {\n  app.EX_CR_ACC_ID.setValue();\n}\napp.query_cr_acc_name.reset();\n"},"children":[{"configs":{"tagConfigs":"minWidth:400","height":"350","barPageButton":"true","barExportButtons":"false","width":"400","barRefreshButton":"false","barNavigateButtons":"true","itemId":"pickComp"},"events":{"itemclick":"var picker = this.ownerCmp;\npicker.setValue(record.data.ACC_NAME);\napp.EX_CR_ACC_ID.setValue(record.data.ACC_ID);//把记录ACC_ID存放到隐藏域，可方便被提交到后台\npicker.collapse();//隐藏picker"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"emptyText":"输入编码或名称查询","itemId":"query_cr_acc_name"},"events":{"specialkey":"if(e.getKey()===13) {\n  app.queryCrBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"itemId":"queryCrBtn","iconCls":"seek_icon"},"events":{"click":"app.EX_CR_ACC_NAME.getPicker().getStore().load({\n   params:{acc_name:app.query_cr_acc_name.getValue()}});"},"children":[],"expanded":false,"type":"item"},{"configs":{"itemId":"deleteCrBtn","iconCls":"delete_icon"},"events":{"click":"app.EX_CR_ACC_ID.reset();\napp.EX_CR_ACC_NAME.reset();\n\napp.EX_CR_ACC_NAME.getPicker().hide();"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#rowNum#}","hidden":"true","align":"center","width":"50","xtype":"rownumberer","titleAlign":"center","itemId":"cr_row_num"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#accId#}","hidden":"true","width":"80","dataIndex":"ACC_ID","titleAlign":"center","itemId":"cr_acc_id_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#code#}","width":"80","dataIndex":"ACC_CODE","titleAlign":"center","itemId":"cr_acc_code_col"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#name#}","width":"230","dataIndex":"ACC_NAME","titleAlign":"center","itemId":"cr_acc_name_col"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"pageSize":"10","autoLoad":"false","itemId":"store","url":"m?xwl=xc/ex/base/ex-ld/ex_ld_db/select_accounts"},"events":{"beforeload":"var temp = app.ex_grid.getSelection()[0].data.LEDGER_ID;\nstore.proxy.extraParams.LEDGER_ID = temp;"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"picker"}],"expanded":false,"type":"form"}],"expanded":true,"type":"window"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}