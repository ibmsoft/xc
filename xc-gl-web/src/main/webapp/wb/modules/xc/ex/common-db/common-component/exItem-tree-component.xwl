{"inframe":false,"title":"","hidden":false,"roles":{"default":1},"children":[{"configs":{"serverScript":"com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/ex/qry/ex-my-doc-qry/doc-wins/json/ex-doc-win\");\nrequest.setAttribute(\"ctxPath\", request.getContextPath()) ;","itemId":"module"},"events":{"initialize":"/*\n *调用形式\n if(!Ext.isEmpty(app.LEDGER_ID.getValue())){\n  Wb.run({\n      url:'m?xwl=xc/ex/common-db/common-component/exItem-tree-component',\n      success:function(appObj){\n        appObj.initWindow({\n          ledgerId:app.LEDGER_ID.getValue(),\n          exCatCode:'EX04',\n          XY:e.getXY(),\n          W:345,\n          success:function(objRecord){\n            var exItemId = objRecord.exItemId;\n            var exItemName = objRecord.exItemName;\n          }\n        });\n      }\n    });\n}else{\n  return false;\n}  \n */\nExt.apply(app,{\n  initWindow:function(params){\n    Ext.apply(app, params);\n    app.exItemTreePubWin = new Ext.window.Window(app.exItemTreePubWin);\n    //设置参数\n    var _pubLedgerId = params.ledgerId;\n    var _pubExCatCode = params.exCatCode;\n    var _pubXY = params.XY;\n    if(!Ext.isEmpty(params.W)){\n      app.exItemTreePubWin.setWidth(params.W);\n    }\n    app.exTreeLedgerId.setValue(_pubLedgerId);\n    app.exTreeCatCode.setValue(_pubExCatCode);\n    app.exItemTreePubWin.showAt(_pubXY);\n  }\n});"},"children":[{"configs":{"footerScript":"/**\nname:treeNodeQuery(实现树的模糊查找)\ndesc:根据名称查询节点在树中的位置\nparams:text(节点名称)\nparams:by(依据字段<树查询默认为'text'>)\nparams:treeId(树的ID)\n*/\nfunction treeNodeQuery(text,by,treeId) { \n \n  if(Ext.isEmpty(by))\n    by = 'text';\n  var menuFunTree = treeId;\n  menuFunTree.expandAll(function(){\n      var view = menuFunTree.getView(),\n      me = menuFunTree,\n      nodesAndParents = [];\n  menuFunTree.getRootNode().cascadeBy(function(tree, view) {\n        var uiNode = view.getNodeByRecord(this);\n        if (uiNode) {\n            Ext.get(uiNode).setDisplayed('table-row');\n        }\n    }, null, [menuFunTree, view]);\n    //添加匹配的节点和他们的父节点到nodesAndParents数组.\n    menuFunTree.getRootNode().cascadeBy(function(tree, view) {\n      var currNode = this;\n      if (currNode && currNode.data[by] && currNode.data[by].toString().toLowerCase().indexOf(text.toLowerCase()) > -1) {\n             menuFunTree.expandPath(currNode.getPath());\n             while (currNode.parentNode) {\n                nodesAndParents.push(currNode.id);\n                currNode = currNode.parentNode;\n            }\n        }\n    }, null, [menuFunTree, view]);\n    // 将不在nodesAndParents数组中的节点隐藏\n    // 将根节点放在显示数组中\n    nodesAndParents.push(menuFunTree.getRootNode().id);\n    menuFunTree.getRootNode().cascadeBy(function(tree, view){\n        var uiNode = view.getNodeByRecord(this);\n        if (uiNode && !Ext.Array.contains(nodesAndParents, this.id)) {\n            Ext.get(uiNode).setDisplayed('none');\n        }\n    }, null, [menuFunTree, view]);\n  });\n}\n","itemId":"exItemTreeQueryPubFun"},"children":[],"expanded":false,"type":"clientscript"},{"configs":{"height":"200","constrain":"true","width":"345","layout":"fit","border":"false","itemId":"exItemTreePubWin"},"events":{"show":"app.treeQueryBtn.fireEvent('click');","ok":"//返回弹出框的回带值\nvar returnObj ={'name':'','code':''};\nif(Ext.isEmpty(app.attrCombobox.getValue()) || app.attrCombobox.getValue() === 'none'){\n  returnObj.name='';\n  returnObj.code='';\n}else{\n  returnObj.code = app.attrCombobox.getValue();\n  returnObj.name = app.attrCombobox.getRawValue();\n}\nif (app.success)\n  app.success(returnObj);\napp.pubWin.close();"},"children":[{"configs":{"itemId":"exTreeLedgerId"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"itemId":"exTreeCatCode"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"rootVisible":"false","normalName":"exTreePanel","itemId":"exItemPubTree"},"events":{"itemclick":"if(!record.data.leaf){\n  return ;\n}\nvar exItemId = record.data.EX_ITEM_ID;\nvar exItemName = record.data.text;\nvar bgItemId = record.data.BG_ITEM_ID;\nvar bgItemName = record.data.BG_ITEM_NAME;\napp.EX_ITEM_ID.setValue(exItemId) ;\napp.EX_ITEM_NAME.setValue(exItemName) ;\nif(app.success){\n   var returnObj = {'exItemId':exItemId,'exItemName':exItemName,'bgItemId':bgItemId,'bgItemName':bgItemName};\n   app.success(returnObj);\n}","beforeload":"if(Ext.isEmpty(app.exTreeLedgerId.getValue)){\n  return false ;\n}"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"{#ctxPath#}/exItemTreeAction.do?method=getExItemTree","fields":"[{name:'LEDGER_ID'},{name:'EX_ITEM_ID'},{name:'text'},{name:'EX_ITEM_UP_ID'},{name:'EX_ITEM_CODE'},{name:'BG_ITEM_ID'},{name:'BG_ITEM_NAME'}]"},"events":{"beforeload":"if(Ext.isEmpty(app.exTreeLedgerId.getValue())){\n  return false ;\n}else{\n operation.params.ledgerId = app.exTreeLedgerId.getValue();\n operation.params.exDocCat = app.exTreeCatCode.getValue();\n operation.params.exCodeName ='';\n}"},"children":[],"expanded":false,"type":"treestore"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"width":"250","labelAlign":"right","itemId":"treeName"},"events":{"specialkey":"app.treeQueryBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"itemId":"treeQueryBtn","iconCls":"seek_icon"},"events":{"click":"treeNodeQuery(app.treeName.getValue(),'text', app.exTreePanel);"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"}],"expanded":true,"type":"tree"}],"expanded":true,"type":"window"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}