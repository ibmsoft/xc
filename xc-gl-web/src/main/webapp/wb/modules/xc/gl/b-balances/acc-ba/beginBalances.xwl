{"inframe":false,"title":"期初余额","hidden":false,"roles":{"default":1},"children":[{"configs":{"title":"{#la_pageTitle#}","loginRequired":"false","serverScript":"com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/gl/b-balances/acc-ba/beginBalances\");\nvar ctxPath = request.getContextPath() ;\nrequest.setAttribute(\"contextPath\",ctxPath);","itemId":"module"},"events":{"initialize":"Ext.QuickTips.init();\nvar queryType = 'INIT';\nvar accCategory = 0;\nvar queryPeriod = '';\nvar accountBuild = 0;\n//缓存临时标题\nvar globalTitle = '';\n//====全局加减函数====\nfunction numberAdd(arg1,arg2){\n  var r1,r2,m;\n  try{\n    r1 = arg1.toString().split('.')[1].length ;\n  }catch(e){\n    r1 = 0 ;\n  }\n  try{\n    r2 = arg2.toString().split('.')[1].length ;      \n  }catch(e){\n    r2 = 0 ;\n  }\n  m = Math.pow(10,Math.max(r1,r2));\n    return (arg1 * m + arg2 * m) / m;\n}\n//=============全局减法函数=============\nfunction numberSub(arg1,arg2){\n    var r1,r2,m,n;\n    try{\n      r1 = arg1.toString().split('.')[1].length;\n    }catch(e){\n      r1 = 0;\n    }\n    try{\n      r2 = arg2.toString().split('.')[1].length;\n    }catch(e){\n      r2 = 0;\n    }\n    m = Math.pow(10,Math.max(r1,r2));  \n    n = (r1 >= r2) ? r1 : r2;\n    return ((arg1 * m - arg2 * m) / m).toFixed(n);\n}\n"},"children":[{"configs":{"itemId":"gridPabelBar"},"children":[{"configs":{"itemId":"initYearBar"},"children":[{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#la_addBtn#}","itemId":"addBalance","iconCls":"plus_icon"},"events":{"click":"if(!Ext.isEmpty(app.ledgerCombo.getValue())){\n  Wb.addEdit(app.initBalanceGrid,{'IS_VALID':'N','YEAR_AMOUNT':0,'YEAR_OR_BALANCE':0,'YEAR_BALANCE':0});\n}else{\n  Wb.info('{#la_chooseLedgerTip#}');\n}\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item8"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#la_delBtn#}","itemId":"delBalance","iconCls":"minus_icon"},"events":{"click":"var records = app.initBalanceGrid.getSelection();\nif(records.length === 0){\n  Wb.warn('{#la_selectTips#}');\n  return false;\n}\nvar ids = '';\nExt.each(records,function(r){\n  ids += '\\''+r.data.ID+'\\',';\n});\nids = ids.substring(0,ids.length-1);\nWb.confirm('{#la_confirmTips#}',function(){\n  Wb.request({\n    url:'m?xwl=xc/gl/b-balances/acc-ba/data/delBalances',\n    params:{'IDS':ids},\n    success:function(){\n      Wb.info('{#la_delSuccessTips#}');\n      Wb.remove(app.initBalanceGrid);\n    },\n    failure:function(){\n      Wb.info('{#la_delFailureTips#}');\n    }\n  });\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item0"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#la_saveBtn#}","itemId":"saveBalance","iconCls":"save_icon"},"events":{"click":"//账簿开始期间为年初\nvar insertArray = [];\nvar updateArray = [];\nvar _ledgerId = app.ledgerCombo.getValue();\nvar _comboRecord = app.ledgerCombo.findRecord('LEDGER_ID',_ledgerId);\nvar records = app.initBalanceGrid.getStore().getModifiedRecords();\nif(records.length === 0){\n  return false;\n}\n//校验必填项\nvar isValid = true;\nExt.each(records,function(item){\n  if(Ext.isEmpty(item.data.CCID) || Ext.isEmpty(item.data.YEAR_BALANCE)){\n    isValid = false;\n    return ;\n  }\n  if(Ext.isEmpty(item.data.ID)){\n    var _addJson = {'ID':'',\n                    'LEDGER_ID':_ledgerId,\n                    'CCID':item.data.CCID,\n                    'PERIOD_CODE':queryPeriod,\n                    'CURRENCY_CODE':_comboRecord.data.CURRENCY_CODE,  //本位币\n                    'ENTER_CNY_CODE':item.data.ENTER_CNY_CODE,        //原币\n                    'IS_VALID':'N',\n                    'Y_DR':0.000000,                //年初借方余额\n                    'Y_CR':0.000000,                //年初贷方余额\n                    'T_Y_DR':0.000000,              //年初借方原币余额\n                    'T_Y_CR':0.000000,              //年初贷方原币余额\n                    'AMT_Y_DR':0.000000,            //年初借方数量\n                    'AMT_Y_CR':0.000000,            //年初贷方数量\n                    \n                    'B_DR':0.000000,                //期初借方余额\n                    'B_CR':0.000000,                //期初贷方余额\n                    'AMT_B_DR':0.000000,            //期初借方数量\n                    'AMT_B_CR':0.000000,            //期初贷方数量\n                    'T_B_DR':0.000000,              //期初借方原币余额\n                    'T_B_CR':0.000000,              //期初贷方原币余额\n                    \n                    'AMT_PJTD_DR':0.000000,         //数量借方\n                    'AMT_PJTD_CR':0.000000,         //数量贷方\n                    'PJTD_DR'    :0.000000,         //期末借方余额\n                    'PJTD_CR'    :0.000000,         //期末贷方余额\n                    'T_PJTD_DR'  :0.000000,         //期末借方原币余额\n                    'T_PJTD_CR'  :0.000000          //期末贷方原币余额\n                   };\n    var _cAddJson = Ext.clone(_addJson);      \n    if(item.data.BALANCE_DIRECTION === '1'){\n      //==============借方=========================\n      _addJson.PJTD_DR = item.data.YEAR_BALANCE;          //借方余额\n      _addJson.B_DR = item.data.YEAR_BALANCE;             //期初余额\n      if(item.data.IS_AMOUNT ==='1' && !Ext.isEmpty(item.data.YEAR_AMOUNT) && 0!==item.data.YEAR_AMOUNT){\n        _addJson.AMT_PJTD_DR = item.data.YEAR_AMOUNT;     //借方数量\n        _addJson.AMT_B_DR = item.data.YEAR_AMOUNT;          //期初数量\n      }\n      if(!Ext.isEmpty(item.data.YEAR_OR_BALANCE) && 0!==item.data.YEAR_OR_BALANCE){\n        _addJson.T_PJTD_DR = item.data.YEAR_OR_BALANCE;  //借方原币金额\n        _addJson.T_B_DR = item.data.YEAR_OR_BALANCE;        //期初原币余额\n      }\n    }else{\n      //=============贷方=========================\n      _addJson.PJTD_CR = item.data.YEAR_BALANCE;          //贷方余额\n       _addJson.B_CR = item.data.YEAR_BALANCE;             //期初余额\n      if(!Ext.isEmpty(item.data.YEAR_AMOUNT) && 0!==item.data.YEAR_AMOUNT){\n        _addJson.AMT_PJTD_CR = item.data.YEAR_AMOUNT;     //贷方数量\n        _addJson.AMT_B_CR = item.data.YEAR_AMOUNT;          //期初数量\n      }\n      if(!Ext.isEmpty(item.data.YEAR_OR_BALANCE) && 0!==item.data.YEAR_OR_BALANCE){\n        _addJson.T_PJTD_CR = item.data.YEAR_OR_BALANCE;  //贷方原币金额\n        _addJson.T_B_CR = item.data.YEAR_OR_BALANCE;     //期初原币余额\n      }\n    }\n    //======新增数据================\n    insertArray.push(_addJson);\n  }else{ \n//====================修改的数据==========================\n      var _editJson = {'ID':item.data.ID,\n                       'LEDGER_ID':_ledgerId,\n                       'CCID':item.data.CCID,\n                       'PERIOD_CODE':queryPeriod,\n                       'CURRENCY_CODE':_comboRecord.data.CURRENCY_CODE,//本位币币种\n                       'ENTER_CNY_CODE':item.data.ENTER_CNY_CODE,      //原币币种\n                       'IS_VALID':'N',\n                       'AMT_PJTD_DR':0.000000,         //数量借方\n                       'AMT_PJTD_CR':0.000000,         //数量贷方\n                       'PJTD_DR'    :0.000000,         //期末借方余额\n                       'PJTD_CR'    :0.000000,         //期末贷方余额\n                       'T_PJTD_DR'  :0.000000,         //期末借方原币余额\n                       'T_PJTD_CR'  :0.000000,          //期末贷方原币余额\n                       'B_DR':0.000000,                //期初借方余额\n                       'B_CR':0.000000,                //期初贷方余额\n                       'AMT_B_DR':0.000000,            //期初借方数量\n                       'AMT_B_CR':0.000000,            //期初贷方数量\n                       'T_B_DR':0.000000,              //期初借方原币余额\n                       'T_B_CR':0.000000              //期初贷方原币余额\n                   };\n      if(item.data.BALANCE_DIRECTION === '1'){\n                 //==========================借方=========================\n         if(item.data.IS_AMOUNT ===1 && !Ext.isEmpty(item.data.YEAR_AMOUNT) && 0!==item.data.YEAR_AMOUNT){\n            _editJson.AMT_PJTD_DR = item.data.YEAR_AMOUNT;\n            _editJson.AMT_B_DR = item.data.YEAR_AMOUNT;             \n         }\n          _editJson.PJTD_DR = item.data.YEAR_BALANCE;\n         _editJson.B_DR = item.data.YEAR_BALANCE;            \n         if(!Ext.isEmpty(item.data.YEAR_OR_BALANCE) && 0!==item.data.YEAR_OR_BALANCE){\n                _editJson.T_PJTD_DR = item.data.YEAR_OR_BALANCE;  \n                _editJson.T_B_DR = item.data.YEAR_OR_BALANCE;             \n         }\n      }else{\n         //==========================贷方=========================\n         if(item.data.IS_AMOUNT ===1 && !Ext.isEmpty(item.data.YEAR_AMOUNT) && 0!==item.data.YEAR_AMOUNT){\n            _editJson.AMT_PJTD_CR = item.data.YEAR_AMOUNT;\n            _editJson.AMT_B_CR = item.data.YEAR_AMOUNT;           \n         }\n          _editJson.PJTD_CR = item.data.YEAR_BALANCE;\n          _editJson.B_CR = item.data.YEAR_BALANCE;\n         if(!Ext.isEmpty(item.data.YEAR_OR_BALANCE) && 0!==item.data.YEAR_OR_BALANCE){\n                _editJson.T_PJTD_CR = item.data.YEAR_OR_BALANCE;  //贷方原币金额\n                _editJson.T_B_CR = item.data.YEAR_OR_BALANCE;  \n         }\n     }\n     updateArray.push(_editJson);\n}\n});\nif(!isValid){\n  Wb.info('{#la_fillAllTips#}');\n  return false;\n}\n//==========数据处理完毕,保存当前修改的数据===========================\n//=================判断当前账簿是否处于建账状态======================\nWb.request({\n  url:'m?xwl=xc/gl/b-balances/acc-ba/data/checkIsBulidAccount',\n  params:{'ledgerId':_ledgerId},\n  success:function(response,options){\n      var obj = Wb.decode(response.responseText);\n      if(obj.isBuild === 1){\n         Wb.info('{#la_buildTips#}',function(){\n            app.initBalanceGrid.getStore().load();\n         });  \n     }else{\n       Wb.request({\n          url:'m?xwl=xc/gl/b-balances/acc-ba/data/insertInitBalance',\n          params:{'insertArray':Wb.encode(insertArray),'updateArray':Wb.encode(updateArray)},\n          success:function(){\n             Wb.info('{#la_saveSuccessTips#}',function(){\n                app.initBalanceGrid.getStore().load();\n             });\n           },\n          failure:function(response,options){\n                Wb.info('{#la_saveFailureTips#}');\n           }\n});     \n }\n    },\n  failure:function(response,options){\n    Wb.info('{#la_saveSuccessTips#}',function(){\n      app.initBalanceGrid.getStore().load();\n    });\n    \n  }\n});\n\n\n\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#la_balanceBtn#}","itemId":"balanceBtn","iconCls":"measure_icon"},"events":{"click":"/**\n *校验当前账簿下的余额录入是否满足借贷平衡，平衡校验时必须从数据库中取当前时间点的数据,必须是已经保存的记录\n */\nvar modifyRecords = app.initBalanceGrid.getStore().getModifiedRecords();\nif(Ext.isEmpty(app.ledgerCombo.getValue())){\n  Wb.info('{#la_chooseLedgerTip#}');\n}else if(!Ext.isEmpty(modifyRecords) && modifyRecords.length>0){\n  Wb.info('{#la_saveFirstTip#}');\n}else{\n  var win = new Ext.window.Window(app._checkBalanceWin);\n  win.show();\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#la_bulidAccont#}","itemId":"buildAccount","iconCls":"lock_icon"},"events":{"click":"/*\n *建账前的操作：\n *1、检查当前账簿是否处在建账状态\n *2、检查当前账簿期间的余额是否平衡\n *3、检查当前操作是否已保存\n *取消建账前的操作：\n *1、检查当前账簿是否正在执行建账/取消建账操作\n *2、检查当前账簿是否已经处于未建账状态\n */\nvar modifyRecords = app.initBalanceGrid.getStore().getModifiedRecords();\nif (Ext.isEmpty(app.ledgerCombo.getValue())) {\n  Wb.info('{#la_chooseLedgerTip#}');\n} else if (!Ext.isEmpty(modifyRecords) && modifyRecords.length > 0) {\n  Wb.info('{#la_saveFirstTip#}');\n} else {\n  var _ledgerId = app.ledgerCombo.getValue();\n  /*-------------取消建账操作-----------*/\n  if (accountBuild !== 0) {\n    //如果账簿已经处在【非建账】状态，或者账簿正在执行【建账】操作，不允许执行【取消建账】操作，只有账簿处于【建账】状态，才执行【取消建账】操作\n    //---------------------建账/取消建账操作 同步操作 --------------\n    Wb.confirm('{#la_confirmCancel#}', function() {\n      Wb.request({\n        url: '{#contextPath#}/sumBalanceAction.do?method=createOrCancelAccount',\n        timeout:60*60*1000,\n        params: {\n          'ledgerId': _ledgerId,\n          'isCanceled': 'Y'\n        },\n        success: function(response, options) {\n          //--------取消建账成功的后续操作---------------------\n          var resultJson = Wb.decode(response.responseText);\n          Wb.info(resultJson.msg, function() {\n            //取消建账成功，重新载入当前页面/页签\n            if (app.funTabPanel) {\n              var funUrl = app.funTabPanel.selectedTab.bindFile;\n              Wb.open({\n                url: funUrl,\n                title: app.funTabPanel.selectedTab.title,\n                reload: true,\n                container: app.funTabPanel.tabPanel\n              });\n            } else {\n              window.location.reload();\n            }\n          });\n        },\n        failure: function(response, options) {\n          //------------取消建账失败后的操作-----------------\n          Wb.info('{#la_cancelBuild#}');\n        }\n      });\n    });\n\n  } else {\n    /*-----------建账操作--------------*/\n    //如果账簿正处在【建账】状态，或者账簿正在执行【建账】操作，不允许执行【建账】操作，只有账簿处在【非建账】状态，才能执行【建账】操作。\n    //--------------------校验账簿余额的平衡性--------------------------\n    Wb.request({\n      url: '{#contextPath#}/periodBalanceManageAction.do?method=checkTheBalance',\n      message: '{#la_checkBalanceTip#}',\n      params: {\n        'ledgerId': app.ledgerCombo.getValue(),\n        'periodCode': queryPeriod,\n        'isBuild': 'Y'\n      },\n      success: function(response, opts) {\n        var tmpObj = Wb.decode(response.responseText);\n        if (tmpObj.flag == \"1\") {\n          //===============借贷平衡，继续执行后续操作=====\n          Wb.confirm('{#la_confirmBuild#}', function() {\n            Wb.request({\n              url: '{#contextPath#}/sumBalanceAction.do?method=createOrCancelAccount',\n              params: {\n                'ledgerId': _ledgerId,\n                'isCanceled': 'N'\n              },\n              success: function(response, options) {\n                //--------取消建账成功的后续操作---------------------\n                var resultJson = Wb.decode(response.responseText);\n                Wb.info(resultJson.msg, function() {\n                  //取消建账成功，重新载入当前页面/页签\n                  if (app.funTabPanel) {\n                    var funUrl = app.funTabPanel.selectedTab.bindFile;\n                    Wb.open({\n                      url: funUrl,\n                      title: app.funTabPanel.selectedTab.title,\n                      reload: true,\n                      container: app.funTabPanel.tabPanel\n                    });\n                  } else {\n                    window.location.reload();\n                  }\n                });\n              },\n              failure: function(response, options) {\n                //------建账失败---------\n                Wb.info('{#la_buildFailure#}');\n              }\n            });\n          });\n        } else {\n          //余额不平衡,弹出余额平衡检验窗口\n           app.balanceBtn.fireEvent('click');\n        }\n      },\n      failure: function(response, opts) {\n        Wb.warn('{#la_tmpTip1#}');\n        app.initBalanceGrid.getStore().load();\n      }\n    });\n  }\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item5"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#la_importBtn#}","itemId":"importBtn","iconCls":"ok_icon"},"events":{"click":"if(Ext.isEmpty(app.ledgerCombo.getValue())){\n    Wb.info('{#la_chooseLedgerTip#}');\n}else{\n  var win = new Ext.window.Window(app._importBalanceWin);\n  win.show();\n}\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item6"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#la_exportBtn#}","hidden":"true","itemId":"exportBtn","iconCls":"export_icon"},"events":{"click":"if(Ext.isEmpty(app.ledgerCombo.getValue())){\n    Wb.info('{#la_chooseLedgerTip#}');\n}else{\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"->","itemId":"item9"},"children":[],"expanded":true,"type":"item"},{"configs":{"text":"{#la_downloadModule#}","itemId":"downMoudle","iconCls":"down_icon"},"events":{"click":"  if(Ext.isEmpty(app.ledgerCombo.getValue())){\n    Wb.info('{#la_chooseLedgerTip#}');\n    return false;\n  }else{\n    window.location.href = '{#contextPath#}/periodBalanceManageAction.do?method=downloadBalanceModel&modelType=MID_BALANCES';\n  }\n  \n"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"midYearBar"},"children":[{"configs":{"text":"-","itemId":"item2"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#la_addBtn#}","itemId":"addBalanceM","iconCls":"plus_icon"},"events":{"click":"if(!Ext.isEmpty(app.ledgerCombo.getValue())){\n  Wb.addEdit(app.midBalanceGrid,{'IS_VALID':'N','AMT_YTD_DR':0,'DEBIT_OR_AMOUNT':0,'YTD_DR':0,'AMT_YTD_CR':0,'CREBIT_OR_AMOUNT':0,'YTD_CR':0,'PRRIOD_AMOUNT':0,'PERIOD_OR_BALANCE':0,'PRRIOD_BALANCE':0});\n}else{\n  Wb.info('{#la_chooseLedgerTip#}');\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item8"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#la_delBtn#}","itemId":"delBalanceM","iconCls":"minus_icon"},"events":{"click":"var records = app.midBalanceGrid.getSelection();\nif(records.length === 0){\n  Wb.warn('{#la_selectTips#}');\n  return false;\n}\nvar ids = '';\nExt.each(records,function(r){\n  ids += '\\''+r.data.ID+'\\',';\n});\nids = ids.substring(0,ids.length-1);\nWb.confirm('{#la_confirmTips#}',function(){\n  Wb.request({\n    url:'m?xwl=xc/gl/b-balances/acc-ba/data/delBalances',\n    params:{'IDS':ids},\n    success:function(){\n      Wb.info('{#la_delSuccessTips#}');\n      Wb.remove(app.midBalanceGrid);\n    },\n    failure:function(){\n      Wb.info('{#la_delFailureTips#}');\n    }\n  });\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item0"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#la_saveBtn#}","itemId":"saveBalanceM","iconCls":"save_icon"},"events":{"click":"//账簿开始期间为年初\nvar insertArray = [];\nvar updateArray = [];\nvar _ledgerId = app.ledgerCombo.getValue();\nvar _comboRecord = app.ledgerCombo.findRecord('LEDGER_ID',_ledgerId);\nvar records = app.midBalanceGrid.getStore().getModifiedRecords();\nif(records.length === 0){\n  return false;\n}\n//保存之前需县校验所有的必填项是否已经填写\nvar isValid = true;\nExt.each(records,function(item){\n  //累借、累贷、期末余额不能同时为空！\n  if(Ext.isEmpty(item.data.CCID) ||(Ext.isEmpty(item.data.PRRIOD_BALANCE) && Ext.isEmpty(item.data.YTD_DR) && Ext.isEmpty(item.data.YTD_CR))){\n    isValid = false;\n    return ;\n  }\n    var _addJson = {'ID':'',\n                    'LEDGER_ID':_ledgerId,\n                    'CCID':item.data.CCID,\n                    'PERIOD_CODE':queryPeriod,\n                    'CURRENCY_CODE':_comboRecord.data.CURRENCY_CODE,  //本位币币种\n                    'ENTER_CNY_CODE':item.data.ENTER_CNY_CODE,        //原币币种\n                    'IS_VALID':'N',\n                    'Y_DR':0.000000,                //年初借方余额 \n                    'Y_CR':0.000000,                //年初贷方余额 \n                    'T_Y_DR':0.000000,              //年初原币借方余额 \n                    'T_Y_CR':0.000000,              //年初原币贷方余额 \n                    'AMT_Y_DR':0.000000,            //年初借方数量 \n                    'AMT_Y_CR':0.000000,            //年初贷方数量\n                                        \n                    'PTD_DR':0.000000,              //本期借方累计金额 \n                    'T_PTD_DR':0.000000,            //本期借方累计原币金额 \n                    'AMT_PTD_DR':0.000000,          //本期借方累计数量\n                    \n                    'PTD_CR':0.000000,              //本期贷方累计金额 \n                    'T_PTD_CR':0.000000,            //本期贷方累计原币金额 \n                    'AMT_PTD_CR':0.000000,          //本期贷方累计数量\n                    \n                    \n                    'YTD_DR':0.000000,              //借方累计金额 \n                    'T_YTD_DR':0.000000,            //借方累计原币金额 \n                    'AMT_YTD_DR':0.000000,          //借方累计数量\n                    \n                    'YTD_CR':0.000000,              //贷方累计金额 \n                    'T_YTD_CR':0.000000,            //贷方累计原币金额 \n                    'AMT_YTD_CR':0.000000,          //贷方累计数量\n                    \n                    'AMT_PJTD_DR':0.000000,         //期末数量借方\n                    'AMT_PJTD_CR':0.000000,         //期末数量贷方\n                    'PJTD_DR'    :0.000000,         //期末借方余额\n                    'PJTD_CR'    :0.000000,         //期末贷方余额\n                    'T_PJTD_DR'  :0.000000,         //期末借方原币余额\n                    'T_PJTD_CR'  :0.000000,          //期末贷方原币余额\n                    \n                    'B_DR':0.000000,                //期初借方余额\n                    'B_CR':0.000000,                //期初贷方余额\n                    'AMT_B_DR':0.000000,            //期初借方数量\n                    'AMT_B_CR':0.000000,            //期初贷方数量\n                    'T_B_DR':0.000000,              //期初借方原币余额\n                    'T_B_CR':0.000000              //期初贷方原币余额\n                   };   \n      //=====================期末变量 期末借方余额、数量、原币=================\n      var _tmpDebitAmount = 0.000000;      \n      var _tmpAmtDebit = 0.000000;  \n      var _tmpDebitTAmount = 0.000000;    \n     //=====================期末变量 期末贷方余额、数量、原币=================\n      var _tmpCebitAmount = 0.000000;\n      var _tmpAmtCebit = 0.000000; \n      var _tmpCebitTAmount = 0.000000;  \n       if((item.data.BALANCE_DIRECTION+'') === '1'){\n         if(!Ext.isEmpty(item.data.YTD_CR)){\n            _tmpCebitAmount = Ext.Number.toFixed(item.data.YTD_CR,6); \n            _tmpDebitAmount =  numberAdd(Ext.Number.toFixed(item.data.PRRIOD_BALANCE,6),Ext.Number.toFixed(item.data.YTD_CR,6));\n         }else{\n            _tmpDebitAmount = Ext.Number.toFixed(item.data.PRRIOD_BALANCE,6); \n         }\n       }else{\n         if(!Ext.isEmpty(item.data.YTD_DR)){\n           _tmpDebitAmount = Ext.Number.toFixed(item.data.YTD_DR,6); \n           _tmpCebitAmount =  numberAdd(Ext.Number.toFixed(item.data.PRRIOD_BALANCE,6),Ext.Number.toFixed(item.data.YTD_DR,6));   \n         }else{\n            _tmpCebitAmount = Ext.Number.toFixed(item.data.PRRIOD_BALANCE,6);\n         }\n       }     \n      //=====================累计借方=====================\n      if(!Ext.isEmpty(item.data.YTD_DR)){\n       _addJson.YTD_DR = Ext.Number.toFixed(item.data.YTD_DR,6);                 \n       _addJson.PTD_DR = Ext.Number.toFixed(item.data.YTD_DR,6); \n        \n      }\n      if((item.data.IS_AMOUNT+'') ==='1'){\n        if(!Ext.isEmpty(item.data.AMT_YTD_DR)){\n           _addJson.AMT_YTD_DR =  Ext.Number.toFixed(item.data.AMT_YTD_DR,6);       \n           _addJson.AMT_PTD_DR =  Ext.Number.toFixed(item.data.AMT_YTD_DR,6);\n        }\n        //重新计算借贷方数量的期末数\n        if((item.data.BALANCE_DIRECTION+'') === '1'){\n          if(!Ext.isEmpty(item.data.AMT_YTD_CR)){\n            _tmpAmtCebit = Ext.Number.toFixed(item.data.AMT_YTD_CR,6);\n            _tmpAmtDebit = numberAdd(Ext.Number.toFixed(item.data.PRRIOD_AMOUNT,6),Ext.Number.toFixed(item.data.AMT_YTD_CR,6));\n          }else{\n            _tmpAmtDebit = Ext.Number.toFixed(item.data.PRRIOD_AMOUNT,6);\n          }\n        }else if((item.data.BALANCE_DIRECTION+'') === '-1'){\n           if(!Ext.isEmpty(item.data.AMT_YTD_DR)){\n              _tmpAmtDebit = Ext.Number.toFixed(item.data.AMT_YTD_DR,6);\n              _tmpAmtCebit = numberAdd(Ext.Number.toFixed(item.data.PRRIOD_AMOUNT,6),Ext.Number.toFixed(item.data.AMT_YTD_DR,6));\n           }else{\n              _tmpAmtCebit = Ext.Number.toFixed(item.data.PRRIOD_AMOUNT,6);\n           }\n        }\n      }\n      if(!Ext.isEmpty(item.data.DEBIT_OR_AMOUNT)){\n        _addJson.T_YTD_DR =  Ext.Number.toFixed(item.data.DEBIT_OR_AMOUNT,6);    //累计借方原币金额\n        _addJson.T_PTD_DR =  Ext.Number.toFixed(item.data.DEBIT_OR_AMOUNT,6); \n      }\n      //重新计算借贷方原币的期末数\n      if((item.data.BALANCE_DIRECTION+'') === '1'){\n         if(!Ext.isEmpty(item.data.CREBIT_OR_AMOUNT)){\n            _tmpCebitTAmount = Ext.Number.toFixed(item.data.CREBIT_OR_AMOUNT,6);\n            _tmpDebitTAmount = numberAdd(Ext.Number.toFixed(item.data.PERIOD_OR_BALANCE,6),Ext.Number.toFixed(item.data.CREBIT_OR_AMOUNT,6));\n         }else{\n           _tmpDebitTAmount = Ext.Number.toFixed(item.data.PERIOD_OR_BALANCE,6);\n         }\n      }else if((item.data.BALANCE_DIRECTION+'') === '-1'){\n         if(!Ext.isEmpty(item.data.DEBIT_OR_AMOUNT)){\n            _tmpDebitTAmount = Ext.Number.toFixed(item.data.DEBIT_OR_AMOUNT,6);\n            _tmpCebitTAmount = numberAdd(Ext.Number.toFixed(item.data.PERIOD_OR_BALANCE,6),Ext.Number.toFixed(item.data.DEBIT_OR_AMOUNT,6));\n         }else{\n            _tmpCebitTAmount = Ext.Number.toFixed(item.data.PERIOD_OR_BALANCE,6);\n         }\n      }\n      //=====================累计贷方=====================\n      if(!Ext.isEmpty(item.data.YTD_CR)){\n       _addJson.YTD_CR = Ext.Number.toFixed(item.data.YTD_CR,6);                 //累计贷方金额\n       _addJson.PTD_CR = Ext.Number.toFixed(item.data.YTD_CR,6);\n      }\n      if(item.data.IS_AMOUNT ==='1' && !Ext.isEmpty(item.data.AMT_YTD_CR,6)){\n        _addJson.AMT_YTD_CR =  Ext.Number.toFixed(item.data.AMT_YTD_CR,6);       //累计贷方数量\n        _addJson.AMT_PTD_CR =  Ext.Number.toFixed(item.data.AMT_YTD_CR,6);\n      } \n      if(!Ext.isEmpty(item.data.CREBIT_OR_AMOUNT)){\n        _addJson.T_YTD_CR =  Ext.Number.toFixed(item.data.CREBIT_OR_AMOUNT,6);    //累计贷方原币金额\n        _addJson.T_PTD_CR =  Ext.Number.toFixed(item.data.CREBIT_OR_AMOUNT,6);\n      }\n    if((item.data.BALANCE_DIRECTION+'') === '1'){\n      //===================================借方=================================\n      //================================期末余额=================================\n      if(!Ext.isEmpty(item.data.PRRIOD_BALANCE)){\n       _addJson.PJTD_DR = _tmpDebitAmount;          //期末借方余额\n       _addJson.PJTD_CR = _tmpCebitAmount;          //期末贷方余额\n      }\n      if(item.data.IS_AMOUNT ==='1' && !Ext.isEmpty(item.data.PRRIOD_AMOUNT)){\n        _addJson.AMT_PJTD_DR =  _tmpAmtDebit;      //数量\n        _addJson.AMT_PJTD_CR =  _tmpAmtCebit;\n      }\n      if(!Ext.isEmpty(item.data.PERIOD_OR_BALANCE)){\n        _addJson.T_PJTD_DR =  _tmpDebitTAmount;   //金额\n        _addJson.T_PJTD_CR =  _tmpCebitTAmount;\n      }\n      //================================年初余额=================================\n      if(!Ext.isEmpty(item.data.YEAR_BALANCE)){\n       _addJson.Y_DR = Ext.Number.toFixed(item.data.YEAR_BALANCE,6);          //年初借方余额\n       _addJson.B_DR = Ext.Number.toFixed(item.data.YEAR_BALANCE,6);          //年初借方余额\n      }\n      if(item.data.IS_AMOUNT ==='1' && !Ext.isEmpty(item.data.YEAR_AMOUNT)){\n        _addJson.AMT_Y_DR =  Ext.Number.toFixed(item.data.YEAR_AMOUNT,6);     //借方数量\n        _addJson.AMT_B_DR =  Ext.Number.toFixed(item.data.YEAR_AMOUNT,6); \n      }\n      if(!Ext.isEmpty(item.data.YEAR_OR_BALANCE)){\n        _addJson.T_Y_DR =  Ext.Number.toFixed(item.data.YEAR_OR_BALANCE,6);   //借方原币金额\n        _addJson.T_B_DR =  Ext.Number.toFixed(item.data.YEAR_OR_BALANCE,6);\n      }\n    }else{\n      //===================================贷方=================================\n      //================================期末余额=================================\n      if(!Ext.isEmpty(item.data.PRRIOD_BALANCE)){\n       _addJson.PJTD_DR = _tmpDebitAmount;          //期末借方余额\n       _addJson.PJTD_CR = _tmpCebitAmount;          //期末贷方余额\n      }\n      if(item.data.IS_AMOUNT ==='1' && !Ext.isEmpty(item.data.PRRIOD_AMOUNT)){\n        _addJson.AMT_PJTD_DR =  _tmpAmtDebit;      //数量\n        _addJson.AMT_PJTD_CR =  _tmpAmtCebit;\n      }\n      if(!Ext.isEmpty(item.data.PERIOD_OR_BALANCE)){\n        _addJson.T_PJTD_DR =  _tmpDebitTAmount;   //金额\n        _addJson.T_PJTD_CR =  _tmpCebitTAmount;\n      }\n      //================================年初余额=================================\n      if(!Ext.isEmpty(item.data.YEAR_BALANCE)){\n       _addJson.Y_CR = Ext.Number.toFixed(item.data.YEAR_BALANCE,6);              //年初贷方余额\n       _addJson.B_CR = Ext.Number.toFixed(item.data.YEAR_BALANCE,6);              //年初贷方余额\n      }\n      if(item.data.IS_AMOUNT ==='1' && !Ext.isEmpty(item.data.YEAR_AMOUNT)){\n        _addJson.AMT_Y_CR =  Ext.Number.toFixed(item.data.YEAR_AMOUNT,6);         //年初贷方数量    \n        _addJson.AMT_B_CR =  Ext.Number.toFixed(item.data.YEAR_AMOUNT,6);            //期初贷方数量\n      }\n      if(!Ext.isEmpty(item.data.YEAR_OR_BALANCE)){\n        _addJson.T_Y_CR =  Ext.Number.toFixed(item.data.YEAR_OR_BALANCE,6);       //年初贷方原币金额\n        _addJson.T_B_CR =  Ext.Number.toFixed(item.data.YEAR_OR_BALANCE,6);       \n      }\n    }\n    /*======================================================*/\n    //====================新增的数据==========================\n    /*======================================================*/\n  if(Ext.isEmpty(item.data.ID)){\n    insertArray.push(_addJson);\n    /*======================================================*/\n    //====================修改的数据==========================\n    /*======================================================*/\n  }else{\n    _addJson.ID = item.data.ID;\n     updateArray.push(_addJson);\n  }\n});\nif(!isValid){\n  Wb.info('{#la_fillAllTips#}');\n  return false;\n}\n//==========数据处理完毕,保存当前修改的数据===========================\n//=================判断当前账簿是否处于建账状态======================\nWb.request({\n  url:'m?xwl=xc/gl/b-balances/acc-ba/data/checkIsBulidAccount',\n  params:{'ledgerId':_ledgerId},\n  success:function(response,options){\n      var obj = Wb.decode(response.responseText);\n      if(obj.isBuild === 1){\n         Wb.info('{#la_buildTips#}',function(){\n            app.midBalanceGrid.getStore().load();\n         });  \n     }else{\n       Wb.request({\n          url:'m?xwl=xc/gl/b-balances/acc-ba/data/insertMidBalance',\n          params:{'insertArray':Wb.encode(insertArray),'updateArray':Wb.encode(updateArray)},\n          success:function(){\n             Wb.info('{#la_saveSuccessTips#}',function(){\n                app.midBalanceGrid.getStore().load();\n             });\n           },\n          failure:function(response,options){\n                Wb.info('{#la_saveFailureTips#}');\n           }\n});     \n }\n    },\n  failure:function(response,options){\n    Wb.info('{#la_saveSuccessTips#}',function(){\n      app.midBalanceGrid.getStore().load();\n    });\n    \n  }\n});\n\n\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#la_balanceBtn#}","itemId":"balanceBtnM","iconCls":"measure_icon"},"events":{"click":"/**\n *校验当前账簿下的余额录入是否满足借贷平衡，平衡校验时必须从数据库中取当前时间点的数据,必须是已经保存的记录\n */\nvar modifyRecords = app.midBalanceGrid.getStore().getModifiedRecords();\nif(Ext.isEmpty(app.ledgerCombo.getValue())){\n   Wb.info('{#la_chooseLedgerTip#}');\n}else if(!Ext.isEmpty(modifyRecords) && modifyRecords.length>0){\n   Wb.info('{#la_saveFirstTip#}');\n}else{\n    var win = new Ext.window.Window(app._checkBalanceWin);\n    win.show();\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item3"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#la_bulidAccont#}","itemId":"buildAccountM","iconCls":"lock_icon"},"events":{"click":"/*\n *建账前的操作：\n *1、检查当前账簿是否处在建账状态\n *2、检查当前账簿期间的余额是否平衡\n *3、检查当前操作是否已保存\n *取消建账前的操作：\n *1、检查当前账簿是否正在执行建账/取消建账操作\n *2、检查当前账簿是否已经处于未建账状态\n */\nvar modifyRecords = app.midBalanceGrid.getStore().getModifiedRecords();\nif (Ext.isEmpty(app.ledgerCombo.getValue())){\n  Wb.info('{#la_chooseLedgerTip#}');\n}else if (!Ext.isEmpty(modifyRecords) && modifyRecords.length > 0){\n  Wb.info('{#la_saveFirstTip#}');\n}else {\n  var _ledgerId = app.ledgerCombo.getValue();\n  /*-------------取消建账操作-----------*/\n  if (accountBuild !== 0) {\n    //如果账簿已经处在【非建账】状态，或者账簿正在执行【建账】操作，不允许执行【取消建账】操作，只有账簿处于【建账】状态，才执行【取消建账】操作\n    //---------------------建账/取消建账操作 同步操作 --------------\n    Wb.confirm('{#la_confirmCancel#}', function() {\n      Wb.request({\n        url: '{#contextPath#}/sumBalanceAction.do?method=createOrCancelAccount',\n        params: {\n          'ledgerId': _ledgerId,\n          'isCanceled': 'Y'\n        },\n        success: function(response, options) {\n          //--------取消建账成功的后续操作---------------------\n          var resultJson = Wb.decode(response.responseText);\n          Wb.info(resultJson.msg, function() {\n            //取消建账成功，重新载入当前页面/页签\n            if (app.funTabPanel) {\n              var funUrl = app.funTabPanel.selectedTab.bindFile;\n              Wb.open({\n                url: funUrl,\n                title: app.funTabPanel.selectedTab.title,\n                reload: true,\n                container: app.funTabPanel.tabPanel\n              });\n            } else {\n              window.location.reload();\n            }\n          });\n        },\n        failure: function(response, options) {\n          //------------取消建账失败后的操作-----------------\n          Wb.info('{#la_cancelBuild#}');\n        }\n      });\n    });\n\n  } else {\n    /*-----------建账操作--------------*/\n    //如果账簿正处在【建账】状态，或者账簿正在执行【建账】操作，不允许执行【建账】操作，只有账簿处在【非建账】状态，才能执行【建账】操作。\n    //--------------------校验账簿余额的平衡性--------------------------\n    Wb.request({\n      url: '{#contextPath#}/periodBalanceManageAction.do?method=checkTheBalance',\n      message: '{#la_checkBalanceTip#}',\n      params: {\n        'ledgerId': app.ledgerCombo.getValue(),\n        'periodCode': queryPeriod,\n        'isBuild': 'Y'\n      },\n      success: function(response, opts) {\n        var tmpObj = Wb.decode(response.responseText);\n        if (tmpObj.flag == \"1\") {\n          //===============借贷平衡，继续执行后续操作=====\n          Wb.confirm('{#la_confirmBuild#}', function() {\n            Wb.request({\n              url: '{#contextPath#}/sumBalanceAction.do?method=createOrCancelAccount',\n              timeout:60*60*1000,\n              params: {\n                'ledgerId': _ledgerId,\n                'isCanceled': 'N'\n              },\n              success: function(response, options) {\n                //--------取消建账成功的后续操作---------------------\n                var resultJson = Wb.decode(response.responseText);\n                Wb.info(resultJson.msg, function() {\n                  //取消建账成功，重新载入当前页面/页签\n                  if (app.funTabPanel) {\n                    var funUrl = app.funTabPanel.selectedTab.bindFile;\n                    Wb.open({\n                      url: funUrl,\n                      title: app.funTabPanel.selectedTab.title,\n                      reload: true,\n                      container: app.funTabPanel.tabPanel\n                    });\n                  } else {\n                    window.location.reload();\n                  }\n                });\n              },\n              failure: function(response, options) {\n                //------建账失败---------\n                Wb.info('{#la_buildFailure#}');\n              }\n            });\n          });\n        } else {\n          //余额不平衡,弹出余额平衡检验窗口\n        app.balanceBtnM.fireEvent('click');\n        }\n      },\n      failure: function(response, opts) {\n        Wb.warn('{#la_tmpTip1#}');\n        app.midBalanceGrid.getStore().load();\n      }\n    });\n  }\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item5"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#la_importBtn#}","itemId":"importBtnM","iconCls":"ok_icon"},"events":{"click":"app.importBtn.fireEvent('click');"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"-","itemId":"item6"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"{#la_exportBtn#}","hidden":"true","itemId":"exportBtnM","iconCls":"export_icon"},"events":{"click":"if(Ext.isEmpty(app.ledgerCombo.getValue())){\n    Wb.info('{#la_chooseLedgerTip#}');\n}else{\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"->","itemId":"item9"},"children":[],"expanded":true,"type":"item"},{"configs":{"text":"{#la_downloadModule#}","itemId":"downMoudleM","iconCls":"down_icon"},"events":{"click":"  if(Ext.isEmpty(app.ledgerCombo.getValue())){\n    Wb.info('{#la_chooseLedgerTip#}');\n    return false;\n  }else{\n    window.location.href = '{#contextPath#}/periodBalanceManageAction.do?method=downloadBalanceModel&modelType=MID_BALANCES';\n  }"},"children":[],"expanded":false,"type":"item"}],"expanded":true,"type":"toolbar"}],"expanded":false,"type":"folder"},{"configs":{"itemId":"windows"},"children":[{"configs":{"maximized":"true","title":"{#la_downTitle#}","height":"400","minimizable":"true","width":"750","layout":"border","dialog":"false","border":"false","itemId":"importBalanceWin","modal":"true","maximizable":"true","createInstance":"false"},"children":[{"configs":{"region":"center","frame":"true","style":"border-width:0px","layout":"column","padding":"15 0 0 5","border":"false","itemId":"importForm"},"children":[{"configs":{"labelWidth":"80","allowBlank":"false","emptyText":"{#la_emptyContent#}","labelAlign":"left","itemId":"selectFile","fieldLabel":"{#la_chooseFile#}"},"children":[],"expanded":false,"type":"file"},{"configs":{"text":"{#la_importBtn#}","itemId":"importFile","iconCls":"db_import_icon","x":"2"},"events":{"click":"if(!app.importForm.getForm().isValid()){\n  Wb.info('{#la_chooseFileTip#}');\n  return false;\n}\nvar fileType = app.selectFile.getValue();\nif(!Ext.String.endsWith(fileType,'.xls') && !Ext.String.endsWith(fileType,'.xlsx')){\n  Wb.info('{#la_officeTip#}',function(){\n    app.importForm.getForm().reset();\n  });\n}else{\n  //导入前，先清除错误数据\n  app.dupGrid.getStore().removeAll();\n  app.errorGrid.getStore().removeAll();\n  var msgProcessBar = Ext.Msg.show({\n     title:'{#la_tmpTip2#}',\n     msg  :'{#la_processing#}',\n     wait :true,\n     width:200\n  });\n  //将Office Excel数据导入到余额临时表中\n  app.importForm.getForm().submit({\n    url:'{#contextPath#}/periodBalanceManageAction.do?method=importBalances&ledgerId='+app.ledgerCombo.getValue()+'&periodCode='+queryPeriod+'&balanceType='+queryType,\n    timeout:3600*1000,\n    success:function(form,action){\n      msgProcessBar.hide();\n      Wb.info(action.result.msg,function(){\n        app.importBalanceWin.close();\n        app.queryBtn.fireEvent('click');\n      });\n    },\n    failure:function(form,action){\n      var returnObj = Wb.decode(action.response.responseText);\n      if(returnObj.tag === 0){\n        Wb.info('{#la_importIllegal#}');\n        app.southTab.setActiveTab(1);\n        app.errorGrid.getStore().getProxy().extraParams.ledgerId = app.ledgerCombo.getValue();\n        app.errorGrid.getStore().getProxy().extraParams.sessionId = returnObj.msg;\n        app.errorGrid.getStore().load();\n      }else if(returnObj.tag === 1){\n         Wb.info(action.result.msg);\n      }else if(returnObj.tag === 2){\n         Wb.info(action.result.msg);\n        app.southTab.setActiveTab(0);\n        app.dupGrid.getStore().getProxy().extraParams.ledgerId = app.ledgerCombo.getValue();\n        app.dupGrid.getStore().getProxy().extraParams.sessionId = returnObj.sessionId;\n        app.dupGrid.getStore().getProxy().extraParams.periodCode = queryPeriod;\n        app.dupGrid.getStore().load();\n      }\n    }   \n  });\n}"},"children":[],"expanded":false,"type":"button"}],"expanded":false,"type":"form"},{"configs":{"region":"south","height":"'88%'","itemId":"southTab"},"children":[{"configs":{"title":"{#la_duliptyData#}","selType":"checkboxmodel","itemId":"dupGrid"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#la_account#}","itemId":"E_ACCOUNT"},"children":[{"configs":{"text":"{#la_accountCode#}","dataIndex":"SEGMENT01","itemId":"E_ACCOUNT_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accountName#}","dataIndex":"SEGMENT01_NAME","itemId":"E_ACCOUNT_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_vendor#}","itemId":"E_VENDOR"},"children":[{"configs":{"text":"{#la_accountCode#}","dataIndex":"SEGMENT02","itemId":"E_VENDOR_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accountName#}","dataIndex":"SEGMENT02_NAME","itemId":"E_VENDOR_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_customer#}","itemId":"E_CUATOMER"},"children":[{"configs":{"text":"{#la_accountCode#}","dataIndex":"SEGMENT03","itemId":"E_CUST_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accountName#}","dataIndex":"SEGMENT03_NAME","itemId":"E_CUST_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_product#}","itemId":"E_PRODUCT"},"children":[{"configs":{"text":"{#la_accountCode#}","dataIndex":"SEGMENT04","itemId":"E_PRODUCT_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accountName#}","dataIndex":"SEGMENT04_NAME","itemId":"E_PRODUCT_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_organization#}","itemId":"E_INNER"},"children":[{"configs":{"text":"{#la_accountCode#}","dataIndex":"SEGMENT05","itemId":"E_INNER_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accountName#}","dataIndex":"SEGMENT05_NAME","itemId":"E_INNER_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_pperson#}","itemId":"E_PERSON"},"children":[{"configs":{"text":"{#la_accountCode#}","dataIndex":"SEGMENT06","itemId":"E_PERSON_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accountName#}","dataIndex":"SEGMENT06_NAME","itemId":"E_PERSON_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_errorMsg#}","width":"300","dataIndex":"ERROR_MSG","itemId":"E_MSG","renderer":"return '{#la_duplicateImport#}';"},"children":[],"expanded":false,"type":"column"}],"expanded":false,"type":"array"},{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/b-balances/acc-ba/data/getDuplicate"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"grid"},{"configs":{"title":"{#la_illegalData#}","selType":"checkboxmodel","itemId":"errorGrid"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#la_account#}","itemId":"E_ACCOUNT"},"children":[{"configs":{"text":"{#la_accountCode#}","dataIndex":"SEGMENT01","itemId":"E_ACCOUNT_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accountName#}","dataIndex":"SEGMENT01_NAME","itemId":"E_ACCOUNT_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_vendor#}","itemId":"E_VENDOR"},"children":[{"configs":{"text":"{#la_accountCode#}","dataIndex":"SEGMENT02","itemId":"E_VENDOR_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accountName#}","dataIndex":"SEGMENT02_NAME","itemId":"E_VENDOR_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_customer#}","itemId":"E_CUATOMER"},"children":[{"configs":{"text":"{#la_accountCode#}","dataIndex":"SEGMENT03","itemId":"E_CUST_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accountName#}","dataIndex":"SEGMENT03_NAME","itemId":"E_CUST_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_product#}","itemId":"E_PRODUCT"},"children":[{"configs":{"text":"{#la_accountCode#}","dataIndex":"SEGMENT04","itemId":"E_PRODUCT_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accountName#}","dataIndex":"SEGMENT04_NAME","itemId":"E_PRODUCT_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_organization#}","itemId":"E_INNER"},"children":[{"configs":{"text":"{#la_accountCode#}","dataIndex":"SEGMENT05","itemId":"E_INNER_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accountName#}","dataIndex":"SEGMENT05_NAME","itemId":"E_INNER_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_pperson#}","itemId":"E_PERSON"},"children":[{"configs":{"text":"{#la_accountCode#}","dataIndex":"SEGMENT06","itemId":"E_PERSON_CODE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accountName#}","dataIndex":"SEGMENT06_NAME","itemId":"E_PERSON_NAME"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_errorMsg#}","width":"300","dataIndex":"ERROR_MSG","itemId":"E_MSG","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:10px;';   \nreturn '<font color=\"red\">'+value+'<\/font>';"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/b-balances/acc-ba/data/getInvalidData"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"tab"}],"expanded":true,"type":"window"},{"configs":{"title":"{#la_balanceWinTitle#}","height":"400","minimizable":"true","width":"750","layout":"border","dialog":"false","border":"false","itemId":"checkBalanceWin","modal":"true","maximizable":"true","createInstance":"false"},"events":{"show":"app.checkGrid.getStore().load({\n  params:{'ledgerId':app.ledgerCombo.getValue(),'periodCode':queryPeriod}});"},"children":[{"configs":{"region":"center","pagingBar":"false","selType":"checkboxmodel","itemId":"checkGrid"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#la_accountCategory#}","width":"250","dataIndex":"CATOGERY_NAME","itemId":"CATOGERY_NAME"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_money#}","width":"250","xtype":"numbercolumn","dataIndex":"CATOGERY_AMOUNT","itemId":"CATOGERY_AMOUNT"},"children":[],"expanded":true,"type":"column"},{"configs":{"hidden":"true","dataIndex":"CATOGERY_STATUS","itemId":"CATOGERY_STATUS"},"children":[],"expanded":true,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"pageSize":"-1","autoLoad":"false","itemId":"store","url":"{#contextPath#}/periodBalanceManageAction.do?method=checkTheBalance"},"events":{"load":"if (records.length > 0 && queryType == 'INIT') {\n   var _tmpObj = records[0];\n  if(_tmpObj.data.CATOGERY_STATUS == \"1\"){\n     Wb.info('{#la_equalTip#}');\n    var _resultTitle = '{#la_equalFormual#}'+'0';     \n    app.showResult.setText(_resultTitle,false);\n  }else{\n    Wb.info('{#la_unequalTip#}');\n    var _amount1 = numberAdd(records[1].data.CATOGERY_AMOUNT,records[2].data.CATOGERY_AMOUNT); \n    var _amount2 = numberSub( _tmpObj.data.CATOGERY_AMOUNT,_amount1);\n    var _resultTitle = '{#la_equalFormual#} '+_amount2;     \n    app.showResult.setText(_resultTitle,false);\n  }\n}else if(records.length > 0 && queryType !== 'INIT'){\n    var _tmpObj = records[0];\n  if(_tmpObj.data.CATOGERY_STATUS == \"1\"){\n     Wb.info('{#la_equalTip#}');\n     var _resultTitle = '{#la_midEqual#}'+'0';     \n     app.showResult.setText(_resultTitle,false);\n  }else{\n    Wb.info('{#la_unequalTip#}');\n    var _amount1 = numberAdd(records[2].data.CATOGERY_AMOUNT,_tmpObj.data.CATOGERY_AMOUNT);\n    var _amount2 = numberAdd(records[1].data.CATOGERY_AMOUNT,records[4].data.CATOGERY_AMOUNT);\n    var _amount3 = numberAdd(_amount2,records[3].data.CATOGERY_AMOUNT);\n    var _finalAmount = numberSub(_amount1,_amount3);\n    var _resultTitle = '{#la_midEqual#}'+Ext.util.Format.number(Ext.Number.toFixed(parseFloat(_finalAmount),2),'0,000.00');   \n    app.showResult.setText(_resultTitle,false);\n  }\n  \n}"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"grid"},{"configs":{"region":"south","height":"100","layout":"fit","itemId":"resultPanel"},"children":[{"configs":{"style":"fontSize:10px;fontWeight:bold","itemId":"showResult"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"window"}],"expanded":false,"type":"folder"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","height":"'13%'","layout":"form","split":"false","itemId":"conditionSet"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-bo-border'","layout":"column","padding":"10 0 0 0","border":"false","itemId":"panel1"},"children":[{"configs":{"labelWidth":"70","displayField":"LEDGER_NAME","valueField":"LEDGER_ID","emptyText":"{#la_emptyLedger#}","labelAlign":"right","itemId":"ledgerCombo","fieldLabel":"{#la_ledgerLabel#}"},"events":{"select":"app.accGroupCombo.clearValue();\napp.accCombo.clearValue();\nvar whereSql = ' AND  ACC_HRCY_ID = \\''+records[0].data.ACC_HRCY_ID+'\\'';\nif(!Ext.isEmpty(app.accGroupCombo.getValue())){\n  whereSql +=' AND ACC_GROUP_ID =\\''+app.accGroupCombo.getValue()+'\\'';\n}\napp.accCombo.getStore().getProxy().extraParams.WHERESQL = whereSql;\napp.accCombo.getStore().load();\n//设置表格的显示标题 \nvar currentPeriod = records[0].data.START_PERIOD_CODE;\nvar isAccount = records[0].data.ESTABLISH_ACCOUNT;\n//建账 or 非建账操作\naccountBuild = isAccount;\nif(Ext.isEmpty(currentPeriod)){\n  currentPeriod = '{#la_null#}';\n}\nvar gridTitle = '<center><font size=\"4\" style=\"font-weight:bold;font-style:italic;\">{#la_changeTitle#}<\/font>&nbsp;&nbsp;&nbsp;&nbsp;{#la_currentPeriod#}：'+currentPeriod+'&nbsp;&nbsp;&nbsp;&nbsp;{#la_status#}：{#la_notBuild#}<\/center>';\nglobalTitle = '<center><font size=\"4\" style=\"font-weight:bold;font-style:italic;\">{#la_changeTitle#}<\/font>&nbsp;&nbsp;&nbsp;&nbsp;{#la_currentPeriod#}：'+currentPeriod+'&nbsp;&nbsp;&nbsp;&nbsp;{#la_status#}: ';\nif(isAccount !== 0){\n  gridTitle = '<center><font size=\"4\" style=\"font-weight:bold;font-style:italic;\">{#la_changeTitle#}<\/font>&nbsp;&nbsp;&nbsp;&nbsp;{#la_currentPeriod#}：'+currentPeriod+'&nbsp;&nbsp;&nbsp;&nbsp;{#la_status#}：{#la_haveBuild#}<\/center>';\n  if(queryType === 'INIT'){\n    app.addBalance.disable();\n    app.delBalance.disable();\n    app.saveBalance.disable();\n    app.balanceBtn.disable();\n    app.importBtn.disable();\n    app.exportBtn.disable();\n    app.buildAccount.setText('{#la_dismissBuild#}');\n  }else{\n    app.addBalanceM.disable();\n    app.delBalanceM.disable();\n    app.saveBalanceM.disable();\n    app.balanceBtnM.disable();\n    app.importBtnM.disable();\n    app.exportBtnM.disable();\n    app.buildAccountM.setText('{#la_dismissBuild#}');\n  }\n  \n}else{\n   if(queryType === 'INIT'){\n    app.addBalance.enable();\n    app.delBalance.enable();\n    app.saveBalance.enable();\n    app.balanceBtn.enable();\n    app.importBtn.enable();\n    app.exportBtn.enable();\n    app.buildAccount.setText('{#la_canBuild#}');\n  }else{\n    app.addBalanceM.enable();\n    app.delBalanceM.enable();\n    app.saveBalanceM.enable();\n    app.balanceBtnM.enable();\n    app.importBtnM.enable();\n    app.exportBtnM.enable();\n    app.buildAccountM.setText('{#la_canBuild#}');\n  }\n  \n}\napp.initBalanceGrid.setTitle(gridTitle);\napp.midBalanceGrid.setTitle(gridTitle);\napp.queryBtn.fireEvent('click');\n","beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}","beforeselect":"var selCode = record.data.START_PERIOD_CODE;\nif(!Ext.isEmpty(selCode)){\n  var periodYear = selCode.substring(0,selCode.indexOf('-'));\n  var periodMonth = selCode.substring(selCode.indexOf('-'),selCode.length);\n  var periodMonthF = selCode.substring(selCode.indexOf('-')+1,selCode.length-1);\n  var periodMonthL = selCode.substring(selCode.indexOf('-')+2,selCode.length);\n  if(Ext.String.endsWith(selCode,'-01')){\n    queryPeriod = (parseInt(periodYear)-1)+'-12';\n    queryType = 'INIT';\n    app.initBalanceGrid.show();\n    app.midBalanceGrid.hide();\n  }else{\n    if(parseInt(periodMonthL)>0){\n       queryPeriod = periodYear+'-'+periodMonthF+(parseInt(periodMonthL)-1);\n    }else{\n       queryPeriod = periodYear+'-'+(parseInt(periodMonthF)-1)+periodMonthL;\n    }\n    queryType = 'MID';\n    app.midBalanceGrid.show();\n    app.initBalanceGrid.hide();\n  }\n}"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/b-balances/acc-ba/data/getLedgers"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"},{"configs":{"labelWidth":"100","displayField":"ACC_GROUP_NAME","valueField":"ACC_GROUP_ID","labelAlign":"right","itemId":"accGroupCombo","fieldLabel":"{#la_accountGroup#}"},"events":{"select":"app.accCombo.clearValue();\nvar whereSql =''; \nif(!Ext.isEmpty(app.ledgerCombo.getValue())){\n  var ledgerRecord = app.ledgerCombo.findRecord('LEDGER_ID',app.ledgerCombo.getValue());\n   whereSql +=' AND ACC_HRCY_ID =\\''+ledgerRecord.data.ACC_HRCY_ID+'\\'';\n}\nwhereSql +=' AND ACC_GROUP_ID =\\''+app.accGroupCombo.getValue()+'\\'';\napp.accCombo.getStore().getProxy().extraParams.WHERESQL = whereSql;\napp.accCombo.getStore().load();","beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/b-balances/acc-ba/data/getAccGroup"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"},{"configs":{"labelWidth":"70","displayField":"ACC_NAME","valueField":"ACC_ID","labelAlign":"right","itemId":"accCombo","fieldLabel":"{#la_account#}"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/b-balances/acc-ba/data/getAccount"},"events":{"beforeload":"if(Ext.isEmpty(app.ledgerCombo.getValue())){\n  return false;\n}"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"},{"configs":{"text":"{#la_queryBtn#}","itemId":"queryBtn","iconCls":"seek_icon","x":"5"},"events":{"click":"if (Ext.isEmpty(app.ledgerCombo.getValue())) {\n  Wb.info('请先选择账簿!');\n  return false;\n}\nif (queryType == 'INIT') {\n  app.initBalanceGrid.getStore().load();\n} else {\n  app.midBalanceGrid.getStore().load();\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#la_resetBtn#}","itemId":"resetBtn","iconCls":"refresh_icon","x":"10"},"events":{"click":"app.initBalanceGrid.getStore().load();\napp.midBalanceGrid.getStore().load();\nWb.reset(app.conditionSet);   \n//展示年初表格\napp.midBalanceGrid.hide();\napp.initBalanceGrid.show();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-bo-border'","layout":"column","border":"false","padding":"0px 0px 0px 30px","itemId":"panel2"},"children":[{"configs":{"labelWidth":"70","width":"70","name":"otherOpt","labelAlign":"right","itemId":"allOpt","checked":"true","boxLabel":"{#la_all#}","handler":"if(value){\n  accCategory = 0;\n  app.queryBtn.fireEvent('click');\n}\n"},"children":[],"expanded":true,"type":"radio"},{"configs":{"width":"70","name":"otherOpt","itemId":"assetOpt","boxLabel":"{#la_asset#}","handler":"if(value){\n  accCategory = 1;\n  app.queryBtn.fireEvent('click');\n}\n"},"children":[],"expanded":false,"type":"radio"},{"configs":{"width":"70","name":"otherOpt","itemId":"liabilityOpt","boxLabel":"{#la_debit#}","handler":"if(value){\n  accCategory = 2;\n  app.queryBtn.fireEvent('click');\n}\n"},"children":[],"expanded":false,"type":"radio"},{"configs":{"width":"70","name":"otherOpt","itemId":"commonOpt","boxLabel":"{#la_common#}","handler":"if(value){\n  accCategory = 3;\n  app.queryBtn.fireEvent('click');\n}\n"},"children":[],"expanded":false,"type":"radio"},{"configs":{"width":"120","name":"otherOpt","itemId":"abilityOpt","boxLabel":"{#la_ability#}","handler":"if(value){\n  accCategory = 4;\n  app.queryBtn.fireEvent('click');\n}\n"},"children":[],"expanded":false,"type":"radio"},{"configs":{"width":"80","name":"otherOpt","itemId":"feeOpt","boxLabel":"{#la_cost#}","handler":"if(value){\n  accCategory = 5;\n  app.queryBtn.fireEvent('click');\n}\n"},"children":[],"expanded":false,"type":"radio"},{"configs":{"width":"70","name":"otherOpt","itemId":"decreasOpt","boxLabel":"{#la_lost#}","handler":"if(value){\n  accCategory = 6;\n  app.queryBtn.fireEvent('click');\n}\n"},"children":[],"expanded":false,"type":"radio"},{"configs":{"width":"120","name":"otherOpt","itemId":"sheetOpt","boxLabel":"{#la_offBalance#}","handler":"if(value){\n  accCategory = 8;\n  app.queryBtn.fireEvent('click');\n}\n"},"children":[],"expanded":false,"type":"radio"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"tbar":"app.midYearBar","region":"center","tagConfigs":"features: [{\n  id: 'gl_group',\n  ftype: 'grouping',\n  groupHeaderTpl: [\n     '{name}<span style=\"float:right\"><font color=\"red\">合计：{children:this.sumData}<\/font><\/span>',\n  {\n  sumData:function(values){\n   var _sumCrebitAmount = 0;\n   var _sumDebitAmount = 0;\n   var _sumAmountFlag = 1;\n   var _finalAmount = 0;\n   //SUM_DIRECTION\n   for(var i=0;i<values.length;i++){\n     _sumAmountFlag = values[i].data.SUM_DIRECTION;\n     if(values[i].data.BALANCE_DIRECTION == '1'){\n        _sumDebitAmount = numberAdd(_sumDebitAmount,values[i].data.PRRIOD_BALANCE);\n     }else{\n        _sumCrebitAmount = numberAdd(_sumCrebitAmount,values[i].data.PRRIOD_BALANCE);\n     }\n   }\n    _finalAmount = numberSub(_sumDebitAmount,_sumCrebitAmount)*_sumAmountFlag;\n    return Ext.util.Format.number(Ext.Number.toFixed(_finalAmount,2),'0,000.00');\n}\n}],\n  hideGroupedHeader: true,\n  enableGroupingMenu: false\n  \n}]\n","selType":"checkboxmodel","height":"'100%'","hidden":"true","itemId":"midBalanceGrid","editable":"true"},"events":{"tagEvents":"'cellclick':function(grid,td,cellIndex,record,tr,rowIndex,e,eOpts){\n  if((cellIndex == 9 || cellIndex == 12 || cellIndex == 16) && Ext.isEmpty(record.data.DIM_ID)){\n     return false;\n  }else if((cellIndex == 10 || cellIndex == 13 || cellIndex == 17) && (Ext.isEmpty(record.data.IS_FOREGIN_CNY) || record.data.IS_FOREGIN_CNY == 0)){\n    return false;\n  }\n}"},"children":[{"configs":{"groupField":"ACC_CATEGORY_NAME","pageSize":"-1","itemId":"store","url":"m?xwl=xc/gl/b-balances/acc-ba/data/getMidYearBalance"},"events":{"beforeload":"var whereSql = ' AND b.LEDGER_ID = \\''+app.ledgerCombo.getValue()+'\\'';\nif(!Ext.isEmpty(app.accGroupCombo.getValue())){\n  whereSql += ' AND a.ACC_GROUP_ID = \\''+app.accGroupCombo.getValue()+'\\'';\n}\nif(!Ext.isEmpty(app.accCombo.getValue())){\n   whereSql += ' AND c.ACC_ID = \\''+app.accCombo.getValue()+'\\'';\n}\nif(accCategory !==0){\n   whereSql += ' AND a.ACC_CATEGORY_CODE = \\''+accCategory+'\\'';\n}\nwhereSql +=' AND b.PERIOD_CODE = \\''+queryPeriod+'\\'';\nstore.getProxy().extraParams.WHERESQL = whereSql;"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#la_rownum#}","align":"center","xtype":"rownumberer","width":"50","itemId":"rowNumber"},"children":[],"expanded":false,"type":"column"},{"configs":{"hidden":"true","dataIndex":"CCID","itemId":"CCID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_ccidName#}","width":"350","itemId":"accColumn"},"children":[{"configs":{"text":"编码","hidden":"true","dataIndex":"CCID_CODE","itemId":"CCID_CODE","flex":"5"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"<font color='red'>*<\/font>名称","width":"350","dataIndex":"CCID_NAME","itemId":"CCID_NAME","renderer":"metaData.tdAttr = 'data-qtip=\"' + value + '\"';\nreturn value;"},"children":[{"configs":{"itemId":"editor"},"events":{"focus":"var _accName = '';\nvar _accCode = '';\nif(!Ext.isEmpty(app.accCombo.getRawValue())){\n  _accName = app.accCombo.getRawValue();\n}\nif(app.initBalanceGrid.getSelection().length !==0){\n  _accCode = app.midBalanceGrid.getSelection()[0].data.ACC_CODE;\n}\nWb.run({\n    url:'m?xwl=xc/gl/journal/v-windows/handler-ccid-win',\n    params : {\n      'ledgerId' : app.ledgerCombo.getValue()\n    },\n    success:function(appObj){\n      appObj.initWindow({\n        accName : _accCode,\n        ledgerId : app.ledgerCombo.getValue(),\n        groupId : 'ALL',\n        handlerCCID : function(returnObj){\n          //设置返回的科目id以及科目名称的直\n          returnObj = Wb.decode(returnObj);\n          //校验所选择的科目是否已经存在\n          var isExist = false;\n          var existRecords = app.midBalanceGrid.getStore();\n          existRecords.each(function(_tmp){\n            if(_tmp.data.CCID === returnObj.acc_ccid){\n               isExist = true;\n               return false;\n            }\n          });\n          if(isExist){\n            Wb.info('科目已存在,请重新选择！');\n            return false;\n          }\n          var _row = app.midBalanceGrid.getSelection();\n          _row[0].set('CCID', returnObj.acc_ccid) ;     \n          _row[0].set('CCID_NAME', returnObj.acc_ccid_name);\n          _row[0].set('DIM_ID',returnObj.dim_id);\n          _row[0].set('BALANCE_DIRECTION',returnObj.bd);  //1 或者 '-1'\n          //-----------科目是否启用外币核算----------------\n          if(returnObj.f_cny === 'N'){\n             _row[0].set('IS_FOREGIN_CNY',0);\n          }else{\n            _row[0].set('IS_FOREGIN_CNY',1);\n          }\n         \n          //账簿本位币币种--与账簿的本位币币种保持一致\n          _row[0].set('CURRENCY_CODE',returnObj.cny_code);\n          //科目币种---原币币种\n          _row[0].set('ENTER_CNY_CODE',returnObj.cny_code);\n        }\n      });\n    }  \n  }) ; "},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"}],"expanded":false,"type":"column"},{"configs":{"text":"{#la_yearBalance#}","width":"340","itemId":"yearBalance"},"children":[{"configs":{"text":"方向","width":"50","dataIndex":"BALANCE_DIRECTION","titleAlign":"center","itemId":"BALANCE_DIRECTION","renderer":"if(value == '-1'){\n  return '贷';\n}else if(value == '1'){\n  return '借';\n}"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"数量","width":"100","dataIndex":"YEAR_AMOUNT","titleAlign":"center","itemId":"YEAR_AMOUNT"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"原币","width":"100","dataIndex":"YEAR_OR_BALANCE","titleAlign":"center","itemId":"YEAR_OR_BALANCE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"金额","width":"100","dataIndex":"YEAR_BALANCE","titleAlign":"center","itemId":"YEAR_BALANCE"},"children":[],"expanded":false,"type":"column"}],"expanded":false,"type":"column"},{"configs":{"text":"{#la_sumDebeit#}","width":"300","itemId":"calculatedDebit"},"children":[{"configs":{"text":"{#la_amount#}","xtype":"numbercolumn","width":"100","dataIndex":"AMT_YTD_DR","titleAlign":"center","itemId":"AMT_YTD_DR"},"children":[{"configs":{"decimalPrecision":"6","minValue":"0","itemId":"editor"},"events":{"blur":"if(!Ext.isEmpty(number.value)){\n  var calRecord = app.midBalanceGrid.getSelection();\n  //贷方数量\n  var creditAmout = calRecord[0].data.AMT_YTD_CR;\n  var periodAmount = calRecord[0].data.PRRIOD_AMOUNT;\n  if(Ext.isEmpty(creditAmout))\n    creditAmout = 0.000000;\n  if(Ext.isEmpty(periodAmount))\n    periodAmount = 0.000000;\n  //年初+(借-贷)*科目方向 = 期初\n  var _accBalanceDirect = calRecord[0].data.BALANCE_DIRECTION;\n  var _minusNumber = numberSub(Ext.Number.toFixed(number.value,6),Ext.Number.toFixed(creditAmout,6));\n  _minusNumber = _minusNumber*_accBalanceDirect;\n  var yearAmount =numberSub(Ext.Number.toFixed(periodAmount,6),Ext.Number.toFixed(_minusNumber,6));\n  calRecord[0].set('YEAR_AMOUNT',yearAmount);\n}"},"children":[],"expanded":false,"type":"number"}],"expanded":false,"type":"column"},{"configs":{"text":"{#la_originalAmount#}","xtype":"numbercolumn","width":"100","dataIndex":"DEBIT_OR_AMOUNT","titleAlign":"center","itemId":"DEBIT_OR_AMOUNT"},"children":[{"configs":{"decimalPrecision":"6","minValue":"0","itemId":"editor"},"events":{"blur":"if(!Ext.isEmpty(number.value)){\n  var calRecord = app.midBalanceGrid.getSelection();\n  //贷方原币\n  var creditAmout = calRecord[0].data.CREBIT_OR_AMOUNT;\n  //期初原币\n  var periodAmount = calRecord[0].data.PERIOD_OR_BALANCE;\n  if(Ext.isEmpty(creditAmout))\n    creditAmout = 0.000000;\n  if(Ext.isEmpty(periodAmount))\n    periodAmount = 0.000000;\n  \n    //年初+(借-贷)*科目方向 = 期初\n  var _accBalanceDirect = calRecord[0].data.BALANCE_DIRECTION;\n  var _minusNumber = numberSub(Ext.Number.toFixed(number.value,6),Ext.Number.toFixed(creditAmout,6));\n  _minusNumber = _minusNumber*_accBalanceDirect;\n  var yearAmount =numberSub(Ext.Number.toFixed(periodAmount,6),Ext.Number.toFixed(_minusNumber,6));\n  calRecord[0].set('YEAR_OR_BALANCE',yearAmount);\n}"},"children":[],"expanded":false,"type":"number"}],"expanded":false,"type":"column"},{"configs":{"text":"{#la_money#}","xtype":"numbercolumn","width":"100","dataIndex":"YTD_DR","titleAlign":"center","itemId":"YTD_DR"},"children":[{"configs":{"decimalPrecision":"6","minValue":"0","itemId":"editor"},"events":{"blur":"if(!Ext.isEmpty(number.value)){\n  var calRecord = app.midBalanceGrid.getSelection();\n  //贷方金额\n  var creditAmout = calRecord[0].data.YTD_CR;\n  //期初金额\n  var periodAmount = calRecord[0].data.PRRIOD_BALANCE;\n  if(Ext.isEmpty(creditAmout))\n    creditAmout = 0.000000;\n  if(Ext.isEmpty(periodAmount))\n    periodAmount = 0.000000;\n  //年初+(借-贷)*科目方向 = 期初\n  var _accBalanceDirect = calRecord[0].data.BALANCE_DIRECTION;\n  var _minusNumber = numberSub(Ext.Number.toFixed(number.value,6),Ext.Number.toFixed(creditAmout,6));\n  _minusNumber = _minusNumber*_accBalanceDirect;\n  var yearAmount =numberSub(Ext.Number.toFixed(periodAmount,6),Ext.Number.toFixed(_minusNumber,6));\n  calRecord[0].set('YEAR_BALANCE',yearAmount);\n}"},"children":[],"expanded":false,"type":"number"}],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_sumCrebeit#}","width":"300","titleAlign":"center","itemId":"calculateCredit"},"children":[{"configs":{"text":"{#la_amount#}","xtype":"numbercolumn","width":"100","dataIndex":"AMT_YTD_CR","titleAlign":"center","itemId":"AMT_YTD_CR"},"children":[{"configs":{"decimalPrecision":"6","minValue":"0","itemId":"editor"},"events":{"blur":"if(!Ext.isEmpty(number.value)){\n  var calRecord = app.midBalanceGrid.getSelection();\n  //借方数量\n  var creditAmout = calRecord[0].data.AMT_YTD_DR;\n  var periodAmount = calRecord[0].data.PRRIOD_AMOUNT;\n  if(Ext.isEmpty(creditAmout))\n    creditAmout = 0.000000;\n  if(Ext.isEmpty(periodAmount))\n    periodAmount = 0.000000;\n  //年初+(借-贷)*科目方向 = 期初\n  var _accBalanceDirect = calRecord[0].data.BALANCE_DIRECTION;\n  var _minusNumber = numberSub(Ext.Number.toFixed(creditAmout,6),Ext.Number.toFixed(number.value,6));\n  _minusNumber = _minusNumber*_accBalanceDirect;\n  var yearAmount =numberSub(Ext.Number.toFixed(periodAmount,6),Ext.Number.toFixed(_minusNumber,6));\n  calRecord[0].set('YEAR_AMOUNT',yearAmount);\n}"},"children":[],"expanded":false,"type":"number"}],"expanded":false,"type":"column"},{"configs":{"text":"{#la_originalAmount#}","xtype":"numbercolumn","width":"100","dataIndex":"CREBIT_OR_AMOUNT","titleAlign":"center","itemId":"CREBIT_OR_AMOUNT"},"children":[{"configs":{"decimalPrecision":"6","minValue":"0","itemId":"editor"},"events":{"blur":"if(!Ext.isEmpty(number.value)){\n  var calRecord = app.midBalanceGrid.getSelection();\n  //借方原币\n  var creditAmout = calRecord[0].data.DEBIT_OR_AMOUNT;\n  //期初原币\n  var periodAmount = calRecord[0].data.PERIOD_OR_BALANCE;\n  if(Ext.isEmpty(creditAmout))\n    creditAmout = 0.000000;\n  if(Ext.isEmpty(periodAmount))\n    periodAmount = 0.000000;\n  //年初+(借-贷)*科目方向 = 期初\n  var _accBalanceDirect = calRecord[0].data.BALANCE_DIRECTION;\n  var _minusNumber = numberSub(Ext.Number.toFixed(creditAmout,6),Ext.Number.toFixed(number.value,6));\n  _minusNumber = _minusNumber*_accBalanceDirect;\n  var yearAmount =numberSub(Ext.Number.toFixed(periodAmount,6),Ext.Number.toFixed(_minusNumber,6));\n  calRecord[0].set('YEAR_OR_BALANCE',yearAmount);\n}"},"children":[],"expanded":false,"type":"number"}],"expanded":false,"type":"column"},{"configs":{"text":"{#la_money#}","xtype":"numbercolumn","width":"100","dataIndex":"YTD_CR","titleAlign":"center","itemId":"YTD_CR"},"children":[{"configs":{"decimalPrecision":"6","minValue":"0","itemId":"editor"},"events":{"blur":"if(!Ext.isEmpty(number.value)){\n  var calRecord = app.midBalanceGrid.getSelection();\n  //借方金额\n  var creditAmout = calRecord[0].data.YTD_DR;\n  //期初金额\n  var periodAmount = calRecord[0].data.PRRIOD_BALANCE;\n  if(Ext.isEmpty(creditAmout))\n    creditAmout = 0.000000;\n  if(Ext.isEmpty(periodAmount))\n    periodAmount = 0.000000;\n  //年初+(借-贷)*科目方向 = 期初\n  var _accBalanceDirect = calRecord[0].data.BALANCE_DIRECTION;\n  var _minusNumber = numberSub(Ext.Number.toFixed(creditAmout,6),Ext.Number.toFixed(number.value,6));\n  _minusNumber = _minusNumber*_accBalanceDirect;\n  var yearAmount =numberSub(Ext.Number.toFixed(periodAmount,6),Ext.Number.toFixed(_minusNumber,6));\n  calRecord[0].set('YEAR_BALANCE',yearAmount);\n}"},"children":[],"expanded":false,"type":"number"}],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"期初余额","width":"340","titleAlign":"center","itemId":"InitialBalance"},"children":[{"configs":{"text":"{#la_direction#}","width":"50","dataIndex":"BALANCE_DIRECTION","titleAlign":"center","itemId":"BALANCE_DIRECTION_Y","renderer":"if(value == '-1'){\n  return '{#la_directDebit#}';\n}else if(value == '1'){\n  return '{#la_directCrebit#}';\n}"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_amount#}","xtype":"numbercolumn","width":"100","dataIndex":"PRRIOD_AMOUNT","titleAlign":"center","itemId":"PRRIOD_AMOUNT"},"children":[{"configs":{"decimalPrecision":"6","minValue":"0","itemId":"editor"},"events":{"blur":"if(!Ext.isEmpty(number.value)){\n  var calRecord = app.midBalanceGrid.getSelection();\n  //借方数量\n  var creditAmout = calRecord[0].data.AMT_YTD_DR;\n  var periodAmount = calRecord[0].data.AMT_YTD_CR;\n  if(Ext.isEmpty(creditAmout))\n    creditAmout = 0.000000;\n  if(Ext.isEmpty(periodAmount))\n    periodAmount = 0.000000;\n  //年初+(借-贷)*科目方向 = 期初\n  var _accBalanceDirect = calRecord[0].data.BALANCE_DIRECTION;\n  var _minusNumber = numberSub(Ext.Number.toFixed(creditAmout,6),Ext.Number.toFixed(periodAmount,6));\n  _minusNumber = _minusNumber*_accBalanceDirect;\n  var yearAmount =numberSub(Ext.Number.toFixed(number.value,6),Ext.Number.toFixed(_minusNumber,6));\n  calRecord[0].set('YEAR_AMOUNT',yearAmount);\n}"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_originalAmount#}","xtype":"numbercolumn","width":"100","dataIndex":"PERIOD_OR_BALANCE","titleAlign":"center","itemId":"PERIOD_OR_BALANCE"},"children":[{"configs":{"decimalPrecision":"6","minValue":"0","itemId":"editor"},"events":{"blur":"if(!Ext.isEmpty(number.value)){\n  var calRecord = app.midBalanceGrid.getSelection();\n  //借方原币\n  var creditAmout = calRecord[0].data.DEBIT_OR_AMOUNT;\n  //贷方原币\n  var periodAmount = calRecord[0].data.CREBIT_OR_AMOUNT;\n  if(Ext.isEmpty(creditAmout))\n    creditAmout = 0.000000;\n  if(Ext.isEmpty(periodAmount))\n    periodAmount = 0.000000;\n  //期初+贷方-借方\n  //年初+(借-贷)*科目方向 = 期初\n  var _accBalanceDirect = calRecord[0].data.BALANCE_DIRECTION;\n  var _minusNumber = numberSub(Ext.Number.toFixed(creditAmout,6),Ext.Number.toFixed(periodAmount,6));\n  _minusNumber = _minusNumber*_accBalanceDirect;\n  var yearAmount =numberSub(Ext.Number.toFixed(number.value,6),Ext.Number.toFixed(_minusNumber,6));\n  calRecord[0].set('YEAR_OR_BALANCE',yearAmount);\n}"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_moneyNecessary#}","xtype":"numbercolumn","width":"100","dataIndex":"PRRIOD_BALANCE","titleAlign":"center","itemId":"PRRIOD_BALANCE"},"children":[{"configs":{"decimalPrecision":"6","minValue":"0","itemId":"editor"},"events":{"blur":"if(!Ext.isEmpty(number.value)){\n  var calRecord = app.midBalanceGrid.getSelection();\n  //借方金额\n  var creditAmout = calRecord[0].data.YTD_DR;\n  //贷方金额\n  var periodAmount =calRecord[0].data.YTD_CR;\n  if(Ext.isEmpty(creditAmout))\n    creditAmout = 0.000000;\n  if(Ext.isEmpty(periodAmount))\n    periodAmount = 0.000000;\n  var _accBalanceDirect = calRecord[0].data.BALANCE_DIRECTION;\n  var _minusNumber = numberSub(Ext.Number.toFixed(creditAmout,6),Ext.Number.toFixed(periodAmount,6));\n  _minusNumber = _minusNumber*_accBalanceDirect;\n  //期初+贷方-借方\n  //年初+（本年累计借贷相减）=期初\n  var yearAmount = numberSub(Ext.Number.toFixed(number.value,6),Ext.Number.toFixed(_minusNumber,6));\n  calRecord[0].set('YEAR_BALANCE',yearAmount);\n}"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"主键","hidden":"true","dataIndex":"ID","itemId":"ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"是否外币核算","hidden":"true","dataIndex":"IS_FOREGIN_CNY","itemId":"IS_FOREGIN_CNY_H"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"},{"configs":{"tbar":"app.initYearBar","region":"center","tagConfigs":"features: [{\n  id: 'gl_group',\n  ftype: 'grouping',\n  groupHeaderTpl: [\n     '{name}<span style=\"float:right\"><font color=\"red\">合计：{children:this.sumData}<\/font><\/span>',\n  {\n  sumData:function(values){\n   var _sumCrebitAmount = 0;\n   var _sumDebitAmount = 0;\n   var _sumAmountFlag = 1;\n   var _finalAmount = 0;\n   //SUM_DIRECTION\n   for(var i=0;i<values.length;i++){\n     _sumAmountFlag = values[i].data.SUM_DIRECTION;\n     if(values[i].data.BALANCE_DIRECTION == '1'){\n        _sumDebitAmount = numberAdd(_sumDebitAmount,values[i].data.YEAR_BALANCE);\n     }else{\n        _sumCrebitAmount = numberAdd(_sumCrebitAmount,values[i].data.YEAR_BALANCE);\n     }\n   }\n    _finalAmount = numberSub(_sumDebitAmount,_sumCrebitAmount)*_sumAmountFlag;\n   return Ext.util.Format.number(Ext.Number.toFixed(_finalAmount,2),'0,000.00');\n}\n}],\n  hideGroupedHeader: true,\n  enableGroupingMenu: false\n  \n}]\n","selType":"checkboxmodel","height":"'100%'","itemId":"initBalanceGrid","editable":"true"},"events":{"tagEvents":"'cellclick':function(grid,td,cellIndex,record,tr,rowIndex,e,eOpts){\n  if(cellIndex == 7 && Ext.isEmpty(record.data.DIM_ID)){\n     return false;\n  }else if(cellIndex == 8 && record.data.IS_FOREGIN_CNY == 0 ){\n     return false;\n  }\n}"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#la_rownum#}","align":"center","xtype":"rownumberer","width":"50","itemId":"rowNumber"},"children":[],"expanded":false,"type":"column"},{"configs":{"hidden":"true","dataIndex":"CCID_CODE","itemId":"CCID_CODE","flex":"5"},"children":[],"expanded":false,"type":"column"},{"configs":{"hidden":"true","dataIndex":"CCID","itemId":"CCID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_ccidName#}","dataIndex":"CCID_NAME","itemId":"CCID_NAME","renderer":"metaData.tdAttr = 'data-qtip=\"' + value + '\"';\nreturn value;","flex":"4"},"children":[{"configs":{"itemId":"editor"},"events":{"focus":"var _accCode = '';\nvar _accName = '';\nif(!Ext.isEmpty(app.accCombo.getRawValue())){\n  _accName = app.accCombo.getRawValue();\n}\nif(app.initBalanceGrid.getSelection().length !==0){\n  _accCode = app.initBalanceGrid.getSelection()[0].data.ACC_CODE;\n}\nWb.run({\n    url:'m?xwl=xc/gl/journal/v-windows/handler-ccid-win',\n    params : {\n      'ledgerId' : app.ledgerCombo.getValue()\n    },\n    success:function(appObj){\n      appObj.initWindow({\n        accName : _accCode,\n        ledgerId : app.ledgerCombo.getValue(),\n        groupId : 'ALL',\n        handlerCCID : function(returnObj){\n          //设置返回的科目id以及科目名称的直\n          returnObj = Wb.decode(returnObj);\n          //校验所选择的科目是否已经存在\n          var isExist = false;\n          var existRecords = app.initBalanceGrid.getStore();\n          existRecords.each(function(_tmp){\n            if(_tmp.data.CCID === returnObj.acc_ccid){\n               isExist = true;\n               return false;\n            }\n          });\n          if(isExist){\n            Wb.info('科目已存在,请重新选择！');\n            return false;\n          }\n          var _row = app.initBalanceGrid.getSelection();\n          _row[0].set('CCID', returnObj.acc_ccid) ;     \n          _row[0].set('CCID_NAME', returnObj.acc_ccid_name);\n          _row[0].set('DIM_ID',returnObj.dim_id);\n          _row[0].set('BALANCE_DIRECTION',returnObj.bd);\n          //-----------科目是否启用外币核算----------------\n          if(returnObj.f_cny === 'N'){\n             _row[0].set('IS_FOREGIN_CNY',0);\n          }else{\n            _row[0].set('IS_FOREGIN_CNY',1);\n          }\n          //账簿本位币币种--与账簿的本位币币种保持一致\n          _row[0].set('CURRENCY_CODE',returnObj.cny_code);\n          //科目币种---原币币种\n          _row[0].set('ENTER_CNY_CODE',returnObj.cny_code);\n        }\n      });\n    }  \n  }) ; "},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"column"},{"configs":{"hidden":"true","dataIndex":"PERIOD_CODE","titleAlign":"center","itemId":"PERIOD_CODE","flex":"2"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_direction#}","dataIndex":"BALANCE_DIRECTION","titleAlign":"center","itemId":"BALANCE_DIRECTION","renderer":"if(value == '-1'){\n  return '贷';\n}else if(value == '1'){\n  return '借';\n}","flex":"1"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_amount#}","xtype":"numbercolumn","dataIndex":"YEAR_AMOUNT","titleAlign":"center","itemId":"YEAR_AMOUNT","flex":"3"},"children":[{"configs":{"decimalPrecision":"6","itemId":"editor"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_originalAmount#}","xtype":"numbercolumn","dataIndex":"YEAR_OR_BALANCE","titleAlign":"center","itemId":"YEAR_OR_BALANCE","flex":"3"},"children":[{"configs":{"decimalPrecision":"6","itemId":"editor"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"column"},{"configs":{"text":"{#la_moneyNecessary#}","xtype":"numbercolumn","dataIndex":"YEAR_BALANCE","titleAlign":"center","itemId":"YEAR_BALANCE","flex":"3"},"children":[{"configs":{"decimalPrecision":"6","itemId":"editor"},"children":[],"expanded":false,"type":"number"}],"expanded":true,"type":"column"},{"configs":{"text":"是否汇总","hidden":"true","dataIndex":"IS_VALID","titleAlign":"center","itemId":"IS_VALID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"主键","hidden":"true","dataIndex":"ID","itemId":"ID"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"groupField":"ACC_CATEGORY_NAME","pageSize":"-1","itemId":"store","url":"m?xwl=xc/gl/b-balances/acc-ba/data/getInitYearBalance"},"events":{"beforeload":"var whereSql = ' AND b.LEDGER_ID = \\''+app.ledgerCombo.getValue()+'\\'';\nif(!Ext.isEmpty(app.accGroupCombo.getValue())){\n  whereSql += ' AND a.ACC_GROUP_ID = \\''+app.accGroupCombo.getValue()+'\\'';\n}\nif(!Ext.isEmpty(app.accCombo.getValue())){\n   whereSql += ' AND c.ACC_ID = \\''+app.accCombo.getValue()+'\\'';\n}\nif(accCategory !==0){\n   whereSql += ' AND a.ACC_CATEGORY_CODE = \\''+accCategory+'\\'';\n}\nwhereSql +=' AND b.PERIOD_CODE = \\''+queryPeriod+'\\'';\n\nstore.getProxy().extraParams.WHERESQL = whereSql;"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}