{"inframe":false,"title":"辅助组合统计","hidden":false,"roles":{"default":1},"children":[{"configs":{"serverScript":"request.setAttribute('contextPath',request.getContextPath());\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/gl/report/assist-statistic/assistGroupReport\");\nvar sessionVars = request.getSession().getAttribute(com.xzsoft.xip.framework.common.SessionVariable.XZ_SESSION_VARS);\nvar la_system_language = sessionVars.get(com.xzsoft.xip.framework.common.SessionVariable.language);\nrequest.setAttribute('la_system_language',la_system_language);","itemId":"module"},"children":[{"configs":{"itemId":"stores"},"children":[{"configs":{"itemId":"pickStore","url":"m?xwl=xc/gl/report/assist-statistic/data/selectSegVal"},"events":{"beforeload":"var rec = app.grid1.getSelection()[0];\nvar segCode = rec.data.SEG_CODE;\nstore.proxy.extraParams.ledgerId = app.ledgerCombox.getValue();\nstore.proxy.extraParams.segCode = segCode;"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"folder"},{"configs":{"itemId":"buttons"},"children":[{"configs":{"itemId":"buttons"},"children":[],"expanded":true,"type":"array"}],"expanded":false,"type":"folder"},{"configs":{"layout":"border","itemId":"viewport1","border":"false"},"events":{"afterrender":"app.ledgerCombox.getStore().load(function(records, operation, success){\n  if(records.length == 1){\n    app.ledgerCombox.setValue(records[0].data.CODE);\n  }\n});\n//设置默认会计期间\nvar _currentDate = new Date();\nvar _defaultPeriodCode = Ext.Date.format(_currentDate,'Y-m');\napp.startPeriodCode.setValue(_defaultPeriodCode);\napp.startPeriodCode.setRawValue(_defaultPeriodCode);\napp.endPeriodCode.setValue(_defaultPeriodCode);\napp.endPeriodCode.setRawValue(_defaultPeriodCode);"},"children":[{"configs":{"region":"north","frame":"true","height":"140","style":"border-width:0px","border":"false","itemId":"formPanel"},"children":[{"configs":{"frame":"true","layout":"column","border":"false","itemId":"westPanel"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","columnWidth":".60","border":"false","itemId":"panel1"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","border":"false","itemId":"tr1"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"form","columnWidth":".40","border":"false","itemId":"td1"},"children":[{"configs":{"labelWidth":"{#la_labelWidth#}","displayField":"NAME","valueField":"CODE","labelAlign":"right","itemId":"ledgerCombox","fieldLabel":"<font color='red'>*<\/font>{#ledger#}"},"events":{"select":"var rec = records[0];\ngl_defaultCurrency = rec.CURRENCY_CODE;//获取账簿本位币币种\napp.grid1.store.load();\n","beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/report/daily-accounts/cash-daily-account/data/getAllLedger"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"fit","columnWidth":".60","itemId":"td2"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"column","itemId":"td2.1"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".54","itemId":"td2.2.1"},"children":[{"configs":{"labelWidth":"{#la_labelWidth#}","displayField":"NAME","valueField":"CODE","labelAlign":"right","itemId":"startPeriodCode","fieldLabel":"<font color='red'>*<\/font>{#periodAccount#}"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/gl/report/assist-statistic/data/getLedgerPeriod"},"events":{"beforeload":"if(!Ext.isEmpty(app.ledgerCombox.getValue())){\n  store.getProxy().extraParams.ledgerId = app.ledgerCombox.getValue();\n}else{\n  return ;\n}"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".04","itemId":"td2.2.2"},"children":[{"configs":{"text":"--","labelAlign":"center","itemId":"rangeFlag"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".38","itemId":"td3.3.3"},"children":[{"configs":{"tagConfigs":"{\n  columnWidth:0.33\n}","displayField":"NAME","valueField":"CODE","labelAlign":"right","itemId":"endPeriodCode"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/gl/report/assist-statistic/data/getLedgerPeriod"},"events":{"beforeload":"if(!Ext.isEmpty(app.ledgerCombox.getValue())){\n  store.getProxy().extraParams.ledgerId = app.ledgerCombox.getValue();\n}else{\n  return ;\n}"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","border":"false","itemId":"tr2"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","width":".40","layout":"form","columnWidth":".40","border":"false","itemId":"td1"},"children":[{"configs":{"labelWidth":"{#la_labelWidth#}","value":"Y","labelAlign":"right","pickList":"[['N','{#no#}'],['Y','{#yes#}']]","itemId":"isShowDetail","fieldLabel":"{#showDetail#}"},"children":[],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"fit","columnWidth":".60","itemId":"td2"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"column","itemId":"td2.1"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".54","itemId":"td2.2.1"},"children":[{"configs":{"labelWidth":"{#la_labelWidth#}","displayField":"NAME","valueField":"CODE","labelAlign":"right","itemId":"startAccCode","fieldLabel":"{#accountStart#}"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/report/assist-statistic/data/getLedgerAccount"},"events":{"beforeload":"if(!Ext.isEmpty(app.ledgerCombox.getValue())){\n  store.getProxy().extraParams.ledgerId = app.ledgerCombox.getValue();\n}else{\n  return ;\n}"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".04","itemId":"td2.2.2"},"children":[{"configs":{"text":"--","labelAlign":"center","itemId":"rangeFlag"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".38","itemId":"td3.3.3"},"children":[{"configs":{"displayField":"NAME","valueField":"CODE","labelAlign":"right","itemId":"endAccCode"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/report/assist-statistic/data/getLedgerAccount"},"events":{"beforeload":"if(!Ext.isEmpty(app.ledgerCombox.getValue())){\n  store.getProxy().extraParams.ledgerId = app.ledgerCombox.getValue();\n}else{\n  return ;\n}"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","border":"false","itemId":"tr3"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"form","columnWidth":".40","border":"false","itemId":"td1"},"children":[{"configs":{"labelWidth":"{#la_labelWidth#}","value":"0","labelAlign":"right","pickList":"[['0','{#no#}'],['1','{#yes#}']]","itemId":"noCountCheck","fieldLabel":"{#isAccount#}"},"children":[],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"fit","columnWidth":".60","itemId":"td2"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"column","itemId":"td2.1"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".54","itemId":"td2.2.1"},"children":[{"configs":{"labelAlign":"center","itemId":"rangeFlag"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".04","itemId":"td2.2.3"},"children":[{"configs":{"labelAlign":"center","itemId":"rangeFlag"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".12","itemId":"td2.2.2"},"children":[{"configs":{"text":"{#select#}","width":"70","itemId":"queryBtn","iconCls":"seek_icon"},"events":{"click":"var ledgerId = app.ledgerCombox.getValue();\nif(Ext.isEmpty(ledgerId)){\n  Wb.toast('请选择账簿');\n  return false;\n}\nvar map = new Ext.util.HashMap(); // map.add('','');\nmap.add('language','{#la_system_language#}');\nvar startPeriod = app.startPeriodCode.getValue();//开始会计期\nif(startPeriod === '' || startPeriod === null || startPeriod ===undefined){startPeriod = '0';}\n\nvar endPeriod = app.endPeriodCode.getValue();//结束会计期\nif(endPeriod === '' || endPeriod === null || endPeriod === undefined){endPeriod = '0';}\n\nvar isLeaf = app.isShowDetail.getValue();//是否显示明细，包含上级\n\nvar startAccCode = app.startAccCode.getValue();//开始科目\nif(startAccCode === '' || startAccCode === null || startAccCode === undefined){startAccCode = '0';}\n\nvar endAccCode = app.endAccCode.getValue();//结束科目\nif(endAccCode === '' || endAccCode === null || endAccCode === undefined){endAccCode = '0';}\n\nvar isAccount = app.noCountCheck.getValue();//含未记账\n\nmap.add('ledgerId',ledgerId);\nmap.add('startPeriod',startPeriod);\nmap.add('endPeriod',endPeriod);\nmap.add('isLeaf',isLeaf);\nmap.add('startAccCode',startAccCode);\nmap.add('endAccCode',endAccCode);\nmap.add('isFirst','N');\nvar targetUrl = '{#contextPath#}/ReportServer?reportlet=xc_assistant/assistant_static_group.cpt&op=view';\nif('1' == isAccount){\n  targetUrl = '{#contextPath#}/ReportServer?reportlet=xc_assistant/assistant_static_group_t.cpt&op=view';\n}\nvar segs = ['XC_AP_VENDORS','XC_AR_CUSTOMERS','XIP_PUB_EMPS','XIP_PUB_ORGS','XC_GL_PRODUCTS','XIP_PUB_DEPTS',\n            'XC_PM_PROJECTS','XC_GL_CUSTOM1','XC_GL_CUSTOM2','XC_GL_CUSTOM3','XC_GL_CUSTOM4'];\n//获取选中行\nvar recs = app.grid1.getSelection();\n\nfor(var j=0;j<recs.length;j++){\n  if(Ext.Array.contains(segs,recs[j].get('SEG_CODE'))){\n       map.add(recs[j].get('SEG_CODE'),'Y');\n   }else{\n       map.add(recs[j].get('SEG_CODE'),'N');\n   }\n  }\nvar params = '';\nmap.each(function(key, value, length){\n    params +='&'+key+'='+value;\n});\nvar reportFrame = document.getElementById('reportFrame');\nparams = targetUrl+params;\nreportFrame.src = params;\n\n"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".08","itemId":"td2.2.5"},"children":[{"configs":{"labelAlign":"center","itemId":"rangeFlag"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".12","itemId":"td3.3.3"},"children":[{"configs":{"text":"{#reset#}","width":"70","itemId":"resetBtn","iconCls":"refresh_icon"},"events":{"click":"app.conditionForm.getForm().reset();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"fit","columnWidth":".40","border":"false","itemId":"panel2"},"children":[{"configs":{"multiSelect":"true","pagingBar":"false","height":"140","selType":"checkboxmodel","forceFit":"true","itemId":"grid1"},"children":[{"configs":{"autoLoad":"false","itemId":"store","url":"m?xwl=xc/gl/report/assist-statistic/data/selectEnableSeg"},"events":{"beforeload":"store.proxy.extraParams.LEDGER_ID = app.ledgerCombox.getValue();"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#segCode#}","hidden":"true","dataIndex":"SEG_CODE","titleAlign":"center","itemId":"segCodeCol"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#segName#}","dataIndex":"SEG_NAME","titleAlign":"center","itemId":"segNameCol","flex":"1"},"children":[],"expanded":true,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","layout":"fit","html":"<iframe  scrolling=auto frameborder=0 width=100% height=100% id=reportFrame src='{#contextPath#}/ReportServer?reportlet=xc_assistant/assistant_static_group.cpt&language={#la_system_language#}&op=view'><\/iframe>\n","itemId":"reportPanel"},"children":[],"expanded":false,"type":"panel"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}