{"inframe":false,"title":"凭证来源","hidden":false,"roles":{"default":1},"children":[{"configs":{"title":"{#moduleTitle#}","loginRequired":"false","serverScript":"com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/gl/global/voucher/source/XC_GL_GB_SOURCE\");","itemId":"module"},"children":[{"configs":{"itemId":"store"},"children":[{"configs":{"autoLoad":"true","itemId":"v_catstore","url":"m?xwl=xc/gl/global/voucher/source/source-db/selectv_cat"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"folder"},{"configs":{"height":"240","frame":"true","width":"540","layout":"form","closeAction":"hide","border":"false","dialog":"true","itemId":"window1","modal":"true"},"children":[{"configs":{"tagConfigs":"baseCls : 'my-panel-no-border'","layout":"column","itemId":"tr1"},"children":[{"configs":{"labelWidth":"120","width":"240","margin":"10 0 0 0","labelAlign":"right","itemId":"v_src_code","fieldLabel":"{#la_necessaryCode#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"120","store":"app.v_catstore","displayField":"V_CATEGORY_NAME","width":"240","valueField":"V_CATEGORY_ID","margin":"10 0 0 0","labelAlign":"right","itemId":"v_cat","fieldLabel":"{#la_VoucherCategory#}","editable":"false"},"children":[],"expanded":false,"type":"combo"},{"configs":{"itemId":"operateFlag"},"children":[],"expanded":false,"type":"hidden"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls : 'my-panel-no-border'","itemId":"tr2"},"children":[{"configs":{"labelWidth":"120","width":"480","margin":"10 0 0 0","labelAlign":"right","itemId":"v_src_url","fieldLabel":"{#la_necessaryUrl#}"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls : 'my-panel-no-border'","itemId":"tr3"},"children":[{"configs":{"labelWidth":"120","height":"60","width":"480","margin":"10 0 0 0","labelAlign":"right","itemId":"v_src_desc","fieldLabel":"{#la_description#}"},"children":[],"expanded":false,"type":"textarea"}],"expanded":false,"type":"panel"},{"configs":{"itemId":"buttons"},"children":[{"configs":{"text":"{#confirmBtn#}","itemId":"confirmBtn","iconCls":"ok_icon"},"events":{"click":"if(Ext.isEmpty(app.v_src_code.getValue())){\nWb.toast('凭证来源编码不能为空');\n  app.v_src_code.focus();\n  return false;\n} \nif(Ext.isEmpty(app.v_src_url.getValue())){\nWb.toast('凭证来源URL不能为空');\n  app.v_src_url.focus();\n  return false;\n}\nvar _operateFlag = app.operateFlag.getValue();\nif(_operateFlag === '-1'){\n  Wb.request({\n    url:'m?xwl=xc/gl/global/voucher/source/source-db/save-source',\n    out:app.window1,\n    success:function(resp){\n      var returnobj = Wb.decode(resp.responseText);\n      if(returnobj.flag === '0'){\n        app.window1.close();\n        Wb.toast('增加成功！');\n        app.grid1.store.load();\n        return false;\n      }\n      else{\n        Wb.toast('增加失败！');\n        return false;\n      }\n    }\n});\n}else{\n    Wb.request({\n      url:'m?xwl=xc/gl/global/voucher/source/source-db/update-source',\n      out:app.window1,\n      success:function(resp){\n        var returnobj=Wb.decode(resp.responseText);\n        if(returnobj.flag==='0'){\n          Wb.toast('修改成功！');\n          app.window1.close();\n          app.grid1.store.load();\n          return false;\n        }\n        else{\n          Wb.toast('修改失败！');\n          return false;\n        }\n      }\n  });\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#cancelBtn#}","itemId":"cancelBtn","iconCls":"cancel_icon"},"events":{"click":"app.window1.close();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"}],"expanded":true,"type":"window"},{"configs":{"layout":"fit","itemId":"viewport1"},"children":[{"configs":{"selType":"checkboxmodel","itemId":"grid1"},"events":{"itemdblclick":"app.editBtn.fireEvent('click');"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#addBtn#}","itemId":"addBtn","iconCls":"file_add_icon"},"events":{"click":"var win1=new Ext.window.Window(app._window1);\nwin1.setTitle('新增凭证来源');\nwin1.setIconCls('file_add_icon');\napp.operateFlag.setValue('-1');\nwin1.show();\n\n"},"children":[],"expanded":true,"type":"button"},{"configs":{"text":"{#editBtn#}","itemId":"editBtn","iconCls":"file_edit_icon"},"events":{"click":"var rows=app.grid1.getSelection();\nif(rows.length!==1){\n  Wb.toast('请选择一条你要修改的记录！');\n  return false;\n}else{ \n  if(rows[0].data.IS_SYS==='Y'){\n  Wb.toast('内置数据不能修改！');\n    return false;\n  }\n var win1=new Ext.window.Window(app._window1);\n  win1.setTitle('修改凭证来源');\n  app.v_src_code.setValue(rows[0].data.V_SRC_CODE);\n  app.v_src_url.setValue(rows[0].data.V_SRC_URL);\n  app.v_src_desc.setValue(rows[0].data.V_SRC_DESC);\n  app.v_cat.setValue(rows[0].data.V_CAT);\n  app.operateFlag.setValue('1');\n  win1.show();\n  app.v_src_code.setReadOnly(true);\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#delBtn#}","itemId":"delBtn","iconCls":"file_delete_icon"},"events":{"click":"var recs = app.grid1.getSelection();\n\nif (!recs.length) {\n  Wb.toast('请选择需要删除的记录。');\n  return false;\n}\nvar lineArray = [];\nWb.each(recs,function(r){\n  var json={'src_code':r.data.V_SRC_CODE};\n  lineArray.push(json);\n});\nWb.confirm('确定要删除选择的 ' + recs.length + ' 条记录吗？', function() {\n  Wb.request({\n    url: 'm?xwl=xc/gl/global/voucher/source/source-db/delete-source', \n    params:{\n    'destory':Wb.encode(lineArray)\n    },\n    success: function(resp) {\n    var returnobj=Wb.decode(resp.responseText);\n      if(returnobj.flag==='0'){\n      Wb.toast('删除成功！');\n      app.grid1.store.load();\n        return false;\n      }\n      else{\n      Wb.toast('删除失败！');\n        return false;\n      }\n    }\n  });\n});\n"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=xc/gl/global/voucher/source/source-db/select-source"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#rownum#}","align":"center","width":"50","xtype":"rownumberer","itemId":"ROW_NUMBER_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_sourceCode#}","width":"120","align":"left","dataIndex":"V_SRC_CODE","titleAlign":"center","itemId":"V_SRC_CODE_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_sourceUrl#}","width":"300","align":"left","dataIndex":"V_SRC_URL","titleAlign":"center","itemId":"V_SRC_URL_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"hidden":"true","dataIndex":"V_CAT","itemId":"V_CAT_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_VoucherCategory#}","align":"left","width":"130","dataIndex":"V_CAT_NAME","titleAlign":"center","itemId":"V_CAT_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_description#}","width":"300","align":"left","dataIndex":"V_SRC_DESC","titleAlign":"center","itemId":"V_SRC_DESC_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"hidden":"true","dataIndex":"IS_SYS","itemId":"IS_SYS_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}