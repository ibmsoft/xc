{"inframe":false,"title":"保存编辑之后的数据","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"var id, ids = [];\nvar resc=Wb.decode(request.getParameter('create'));\nvar resc1=Wb.decode(request.getParameter('update'));\nWb.each(resc,function(rec){\n\napp.run(\"select 1 from xc_gl_dimensions where '\"+rec.DIM_CODE+\"'=''\",\n        {errorText:'单位缩写不能为空！'});\napp.run(\"select 1 from xc_gl_dimensions where '\"+rec.DIM_NAME+\"'=''\",\n        {errorText:'单位名称不能为空！'});\n  app.run(\"select 1 from xc_gl_dimensions where DIM_CODE='\"+rec.DIM_CODE+\"'\",\n        {errorText:'' + rec.DIM_CODE + '已经存在。'});\n  app.run(\"select 1 from xc_gl_dimensions where DIM_NAME='\"+rec.DIM_NAME+\"'\",\n        {errorText:'' + rec.DIM_NAME + '已经存在。'});\n  id = java.util.UUID.randomUUID();\n  rec.DIM_ID = id;\n  ids.push({\n    DIM_ID: id\n  });\n});\nWb.each(resc1,function(rec){\n\napp.run(\"select 1 from xc_gl_dimensions where '\"+rec.DIM_CODE+\"'=''\",\n        {errorText:'单位缩写不能为空！'});\napp.run(\"select 1 from xc_gl_dimensions where '\"+rec.DIM_NAME+\"'=''\",\n        {errorText:'单位名称不能为空！'});\napp.run(\"select 1 from xc_gl_dimensions where DIM_CODE='\"+rec.DIM_CODE+\"' and DIM_ID <> '\"+rec.DIM_ID+\"' \" ,\n        {errorText:'' + rec.DIM_CODE + '已经存在。'});\napp.run(\"select 1 from xc_gl_dimensions where DIM_NAME='\"+rec.DIM_NAME+\"' and DIM_ID <> '\"+rec.DIM_ID+\"' \",\n        {errorText:'' + rec.DIM_NAME + '已经存在。'});\n});\nrequest.setAttribute('create', Wb.encode(resc)); //重置create记录\nrequest.setAttribute('update', Wb.encode(resc1));//重置update记录\napp.update({\n  tableName: 'XC_GL_DIMENSIONS'\n});\napp.send(ids); //把id列表发送到客户端以同步到表格","itemId":"module"},"children":[],"expanded":false,"type":"module"}],"pageLink":"","iconCls":""}