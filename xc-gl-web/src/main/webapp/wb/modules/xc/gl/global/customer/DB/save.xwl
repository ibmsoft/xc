{"inframe":false,"title":"","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"var recs = Wb.decode(request.getParameter('create'));\nWb.each(recs,function(rec){\n  rec.CUSTOMER_ID = java.util.UUID.randomUUID();\n  rec.CREATION_DATE = new Date();\n  rec.CREATED_BY = '{#XIP.userId#}';\n  rec.LAST_UPDATE_DATE = new Date();\n  rec.LAST_UPDATED_BY = '{#XIP.userId#}';\n  //检查是否存在重复的CUSTOMER_CODE\n  app.run(\"select 1 from xc_ar_customers where CUSTOMER_CODE='\"+rec.CUSTOMER_CODE+\"'\", {\n    errorText: '\"' + rec.CUSTOMER_CODE + '\" 已经存在。'\n  });\n  //检查是否存在重复的CUSTOMER_NAME\n  app.run(\"select 1 from xc_ar_customers where CUSTOMER_NAME='\"+rec.CUSTOMER_NAME+\"'\", {\n    errorText: '\"' + rec.CUSTOMER_NAME + '\" 已经存在。'\n  });\n});\nrequest.setAttribute('create',Wb.encode(recs));\n\nvar recs1 = Wb.decode(request.getParameter('update'));\nWb.each(recs1,function(rec){\n  rec.LAST_UPDATE_DATE = new Date();\n  rec.LAST_UPDATED_BY = '{#XIP.userId#}';\n  //检查是否存在重复的CUSTOMER_CODE\n  app.run(\"select 1 from xc_ar_customers where CUSTOMER_CODE='\"+rec.CUSTOMER_CODE+\"' and CUSTOMER_ID <>'\"+rec.CUSTOMER_ID+\"'\", {\n    errorText: '\"' + rec.CUSTOMER_CODE + '\" 已经存在。'\n  });\n  //检查是否存在重复的CUSTOMER_NAME\n  app.run(\"select 1 from xc_ar_customers where CUSTOMER_NAME='\"+rec.CUSTOMER_NAME+\"' and CUSTOMER_ID <>'\"+rec.CUSTOMER_ID+\"'\", {\n    errorText: '\"' + rec.CUSTOMER_NAME + '\" 已经存在。'\n  });\n});\nrequest.setAttribute('update',Wb.encode(recs1));\napp.update({\n  tableName: 'xc_ar_customers'\n});\napp.send();","itemId":"module"},"children":[],"expanded":false,"type":"module"}],"pageLink":"","iconCls":""}