{"inframe":false,"title":"修改月结模板数据","hidden":true,"roles":{"dev":1},"children":[{"configs":{"serverScript":"var subRows = Wb.decode(request.getParameter('operateData'));\nvar mainData = Wb.decode(request.getParameter('mainData'));\nvar mainRows = [];\nmainRows.push(mainData);\n//只需处理新增和修改的列，删除操作已经单独执行\n//批量执行新增和更新操作\nvar createRows = subRows.create;\nvar updateRows = subRows.update;\nWb.each(createRows, function(rec) {\n  var subKey = java.util.UUID.randomUUID().toString();\n  Wb.apply(rec, {\n    TPL_DTL_ID: subKey\n  });\n});\n\nrequest.setAttribute('updateRows', Wb.encode(updateRows));\nrequest.setAttribute('createRows', Wb.encode(createRows));\nrequest.setAttribute('mainRows',Wb.encode(mainRows));\n\n","itemId":"module"},"children":[{"configs":{"sql":"update xc_gl_jz_tpl\n  set  JZ_TPL_NAME = {?JZ_TPL_NAME?},\n       V_CATEGORY_ID = {?V_CATEGORY_ID?},\n       ZR_ACC_DR = {?ZR_ACC_DR?},\n       SUMMARY = {?SUMMARY?},\n       LAST_UPDATE_DATE = {?timestamp.sys.date?},\n       LAST_UPDATED_BY ={?XIP.userId?}\nwhere JZ_TPL_ID = {?JZ_TPL_ID?}\n","transaction":"start","itemId":"updateMainTable","arrayName":"mainRows"},"children":[],"expanded":false,"type":"query"},{"configs":{"sql":"insert into xc_gl_jz_tpl_dtl(\n TPL_DTL_ID,   \n JZ_TPL_ID,    \n ZC_ACC_ID,    \n SUM_ACC_ID,   \n BAL_RULE,     \n BAL_DR,       \n ACC_SEGMENTS, \n SUMMARY,      \n CREATION_DATE,   \n CREATED_BY,      \n LAST_UPDATE_DATE,\n LAST_UPDATED_BY \n)values(\n {?TPL_DTL_ID?},\n {?JZ_TPL_ID?},\n {?ZC_ACC_ID?},\n {?SUM_ACC_ID?},\n {?BAL_RULE?},\n {?BAL_DR?},\n {?ACC_SEGMENTS?},\n {?SUMMARY?},\n {?timestamp.sys.date?},\n {?XIP.userId?},\n {?timestamp.sys.date?},\n {?XIP.userId?}\n)","itemId":"insertSubTable","arrayName":"createRows"},"children":[],"expanded":false,"type":"query"},{"configs":{"sql":"update xc_gl_jz_tpl_dtl\n set   ZC_ACC_ID =  {?ZC_ACC_ID?},\n       SUM_ACC_ID = {?SUM_ACC_ID?},\n       BAL_RULE = {?BAL_RULE?},\n       SUMMARY = {?SUMMARY?},\n       BAL_DR ={?BAL_DR?},\n       LAST_UPDATE_DATE = {?timestamp.sys.date?},\n       LAST_UPDATED_BY ={?XIP.userId?}\nwhere  TPL_DTL_ID ={?TPL_DTL_ID?}","itemId":"updateSubTable","arrayName":"updateRows"},"children":[],"expanded":false,"type":"query"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}