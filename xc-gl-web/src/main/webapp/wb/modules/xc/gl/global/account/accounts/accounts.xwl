{"inframe":false,"title":"会计科目管理","hidden":false,"roles":{"default":1},"children":[{"configs":{"title":"{#la_moduleTitle#}","initScript":"com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/gl/global/account/accounts/accounts\");\nvar ctxPath = request.getContextPath() ;\nrequest.setAttribute('contextPath',ctxPath);","loginRequired":"false","jsLinks":"[\"platform/util/platformUtil.js\",\"XCloud/js/createAssKey.js\"]","itemId":"module"},"events":{"finalize":"var group_array = [];//存储所有组\nvar cate_code = '';\nvar rec = '';//选中记录\nvar modify = '';//修改的记录\n// var startDate = '';//科目体系的开始日期\n// var endDate = '';//科目体系的结束日期\nvar uuId;\nvar buttonChange = '';\n/*\n编码规则：一级会计科目的编号：一般采用四位纯数字表示；其中1表示资产类，2表示负债类，3表示所有者权益类，4表示成本类，5为损益类；\n        第二位数字（即百位）：可以划分大类下面小类；剩余两码为流水号。在第一位数字主要类别之下，业务性质相同的会计科目都以同样的号码为第二位数字，\n        在相同业务性质的会计科目下，再以第三位依次排列各个会计科目。其中第二位小类的排列顺序：资产类下面的小类是按照变现能力大小排序；\n        负债类下面的小类是按照流动性大小排序；所有者权益类下面的小类是按照转化为资本的能力大小排序。\n        同时，为便于会计科目的增减，一般情况下，编码要考虑到未来的扩展性，在编码间，留有一定的间隔。\n\t\t二级会计科目的编号：一般采用六位编码，其中前四位为一级科目的代码，后两位为流水号。\n        如：银行存款（编码为1002）下根据银行的不同，设置多个二级别科目，诸如\u201c中国建设银行\u201d、\u201c中国工商银行\u201d、\u201c中国农业银行\u201d等等，\n        则可分别编码为：100201中国建设银行、100202中国工商银行、100203中国农业银行。\n\t\t一般情况下，二级科目都是根据企业的需要来设置。但无论一级科目、二级科目如何设置，其前提都必须要保证编码的唯一性。\n        因此，为了确保会计科目的唯一，数据保存时的检验动作必不可少。\n*/"},"children":[{"configs":{"itemId":"tools"},"children":[{"configs":{"itemId":"buttonArray"},"children":[{"configs":{"text":"{#confirmBtn#}","itemId":"okButton","iconCls":"ok_icon"},"events":{"click":"if(!Wb.verify(app.accountsForm))//验证数据是否合法\n\treturn;\nif(app.ACC_CODE.getValue().length %2 == 1){//编码为奇数不符合规则\n    Wb.toast('科目编码格式不正确！请重新输入');\n    return;\n}\n// //校验科目的开始日期和结束日期是否在所选科目体系的有效期之间\n// if(Ext.util.Format.date(app.START_DATE.getValue(),'Y-m-d') < Ext.util.Format.date(startDate,'Y-m-d') || Ext.util.Format.date(app.END_DATE.getValue(),'Y-m-d') > Ext.util.Format.date(endDate,'Y-m-d')){\n// \tWb.toast('开始日期或结束日期不在科目体系的有效期内，请重新输入！');\n//     return;\n// }\nif(app.START_DATE.getValue() > app.END_DATE.getValue()){\n    Wb.toast('结束日期不能小于开始日期，请重新输入！');\n    return;\n}\nvar group = app.ACC_GROUP_ID.getValue();\n//改变显示值\nfor(var i=0;i < group_array.length;i++) {\n    if(group === group_array[i].ACC_GROUP_NAME)\n        group = group_array[i].ACC_GROUP_ID;\n}\nif(app.ACC_CODE.getValue().length == 4){\n    if(buttonChange === 'insertButton' || buttonChange === 'copyButton'){\n        saveInsert();\n    }\n    if(buttonChange === 'editButton'){\n        saveEdit();\n    }\n}\nif(app.ACC_CODE.getValue().length > 4){//编码为4位一级编码\n\tvar TEMP_ACC_CODE = app.ACC_CODE.getValue().substring(0,app.ACC_CODE.getValue().length-2);//截取字符串\n    Wb.request({\n        url : 'm?xwl=xc/gl/global/account/accounts/accountsDB/accountsCodeSelect',\n        params : {ACC_HRCY_ID : app.acc_hrcy_com.getValue(),ACC_CODE : TEMP_ACC_CODE.replace(\"'\",\"\\\\'\"),ACC_ID : app.ACC_ID.getValue()},\n        success : function(resp){\n            var temp = Ext.decode(resp.responseText);\n            var total = temp.total;\n\t\t\tif(total === 0){\n\t\t\t\tWb.toast('上级编码不存在！请重新输入');\n                return;\n            }\n            if(buttonChange === 'insertButton' || buttonChange === 'copyButton'){\n                saveInsert();\n            }\n            if(buttonChange === 'editButton'){\n                Wb.request({\n                    url : 'm?xwl=xc/gl/global/account/accounts/accountsDB/accountsLowerCodeSelect',\n                    params : {ACC_HRCY_ID : app.acc_hrcy_com.getValue(),ACC_CODE : Ext.String.escape(rec[0].data.ACC_CODE),ACC_ID : app.ACC_ID.getValue()},\n                    success : function(resp){\n                        var temp = Ext.decode(resp.responseText);\n                        var total = temp.total;\n                        if(app.ACC_CODE.getValue() !== rec[0].data.ACC_CODE && total > 0){\n                            Wb.toast('下级编码存在，不能修改！请重新输入');\n                            app.searchButton.fireEvent('click');\n                            return;\n                        }\n                        saveEdit();\n                    }\n                });\n            }\n        }\n    });\n}\nfunction saveInsert(){\n    Wb.request({\n        url: 'm?xwl=xc/gl/global/account/accounts/accountsDB/accountsInsert',\n        out : app.accountsWindow,\n        params : {TEMP_ACC_CODE : app.ACC_CODE.getValue().substring(0,app.ACC_CODE.getValue().length-2),ACC_GROUP_ID : group},\n        success: function(resp) {\n            Wb.toast('数据新增成功！');\n            app.searchButton.fireEvent('click');\n            app.accountsWindow.hide();\n        }\n    });\n}\nfunction saveEdit(){\n    Wb.request({\n        url: 'm?xwl=xc/gl/global/account/accounts/accountsDB/accountsEdits',\n        out : app.accountsWindow,\n        params : {ACC_CODES : rec[0].data.ACC_CODE,TEMP_ACC_CODE : app.ACC_CODE.getValue().substring(0,app.ACC_CODE.getValue().length-2),ACC_GROUP_ID : group},\n        success: function(resp) {\n            Wb.toast('数据修改成功！');\n            app.searchButton.fireEvent('click');\n            app.accountsWindow.hide();\n        }\n    });\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#cancelBtn#}","itemId":"cancelButton","iconCls":"cancel_icon"},"events":{"click":"app.accountsWindow.hide();"},"children":[],"expanded":true,"type":"button"}],"expanded":false,"type":"array"},{"configs":{"autoSync":"true","autoLoad":"true","itemId":"group_store","url":"m?xwl=xc/gl/global/account/accounts/accountsDB/groupSelect"},"events":{"load":"group_array = [];\nvar count = store.getCount();\nfor(var i=0;i < count;i++){\n\tgroup_array.push(store.getAt(i).data);\n}"},"children":[],"expanded":false,"type":"store"},{"configs":{"autoLoad":"true","itemId":"cate_store","url":"m?xwl=xc/gl/global/account/accounts/accountsDB/categorySelect"},"children":[],"expanded":false,"type":"store"},{"configs":{"autoLoad":"true","itemId":"bala_store","url":"m?xwl=xc/gl/global/account/accounts/accountsDB/balance_direction"},"children":[],"expanded":false,"type":"store"},{"configs":{"height":"370","closable":"true","width":"300","layout":"absolute","closeAction":"hide","resizable":"false","buttonAlign":"center","dialog":"true","itemId":"editWindow","modal":"true"},"children":[{"configs":{"tagConfigs":"baseCls : 'my-panel-no-border'","itemId":"editForm"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"rowOp","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.35","text":"{#la_isModify#}","margin":"0 0 0 10","itemId":"UPDATE_ITEM"},"children":[],"expanded":false,"type":"label"},{"configs":{"tagConfigs":"columnWidth : 0.40","text":"{#la_modifyContent#}","margin":"0 0 0 30","itemId":"UPDATE_CONTENT"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row1","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.10","height":"22","margin":"0 0 0 20","itemId":"ACC_CATEGORY_CHECK"},"events":{"change":"if(check.getValue() === true){\n\tapp.ACC_CATEGORY_CODES.allowBlank = false;\n\tapp.ACC_CATEGORY_CODES.setReadOnly(false);\n}\nif(check.getValue() === false){\n    app.ACC_CATEGORY_CODES.allowBlank = true;\n\tapp.ACC_CATEGORY_CODES.setReadOnly(true);\n    app.ACC_CATEGORY_CODES.setValue('');\n}"},"children":[],"expanded":true,"type":"check"},{"configs":{"tagConfigs":"columnWidth : 0.88","labelWidth":"80","readOnly":"true","displayField":"ACC_CATEGORY_NAME","valueField":"ACC_CATEGORY_CODE","labelAlign":"right","itemId":"ACC_CATEGORY_CODES","fieldLabel":"{#la_necessaryAccount#}","editable":"false"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/global/account/accounts/accountsDB/categorySelect"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row2","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.1","margin":"0 0 0 20","itemId":"BALANCE_DIRECTION_CHECK"},"events":{"change":"if(check.getValue() === true){\n\tapp.BALANCE_DIRECTIONS.allowBlank = false;\n\tapp.BALANCE_DIRECTIONS.setReadOnly(false);\n}\nif(check.getValue() === false){\n    app.BALANCE_DIRECTIONS.allowBlank = true;\n\tapp.BALANCE_DIRECTIONS.setReadOnly(true);\n    app.BALANCE_DIRECTIONS.setValue('');\n}"},"children":[],"expanded":false,"type":"check"},{"configs":{"tagConfigs":"columnWidth : 0.88","labelWidth":"80","readOnly":"true","displayField":"VAL_NAME","valueField":"VAL_CODE","labelAlign":"right","itemId":"BALANCE_DIRECTIONS","fieldLabel":"{#la_necessaryBalDirection#}","editable":"false"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/global/account/accounts/accountsDB/balance_direction"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row3","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.10","height":"22","margin":"0 0 0 20","itemId":"ACC_GROUP_CHECK"},"events":{"change":"if(check.getValue() === true){\n\tapp.ACC_GROUP_IDS.setReadOnly(false);\n}\nif(check.getValue() === false){\n\tapp.ACC_GROUP_IDS.setReadOnly(true);\n    app.ACC_GROUP_IDS.setValue('');\n}"},"children":[],"expanded":false,"type":"check"},{"configs":{"tagConfigs":"columnWidth : 0.88","labelWidth":"80","readOnly":"true","labelAlign":"right","itemId":"ACC_GROUP_IDS","fieldLabel":"{#la_accountGroup#}"},"events":{"change":"if(newValue !== '' || newValue !== null){\n    //app.clearGroupIds.show();\n}"},"children":[{"configs":{"tagConfigs":"minWidth : 300","height":"300","store":"app.group_store","barExportButtons":"false","barRefreshButton":"false","itemId":"pickComp","barInfoLabel":"false"},"events":{"itemclick":"var picker = this.ownerCmp;\npicker.setValue(record.data.ACC_GROUP_NAME);\n// app.acc_group_com.setValue(record.get('ACC_GROUP_ID')); //把记录ACC_GROUP_ID存放到隐藏域，可方便被提交到后台\npicker.collapse();\napp.GROUP_TEXTS.reset();"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"labelWidth":"70","emptyText":"{#la_accountTip#}","labelAlign":"right","itemId":"GROUP_TEXTS"},"events":{"change":"if(text.getValue() === ''){\n    app.GROUP_TEXTSSearchButton.fireEvent('click');\n}","specialkey":"if(Ext.EventObject.getKey()==13){\n\tapp.GROUP_TEXTSSearchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"width":"25","itemId":"GROUP_TEXTSSearchButton","iconCls":"seek_icon","tooltip":"{#queryBtn#}"},"events":{"click":"app.group_store.load({params : {group_name : app.GROUP_TEXTS.getValue()}});"},"children":[],"expanded":false,"type":"button"},{"configs":{"width":"25","itemId":"GROUP_TEXTSResetButton","iconCls":"cancel_icon","tooltip":"{#resetBtn#}"},"events":{"click":"app.ACC_GROUP_IDS.reset();\napp.ACC_GROUP_IDS.getPicker().hide();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"ID","hidden":"true","dataIndex":"ACC_GROUP_ID","itemId":"ACC_GROUP_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accCode#}","width":"80","dataIndex":"ACC_GROUP_CODE","titleAlign":"center","itemId":"ACC_GROUP_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accName#}","width":"130","dataIndex":"ACC_GROUP_NAME","titleAlign":"center","itemId":"ACC_GROUP_NAME_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"picker"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","text":"✘","height":"18","hidden":"true","itemId":"clearGroupIds"},"events":{"click":"app.ACC_GROUP_IDS.reset();\napp.clearGroupIds.hide();"},"children":[],"expanded":false,"type":"button"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row6","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.10","margin":"0 0 0 20","itemId":"IS_UPDATE_BANK_ACCS"},"events":{"change":"if(check.getValue() === true){\n\tapp.IS_BANK_ACCS.setReadOnly(false);\n}\nif(check.getValue() === false){\n    app.IS_BANK_ACCS.setReadOnly(true);\n    app.IS_BANK_ACCS.reset();\n}"},"children":[],"expanded":true,"type":"check"},{"configs":{"tagConfigs":"columnWidth : 0.88","labelWidth":"80","readOnly":"true","pickList":"[['Y','是'],['N','否']]","labelAlign":"right","itemId":"IS_BANK_ACCS","fieldLabel":"{#la_bankAccount#}","editable":"false"},"children":[],"expanded":false,"type":"combo"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row7","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.10","margin":"0 0 0 20","itemId":"IS_UPDATE_CASH_ACCS"},"events":{"change":"if(check.getValue() === true){\n\tapp.IS_CASH_ACCS.setReadOnly(false);\n}\nif(check.getValue() === false){\n    app.IS_CASH_ACCS.setReadOnly(true);\n    app.IS_CASH_ACCS.reset();\n}"},"children":[],"expanded":false,"type":"check"},{"configs":{"tagConfigs":"columnWidth : 0.88","labelWidth":"80","readOnly":"true","pickList":"[['Y','是'],['N','否']]","labelAlign":"right","itemId":"IS_CASH_ACCS","fieldLabel":"{#la_cashAccount#}","editable":"false"},"children":[],"expanded":false,"type":"combo"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row8","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.10","margin":"0 0 0 20","itemId":"IS_UPDATE_CASH_ITEMS"},"events":{"change":"if(check.getValue() === true){\n\tapp.IS_CASH_ITEMS.setReadOnly(false);\n}\nif(check.getValue() === false){\n    app.IS_CASH_ITEMS.setReadOnly(true);\n    app.IS_CASH_ITEMS.reset();\n}"},"children":[],"expanded":false,"type":"check"},{"configs":{"tagConfigs":"columnWidth : 0.88","labelWidth":"80","readOnly":"true","pickList":"[['Y','是'],['N','否']]","labelAlign":"right","itemId":"IS_CASH_ITEMS","fieldLabel":"{#la_cashItem#}","editable":"false"},"children":[],"expanded":false,"type":"combo"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row4","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.10","margin":"0 0 0 20","itemId":"START_DATE_CHECK"},"events":{"change":"if(check.getValue() === true){\n\tapp.START_DATES.allowBlank = false;\n\tapp.START_DATES.setReadOnly(false);\n    app.START_DATES.setValue(new Date());\n}\nif(check.getValue() === false){\n    app.START_DATES.allowBlank = true;\n\tapp.START_DATES.setReadOnly(true);\n    app.START_DATES.setValue('');\n}"},"children":[],"expanded":false,"type":"check"},{"configs":{"tagConfigs":"columnWidth : 0.88","labelWidth":"80","readOnly":"true","labelAlign":"right","itemId":"START_DATES","fieldLabel":"{#la_mustSDate#}"},"children":[],"expanded":false,"type":"date"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row5","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.10","margin":"0 0 0 20","itemId":"END_DATE_CHECK"},"events":{"change":"if(check.getValue() === true){\n\tapp.END_DATES.allowBlank = false;\n\tapp.END_DATES.setReadOnly(false);\n}\nif(check.getValue() === false){\n    app.END_DATES.allowBlank = true;\n\tapp.END_DATES.setReadOnly(true);\n    app.END_DATES.setValue('');\n}"},"children":[],"expanded":false,"type":"check"},{"configs":{"tagConfigs":"columnWidth : 0.88","labelWidth":"80","readOnly":"true","labelAlign":"right","itemId":"END_DATES","fieldLabel":"{#la_mustEDate#}"},"children":[],"expanded":false,"type":"date"}],"expanded":false,"type":"panel"}],"expanded":true,"type":"form"}],"expanded":true,"type":"window"},{"configs":{"height":"205","width":"610","layout":"absolute","closeAction":"hide","resizable":"false","buttons":"app.buttonArray","buttonAlign":"center","itemId":"accountsWindow1","modal":"true"},"children":[{"configs":{"tagConfigs":"baseCls : 'my-panel-no-border'","itemId":"accountsForm"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","hidden":"true","layout":"column","itemId":"rowHide","border":"false"},"children":[{"configs":{"labelWidth":"80","hidden":"true","labelAlign":"right","itemId":"ACC_HRCY_ID","fieldLabel":"科目体系"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","height":"22","hidden":"true","labelAlign":"right","itemId":"IS_LEAF","fieldLabel":"末级"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","hidden":"true","labelAlign":"right","itemId":"UP_ACC_CODE","fieldLabel":"上级编码"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","hidden":"true","labelAlign":"right","itemId":"ACC_LEVEL","fieldLabel":"级别"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","hidden":"true","labelAlign":"right","itemId":"ACC_ID","fieldLabel":"科目ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","hidden":"true","labelAlign":"right","itemId":"ASS_KEY","fieldLabel":"助记符"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row1","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.34","labelWidth":"80","maxLength":"14","minLength":"4","allowOnlyWhitespace":"true","vtype":"alphanum","labelAlign":"right","itemId":"ACC_CODE","fieldLabel":"科目编码"},"events":{"change":"if(newValue.length == 4){\n\tapp.UP_ACC_CODE.setValue('-1');\n}\nif(newValue.length > 4){\n    app.UP_ACC_CODE.setValue(newValue.substring(0,newValue.length-2));\n}\napp.ACC_LEVEL.setValue((newValue.length - 4) / 2 + 1);"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"columnWidth : 0.64","labelWidth":"80","labelAlign":"right","itemId":"ACC_NAME","fieldLabel":"科目名称"},"events":{"change":"app.ASS_KEY.setValue(getAssKey(newValue));"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row2","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.34","labelWidth":"80","store":"app.cate_store","displayField":"ACC_CATEGORY_NAME","valueField":"ACC_CATEGORY_CODE","labelAlign":"right","itemId":"ACC_CATEGORY_CODE","fieldLabel":"科目分类","editable":"false"},"children":[],"expanded":true,"type":"combo"},{"configs":{"tagConfigs":"columnWidth : 0.64","labelWidth":"80","store":"app.group_store","displayField":"ACC_GROUP_NAME","hidden":"true","valueField":"ACC_GROUP_ID","labelAlign":"right","itemId":"ACC_GROUP_ID1","fieldLabel":"科目组　","editable":"false"},"events":{"change":"if(combo.getValue() !== ''){\n\tapp.clearGroupId.show();\n}"},"children":[],"expanded":true,"type":"combo"},{"configs":{"tagConfigs":"columnWidth : 0.64","labelWidth":"80","labelAlign":"right","itemId":"ACC_GROUP_ID","fieldLabel":"科目组　","editable":"false"},"events":{"change":"if(newValue !== '' || newValue !== null){\n    //app.clearGroupId.show();\n}\n//改变显示值\nfor(var i=0;i < group_array.length;i++) {\n\tif(newValue === group_array[i].ACC_GROUP_ID){\n        app.ACC_GROUP_ID.setValue(group_array[i].ACC_GROUP_NAME);\n    }\n}"},"children":[{"configs":{"tagConfigs":"minWidth : 320","height":"300","store":"app.group_store","barExportButtons":"false","barRefreshButton":"false","itemId":"pickComp","barInfoLabel":"false"},"events":{"itemclick":"var picker = this.ownerCmp;\npicker.setValue(record.data.ACC_GROUP_ID);\n// app.acc_group_com.setValue(record.get('ACC_GROUP_ID')); //把记录ACC_GROUP_ID存放到隐藏域，可方便被提交到后台\npicker.collapse();\napp.GROUP_TEXT.reset();"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"labelWidth":"70","emptyText":"根据编码/名称查询","labelAlign":"right","itemId":"GROUP_TEXT"},"events":{"change":"if(text.getValue() === ''){\n    app.GROUP_TEXTSearchButton.fireEvent('click');\n}","specialkey":"if(Ext.EventObject.getKey()==13){\n\tapp.GROUP_TEXTSearchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"width":"25","itemId":"GROUP_TEXTSearchButton","iconCls":"seek_icon","tooltip":"查询"},"events":{"click":"app.group_store.load({params : {group_name : app.GROUP_TEXT.getValue()}});"},"children":[],"expanded":false,"type":"button"},{"configs":{"width":"25","itemId":"GROUP_TEXTResetButton","iconCls":"cancel_icon","tooltip":"重置"},"events":{"click":"app.ACC_GROUP_ID.reset();\napp.ACC_GROUP_ID.getPicker().hide();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"序号","hidden":"true","align":"center","xtype":"rownumberer","width":"50","titleAlign":"center","itemId":"ORDERBY"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ID","hidden":"true","dataIndex":"ACC_GROUP_ID","itemId":"ACC_GROUP_ID_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"编码","width":"80","dataIndex":"ACC_GROUP_CODE","titleAlign":"center","itemId":"ACC_GROUP_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"名称","width":"130","dataIndex":"ACC_GROUP_NAME","titleAlign":"center","itemId":"ACC_GROUP_NAME_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":false,"type":"grid"}],"expanded":true,"type":"picker"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","text":"✘","hidden":"true","margin":"0 0 0 0","itemId":"clearGroupId"},"events":{"click":"app.ACC_GROUP_ID.reset();\napp.clearGroupId.hide();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row3","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.34","labelWidth":"80","store":"app.bala_store","displayField":"VAL_NAME","valueField":"VAL_CODE","labelAlign":"right","itemId":"BALANCE_DIRECTION","fieldLabel":"余额方向","editable":"false"},"children":[],"expanded":true,"type":"combo"},{"configs":{"tagConfigs":"columnWidth : 0.32","labelWidth":"80","pickList":"[['Y','是'],['N','否']]","labelAlign":"right","itemId":"IS_BANK_ACC","fieldLabel":"银行科目","editable":"false"},"children":[],"expanded":false,"type":"combo"},{"configs":{"tagConfigs":"columnWidth : 0.32","labelWidth":"80","pickList":"[['Y','是'],['N','否']]","labelAlign":"right","itemId":"IS_CASH_ACC","fieldLabel":"现金科目","editable":"false"},"children":[],"expanded":false,"type":"combo"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 10 0","itemId":"row5","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.34","labelWidth":"80","pickList":"[['Y','是'],['N','否']]","labelAlign":"right","itemId":"IS_CASH_ITEM","fieldLabel":"现金流量","editable":"false"},"children":[],"expanded":false,"type":"combo"},{"configs":{"tagConfigs":"columnWidth : 0.32","labelWidth":"80","labelAlign":"right","itemId":"START_DATE","fieldLabel":"开始日期"},"children":[],"expanded":false,"type":"date"},{"configs":{"tagConfigs":"columnWidth : 0.32","labelWidth":"80","labelAlign":"right","itemId":"END_DATE","fieldLabel":"结束日期"},"children":[],"expanded":false,"type":"date"}],"expanded":false,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row6","border":"false"},"children":[],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"}],"expanded":false,"type":"window"},{"configs":{"height":"380","width":"700","layout":"absolute","closeAction":"hide","resizable":"false","buttons":"app.buttonArray","buttonAlign":"center","itemId":"accountsWindow","modal":"true"},"children":[{"configs":{"tagConfigs":"baseCls : 'my-panel-no-border'","itemId":"accountsForm"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","hidden":"true","layout":"column","itemId":"rowHide","border":"false"},"children":[{"configs":{"labelWidth":"80","hidden":"true","labelAlign":"right","itemId":"ACC_HRCY_ID","fieldLabel":"科目体系"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","height":"22","hidden":"true","labelAlign":"right","itemId":"IS_LEAF","fieldLabel":"末级"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","hidden":"true","labelAlign":"right","itemId":"UP_ACC_CODE","fieldLabel":"上级编码"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","hidden":"true","labelAlign":"right","itemId":"ACC_LEVEL","fieldLabel":"级别"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","hidden":"true","labelAlign":"right","itemId":"ACC_ID","fieldLabel":"科目ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"80","hidden":"true","labelAlign":"right","itemId":"ASS_KEY","fieldLabel":"助记符"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"panel"},{"configs":{"title":"{#la_setInformation#}","frame":"true","margin":"10","border":"true","itemId":"set_row1"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"3 0 0 0","itemId":"row1","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.47","labelWidth":"{#labelWidth#}","allowBlank":"false","maxLength":"14","minLength":"4","vtype":"alphanum","labelAlign":"right","itemId":"ACC_CODE","fieldLabel":"{#la_necessaryCode#}"},"events":{"change":"if(newValue.length == 4){\n\tapp.UP_ACC_CODE.setValue('-1');\n}\nif(newValue.length > 4){\n    app.UP_ACC_CODE.setValue(newValue.substring(0,newValue.length-2));\n}\napp.ACC_LEVEL.setValue((newValue.length - 4) / 2 + 1);"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"columnWidth : 0.47","labelWidth":"{#labelWidth#}","allowBlank":"false","labelAlign":"right","itemId":"ACC_NAME","fieldLabel":"{#la_necessaryName#}"},"events":{"change":"app.ASS_KEY.setValue(getAssKey(newValue));"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row2","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.47","labelWidth":"{#labelWidth#}","allowBlank":"false","store":"app.cate_store","displayField":"ACC_CATEGORY_NAME","valueField":"ACC_CATEGORY_CODE","labelAlign":"right","itemId":"ACC_CATEGORY_CODE","fieldLabel":"{#la_necessaryAccount#}","editable":"false"},"events":{"change":"if(buttonChange === 'insertButton'){\n    Wb.request({\n        url : 'm?xwl=xc/gl/global/account/accounts/accountsDB/categorySelect',\n        params : {ACC_CATEGORY_CODE : newValue},\n        success : function(resp){\n            var temp = Wb.decode(resp.responseText);\n            app.BALANCE_DIRECTION.setValue(temp.rows[0].BALANCE_DIRECTION);\n        }\n    });\n}"},"children":[],"expanded":true,"type":"combo"},{"configs":{"tagConfigs":"columnWidth : 0.47","labelWidth":"{#labelWidth#}","labelAlign":"right","itemId":"ACC_GROUP_ID","fieldLabel":"{#la_accountGroup#}","editable":"false"},"events":{"change":"if(newValue !== '' || newValue !== null){\n    //app.clearGroupId.show();\n}\n//改变显示值\nfor(var i=0;i < group_array.length;i++) {\n\tif(newValue === group_array[i].ACC_GROUP_ID){\n        app.ACC_GROUP_ID.setValue(group_array[i].ACC_GROUP_NAME);\n    }\n}"},"children":[{"configs":{"tagConfigs":"minWidth : 300","height":"300","store":"app.group_store","barExportButtons":"false","barRefreshButton":"false","itemId":"pickComp","barInfoLabel":"false"},"events":{"itemclick":"var picker = this.ownerCmp;\npicker.setValue(record.data.ACC_GROUP_ID);\n// app.acc_group_com.setValue(record.get('ACC_GROUP_ID')); //把记录ACC_GROUP_ID存放到隐藏域，可方便被提交到后台\npicker.collapse();\napp.GROUP_TEXT.reset();"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"labelWidth":"70","emptyText":"{#la_accountTip#}","labelAlign":"right","itemId":"GROUP_TEXT"},"events":{"change":"if(text.getValue() === ''){\n    app.GROUP_TEXTSearchButton.fireEvent('click');\n}","specialkey":"if(Ext.EventObject.getKey()==13){\n\tapp.GROUP_TEXTSearchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"width":"25","itemId":"GROUP_TEXTSearchButton","iconCls":"seek_icon","tooltip":"{#queryBtn#}"},"events":{"click":"app.group_store.load({params : {group_name : app.GROUP_TEXT.getValue()}});"},"children":[],"expanded":false,"type":"button"},{"configs":{"width":"25","itemId":"GROUP_TEXTResetButton","iconCls":"cancel_icon","tooltip":"{#resetBtn#}"},"events":{"click":"app.ACC_GROUP_ID.reset();\napp.ACC_GROUP_ID.getPicker().hide();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"ID","hidden":"true","dataIndex":"ACC_GROUP_ID","itemId":"ACC_GROUP_ID_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_accCode#}","width":"80","dataIndex":"ACC_GROUP_CODE","titleAlign":"center","itemId":"ACC_GROUP_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accName#}","width":"130","dataIndex":"ACC_GROUP_NAME","titleAlign":"center","itemId":"ACC_GROUP_NAME_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":false,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"picker"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","text":"✘","hidden":"true","margin":"0 0 0 0","itemId":"clearGroupId"},"events":{"click":"app.ACC_GROUP_ID.reset();\napp.clearGroupId.hide();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 10 0","itemId":"row3","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.47","labelWidth":"{#labelWidth#}","allowBlank":"false","store":"app.bala_store","displayField":"VAL_NAME","valueField":"VAL_CODE","labelAlign":"right","itemId":"BALANCE_DIRECTION","fieldLabel":"{#la_necessaryBalDirection#}","editable":"false"},"children":[],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"fieldset"},{"configs":{"title":"{#la_setAccount#}","frame":"true","margin":"10","itemId":"set_row2"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"3 0 0 0","itemId":"row4","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.47","labelWidth":"{#labelWidth#}","pickList":"[['Y','是'],['N','否']]","labelAlign":"right","itemId":"IS_BANK_ACC","fieldLabel":"{#la_bankAccount#}","editable":"false"},"children":[],"expanded":false,"type":"combo"},{"configs":{"tagConfigs":"columnWidth : 0.47","labelWidth":"{#labelWidth#}","pickList":"[['Y','是'],['N','否']]","labelAlign":"right","itemId":"IS_CASH_ACC","fieldLabel":"{#la_cashAccount#}","editable":"false"},"children":[],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 10 0","itemId":"row5","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.47","labelWidth":"{#labelWidth#}","pickList":"[['Y','是'],['N','否']]","labelAlign":"right","itemId":"IS_CASH_ITEM","fieldLabel":"{#la_cashItem#}","editable":"false"},"children":[],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"fieldset"},{"configs":{"title":"{#la_expireDate#}","frame":"true","margin":"10","itemId":"set_row3"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"3 0 10 0","itemId":"row5","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.47","labelWidth":"{#labelWidth#}","allowBlank":"false","labelAlign":"right","itemId":"START_DATE","fieldLabel":"{#la_mustSDate#}"},"children":[],"expanded":false,"type":"date"},{"configs":{"tagConfigs":"columnWidth : 0.47","labelWidth":"{#labelWidth#}","allowBlank":"false","labelAlign":"right","itemId":"END_DATE","fieldLabel":"{#la_mustEDate#}"},"children":[],"expanded":false,"type":"date"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"fieldset"}],"expanded":true,"type":"form"}],"expanded":true,"type":"window"}],"expanded":true,"type":"folder"},{"configs":{"itemId":"windows"},"children":[{"configs":{"maximized":"true","title":"{#la_importTitle#}","height":"400","minimizable":"true","width":"750","layout":"border","dialog":"false","border":"false","itemId":"importDataWin","modal":"true","maximizable":"true","createInstance":"false"},"events":{"close":"app.accounts_grid.getStore().reload();"},"children":[{"configs":{"region":"center","frame":"true","style":"border-width:0px","layout":"column","padding":"15 0 0 5","border":"false","itemId":"importForm"},"children":[{"configs":{"tagConfigs":"columnWidth:.35","labelWidth":"80","allowBlank":"false","emptyText":"{#la_fileTip#}","labelAlign":"left","itemId":"selectFile","fieldLabel":"{#la_fileName#}"},"children":[],"expanded":false,"type":"file"},{"configs":{"text":"{#importBtn#}","itemId":"importFile","iconCls":"ok_icon","x":"2"},"events":{"click":"if(!app.importForm.getForm().isValid()){\n  Wb.info('请选择要上传的文件！');\n  return false;\n}\nvar fileType = app.selectFile.getValue();\nif(!Ext.String.endsWith(fileType,'.xls')){\n  Wb.info('请选择以xls结尾的Office Excel文档!',function(){\n    app.importForm.getForm().reset();\n  });\n}else{\n  //导入前，先清除错误数据\n  app.importLogGrid.getStore().removeAll();\n  var msgProcessBar = Ext.Msg.show({\n     title:'提示',\n     msg  :'导入中，请稍后.....',\n     wait :true,\n     width:200\n  });\n  //将Office Excel数据导入到余额临时表中\n  //科目体系\n  var accHrcyId = app.acc_hrcy_com.getValue();\n  app.importForm.getForm().submit({\n    url:'{#contextPath#}/glDataTransgerManageAction.do?method=importAccountData&templateCode=XC_GL_ACCOUNTS&accHrcyId='+accHrcyId,\n    timeout:3600*1000,\n    success:function(form,action){\n      msgProcessBar.hide();\n      Wb.info(action.result.msg,function(){\n        app.importDataWin.close();\n      });\n    },\n    failure:function(form,action){\n      msgProcessBar.hide();\n      var _flag = action.result.flag;\n      //flag =0,导入时发生异常，输出异常信息\n      if(_flag == '0'){\n        Wb.info(action.result.msg);\n      }else if(_flag == '2'){\n       //flag =2,数据导入临时表成功，数据校验发生异常\n        var _sessionId = action.result.msg;\n        Wb.info('导入数据不合法！');\n        app.importLogGrid.getStore().load({params:{'sessionId':_sessionId}});\n      }\n    }   \n  });\n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"form"},{"configs":{"region":"south","height":"'88%'","itemId":"southTab"},"children":[{"configs":{"title":"{#la_importLogs#}","selType":"checkboxmodel","itemId":"importLogGrid"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#la_incorrectColumn#}","width":"70","dataIndex":"ROW_NUM","itemId":"ROW_NUM","renderer":"return '<font color=\"red\">'+value+'<\/font>';"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_accCode#}","width":"150","dataIndex":"ACC_CODE","itemId":"ACC_CODE"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_upAccCode#}","width":"120","dataIndex":"UP_ACC_CODE","itemId":"UP_ACC_CODE"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_accName#}","width":"200","dataIndex":"ACC_NAME","itemId":"ACC_NAME"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_balDirection#}","width":"55","dataIndex":"BALANCE_DIRECTION","itemId":"BALANCE_DIRECTION","renderer":"if(value == 1)\n  return '借';\nelse\n   return '贷';"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_startDate#}","width":"120","dataIndex":"START_DATE","itemId":"START_DATE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_endDate#}","width":"120","dataIndex":"END_DATE","itemId":"END_DATE"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_errorInformation#}","width":"300","dataIndex":"ERROR_MSG","itemId":"E_MSG","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:15px;';   \nreturn '<font color=\"red\">'+value+'<\/font>';","flex":"1"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/global/account/accounts/accountsDB/getInvalidAccount"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"tab"}],"expanded":true,"type":"window"}],"expanded":true,"type":"folder"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","border":"false","itemId":"search_form"},"events":{"afterrender":"Wb.request({\n\turl : 'm?xwl=xc/gl/global/account/accounts/accountsDB/categorySelect',\n\tsuccess : function(response){\n        var temp = Ext.decode(response.responseText);//从后台获取数据\n\t\tvar total = temp.total;\n\t\t//var name = temp1.ACC_CATEGORY_NAME;\n        var allRadio = Ext.create('Ext.form.field.Radio',{\n            name : 'answerRadio',\n            boxLabel : '全部',\n            inputValue : '',\n\t\t\tid : 'radio'+0,\n            labelAlign : \"right\",\n            labelWidth : 60,\n            width : 100\n        });\n\t\tapp.radioPanel1.add(allRadio);\n        for(var i = 1;i <= total; i++){\n\t\t\tvar name = temp.rows[i-1].ACC_CATEGORY_NAME;\n\t\t\tvar code = temp.rows[i-1].ACC_CATEGORY_CODE;\n            var anserRadio = Ext.create('Ext.form.field.Radio',{\n                name : 'answerRadio',\n                boxLabel : name,\n                inputValue : code,\n                id : 'radio'+i,\n                labelAlign: \"right\",\n                labelWidth : 60,\n                width : 100\n            });\n            app.radioPanel1.add(anserRadio);\n        }\n\t\t/*for(var j = 0;j < total;j++){\n            Ext.getCmp('radio' + j).on('focus',function(){\n                cate_code = Ext.getCmp('radio' + j).inputValue;\n                alert(cate_code);\n                app.searchButton.fireEvent('click');\n            });\n        }*/\n        Ext.getCmp('radio' + 0).on('focus',function(){\n            cate_code = Ext.getCmp('radio' + 0).inputValue;\n            Ext.getCmp('radio' + 0).setValue(true);\n            app.searchButton.fireEvent('click');\n        });\n        Ext.getCmp('radio' + 1).on('focus',function(){\n            cate_code = Ext.getCmp('radio' + 1).inputValue;\n            Ext.getCmp('radio' + 1).setValue(true);\n            app.searchButton.fireEvent('click');\n        });\n        Ext.getCmp('radio' + 2).on('focus',function(){\n            cate_code = Ext.getCmp('radio' + 2).inputValue;\n            Ext.getCmp('radio' + 2).setValue(true);\n            app.searchButton.fireEvent('click');\n        });\n        Ext.getCmp('radio' + 3).on('focus',function(){\n            cate_code = Ext.getCmp('radio' + 3).inputValue;\n            Ext.getCmp('radio' + 3).setValue(true);\n            app.searchButton.fireEvent('click');\n        });\n        Ext.getCmp('radio' + 4).on('focus',function(){\n          cate_code = Ext.getCmp('radio' + 4).inputValue;\n            Ext.getCmp('radio' + 4).setValue(true);\n          app.searchButton.fireEvent('click');\n        });\n\t\tExt.getCmp('radio' + 5).on('focus',function(){\n            cate_code = Ext.getCmp('radio' + 5).inputValue;\n            Ext.getCmp('radio' + 5).setValue(true);\n            app.searchButton.fireEvent('click');\n        });\n        Ext.getCmp('radio' + 6).on('focus',function(){\n            cate_code = Ext.getCmp('radio' + 6).inputValue;\n            Ext.getCmp('radio' + 6).setValue(true);\n            app.searchButton.fireEvent('click');\n        });\n        Ext.getCmp('radio' + 7).on('focus',function(){\n            cate_code = Ext.getCmp('radio' + 7).inputValue;\n            Ext.getCmp('radio' + 7).setValue(true);\n            app.searchButton.fireEvent('click');\n        });\n    }\n});\n"},"children":[{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","layout":"column","margin":"10 0 0 0","itemId":"row1","border":"false"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.25","labelWidth":"{#labelWidth#}","store":"app.hrcy_store","displayField":"ACC_HRCY_NAME","valueField":"ACC_HRCY_ID","labelAlign":"right","itemId":"acc_hrcy_com","fieldLabel":"{#la_accountHrcy#}","editable":"false"},"events":{"change":"if(combo.getValue() === null){\n    app.searchButton.fireEvent('click');\n    app.acc_group_com1.reset();\n    app.searchText.reset();\n}","select":"app.searchButton.fireEvent('click');","specialkey":"if(Ext.EventObject.getKey()==13){\n\tapp.searchButton.fireEvent('click');\n}"},"children":[{"configs":{"itemId":"store","url":"m?xwl=xc/gl/global/account/accounts/accountsDB/hrcySelect"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"},{"configs":{"tagConfigs":"columnWidth : 0.20","labelWidth":"{#labelWidth#}","labelAlign":"right","itemId":"acc_group_com","fieldLabel":"{#la_accountGroup#}","editable":"false"},"events":{"change":"app.searchButton.fireEvent('click');"},"children":[{"configs":{"tagConfigs":"minWidth : 300","height":"300","store":"app.group_store","barExportButtons":"false","barRefreshButton":"false","itemId":"pickComp","barInfoLabel":"false"},"events":{"itemclick":"var picker = this.ownerCmp;\npicker.setValue(record.data.ACC_GROUP_NAME);\napp.exportGroupId.setValue(record.data.ACC_GROUP_ID);\npicker.collapse();\napp.group_text.reset();"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"labelWidth":"70","emptyText":"根据编码/名称查询","labelAlign":"right","itemId":"group_text"},"events":{"change":"if(text.getValue() === ''){\n    app.groupSearchButton.fireEvent('click');\n}","specialkey":"if(Ext.EventObject.getKey()==13){\n\tapp.groupSearchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"width":"25","itemId":"groupSearchButton","iconCls":"seek_icon","tooltip":"查询"},"events":{"click":"app.group_store.load({params : {group_name : app.group_text.getValue()}});"},"children":[],"expanded":false,"type":"button"},{"configs":{"width":"25","itemId":"groupResetButton","iconCls":"cancel_icon","tooltip":"重置"},"events":{"click":"app.acc_group_com.reset();\napp.acc_group_com.getPicker().hide();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"序号","hidden":"true","align":"center","xtype":"rownumberer","width":"50","titleAlign":"center","itemId":"ORDERBY"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ID","hidden":"true","dataIndex":"ACC_GROUP_ID","itemId":"ACC_GROUP_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"编码","width":"80","dataIndex":"ACC_GROUP_CODE","titleAlign":"center","itemId":"ACC_GROUP_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"名称","width":"130","dataIndex":"ACC_GROUP_NAME","titleAlign":"center","itemId":"ACC_GROUP_NAME_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"picker"},{"configs":{"tagConfigs":"columnWidth : 0.25","labelWidth":"{#labelWidth#}","labelAlign":"right","itemId":"searchText","fieldLabel":"{#la_codeName#}"},"events":{"change":"if(text.getValue() === ''){\n    app.searchButton.fireEvent('click');\n    app.clearText.hide();\n}\nelse{\n\tapp.clearText.hide();\n}","specialkey":"if(Ext.EventObject.getKey()==13){\n\tapp.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"exportGroupId","fieldLabel":"导出科目组ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","text":"✘","hidden":"true","itemId":"clearText"},"events":{"click":"app.searchText.reset();"},"children":[],"expanded":false,"type":"button"},{"configs":{"tagConfigs":"columnWidth : 0.08","text":"{#la_queryBtn#}","margin":"0 0 0 20","itemId":"searchButton","iconCls":"seek_icon"},"events":{"click":"if(app.acc_hrcy_com.getValue() === null || app.acc_hrcy_com.getValue() === ''){\n\tWb.toast('请选择科目体系！');\n    return;\n}\nWb.request({\n\turl : 'm?xwl=xc/gl/global/account/accounts/accountsDB/hrcySelect',\n    params : {ACC_HRCY_ID : app.acc_hrcy_com.getValue(),NOWDATE : Ext.util.Format.date(new Date(),'Y-m-d')},\n    success : function(resp){\n        var temp = Ext.decode(resp.responseText);\n        if(temp.total > 0){\n//             startDate = temp.rows[0].START_DATE;\n//             endDate = temp.rows[0].END_DATE;\n            if(temp.rows[0].IS_PREPARED == 'Y'){\n                app.addButton.setDisabled(true);\n                app.addButton1.setDisabled(true);\n                app.editButton.setDisabled(true);\n                app.deleteButton.setDisabled(true);\n                app.batchEditButton.setDisabled(true);\n                app.saveButton.setDisabled(true);\n                app.copyButton.setDisabled(true);\n                app.copyButton1.setDisabled(true);\n                app.importButton.setDisabled(true);\n            }\n            if(temp.rows[0].IS_PREPARED == 'N'){\n                app.addButton.setDisabled(false);\n                app.addButton1.setDisabled(false);\n                app.editButton.setDisabled(false);\n                app.deleteButton.setDisabled(false);\n                app.batchEditButton.setDisabled(false);\n                app.saveButton.setDisabled(false);\n                app.copyButton.setDisabled(false);\n                app.copyButton1.setDisabled(false);\n                app.importButton.setDisabled(false);\n            }\n        }\n        var group = app.acc_group_com.getValue();\n        //改变显示值\n        for(var i=0;i < group_array.length;i++) {\n            if(group === group_array[i].ACC_GROUP_NAME)\n               group = group_array[i].ACC_GROUP_ID;\n        }\n\t\tapp.accounts_grid.store.load({\n          params : {\n            'ACC_INFO'          : Ext.String.escape(app.searchText.getValue()),\n            'ACC_HRCY_ID'       : app.acc_hrcy_com.getValue(),\n            'ACC_GROUP_ID'      : group,\n            'ACC_CATEGORY_INFO' : cate_code,\n            'IS_LEAF'           : app.chkLeaf.checked ? 'Y' : 'N'\n          }\n        });\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"tagConfigs":"columnWidth : 0.08","text":"{#la_resetBtn#}","height":"22","margin":"0 0 0 20","itemId":"resetButton","iconCls":"refresh_icon"},"events":{"click":"app.search_form.getForm().reset();\ncate_code = '';\napp.searchButton.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","hidden":"true","layout":"column","margin":"10 0 10 15","itemId":"row2","border":"false"},"children":[{"configs":{"tagConfigs":"baseCls : 'my-panel-no-border',\ncolumnWidth : 1","frame":"true","layout":"column","itemId":"radioPanel1"},"children":[],"expanded":false,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"baseCls : 'my-panel-no-border'","layout":"column","margin":"10 0 10 10","itemId":"radioPanel"},"children":[{"configs":{"labelWidth":"80","name":"categoryInfo","width":"80","inputValue":"0","margin":"0 0 0 10","labelAlign":"right","itemId":"allRadio","checked":"true","boxLabel":"{#la_allItem#}","handler":"if(value){\n    cate_code = '';\n    app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"radio"},{"configs":{"labelWidth":"80","name":"categoryInfo","width":"80","inputValue":"1","margin":"0 0 0 10","labelAlign":"right","itemId":"zcRadio","boxLabel":"{#la_zcItem#}","handler":"if(value){\n    cate_code = '资产';\n    app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"radio"},{"configs":{"labelWidth":"80","name":"categoryInfo","width":"80","inputValue":"2","margin":"0 0 0 10","labelAlign":"right","itemId":"fzRadio","boxLabel":"{#la_fzItem#}","handler":"if(value){\n    cate_code = '负债';\n    app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"radio"},{"configs":{"labelWidth":"80","name":"categoryInfo","width":"80","inputValue":"3","margin":"0 0 0 10","labelAlign":"right","itemId":"gtRadio","boxLabel":"{#la_gtItem#}","handler":"if(value){\n    cate_code = '共同';\n    app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"radio"},{"configs":{"labelWidth":"80","name":"categoryInfo","width":"100","inputValue":"4","margin":"0 0 0 10","labelAlign":"right","itemId":"qyRadio","boxLabel":"{#la_syzItem#}","handler":"if(value){\n    cate_code = '所有者权益';\n    app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"radio"},{"configs":{"labelWidth":"80","name":"categoryInfo","width":"80","inputValue":"5","margin":"0 0 0 10","labelAlign":"right","itemId":"cbRadio","boxLabel":"{#la_cbItem#}","handler":"if(value){\n    cate_code = '成本';\n    app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"radio"},{"configs":{"labelWidth":"80","name":"categoryInfo","width":"80","inputValue":"6","margin":"0 0 0 10","labelAlign":"right","itemId":"ryRadio","boxLabel":"{#la_syItem#}","handler":"if(value){\n    cate_code = '损益';\n    app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"radio"},{"configs":{"labelWidth":"{#labelWidth#}","name":"categoryInfo","width":"80","inputValue":"8","margin":"0 0 0 10","labelAlign":"right","itemId":"bwRadio","boxLabel":"{#la_bwItem#}","handler":"if(value){\n    cate_code = '表外';\n    app.searchButton.fireEvent('click');\n}"},"children":[],"expanded":true,"type":"radio"},{"configs":{"labelWidth":"80","itemId":"chkLeaf","boxLabel":"{#la_isLeaf#}"},"events":{"change":"app.searchButton.fireEvent('click') ;"},"children":[],"expanded":false,"type":"check"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","selType":"checkboxmodel","rowNumber":"false","itemId":"accounts_grid"},"events":{"itemdblclick":"rec = app.accounts_grid.getSelection();\nvar win = new Ext.window.Window(app._accountsWindow); //app._strategy_window指向配置对象而非实例\nwin.show();//显示窗口\nwin.setIconCls('seek_icon');//图标\nWb.setTitle(win,'查看科目\"'+rec[0].data.ACC_NAME+'\"');//标题\nWb.setValue(win,rec[0].data);//把记录数据应用到窗口\napp.ACC_CODE.setReadOnly(true);\napp.ACC_NAME.setReadOnly(true);\napp.ACC_CATEGORY_CODE.setReadOnly(true);\napp.ACC_GROUP_ID.setReadOnly(true);\napp.BALANCE_DIRECTION.setReadOnly(true);\napp.START_DATE.setReadOnly(true);\napp.END_DATE.setReadOnly(true);\napp.IS_BANK_ACC.setReadOnly(true);\napp.IS_CASH_ACC.setReadOnly(true);\napp.IS_CASH_ITEM.setReadOnly(true);\napp.clearGroupId.hide();"},"children":[{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"增加","hidden":"true","itemId":"addButton","iconCls":"file_add_icon"},"events":{"click":"if(app.acc_hrcy_com.getValue()===null){//没有选择科目体系\n\tWb.toast('请选择科目体系');\n\treturn;\n}\nvar orderby = app.accounts_grid.store.getCount();//获得store中的个数\nvar e = app.accounts_grid.plugins[0];\ne.completeEdit();\nWb.request({//得到UUID\n    url : 'm?xwl=xc/gl/global/account/hrcy/hrcyDB/getUUID',\n    success : function(res){\n        var temp = Ext.decode(res.responseText);\n        uuId = temp.uuid;\n//         Wb.addEdit(app.accounts_grid,[{ACC_ID:uuId,\n//                                        ACC_HRCY_ID:app.acc_hrcy_com.getValue(),//设置默认值\n//                                        BALANCE_DIRECTION:0,\n//                                        START_DATE:Ext.Date.parse('1900-01-01','Y-m-d'),\n//                                        END_DATE:Ext.Date.parse('9999-12-31','Y-m-d')}]);\n        app.accounts_grid.store.insert(orderby,{ACC_ID:uuId,\n                                       ACC_HRCY_ID:app.acc_hrcy_com.getValue(),//设置默认值\n                                       BALANCE_DIRECTION:0,\n                                       START_DATE:Ext.Date.parse(Ext.util.Format.date(new Date(),'Y-m-d'),'Y-m-d'),\n                                       END_DATE:Ext.Date.parse('9999-12-31','Y-m-d')});//\n        e.startEditByPosition({row:orderby,column:2});//开始编辑\n        buttonChange = 'insertButton';\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#addBtn#}","itemId":"addButton1","iconCls":"file_add_icon"},"events":{"click":"if(app.acc_hrcy_com.getValue()===null){//没有选择科目体系\n\tWb.toast('请选择科目体系');\n\treturn;\n}\nWb.request({//得到UUID\n    url : 'm?xwl=xc/gl/global/account/accounts/accountsDB/getUUID',\n    success : function(res){\n        var temp = Ext.decode(res.responseText);\n        buttonChange = 'insertButton';\n        var win = new Ext.window.Window(app._accountsWindow); //app._strategy_window指向配置对象而非实例\n        win.show();//显示窗口\n        win.setIconCls('file_add_icon');//图标\n        Wb.setTitle(win,'增加科目');//标题\n        app.START_DATE.setValue(Ext.Date.parse(Ext.util.Format.date(new Date(),'Y-m-d'),'Y-m-d'));\n        app.END_DATE.setValue(Ext.Date.parse('9999-12-31','Y-m-d'));\n        app.ACC_HRCY_ID.setValue(app.acc_hrcy_com.getValue());\n        app.ACC_ID.setValue(temp.uuid);\n\t}\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#editBtn#}","itemId":"editButton","iconCls":"file_edit_icon"},"events":{"click":"if(app.acc_hrcy_com.getValue()===null){//没有选择科目体系\n\tWb.toast('请选择科目体系');\n\treturn;\n}\nrec = app.accounts_grid.getSelection();\nif (rec.length > 1 || rec.length === 0) {//大于一条或没选择会警告\n    Wb.toast('请选择一条需要修改的记录。');\n    return;\n}\nbuttonChange = 'editButton';\nWb.request({\n    url : 'm?xwl=xc/gl/global/account/accounts/accountsDB/ld_accountIsExistAccId',\n    params : {ACC_HRCY_ID : app.acc_hrcy_com.getValue(),ACC_ID : rec[0].data.ACC_ID},\n    success : function(resp){\n        var temp = Wb.decode(resp.responseText);\n        if(temp.rows[0].COUNT > 0){\n            app.ACC_CODE.setReadOnly(true);\n        }\n    }\n});\nvar win = new Ext.window.Window(app._accountsWindow); //app._strategy_window指向配置对象而非实例\nwin.show();//显示窗口\nwin.setIconCls('file_edit_icon');//图标\nWb.setTitle(win,'修改科目\"'+rec[0].data.ACC_NAME+'\"');//标题\nWb.setValue(win,rec[0].data);//把记录数据应用到窗口"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#delBtn#}","itemId":"deleteButton","iconCls":"file_delete_icon"},"events":{"click":"var recs = app.accounts_grid.getSelection();//选中数据\nif (!recs.length) {\n    Wb.toast('请选择需要删除的记录。');\n    return;\n}\nWb.confirm('确定要删除选择的 ' + recs.length + ' 条记录吗？',function() {\n    Wb.request({\n        url : 'm?xwl=xc/gl/global/account/accounts/accountsDB/accountsDelete',\n        params : {'infoArray' : Wb.encode(Wb.getData(recs))},\n        success : function(){\n            Wb.request({\n                url : 'm?xwl=xc/gl/global/account/accounts/accountsDB/accountsLowerCodeSelect',//查询是否有下级编码\n                params : {ACC_HRCY_ID : app.acc_hrcy_com.getValue(),ACC_CODE : Ext.String.escape(recs[0].data.ACC_CODE).substring(0,recs[0].data.ACC_CODE.length-2),ACC_ID : recs[0].data.ACC_ID},\n                success : function(resp){\n                    var temp = Ext.decode(resp.responseText);\n                    if(temp.total == 1){//下级编码不存在更新级别\n                        Wb.request({\n                            url : 'm?xwl=xc/gl/global/account/accounts/accountsDB/accountsLeafEdit',\n                            params : {ACC_HRCY_ID : app.acc_hrcy_com.getValue(),ACC_CODE : Ext.String.escape(recs[0].data.ACC_CODE).substring(0,recs[0].data.ACC_CODE.length-2)}                            \n                        });\n                    }\n                    Wb.toast(recs.length+'条科目删除成功');\n                    Wb.remove(app.accounts_grid);//直接从表格中删除\n                    app.searchButton.fireEvent('click');\n                }\n            });\n        }\n    });\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#batchEditBtn#}","itemId":"batchEditButton","iconCls":"check_group_icon"},"events":{"click":"var recs = app.accounts_grid.getSelection();\nif (recs < 1) {//大于一条或没选择会警告\n    Wb.toast('请选择需要修改的记录。');\n    return;\n}\nvar win = new Ext.window.Window(app._editWindow); //app._strategy_window指向配置对象而非实例\nwin.show();//显示窗口\nwin.setIconCls('check_group_icon');//图标\nWb.setTitle(win,'批量修改');//标题\nvar ACC_GROUP_CHECK = 0;//选中科目组\nvar ACC_GROUP_ID = '';//科目组\nvar ACC_CATEGORY_CHECK = 0;//选中科目分类\nvar ACC_CATEGORY_CODE = '';//科目分类\nvar BALANCE_DIRECTION_CHECK = 0;//选中余额方向\nvar BALANCE_DIRECTION = '';\nvar END_DATE_CHECK = 0;//选中结束日期\nvar ACC_END_DATE;//结束日期\nvar END_DATE;\nvar START_DATE_CHECK = 0;//选中开始日期\nvar ACC_START_DATE;\nvar START_DATE;//开始日期\nvar IS_BANK_ACC = 'N';//银行科目\nvar IS_CASH_ACC = 'N';//现金科目\nvar IS_CASH_ITEM = 'N';//现金核算\nvar IS_BANK_ACC_CHECK = 0;//银行科目\nvar IS_CASH_ACC_CHECK = 0;//现金科目\nvar IS_CASH_ITEM_CHECK = 0;//现金核算\nwin.mon(win,'ok',function() {\n    if(app.ACC_GROUP_CHECK.getValue() === true){//修改科目组\n        ACC_GROUP_CHECK = 1;\n        ACC_GROUP_ID = app.ACC_GROUP_IDS.getValue();\n        //改变显示值\n        for(var i=0;i < group_array.length;i++) {\n            if(ACC_GROUP_ID === group_array[i].ACC_GROUP_NAME)\n                ACC_GROUP_ID = group_array[i].ACC_GROUP_ID;\n        }\n    }\n    if(app.ACC_CATEGORY_CHECK.getValue() === true){//修改科目分类\n        ACC_CATEGORY_CHECK = 1;\n        ACC_CATEGORY_CODE = app.ACC_CATEGORY_CODES.getValue();\n    }\n    if(app.BALANCE_DIRECTION_CHECK.getValue() === true){//修改余额方向\n        BALANCE_DIRECTION_CHECK = 1;\n        BALANCE_DIRECTION = app.BALANCE_DIRECTIONS.getValue();\n    }\n    if(app.IS_UPDATE_BANK_ACCS.getValue() === true){//银行科目\n        IS_BANK_ACC_CHECK = 1;\n        IS_BANK_ACC = app.IS_BANK_ACCS.getValue();\n    }\n    if(app.IS_UPDATE_CASH_ACCS.getValue() === true){//现金科目\n        IS_CASH_ACC_CHECK = 1;\n        IS_CASH_ACC = app.IS_CASH_ACCS.getValue();\n    }\n    if(app.IS_UPDATE_CASH_ITEMS.getValue() === true){//现金核算\n        IS_CASH_ITEM_CHECK = 1;\n        IS_CASH_ITEM = app.IS_CASH_ITEMS.getValue();\n    }\n    if(app.START_DATE_CHECK.getValue() === true && app.END_DATE_CHECK.getValue() === false){//需要修改开始日期\n        START_DATE_CHECK = 1;\n        START_DATE = app.START_DATES.getValue();\n        for(var q = 0; q < recs.length; q++){\n            END_DATE = recs[q].data.END_DATE;\n            if(START_DATE > END_DATE && END_DATE !== null){\n                Wb.toast('结束日期不能小于开始日期，请重新输入！');\n                return;\n            }\n        }\n    }\n    if(app.END_DATE_CHECK.getValue() === true && app.START_DATE_CHECK.getValue() === false){//需要修改结束日期\n        END_DATE_CHECK = 1;\n        END_DATE = app.END_DATES.getValue();\n        if(END_DATE !== null){\n            for(var t = 0; t < recs.length; t++){\n                START_DATE = recs[t].data.START_DATE;\n                if(START_DATE > END_DATE){\n                    Wb.toast('结束日期不能小于开始日期，请重新输入！');\n                    return;\n                }\n            }\n        }\n        else{\n            END_DATE = new Date('9999-12-31 00:00');\n        }\n    }\n    if(app.END_DATE_CHECK.getValue() === true && app.START_DATE_CHECK.getValue() === true){//开始日期结束日期都修改\n        START_DATE_CHECK = 1;\n        END_DATE_CHECK = 1;\n        END_DATE = app.END_DATES.getValue();\n        START_DATE = app.START_DATES.getValue();\n        if(END_DATE !== null){\n            if(START_DATE > END_DATE){\n                Wb.toast('结束日期不能小于开始日期，请重新输入！');\n                return;\n            }\n        }\n        else{\n            END_DATE = new Date('9999-12-31 00:00');\n        }\n    }\n    Wb.request({\n        url: 'm?xwl=xc/gl/global/account/accounts/accountsDB/accountsEdit',\n        params:{ACC_GROUP_CHECK:ACC_GROUP_CHECK,\n                END_DATE_CHECK:END_DATE_CHECK,\n                START_DATE_CHECK:START_DATE_CHECK,\n                STARTDATE:START_DATE,\n                GROUP_ID:ACC_GROUP_ID,\n                ENDDATE:END_DATE,\n                ACC_CATEGORY_CHECK:ACC_CATEGORY_CHECK,\n                CATEGORY_CODE:ACC_CATEGORY_CODE,\n                BALANCE_DIRECTION_CHECK:BALANCE_DIRECTION_CHECK,\n                BALANCE:BALANCE_DIRECTION,\n                BANK_ACC:IS_BANK_ACC,\n                IS_BANK_ACC_CHECK : IS_BANK_ACC_CHECK,\n                CASH_ACC:IS_CASH_ACC,\n                IS_CASH_ACC_CHECK : IS_CASH_ACC_CHECK,\n                CASH_ITEM:IS_CASH_ITEM,\n                IS_CASH_ITEM_CHECK :IS_CASH_ITEM_CHECK,\n                'infoArray':Wb.encode(Wb.getData(recs))},\n        success: function(resp) {\n            app.searchButton.fireEvent('click');\n            Wb.toast('数据保存成功！');\n            app.editWindow.hide(); //根据closeAction属性，默认为销毁\n        }\n    });\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"保存","hidden":"true","itemId":"saveButton","iconCls":"save_icon","tooltip":"保存(save)"},"events":{"click":"var rec = app.accounts_grid.getSelection();//选择一行信息\nmodify = app.accounts_grid.store.getModifiedRecords();//获得修改的记录\nif(modify === '' || modify.length === 0){\n    Wb.warn('没有数据需要保存！');\n\treturn;\n}\n// app.save();//调用更改日期的方法之后在调用保存方法\nvar END_DATE = modify[0].data.END_DATE;//结束时间\nvar START_DATE = modify[0].data.START_DATE;//开始时间\nvar ACC_NAME = modify[0].data.ACC_NAME;//名称\nvar ASS_KEY = getAssKey(ACC_NAME);//助记符\nvar ACC_CODE = modify[0].data.ACC_CODE;//编码\nvar ACC_ID;\nif(!Wb.verifyGrid(app.accounts_grid))//验证数据是否合法\n    return;\nif(START_DATE !== null && END_DATE !== null)\n{\n    if(START_DATE.getTime() > END_DATE.getTime() && END_DATE !== null){//开始时间不能大于结束时间\n        Wb.error('开始时间不能大于结束时间，请重新输入！');\n        return;\n    }\n}\nif(buttonChange == 'insertButton'){\n\tACC_ID = uuId;\n}\nelse{\n\tACC_ID = modify[0].data.ACC_ID;\n}\nif(ACC_CODE.length %2 == 1){//编码为奇数不符合规则\n\tWb.error('科目编码格式不正确！请重新输入');\n    return;\n}\nif(ACC_CODE.length == 4){\n\tsave();\n}\nif(ACC_CODE.length > 4){//编码为4位一级编码\n\tvar TEMP_ACC_CODE = ACC_CODE.substring(0,ACC_CODE.length-2);//截取字符串\n    Wb.request({\n        url : 'm?xwl=xc/gl/global/account/accounts/accountsDB/accountsCodeSelect',\n        params : {ACC_HRCY_ID : app.acc_hrcy_com.getValue(),ACC_CODE : TEMP_ACC_CODE.replace(\"'\",\"\\\\'\"),ACC_ID : ACC_ID},\n        success : function(resp){\n            var temp = Ext.decode(resp.responseText);\n            var total = temp.total;\n\t\t\tif(total == 0){\n\t\t\t\tWb.error('上级编码不存在！请重新输入');\n                return;\n            }\n            save();\n        }\n    });\n}\nfunction save(){\n    Wb.sync({\n        grid: app.accounts_grid,\n        url: 'm?xwl=xc/gl/global/account/accounts/accountsDB/accountsUpdate',\n        params:{'infoArray':Wb.encode(Wb.getData(modify)),ASS_KEY:ASS_KEY},\n        message: '正在保存中...',\n        success : function(){\n            Wb.info('数据保存成功！');\n            app.searchButton.fireEvent('click');\n            buttonChange = '';\n        }\n    });\n}"},"children":[],"expanded":true,"type":"button"},{"configs":{"text":"复制","hidden":"true","itemId":"copyButton","iconCls":"copy_icon","tooltip":"复制(copy)"},"events":{"click":"var rec = app.accounts_grid.getSelection();//选择记录\nif (rec.length > 1 || rec.length === 0) {//大于一条或没选择会警告\n    Wb.warn('请选择一条需要复制的记录。');\n    return;\n}\nWb.request({//得到UUID\n    url : 'm?xwl=xc/gl/global/account/accounts/accountsDB/getUUID',\n    success : function(res){\n        var temp = Ext.decode(res.responseText);\n        var uuId = temp.uuid;\n        buttonChange = 'copyButton';\n        var parmas = {ACC_ID : uuId,\n                    ACC_HRCY_ID : rec[0].data.ACC_HRCY_ID,//获得科目体系ID\n                    ACC_CODE : rec[0].data.ACC_CODE,//获得选中的会计科目编码\n                    ACC_NAME : rec[0].data.ACC_NAME,//获得选中的会计科目名称\n                    ACC_CATEGORY_CODE : rec[0].data.ACC_CATEGORY_CODE,//获得选中的科目编码\n                    ACC_GROUP_ID : rec[0].data.ACC_GROUP_ID,//获得选中的科目组ID\n                    BALANCE_DIRECTION : rec[0].data.BALANCE_DIRECTION,//获得选中的余额方向\n                    ACC_HRCY_NAME : rec[0].data.ACC_HRCY_NAME,//获得选中的科目体系编码\n                    START_DATE : Ext.Date.parse(Ext.util.Format.date(new Date(),'Y-m-d'),'Y-m-d'),//获得选中的开始日期\n                    END_DATE : rec[0].data.END_DATE,//获得选中的结束日期\n                    IS_LEAF : rec[0].data.IS_LEAF,//末级\n                    IS_BANK_ACC : rec[0].data.IS_BANK_ACC,//末级\n                    IS_CASH_ACC : rec[0].data.IS_CASH_ACC,//末级\n                    IS_CASH_ITEM : rec[0].data.IS_CASH_ITEM,//末级\n                    ACC_LEVEL : rec[0].data.ACC_LEVEL//获得选中的级别\n        };\n        Wb.addEdit(app.accounts_grid,parmas);\n        Wb.info('复制成功！');\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#copyBtn#}","itemId":"copyButton1","iconCls":"copy_icon"},"events":{"click":"var rec = app.accounts_grid.getSelection();//选择记录\nif (rec.length > 1 || rec.length === 0) {//大于一条或没选择会警告\n    Wb.toast('请选择一条需要复制的记录。');\n    return;\n}\nWb.request({//得到UUID\n    url : 'm?xwl=xc/gl/global/account/accounts/accountsDB/getUUID',\n    success : function(res){\n        var temp = Ext.decode(res.responseText);\n        var uuId = temp.uuid;\n        buttonChange = 'copyButton';\n        var parmas = {ACC_ID : uuId,\n                    ACC_HRCY_ID : rec[0].data.ACC_HRCY_ID,//获得科目体系ID\n                    ACC_CODE : rec[0].data.ACC_CODE,//获得选中的会计科目编码\n                    ACC_NAME : rec[0].data.ACC_NAME,//获得选中的会计科目名称\n                    ACC_CATEGORY_CODE : rec[0].data.ACC_CATEGORY_CODE,//获得选中的科目编码\n                    ACC_GROUP_ID : rec[0].data.ACC_GROUP_ID,//获得选中的科目组ID\n                    BALANCE_DIRECTION : rec[0].data.BALANCE_DIRECTION,//获得选中的余额方向\n                    ACC_HRCY_NAME : rec[0].data.ACC_HRCY_NAME,//获得选中的科目体系编码\n                    START_DATE : Ext.Date.parse(Ext.util.Format.date(new Date(),'Y-m-d'),'Y-m-d'),//获得选中的开始日期\n                    END_DATE : rec[0].data.END_DATE,//获得选中的结束日期\n                    IS_LEAF : rec[0].data.IS_LEAF,//末级\n                    IS_BANK_ACC : rec[0].data.IS_BANK_ACC,//末级\n                    IS_CASH_ACC : rec[0].data.IS_CASH_ACC,//末级\n                    IS_CASH_ITEM : rec[0].data.IS_CASH_ITEM,//末级\n                    ACC_LEVEL : rec[0].data.ACC_LEVEL//获得选中的级别\n        };\n        var win = new Ext.window.Window(app._accountsWindow); //app._strategy_window指向配置对象而非实例\n        win.show();//显示窗口\n        win.setIconCls('copy_icon');//图标\n        Wb.setTitle(win,'复制科目\"'+rec[0].data.ACC_NAME+'\"');//标题\n        Wb.setValue(win,parmas);//把记录数据应用到窗口\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#importBtn#}","itemId":"importButton","iconCls":"import_icon"},"events":{"click":"if(Ext.isEmpty(app.acc_hrcy_com.getValue())){\n  Wb.info('请选择科目体系！');\n}else{\n   var win = new Ext.window.Window(app._importDataWin);\n   win.setTitle('导入科目数据');\n   win.show();\n}\n\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#exprotBtn#}","itemId":"exportButton","iconCls":"export_icon"},"events":{"click":"if(app.acc_hrcy_com.getValue()===null){\n\tWb.info('请选择科目体系');\n}else{\n  var params = '&accHrcyId='+app.acc_hrcy_com.getValue();\n  var accCategoryExport = app.search_form.getForm().findField('categoryInfo').getGroupValue();\n  if(Ext.isEmpty(accCategoryExport))\n    accCategoryExport = '0';\n  params = params+'&accCategoryCode='+accCategoryExport;\n  if(!Ext.isEmpty(app.exportGroupId.getValue())){\n     params = params+'&accGroupId='+app.exportGroupId.getValue();\n  }\n  window.location.href = '{#contextPath#}/glDataTransgerManageAction.do?method=exportBaseDataByModel&templateCode=XC_GL_ACCOUNTS'+params;\n}\n"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"store","url":"m?xwl=xc/gl/global/account/accounts/accountsDB/accountsSelect"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#rownum#}","align":"center","xtype":"rownumberer","width":"50","titleAlign":"center","itemId":"ORDERBY"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ACC_ID","hidden":"true","dataIndex":"ACC_ID","itemId":"ACC_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ASS_KEY","hidden":"true","dataIndex":"ASS_KEY","itemId":"ASS_KEY_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"ACC_HRCY_ID","hidden":"true","dataIndex":"ACC_HRCY_ID","itemId":"ACC_HRCY_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"ACC_HRCY_NAME","hidden":"true","dataIndex":"ACC_HRCY_NAME","itemId":"ACC_HRCY_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_accCode#}","width":"150","dataIndex":"ACC_CODE","titleAlign":"center","itemId":"ACC_CODE_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_accName#}","width":"250","dataIndex":"ACC_NAME","titleAlign":"center","itemId":"ACC_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_accCategory#}","width":"100","defaultRenderer":"true","dataIndex":"ACC_CATEGORY_NAME","titleAlign":"center","itemId":"ACC_CATEGORY_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_accountGroup#}","width":"100","defaultRenderer":"true","dataIndex":"ACC_GROUP_NAME","titleAlign":"center","itemId":"ACC_GROUP_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_balDirection#}","width":"80","dataIndex":"BALANCE_DIRECTION","titleAlign":"center","itemId":"BALANCE_DIRECTION_COL","renderer":"if(value == 1){\n  return '借';\n}\nelse if(value == 0){\n  return '平';\n}\nelse if(value==-1){\n  return '贷';\n}"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_accLevel#}","hidden":"true","dataIndex":"ACC_LEVEL","itemId":"ACC_LEVEL_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_upAccCode#}","hidden":"true","dataIndex":"UP_ACC_CODE","itemId":"UP_ACC_CODE_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_isLeaf#}","hidden":"true","dataIndex":"IS_LEAF","titleAlign":"center","itemId":"IS_LEAF_COL","renderer":"if(value == 'Y'){\n\treturn '是';\n}\nif(value == 'N'){\n\treturn '否';\n}"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_bankAccount#}","width":"80","dataIndex":"IS_BANK_ACC","titleAlign":"center","itemId":"IS_BANK_ACC_COL","renderer":"if(value == 'Y'){\n\treturn '是';\n}\nif(value == 'N'){\n\treturn '否';\n}"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_cashAccount#}","width":"80","dataIndex":"IS_CASH_ACC","titleAlign":"center","itemId":"IS_CASH_ACC_COL","renderer":"if(value == 'Y'){\n\treturn '是';\n}\nif(value == 'N'){\n\treturn '否';\n}"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_cashItem#}","width":"80","dataIndex":"IS_CASH_ITEM","titleAlign":"center","itemId":"IS_CASH_ITEM_COL","renderer":"if(value == 'Y'){\n\treturn '是';\n}\nif(value == 'N'){\n\treturn '否';\n}"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_startDate#}","width":"100","dataIndex":"START_DATE","titleAlign":"center","itemId":"START_DATE_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_endDate#}","width":"100","dataIndex":"END_DATE","titleAlign":"center","itemId":"END_DATE_COL","renderer":"if(Ext.util.Format.date(value, 'Y-m-d') == '9999-12-31'){\n  return null;\n}else{\n  return Ext.util.Format.date(value, 'Y-m-d');\n}"},"children":[],"expanded":true,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}