{"inframe":false,"title":"更新科目组信息","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"var id,ids = [],\nrecsCreate = Wb.decode(request.getParameter('create'));\nWb.each(recsCreate,function(rec){\n    app.run(\"select 1 from xc_gl_acc_group where ACC_GROUP_CODE='\" + rec.ACC_GROUP_CODE.replace(\"'\",\"\\\\'\") + \"'\",{\n        errorText: '编码\"' + rec.ACC_GROUP_CODE + '\" 已经存在。'\n    });\n    app.run(\"select 1 from xc_gl_acc_group where ACC_GROUP_NAME='\" + rec.ACC_GROUP_NAME.replace(\"'\",\"\\\\'\") + \"'\",{\n        errorText: '编码名称\"' + rec.ACC_GROUP_NAME + '\" 已经存在。'\n    });\n    app.run(\"update xc_gl_acc_group set ORDERBY=ORDERBY+1 where ORDERBY>='\"+rec.ORDERBY+\"'\",{});\n\tid = java.util.UUID.randomUUID();\n\trec.ACC_GROUP_ID = id;\n    rec.CREATION_DATE = new Date();\n    rec.CREATED_BY = '{#XIP.userId#}';\n    rec.LAST_UPDATE_DATE = new Date();\n    rec.LAST_UPDATED_BY = '{#XIP.userId#}';\n\tids.push({\n\t\tACC_GROUP_ID : id\n\t});\n});\nrecsUpdate = Wb.decode(request.getParameter('update'));\nWb.each(recsUpdate,function(rec){\n    app.run(\"select 1 from xc_gl_acc_group where ACC_GROUP_CODE='\" + rec.ACC_GROUP_CODE.replace(\"'\",\"\\\\'\") + \"'and ACC_GROUP_ID <> '\" + rec.ACC_GROUP_ID+\"' \",{\n        errorText: '编码\"' + rec.ACC_GROUP_CODE + '\" 已经存在。'\n    });\n    app.run(\"select 1 from xc_gl_acc_group where ACC_GROUP_NAME='\" + rec.ACC_GROUP_NAME.replace(\"'\",\"\\\\'\") + \"'and ACC_GROUP_ID <> '\" + rec.ACC_GROUP_ID+\"' \",{\n        errorText: '编码名称\"' + rec.ACC_GROUP_NAME + '\" 已经存在。'\n    });\n    rec.LAST_UPDATE_DATE = new java.util.Date();\n    rec.LAST_UPDATED_BY = '{#XIP.userId#}';\n});\nrequest.setAttribute('update',Wb.encode(recsUpdate));//重置create记录\nrequest.setAttribute('create',Wb.encode(recsCreate));//重置create记录\napp.update({\n\ttableName: 'xc_gl_acc_group'\n});\napp.send(ids);//把id列表发送到客户端以同步到表格","itemId":"module"},"children":[],"expanded":false,"type":"module"}],"pageLink":"","iconCls":""}