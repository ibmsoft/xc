{"inframe":false,"title":"科目删除","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"var recsDelete = Wb.decode(request.getParameter('infoArray'));\nWb.each(recsDelete,function(rec){\n    app.run(\"SELECT 1 FROM xc_gl_accounts WHERE ACC_CODE like if('\"+rec.ACC_CODE.replace(\"'\",\"\\\\'\")+\"'<>'','\"+rec.ACC_CODE.replace(\"'\",\"\\\\'\")+\"%','') AND ACC_ID <> '\"+rec.ACC_ID+\"' AND ACC_HRCY_ID='\"+rec.ACC_HRCY_ID+\"'\",{\n        errorText:'科目编码\"'+rec.ACC_CODE+'\"存在下级，不能删除！'\n    });\n    app.run(\"SELECT 1 FROM xc_gl_ld_accounts WHERE ACC_ID ='\"+rec.ACC_ID+\"'\",{\n        errorText:'科目\"'+rec.ACC_NAME+'\"已经被账簿科目使用，不能删除！'\n    });\n    //app.run(\"UPDATE xc_gl_accounts SET IS_LEAF = 'Y' WHERE ACC_CODE ='\" + rec.ACC_CODE.substring(0,rec.ACC_CODE.length-2).replace(\"'\",\"\\\\'\") + \"' and ACC_HRCY_ID='\"+rec.ACC_HRCY_ID+\"'\",{});\n});\nvar newArr = Wb.encode(recsDelete);\nrequest.setAttribute(\"batArray\",newArr);","itemId":"module"},"children":[{"configs":{"sql":"DELETE\nFROM\n\txc_gl_accounts\nWHERE\n\tACC_ID = {?ACC_ID?}","itemId":"accountsDelete","arrayName":"batArray"},"children":[],"expanded":false,"type":"query"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}