{"inframe":false,"title":"保存j结转模板数据","hidden":true,"roles":{"dev":1},"children":[{"configs":{"serverScript":"var subRows = Wb.decode(request.getParameter('operateData'));\nvar mainRow = Wb.decode(request.getParameter('mainData'));\nvar primaryKey = java.util.UUID.randomUUID().toString();\nvar primaryCode = java.util.UUID.randomUUID().toString();\nvar mainRows = [];\nWb.apply(mainRow,{JZ_TPL_ID:primaryKey,JZ_TPL_CODE:primaryCode});\nmainRows.push(mainRow);\nvar createRows = subRows.create;\nWb.each(createRows, function(rec) {\n  var subKey = java.util.UUID.randomUUID().toString();\n  Wb.apply(rec, {\n    JZ_TPL_ID: primaryKey,\n    TPL_DTL_ID: subKey\n  });\n});\nrequest.setAttribute('mainRow', Wb.encode(mainRows));\nrequest.setAttribute('subRows', Wb.encode(createRows));\nrequest.setAttribute('primaryKey',primaryKey);\n","itemId":"module"},"children":[{"configs":{"sql":"insert into xc_gl_jz_tpl(\n  JZ_TPL_ID,       \n  JZ_TPL_CODE,     \n  JZ_TPL_NAME,     \n  LEDGER_ID,       \n  V_CATEGORY_ID,   \n  ZR_ACC_ID,       \n  ACC_SEGMENTS,    \n  ZR_ACC_DR,       \n  SUMMARY,         \n  CREATION_DATE,   \n  CREATED_BY,      \n  LAST_UPDATE_DATE,\n  LAST_UPDATED_BY \n)values(\n {?JZ_TPL_ID?},\n {?JZ_TPL_CODE?},\n {?JZ_TPL_NAME?},\n {?LEDGER_ID?},\n {?V_CATEGORY_ID?},\n {?ZR_ACC_ID?},\n {?ACC_SEGMENTS?},\n {?ZR_ACC_DR?},\n {?SUMMARY?},\n {?timestamp.sys.date?},\n {?XIP.userId?},\n {?timestamp.sys.date?},\n {?XIP.userId?}\n)","transaction":"start","itemId":"insertMainTable","arrayName":"mainRow"},"children":[],"expanded":false,"type":"query"},{"configs":{"sql":"insert into xc_gl_jz_tpl_dtl(\n TPL_DTL_ID,   \n JZ_TPL_ID,    \n ZC_ACC_ID,    \n SUM_ACC_ID,   \n BAL_RULE,     \n BAL_DR,       \n ACC_SEGMENTS, \n SUMMARY,      \n CREATION_DATE,   \n CREATED_BY,      \n LAST_UPDATE_DATE,\n LAST_UPDATED_BY \n)values(\n {?TPL_DTL_ID?},\n {?JZ_TPL_ID?},\n {?ZC_ACC_ID?},\n {?SUM_ACC_ID?},\n {?BAL_RULE?},\n {?BAL_DR?},\n {?ACC_SEGMENTS?},\n {?SUMMARY?},\n {?timestamp.sys.date?},\n {?XIP.userId?},\n {?timestamp.sys.date?},\n {?XIP.userId?}\n)","itemId":"insertSubTable","arrayName":"subRows"},"children":[],"expanded":false,"type":"query"},{"configs":{"string":"{JZ_TPL_ID:'{#primaryKey#}'}","itemId":"responseIdField"},"children":[],"expanded":false,"type":"response"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}