{"inframe":false,"title":"","hidden":false,"roles":{"default":1},"children":[{"configs":{"loginRequired":"false","serverScript":"var recs = Wb.decode(request.getParameter('create'));\nWb.each(recs,function(rec){\n  rec.PRODUCT_ID = java.util.UUID.randomUUID();\n  rec.CREATION_DATE = new Date();\n  rec.CREATED_BY = '{#XIP.userId#}';\n  rec.LAST_UPDATE_DATE = new Date();\n  rec.LAST_UPDATED_BY = '{#XIP.userId#}';\n  //检查是否存在重复的PRODUCT_CODE\n  app.run(\"select 1 from xc_gl_products where PRODUCT_CODE='\"+rec.PRODUCT_CODE+\"'\", {\n    errorText: '\"' + rec.PRODUCT_CODE + '\" 已经存在。'\n  });\n  //检查是否存在重复的PRODUCT_NAME\n  app.run(\"select 1 from xc_gl_products where PRODUCT_NAME='\"+rec.PRODUCT_NAME+\"'\", {\n    errorText: '\"' + rec.PRODUCT_NAME + '\" 已经存在。'\n  });\n});\nrequest.setAttribute('create',Wb.encode(recs));\n\nvar recs1 = Wb.decode(request.getParameter('update'));\nWb.each(recs1,function(rec){\n  rec.LAST_UPDATE_DATE = new Date();\n  rec.LAST_UPDATED_BY = '{#XIP.userId#}';\n  //检查是否存在重复的PRODUCT_CODE\n  app.run(\"select 1 from xc_gl_products where PRODUCT_CODE='\"+rec.PRODUCT_CODE+\"' and PRODUCT_ID<>'\"+rec.PRODUCT_ID+\"'\", {\n    errorText: '\"' + rec.PRODUCT_CODE + '\" 已经存在。'\n  });\n  //检查是否存在重复的PRODUCT_NAME\n  app.run(\"select 1 from xc_gl_products where PRODUCT_NAME='\"+rec.PRODUCT_NAME+\"' and PRODUCT_ID<>'\"+rec.PRODUCT_ID+\"'\", {\n    errorText: '\"' + rec.PRODUCT_NAME + '\" 已经存在。'\n  });\n});\nrequest.setAttribute('update',Wb.encode(recs1));\napp.update({\n  tableName: 'xc_gl_products'\n});\napp.send();","itemId":"module"},"children":[],"expanded":false,"type":"module"}],"pageLink":"","iconCls":""}