{"inframe":false,"title":"","hidden":false,"roles":{"default":1},"children":[{"configs":{"title":"{#moduleTitle#}","loginRequired":"false","serverScript":"com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/gl/global/pr-modes/pr-modes\");","itemId":"module"},"children":[{"configs":{"itemId":"folder1"},"children":[{"configs":{"itemId":"modeTypeStore"},"children":[],"expanded":false,"type":"store"},{"configs":{"autoLoad":"true","itemId":"storeYN","url":"m?xwl=xc/gl/global/pr-modes/pr-modesDB/myselectYN"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"folder"},{"configs":{"height":"160","closeAction":"hide","buttonAlign":"center","defaultFocus":"mode_name","dialog":"true","itemId":"newWin"},"children":[{"configs":{"tagConfigs":"baseCls : 'my-panel-no-border'","layout":"column","margin":"20 0 0 0 ","itemId":"panel1"},"children":[{"configs":{"itemId":"operateFlag"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"labelWidth":"{#la_labelWidth#}","queryMode":"local","width":"250","pickList":"[['cash','现金'],['bank','银行'],['check','汇票'],['other','其他']]","labelAlign":"right","itemId":"mode_type","fieldLabel":"{#la_necessaryType#}","editable":"false"},"children":[],"expanded":false,"type":"combo"},{"configs":{"labelWidth":"80","store":"app.storeYN","displayField":"VAL_NAME","width":"200","valueField":"VAL_CODE","labelAlign":"right","itemId":"is_enabled","fieldLabel":"{#la_isEnable#}"},"children":[],"expanded":false,"type":"combo"},{"configs":{"hidden":"true","itemId":"mode_id"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"panel"},{"configs":{"labelWidth":"{#la_labelWidth#}","width":"450","margin":"10 50 0 0","labelAlign":"right","itemId":"mode_name","fieldLabel":"{#la_paymentWay#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"height":"80","hidden":"true","width":"350","margin":"25 0 0 0 ","labelAlign":"right","itemId":"mode_desc","fieldLabel":"{#la_description#}"},"children":[],"expanded":false,"type":"textarea"},{"configs":{"itemId":"buttons"},"children":[{"configs":{"text":"{#saveBtn#}","itemId":"saveBtn","iconCls":"save_icon"},"events":{"click":"if(app.operateFlag.getValue() === '-1'){\n      // TODO: 校验输入的名称是否为空\n    var modeName = app.mode_name.getValue() ;\n    if (modeName === null || modeName === '' || modeName === undefined) {\n      Wb.toast(\"请输入收付款方式！\");\n      app.mode_name.focus() ;\n      return false;\n    }\n    var mode_Type = app.mode_type.getValue();\n    if(mode_Type === null || mode_Type === '' || mode_Type === undefined){\n       Wb.toast(\"请选择收付款类型！\");\n       app.mode_type.focus() ;\n      return false;\n    }\n\n    // TODO: 发送保存请求\n    Wb.request({\n      url: 'm?xwl=xc/gl/global/pr-modes/pr-modesDB/save-mode',\n      out:app.newWin,\n      success: function(resp) {\n        var response = Wb.decode(resp.responseText);\n        if(response.flag == '0'){\n          app.grid1.getStore().load();\n          app.newWin.hide() ;\n          Wb.toast('增加成功!') ;\n        }else{\n          Wb.toast('增加失败!') ;\n        }\n      }\n    });\n}else{\n  if(app.is_enabled.getValue()==='N'){\n    var lineArray = [] ;\n    var json = {'modeId':app.mode_id.getValue()} ;\n    lineArray.push(json);\n    Wb.request({\n        url:'m?xwl=xc/gl/global/pr-modes/pr-modesDB/update-validate-mode',\n        params:{'infoArray':Wb.encode(lineArray),'mode_id':app.mode_id.getValue(),'mode_name':app.mode_name.getValue(),'mode_type':app.mode_type.getValue(),'is_enabled':app.is_enabled.getValue(),'mode_desc':app.mode_desc.getValue()},\n        success:function(resp){\n          var response = Wb.decode(resp.responseText);\n          if(response.flag == '0'){\n              app.grid1.getStore().load();\n              app.newWin.hide() ;\n              Wb.toast('修改成功!') ;\n           }else{\n              Wb.toast('修改失败!') ;\n             }\n        }\n      });\n     }else{\n        Wb.request({\n        url:'m?xwl=xc/gl/global/pr-modes/pr-modesDB/update-mode',\n        params:{'mode_id':app.mode_id.getValue(),'mode_name':app.mode_name.getValue(),'mode_type':app.mode_type.getValue(),'is_enabled':app.is_enabled.getValue(),'mode_desc':app.mode_desc.getValue()},\n        success:function(resp){\n          var response = Wb.decode(resp.responseText);\n          if(response.flag == '0'){\n            app.grid1.getStore().load();\n            app.newWin.hide() ;\n            Wb.toast('修改成功!') ;\n\t\t}else{\n            Wb.toast('修改失败!') ;\n       }\n        }\n      });  \n       }\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#cancelBtn#}","itemId":"cancelBtn","iconCls":"cancel_icon"},"events":{"click":"app.newWin.hide();"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"array"}],"expanded":true,"type":"window"},{"configs":{"layout":"fit","itemId":"viewport1"},"children":[{"configs":{"region":"center","selType":"checkboxmodel","itemId":"grid1","editable":"true"},"events":{"itemdblclick":"app.editBtn.fireEvent('click');"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/global/pr-modes/pr-modesDB/select-modes"},"children":[],"expanded":true,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#addBtn#}","itemId":"addBtn","iconCls":"file_add_icon"},"events":{"click":"var win1=new Ext.window.Window(app._newWin);\nwin1.show();\nwin1.setIconCls('file_add_icon');\nwin1.setTitle('新增收付款方式');\napp.operateFlag.setValue('-1');\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#editBtn#}","itemId":"editBtn","iconCls":"file_edit_icon"},"events":{"click":"var rows1 = app.grid1.getSelection();\nif(rows1 < 1){\n  Wb.toast('请选择一条你要修改的数据！');\n  return false;\n}\nelse{\n  var win1 = new Ext.window.Window(app._newWin);\n  win1.setTitle('修改收付款方式');\n  win1.setIconCls('file_edit_icon');\n  win1.show();\n  app.operateFlag.setValue('1');\n  app.mode_id.setValue(rows1[0].data.MODE_ID);\n  app.mode_name.setValue(rows1[0].data.MODE_NAME);\n  app.mode_type.setValue(rows1[0].data.MODE_TYPE);\n  app.is_enabled.setValue(rows1[0].data.IS_ENABLED);\n  app.mode_desc.setValue(rows1[0].data.MODE_DESC);\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#delBtn#}","itemId":"deleteBtn","iconCls":"file_delete_icon"},"events":{"click":"// TODO: 获得选中数据\nvar recs = app.grid1.getSelection();\nif (recs.length === 0) {\n\tWb.toast('请选择需要删除的记录!');\n\treturn false ;\n}else{\n  var lineArray = [] ;\n  Wb.each(recs, function(r){\n    var json = {'modeId':r.data.MODE_ID} ;\n    lineArray.push(json) ;\n  }) ;\n  \n  // TODO: 执行删除\n  Wb.confirm('确定要删除选中的记录吗？',function() {\n      Wb.request({\n          url : 'm?xwl=xc/gl/global/pr-modes/pr-modesDB/delete-modes',\n          params : {'infoArray' : Wb.encode(lineArray)},\n          success: function(resp){\n            var response = Wb.decode(resp.responseText);\n            if(response.flag == '0'){\n              app.grid1.getStore().load();\n              app.newWin.hide() ;\n              Wb.toast('删除成功!') ;\n            }else{\n              Wb.toast('删除失败!') ;\n            }\n          }\n      });\n  });\n}\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#stopBtn#}","itemId":"stopBtn","iconCls":"stop_icon"},"events":{"click":"// TODO: 获得选中数据\nvar recs = app.grid1.getSelection();\nif (recs.length === 0) {\n\tWb.warn('请选择需要停用的收付款方式!');\n\treturn false ;\n}else{\n  if(recs[0].data.IS_ENABLED==='N'){\n  Wb.info('该条收付款方式已经被停用！');\n  return false;\n  }\n  var lineArray = [] ;\n  Wb.each(recs, function(r){\n    var json = {'modeId':r.data.MODE_ID} ;\n    lineArray.push(json) ;\n     }) ;\n  \n     // TODO: 执行停用\n      Wb.request({\n          url : 'm?xwl=xc/gl/global/pr-modes/pr-modesDB/stop-mode',\n          params : {'infoArray' : Wb.encode(lineArray)},\n          success: function(resp){\n            var response = Wb.decode(resp.responseText);\n            if(response.flag == '0'){\n              app.grid1.getStore().load();\n              app.newWin.hide() ;\n              Wb.info('数据停用成功!') ;\n            }else{\n              Wb.info('数据停用失败!') ;\n            }\n          }\n      });\n \n}\n\n"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#rownum#}","width":"50","xtype":"rownumberer","align":"center","titleAlign":"center","itemId":"rownum"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"收款方式ID","hidden":"true","align":"left","dataIndex":"MODE_ID","titleAlign":"center","itemId":"MODE_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"hidden":"true","dataIndex":"MODE_TYPE","itemId":"MODE_TYPE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_paymentType#}","align":"left","width":"150","dataIndex":"MODE_TYPENAME","titleAlign":"center","itemId":"MODE_TYPENAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_paymentName#}","width":"200","align":"left","dataIndex":"MODE_NAME","titleAlign":"center","itemId":"MODE_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"hidden":"true","dataIndex":"IS_ENABLED","itemId":"IS_ENABLED_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_isEnable#}","align":"center","dataIndex":"IS_ENABLED_NAME","titleAlign":"center","itemId":"IS_ENABLED_NAME_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"描述","hidden":"true","width":"400","align":"left","dataIndex":"MODE_DESC","titleAlign":"center","itemId":"MODE_DESC_COL"},"children":[],"expanded":true,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}