{"inframe":false,"title":"凭证分类","hidden":false,"roles":{"default":1},"children":[{"configs":{"title":"{#moduleTitle#}","loginRequired":"false","serverScript":"com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/gl/global/voucher/category/XC_GL_GB_CATEGORY\");","itemId":"module"},"children":[{"configs":{"height":"200","width":"400","layout":"fit","closeAction":"hide","dialog":"true","itemId":"win","modal":"true"},"events":{"ok":"var catId = app.V_CATEGORY_ID.getValue() ;\nvar catCode = app.V_CATEGORY_CODE.getValue() ;\nvar catName = app.V_CATEGORY_NAME.getValue() ;\n\nif(Wb.isEmpty(catCode)){\n  Wb.toast('请录入分类编码') ;\n  return false ;\n}\n\nif(Wb.isEmpty(catCode)){\n  Wb.toast('请录入分类名称') ;\n  return false ;\n}\n\n// 提交请求\nif(Wb.isEmpty(catId)){\n  Wb.request({\n    url: 'm?xwl=xc/common/getUUID',\n    success: function(resp) {\n      var response = Wb.decode(resp.responseText) ;\n      var catId = response.uuid ;\n      Wb.request({\n        url: 'm?xwl=xc/gl/global/voucher/category/category-db/new-category',\n        params: {\n          'V_CATEGORY_ID' : catId,\n          'V_CATEGORY_CODE' : catCode,\n          'V_CATEGORY_NAME' : catName,\n          'V_CATEGORY_DESC' : app.V_CATEGORY_DESC.getValue()\n        } ,\n        success: function(resp) {\n          var response = Wb.decode(resp.responseText) ;\n          app.win.hide() ;\n          app.grid1.getStore().load() ;\n          Wb.toast('保存成功!') ;\n        }\n      });\n    }\n  });\n  \n}else{\n  Wb.request({\n    url: 'm?xwl=xc/gl/global/voucher/category/category-db/update-category',\n    params: Wb.getValue(app.form) ,\n    success: function(resp) {\n      var response = Wb.decode(resp.responseText) ;\n      app.win.hide() ;\n      app.grid1.getStore().load() ;\n      Wb.toast('更新成功!') ;\n    }\n  });\n}\n\n"},"children":[{"configs":{"layout":"form","bodyPadding":"10","itemId":"form"},"children":[{"configs":{"hidden":"true","itemId":"V_CATEGORY_ID"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"50","labelAlign":"right","itemId":"V_CATEGORY_CODE","fieldLabel":"<font color=red>*<\/font>{#la_categoryCode#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"50","labelAlign":"right","itemId":"V_CATEGORY_NAME","fieldLabel":"<font color=red>*<\/font>{#la_categoryName#}"},"children":[],"expanded":false,"type":"text"},{"configs":{"labelWidth":"50","labelAlign":"right","itemId":"V_CATEGORY_DESC","fieldLabel":"{#la_description#}"},"children":[],"expanded":false,"type":"textarea"}],"expanded":true,"type":"form"}],"expanded":true,"type":"window"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"center","itemId":"grid1","editable":"true"},"events":{"itemdblclick":"app.editBtn.fireEvent('click') ;"},"children":[{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=xc/gl/global/voucher/category/category-db/select-category"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#addBtn#}","itemId":"addBtn","iconCls":"file_add_icon"},"events":{"click":"app.form.getForm().reset() ;\napp.win.show() ;"},"children":[],"expanded":true,"type":"button"},{"configs":{"text":"{#editBtn#}","itemId":"editBtn","iconCls":"edit_icon"},"events":{"click":"var records = app.grid1.getSelection() ;\nif(records.length === 0){\n  Wb.toast('请选择 1 条凭证分类信息!') ;\n  return false ;\n}\nWb.setValue(app.form,records[0].data) ;\napp.win.show() ;"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#delBtn#}","itemId":"delBtn","iconCls":"file_delete_icon"},"events":{"click":"//Wb.remove(app.grid1);\n// Wb.del(app.grid1, {\n//   url: 'm?xwl=xc/gl/global/voucher/category/category-db/delete-category',\n//   titleField: 'V_CATEGORY_ID'\n// });\nvar counts;\nvar recs = app.grid1.getSelection();\n\nif (!recs.length) {\n  Wb.toast('请选择需要删除的记录。');\n  return;\n}\n\n\nWb.confirm('确定要删除选择的 ' + recs.length + ' 条记录吗？', function() {\n  Wb.request({\n    url: 'm?xwl=xc/gl/global/voucher/category/category-db/delete-category', //使用basic-delete.xwl用于演示目的，建议使用delete.xwl\n    params: Wb.apply({\n      destroy: Wb.getData(recs),\n      'categoryId': recs[0].data.V_CATEGORY_ID\n    }),\n    success: function() {\n      Wb.remove(app.grid1, recs);\n      app.refreshBtn.fireEvent('click');\n    }\n  });\n});\n"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#rownum#}","align":"center","width":"50","xtype":"rownumberer","titleAlign":"center","itemId":"ROW_NUMBER_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"分类ID","hidden":"true","dataIndex":"V_CATEGORY_ID","titleAlign":"center","itemId":"V_CATEGORY_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#la_categoryCode#}","width":"250","align":"left","dataIndex":"V_CATEGORY_CODE","titleAlign":"center","itemId":"V_CATEGORY_CODE_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_categoryName#}","width":"250","align":"left","dataIndex":"V_CATEGORY_NAME","titleAlign":"center","itemId":"V_CATEGORY_NAME_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#la_description#}","width":"300","align":"left","dataIndex":"V_CATEGORY_DESC","titleAlign":"center","itemId":"V_CATEGORY_DESC_COL"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"创建日期","hidden":"true","dataIndex":"CREATION_DATE","titleAlign":"center","itemId":"CREATION_DATE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"创建人","hidden":"true","dataIndex":"CREATED_BY","titleAlign":"center","itemId":"CREATED_BY_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}