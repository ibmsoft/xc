{"inframe":false,"title":"","hidden":false,"roles":{"default":1},"children":[{"configs":{"title":"现金流量项目余额","loginRequired":"false","serverScript":"var ctxPath = request.getContextPath() ;\nrequest.setAttribute(\"contextPath\",ctxPath);","itemId":"module"},"events":{"initialize":"//记账和取消记账标识\nvar isCanceled = 'N';\nvar flag;\nvar ledgerId;\nvar win1;\n"},"children":[{"configs":{"itemId":"stores"},"children":[{"configs":{"itemId":"store11","url":"m?xwl=xc/gl/b-balances/cash-ba/ld-b-ca-ye/ld-b-ca-yeDB/getDuplicateData"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"store2","url":"m?xwl=xc/gl/b-balances/cash-ba/ld-b-ca-ye/ld-b-ca-yeDB/getInvalidData"},"children":[],"expanded":false,"type":"store"},{"configs":{"autoLoad":"true","itemId":"cashstore","url":"m?xwl=xc/gl/b-balances/cash-ba/ld-b-ca-ye/ld-b-ca-yeDB/selectCash"},"children":[],"expanded":false,"type":"store"},{"configs":{"pageSize":"-1","autoSync":"false","autoLoad":"false","itemId":"accstore","url":"m?xwl=xc/gl/b-balances/cash-ba/ld-b-ca-ye/ld-b-ca-yeDB/selectAcc"},"events":{"beforeload":"store.proxy.extraParams.ledgerId = ledgerId;"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"folder"},{"configs":{"frame":"false","height":"180","closeAction":"hide","dialog":"true","itemId":"newWin","createInstance":"false"},"events":{"ok":"if(Ext.isEmpty(app.cash_id.getValue() )){\n  Wb.info(\"请选择现金流量项目！\");\n  app.ca_name.focus();\n  return false;\n}\nif(Ext.isEmpty(app.acc_id.getValue())){\n  Wb.info(\"请选择会计科目！\");\n  app.acc_name.focus();\n  return false;\n}\nif(Ext.isEmpty(app.ca_sum.getValue())){\n  Wb.info(\"请输入期初金额！\");\n  app.ca_sum.focus();\n  return false;\n}\n/*添加期初现金流\n *处理期初科目\n *账簿开始会计期推至前一个月份\n */\nif(!Ext.isEmpty(app.startPeriodCode.getValue())){\n  var selCode = app.startPeriodCode.getValue();\n  var queryPeriod = '';\n  var periodYear = selCode.substring(0,selCode.indexOf('-'));\n  var periodMonth = selCode.substring(selCode.indexOf('-'),selCode.length);\n  var periodMonthF = selCode.substring(selCode.indexOf('-')+1,selCode.length-1);\n  var periodMonthL = selCode.substring(selCode.indexOf('-')+2,selCode.length);\n  if(Ext.String.endsWith(selCode,'-01')){\n    queryPeriod = (parseInt(periodYear)-1)+'-12';\n  }else{\n    if(parseInt(periodMonthL)>0){\n       queryPeriod = periodYear+'-'+periodMonthF+(parseInt(periodMonthL)-1);\n    }else{\n       queryPeriod = periodYear+'-'+(parseInt(periodMonthF)-1)+periodMonthL;\n    }\n  }\n  //执行保存操作\n  app.period_code.setValue(queryPeriod);\n  var p_ledgerId = app.searchText.getValue();\n  var p_cashId = app.cash_id.getValue();\n  var p_cashCode = app.cash_code.getValue();\n  var p_caName = app.ca_name_picker.getValue();\n  var p_accId = app.acc_id.getValue();\n  var p_accCode = app.acc_code.getValue();\n  var p_accName = app.acc_name_picker.getValue();\n  var p_caSum = app.ca_sum.getValue();\n  var paramJson = {'ledger_id':p_ledgerId,'period_code':queryPeriod,\n                   'ca_id':p_cashId,'ca_code':p_cashCode,\n                   'ca_name':p_caName,'acc_id':p_accId,\n                   'acc_code':p_accCode,'acc_name':p_accName,\n                   'ca_sum':p_caSum\n                  };\n//新增\n  if(Ext.isEmpty(app.sum_id.getValue())){\n    Wb.request({\n    url: 'm?xwl=xc/gl/b-balances/cash-ba/ld-b-ca-ye/ld-b-ca-yeDB/save-sum',\n    method:'post',\n    params:paramJson,\n    success: function(response) {\n                    app.grid1.getStore().load();\n                    app.newWin.close();\n                    Wb.info('添加成功!') ;\n    }\n});\n}else{\n  alert('2');\n  paramJson.sum_id = app.sum_id.getValue();\n  //修改\n  Wb.request({\n  url: 'm?xwl=xc/gl/b-balances/cash-ba/ld-b-ca-ye/ld-b-ca-yeDB/updateCashSum',\n  params:paramJson,\n  success: function(response) {\n      app.grid1.getStore().load();\n      Wb.info('修改成功!') ;\n      win1.hide();\n  }\n});\n}\n}\n\n"},"children":[{"configs":{"labelWidth":"140","width":"450","margin":"10 50 10 0","labelAlign":"right","itemId":"ca_name_picker","fieldLabel":"<font color='red'>*<\/font>现金流量项目","editable":"false"},"events":{"collapse":"app.queryText.setValue('');\napp.queryBtn.fireEvent('click');"},"children":[{"configs":{"tagConfigs":"minWidth :420","height":"300","store":"app.cashstore","barExportButtons":"false","barExportAllButtons":"false","barRefreshButton":"false","itemId":"pickComp"},"events":{"itemclick":"var picker = this.ownerCmp;\npicker.setValue(record.data.CA_NAME);\napp.cash_id.setValue(record.data.CA_ID);\napp.cash_code.setValue(record.data.CA_CODE);\npicker.collapse();"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"序号","hidden":"true","width":"45","align":"center","xtype":"rownumberer","titleAlign":"center","itemId":"rownumber"},"children":[],"expanded":false,"type":"column"},{"configs":{"hidden":"true","width":"20","dataIndex":"CA_CODE","itemId":"id"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"编码","width":"90","align":"left","dataIndex":"CA_CODE","titleAlign":"center","itemId":"code"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"名称","width":"250","align":"left","dataIndex":"CA_NAME","titleAlign":"center","itemId":"name"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"width":"240","emptyText":"输入编码或名称进行查询","itemId":"queryText"},"events":{"specialkey":"if(Ext.EventObject.getKey()===13){\napp.queryBtn.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"查询","itemId":"queryBtn","iconCls":"seek_icon"},"events":{"click":"app.cashstore.load({\nparams:{\ncodeOrName:app.queryText.getValue()\n}\n});"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"}],"expanded":true,"type":"grid"}],"expanded":false,"type":"picker"},{"configs":{"labelWidth":"140","width":"450","margin":"10 50 10 0","labelAlign":"right","itemId":"acc_name_picker","fieldLabel":"<font color='red'>*<\/font>会计科目","editable":"false"},"events":{"collapse":"app.queryText1.setValue('');\napp.queryBtn1.fireEvent('click');"},"children":[{"configs":{"tagConfigs":"minWidth :420","height":"300","store":"app.accstore","itemId":"pickComp"},"events":{"itemclick":"var picker = this.ownerCmp;\npicker.setValue(record.data.ACC_NAME);\napp.acc_id.setValue(record.data.ACC_ID);\napp.acc_code.setValue(record.data.ACC_CODE);\npicker.collapse();"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"序号","hidden":"true","xtype":"rownumberer","align":"center","width":"45","titleAlign":"center","itemId":"ronumber"},"children":[],"expanded":false,"type":"column"},{"configs":{"hidden":"true","dataIndex":"ACC_ID","itemId":"id"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"编码","width":"120","align":"left","dataIndex":"ACC_CODE","titleAlign":"center","itemId":"code"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"名称","width":"220","align":"left","dataIndex":"ACC_NAME","titleAlign":"center","itemId":"name"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"width":"240","emptyText":"输入编码或名称进行查询","itemId":"queryText1"},"events":{"specialkey":"if(Ext.EventObject.getKey()===13){\napp.queryBtn1.fireEvent('click');\n}"},"children":[],"expanded":false,"type":"text"},{"configs":{"text":"查询","itemId":"queryBtn1"},"events":{"click":"app.accstore.load({\nparams:{\ncodeOrName : app.queryText1.getValue()\n}\n});\n"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"picker"},{"configs":{"labelWidth":"140","width":"450","minValue":"0","margin":"10 50 10 0","labelAlign":"right","allowDecimals":"true","itemId":"ca_sum","fieldLabel":"<font color='red'>*<\/font>期初余额"},"children":[],"expanded":false,"type":"number"},{"configs":{"readOnly":"true","hidden":"true","width":"170","labelAlign":"right","itemId":"period_code","fieldLabel":"会计期"},"events":{"focus":"var ledgerId = app.searchText.getValue();\nWb.request({\n  url: 'm?xwl=xc/gl/b-balances/cash-ba/ld-b-ca-ye/ld-b-ca-yeDB/selectPeriod',\n  params: {\n    'ledgerId': ledgerId\n  },\n  success: function(resp) {\n    var res = Wb.decode(resp.responseText);\n    var a = res.rows[0].START_PERIOD_CODE;\n    var syear = a[0] + a[1] + a[2] + a[3];\n    var smonth = a[5] + a[6];\n    if (smonth === 'Q1') {\n      smonth= '03';\n    }\n    if (smonth === 'Q2') {\n      smonth= '06';\n    }\n    if (smonth === 'Q3') {\n      smonth= '09';\n    }\n    if (smonth === 'Q4') {\n      smonth= '12';\n    }\n    var sdate = syear + '/' + smonth;\n    var date = new Date(sdate);\n\n    var strYear = date.getFullYear();\n    var strMonth = date.getMonth();\n    var newStrDate;\n    if (strMonth <= 12 || strMonth>=10) {\n       newStrDate = strYear + \"-\" + strMonth ;\n    }\n    if (strMonth < 10 || strMonth>1) {\n       newStrDate = strYear + \"-\" + \"0\"+strMonth ;\n    }\n    if (strMonth===0){\n       newStrDate= strYear-1 +\"-\" + \"12\";\n    }\n   // var newStrDate = strYear + \"-\" + strMonth ;\n    app.period_code.setValue(newStrDate);\n  }\n});"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","labelAlign":"right","itemId":"ledger_id","fieldLabel":"账簿"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"sum_id"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"cash_id"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"cash_code"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"acc_id"},"children":[],"expanded":false,"type":"text"},{"configs":{"hidden":"true","itemId":"acc_code"},"children":[],"expanded":false,"type":"text"}],"expanded":true,"type":"window"},{"configs":{"maximized":"true","title":"导入余额数据","height":"400","minimizable":"true","layout":"border","width":"750","closeAction":"hide","border":"false","itemId":"window1","modal":"true","maximizable":"true","createInstance":"false"},"events":{"close":"app.grid1.getStore().load();"},"children":[{"configs":{"region":"north","height":"100","frame":"false","style":"border-width:0px","layout":"column","itemId":"form1"},"children":[{"configs":{"labelWidth":"80","allowBlank":"false","margin":"25 5 0 50","emptyText":"请选择Excel文件","labelAlign":"left","itemId":"cashFile","fieldLabel":"<font color='red'>*<\/font>选择文件"},"children":[],"expanded":false,"type":"file"},{"configs":{"text":"导入","margin":"25 0 0 10","itemId":"importCashFile","iconCls":"db_import_icon","x":"2"},"events":{"click":"if (!app.form1.getForm().isValid()) {\n  Wb.info(\"请选择要提交的文件\");\n  return false;\n}\nvar fileType = app.cashFile.getValue();\n\nif (!Ext.String.endsWith(fileType, '.xls') && !Ext.String.endsWith(fileType, '.xlsx')) {\n  //判断是否为excel的文档\n  Wb.info('请选择 Office Excel 文档!', function() {\n    app.form1.getForm().reset();\n  });\n} else {\n  var msgProcessBar = Ext.Msg.show({\n    title: '提示',\n    msg: '导入中，请稍后.....',\n    wait: true,\n    width: 200\n  });\n  //将Office Excel数据导入到现金流量项临时表中\n  app.form1.getForm().submit({\n    url: '{#contextPath#}/periodBalanceManageAction.do?method=importCash&ledgerId=' + app.searchText.getValue(),\n    timeout: 3600 * 1000,\n    success: function(form, action) {\n      var returnObj = Wb.decode(action.response.responseText);\n      msgProcessBar.hide();\n      Wb.info(\"数据导入成功！\");\n      app.window1.close();\n    },\n    failure: function(form, action) {\n      var returnObj = Wb.decode(action.response.responseText);\n      msgProcessBar.hide();\n      //文件上传异常 tag：0 数据校验不合法，tag：1 重复数据导入，tag：2\n      if (returnObj.tag === 1){\n        Wb.info(\"导入的Excel数据不合法！\");\n        app.tab1.setActiveTab(1);\n        app.store2.load({params: {ledger_id: app.searchText.getValue(),session_id: returnObj.msg}});\n      }else if (returnObj.tag === 0) {\n        Wb.info(returnObj.msg);\n      }else if (returnObj.tag === 2){\n        Wb.info('数据重复导入！');\n        app.tab1.setActiveTab(0);\n        app.store11.load({params:{ledger_id: app.searchText.getValue(),session_id: returnObj.msg}});\n      }\n    }\n  });\n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"form"},{"configs":{"region":"south","frame":"false","height":"'88%'","itemId":"tab1"},"children":[{"configs":{"title":"重复导入数据","store":"app.store11","itemId":"grid11"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"现金流量项目","align":"center","itemId":"CASH_COL"},"children":[{"configs":{"text":"编码","width":"160","align":"center","dataIndex":"CA_CODE","itemId":"CA_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"名称","width":"250","align":"center","dataIndex":"CA_NAME","itemId":"CA_NAME_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"会计科目","align":"center","itemId":"ACC_COL"},"children":[{"configs":{"text":"编码","width":"160","align":"center","dataIndex":"ACC_CODE","itemId":"ACC_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"名称","width":"250","align":"center","dataIndex":"ACC_NAME","itemId":"ACC_NAME_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"期初余额","width":"250","align":"center","dataIndex":"CA_SUM","itemId":"CA_SUM_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"},{"configs":{"title":"不合法数据列表","store":"app.store2","itemId":"grid2"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"现金流量项目","width":"300","align":"center","itemId":"CASH_COL"},"children":[{"configs":{"text":"编码","width":"160","align":"center","dataIndex":"CA_CODE","itemId":"CA_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"名称","width":"200","align":"center","dataIndex":"CA_NAME","itemId":"CA_NAME_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"会计科目","align":"center","itemId":"ACC_COL"},"children":[{"configs":{"text":"编码","width":"160","align":"center","dataIndex":"ACC_CODE","itemId":"ACC_CODE_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"名称","width":"200","align":"center","dataIndex":"ACC_NAME","itemId":"ACC_NAME_COL"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"column"},{"configs":{"text":"期初余额","width":"120","align":"center","dataIndex":"CA_SUM","itemId":"CA_SUM_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"错误信息","align":"center","width":"300","dataIndex":"MSG","itemId":"MSG_COL","renderer":"return '<font color=\\'red\\'>'+value+'<\/font>';"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"tab"}],"expanded":true,"type":"window"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","border":"false","itemId":"queryForm"},"children":[{"configs":{"tagConfigs":"baseCls :'my-panel-no-border'","layout":"column","padding":"10","border":"false","itemId":"panel1"},"children":[{"configs":{"labelWidth":"80","height":"22","displayField":"LEDGER_NAME","width":"300","valueField":"LEDGER_ID","margin":"8 0  0 0 ","labelAlign":"right","itemId":"searchText","fieldLabel":"账簿名称"},"events":{"change":"ledgerId = newValue;","select":"app.startPeriodCode.setValue(records[0].data.START_PERIOD_CODE);\nvar _ledgerAccount = records[0].data.ESTABLISH_ACCOUNT;\nif(Ext.String.endsWith(records[0].data.START_PERIOD_CODE,'-01')){\n    app.addBtn.setDisabled(true);\n    app.editBtn.setDisabled(true);\n    app.deleteBtn.setDisabled(true);\n    app.accountBtn.setDisabled(true);\n    app.impBtn.setDisabled(true);\n}else{\n  app.accountBtn.setDisabled(false);\n  //判断当前账簿下的期初现金流是否已经处于记账状态\nif(_ledgerAccount === 0){\n  app.addBtn.setDisabled(false);\n  app.editBtn.setDisabled(false);\n  app.deleteBtn.setDisabled(false);\n  app.accountBtn.setText('记账');\n  app.impBtn.setDisabled(false);\n  isCanceled = 'N';\n}else{\n  app.addBtn.setDisabled(true);\n  app.editBtn.setDisabled(true);\n  app.deleteBtn.setDisabled(true);\n  app.accountBtn.setText('取消记账');\n  app.impBtn.setDisabled(true);\n  isCanceled = 'Y';\n}\n}\napp.grid1.store.load() ;\napp.accstore.load({\nparams:{\nledgerId:app.searchText.getValue()\n}\n});"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/b-balances/cash-ba/ld-b-ca-ye/ld-b-ca-yeDB/selectLedger"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"},{"configs":{"itemId":"startPeriodCode"},"children":[],"expanded":false,"type":"hidden"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","pagingBar":"false","selType":"checkboxmodel","itemId":"grid1","editable":"true"},"events":{"itemclick":"if(record.data.IS_LEAF === 'N'){\n  app.editBtn.setDisabled(true);\n}else{\n  app.editBtn.setDisabled(false);\n}","itemdblclick":"app.editBtn.fireEvent('click');"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/gl/b-balances/cash-ba/ld-b-ca-ye/ld-b-ca-yeDB/selectCashSum"},"events":{"beforeload":"store.proxy.extraParams.ledgerId = app.searchText.getValue();"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"增加","itemId":"addBtn","iconCls":"file_add_icon"},"events":{"click":"var ledgerId = app.searchText.getValue();\n// TODO:校验账簿是否已经选择\n if (Ext.isEmpty(ledgerId)) {\n  Wb.info(\"请选择账簿！\");\n  app.searchText.focus() ;\n  return false;\n}\n// TODO: 弹出添加框\nelse{\n  win1=new Ext.window.Window(app._newWin);\n  flag = 'add';\n  win1.setTitle('新增');\n  win1.setIconCls('file_add_icon');\n  win1.show();  \n}\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"修改","itemId":"editBtn","iconCls":"file_edit_icon"},"events":{"click":"var rows = app.grid1.getSelection();\nif(rows.length!==1){\n  Wb.info('请选择一条你要修改的记录！');\n  return false;\n}\n  win1 = new Ext.window.Window(app._newWin);\n  app.period_code.setValue(rows[0].data.PERIOD_CODE);\n  app.ledger_id.setValue(rows[0].data.LEDGER_ID);\n  app.cash_id.setValue(rows[0].data.CA_ID);\n  app.cash_code.setValue(rows[0].data.CA_CODE);\n  app.ca_name_picker.setValue(rows[0].data.CA_NAME);\n  app.acc_id.setValue(rows[0].data.ACC_ID);\n  app.acc_code.setValue(rows[0].data.ACC_CODE);\n  app.acc_name_picker.setValue(rows[0].data.ACC_NAME);\n  app.cash_id.setValue(rows[0].data.CA_ID);\n  app.acc_id.setValue(rows[0].data.ACC_ID);\n  app.ca_sum.setValue(rows[0].data.CA_SUM);\n  app.sum_id.setValue(rows[0].data.SUM_ID);\n  win1.show();\n  win1.setTitle('修改');\n  win1.setIconCls('file_edit_icon');\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"删除","itemId":"deleteBtn","iconCls":"file_delete_icon"},"events":{"click":"// TODO: 获得选中数据\nvar lederId=app.searchText.getValue();\nvar recs = app.grid1.getSelection();\nif (recs.length === 0) {\n\tWb.warn('请选择需要删除的记录!');\n\treturn false ;\n}else{\n  var lineArray = [] ;\n  Wb.each(recs, function(r){\n    var json = {'sumId':r.data.SUM_ID} ;\n    lineArray.push(json) ;\n  }) ;\n  \n  // TODO: 执行删除\n  Wb.confirm('确定要删除选中的记录吗？',function() {\n      Wb.request({\n          url : 'm?xwl=xc/gl/b-balances/cash-ba/ld-b-ca-ye/ld-b-ca-yeDB/delete-sum',\n          params : {'infoArray' : Wb.encode(lineArray)},\n          success: function(resp){\n            var response = Wb.decode(resp.responseText);              \n            if(response.flag === '0'){\n                Wb.info('删除成功!') ;\n              app.grid1.store.load({\n              params:{\n              ledgerId:app.searchText.getValue()\n              }\n              });\n            }else{\n              Wb.info('删除失败!') ;\n            }\n          }\n      });\n  });\n}\n\n"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"记账","itemId":"accountBtn","iconCls":"lock_icon"},"events":{"click":"if (Ext.isEmpty(app.searchText.getValue())) {\n  Wb.info('请先选择账簿！');\n} else {\n  Wb.confirm('确定要'+app.accountBtn.getText(),function(){\n      Wb.request({\n    url: '{#contextPath#}/sumBalanceAction.do?method=createOrCancelCash',\n    message:'请求提交中....',\n    showMask:true,\n    params: {\n      'ledgerId': app.searchText.getValue(),\n      'isCanceled':isCanceled\n    },\n    success: function(response) {\n      var resultObject = Wb.decode(response.responseText);\n      if (resultObject.flag === '0') {\n        Wb.info(resultObject.msg);\n        if (app.funTabPanel) {\n          var funUrl = app.funTabPanel.selectedTab.bindFile;\n          Wb.open({\n            url: funUrl,\n            title: app.funTabPanel.selectedTab.title,\n            reload: true,\n            container: app.funTabPanel.tabPanel\n          });\n        } else {\n          window.location.reload();\n        }\n      } else {\n        Wb.info(resultObject.msg);\n      }\n    }\n  });\n  });\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"导入","itemId":"impBtn","iconCls":"ok_icon"},"events":{"click":"if(Ext.isEmpty(app.searchText.getValue())){\n    Wb.info('请先选择账簿！');\n}else{\n  var win = new Ext.window.Window(app._window1);\n  //清空导入的记录\n  app.store11.removeAll();\n  app.store2.removeAll();\n  win.show();\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"->","itemId":"item1"},"children":[],"expanded":false,"type":"item"},{"configs":{"text":"下载导入模板","itemId":"downModule","iconCls":"down_icon"},"events":{"click":"  if(Ext.isEmpty(app.searchText.getValue())){\n    Wb.info('请先选择账簿！');\n    return false;\n  }else{\n    window.location.href = '{#contextPath#}/periodBalanceManageAction.do?method=downloadCashModel&modelType=cash';\n  }"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"序号","align":"center","width":"50","xtype":"rownumberer","itemId":"rownumber"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"SUM_ID","hidden":"true","dataIndex":"SUM_ID","itemId":"SUM_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"LEDGER_ID","hidden":"true","dataIndex":"LEDGER_ID","itemId":"LEDGER_ID"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"现金流量项目编码","width":"200","dataIndex":"CA_CODE","titleAlign":"center","itemId":"CA_CODE"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"现金流量项目名称","width":"400","dataIndex":"CA_NAME","titleAlign":"center","itemId":"CA_NAME"},"children":[],"expanded":true,"type":"column"},{"configs":{"hidden":"true","dataIndex":"ACC_ID","itemId":"ACC_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"方向","width":"50","align":"center","dataIndex":"CA_DIRECTION","titleAlign":"center","itemId":"CA_DIRECTION","renderer":"if(value === 1){\n  return '流入';\n}\nelse if(value ===0){\n  return '平';\n}\nelse if(value===-1){\n  return '流出';\n}"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"期初余额","width":"200","align":"right","dataIndex":"CA_SUM","format":"0,000.00","titleAlign":"center","itemId":"CA_SUM"},"children":[],"expanded":true,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}