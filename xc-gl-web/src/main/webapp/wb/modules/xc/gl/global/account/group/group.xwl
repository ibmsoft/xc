{"inframe":true,"title":"会计科目组","hidden":false,"roles":{"default":1},"children":[{"configs":{"title":"{#moduleTitle#}","loginRequired":"false","serverScript":"request.setAttribute('contextPath',request.getContextPath());\ncom.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/gl/global/account/group/group\");","itemId":"module"},"children":[{"configs":{"itemId":"windows"},"children":[{"configs":{"maximized":"true","title":"{#importTitle#}","height":"400","minimizable":"true","width":"750","layout":"border","dialog":"false","border":"false","itemId":"importDataWin","modal":"true","maximizable":"true","createInstance":"false"},"events":{"close":"app.searchButton.fireEvent('click');"},"children":[{"configs":{"region":"center","frame":"true","style":"border-width:0px","layout":"column","padding":"15 0 0 5","border":"false","itemId":"importForm"},"children":[{"configs":{"tagConfigs":"columnWidth:.35","labelWidth":"80","allowBlank":"false","emptyText":"{#fileTip#}","labelAlign":"right","itemId":"selectFile","fieldLabel":"{#fileName#}"},"children":[],"expanded":false,"type":"file"},{"configs":{"text":"{#importBtn#}","itemId":"importFile","iconCls":"ok_icon","x":"2"},"events":{"click":"if(!app.importForm.getForm().isValid()){\n  Wb.info('请选择要上传的文件！');\n  return false;\n}\nvar fileType = app.selectFile.getValue();\nif(!Ext.String.endsWith(fileType,'.xls')){\n  Wb.info('请选择以xls结尾的Office Excel文档!',function(){\n    app.importForm.getForm().reset();\n  });\n}else{\n  //导入前，先清除错误数据\n  app.importLogGrid.getStore().removeAll();\n  var msgProcessBar = Ext.Msg.show({\n     title:'提示',\n     msg  :'导入中，请稍后.....',\n     wait :true,\n     width:200\n  });\n  //将Office Excel数据导入到余额临时表中\n  app.importForm.getForm().submit({\n    url:'{#contextPath#}/glDataTransgerManageAction.do?method=importAccountData&templateCode=XC_GL_ACC_GROUP',\n    timeout:3600*1000,\n    success:function(form,action){\n      msgProcessBar.hide();\n      Wb.info(action.result.msg,function(){\n        app.importDataWin.close();\n      });\n    },\n    failure:function(form,action){\n      msgProcessBar.hide();\n      var _flag = action.result.flag;\n      //flag =0,导入时发生异常，输出异常信息\n      if(_flag == '0'){\n        Wb.info(action.result.msg);\n      }else if(_flag == '2'){\n       //flag =2,数据导入临时表成功，数据校验发生异常\n        var _sessionId = action.result.msg;\n        Wb.info('导入数据不合法！');\n        app.importLogGrid.getStore().load({params:{'sessionId':_sessionId}});\n      }\n    }   \n  });\n}"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"form"},{"configs":{"region":"south","height":"'88%'","itemId":"southTab"},"children":[{"configs":{"title":"{#importLogs#}","selType":"checkboxmodel","itemId":"importLogGrid"},"children":[{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"{#incorrectColumn#}","width":"85","dataIndex":"ROW_NUM","itemId":"ROW_NUM","renderer":"return '<font color=\"red\">'+value+'<\/font>';"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#accCode#}","width":"150","dataIndex":"ACC_GROUP_CODE","itemId":"ACC_GROUP_CODE"},"children":[],"expanded":true,"type":"column"},{"configs":{"text":"{#accGroupName#}","width":"200","dataIndex":"ACC_GROUP_NAME","itemId":"ACC_GROUP_NAME"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#accGroupDesc#}","width":"250","dataIndex":"ACC_GROUP_DESC","itemId":"ACC_GROUP_DESC"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#errorInformation#}","width":"300","dataIndex":"ERROR_MSG","itemId":"E_MSG","renderer":"metaData.style = 'overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space: nowrap;white-space:normal;line-height:15px;';   \nreturn '<font color=\"red\">'+value+'<\/font>';","flex":"1"},"children":[],"expanded":false,"type":"column"}],"expanded":true,"type":"array"},{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/global/account/group/groupDB/getInvalidAccGroup"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"tab"}],"expanded":true,"type":"window"}],"expanded":true,"type":"folder"},{"configs":{"layout":"border","itemId":"viewport1"},"children":[{"configs":{"region":"north","itemId":"search_form"},"children":[{"configs":{"tagConfigs":"baseCls : 'my-panel-no-border'","layout":"column","margin":"10 0 10 0","border":"false","itemId":"row1"},"children":[{"configs":{"tagConfigs":"columnWidth : 0.35","labelWidth":"{#labelWidth#}","emptyText":"{#enterTip#}","labelAlign":"right","itemId":"searchText","fieldLabel":"{#codeName#}"},"events":{"change":"if(text.getValue() === ''){\n    app.searchButton.fireEvent('click');\n    app.clearText.hide();\n}\nelse{\n\tapp.clearText.hide();\n}","specialkey":"if(Ext.EventObject.getKey()==13){\n\tapp.searchButton.fireEvent('click');\n}"},"children":[],"expanded":true,"type":"text"},{"configs":{"tagConfigs":"baseCls:'my-panel-no-border'","text":"✘","hidden":"true","itemId":"clearText"},"events":{"click":"app.searchText.reset();"},"children":[],"expanded":false,"type":"button"},{"configs":{"tagConfigs":"columnWidth : 0.08","text":"查询","hidden":"true","margin":"0 0 0 20","itemId":"searchButton","iconCls":"seek_icon","tooltip":"查询(search)"},"events":{"click":"app.group_grid.store.load({params : {ACC_GROUP_INFO : Ext.String.escape(app.searchText.getValue())}});//查询（重新加载数据）\n/*app.group_grid.store.load({\n  out: app.search_form,\n  mask: app.search_form //mask遮盖对象，未指定默认为全屏，前1.5秒透明遮盖。\n});*/"},"children":[],"expanded":false,"type":"button"},{"configs":{"tagConfigs":"columnWidth : 0.08","text":"重置","height":"22","hidden":"true","margin":"0 0 0 20","itemId":"resetButton","iconCls":"refresh_icon","tooltip":"重置(reset)"},"events":{"click":"app.search_form.getForm().reset();\napp.searchButton.fireEvent('click');"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"form"},{"configs":{"region":"center","multiSelect":"true","selType":"checkboxmodel","rowNumber":"false","border":"false","itemId":"group_grid","editable":"true"},"children":[{"configs":{"autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/global/account/group/groupDB/groupSelect"},"children":[],"expanded":false,"type":"store"},{"configs":{"itemId":"tbar"},"children":[{"configs":{"text":"{#addBtn#}","itemId":"addButton","iconCls":"file_add_icon"},"events":{"click":"var total = app.group_grid.store.getCount();//获得store中的个数\nvar rec = app.group_grid.getSelection();//获得选中数据\nvar row = app.group_grid.store.indexOf(rec[0]);//获得选中行号\nvar e = app.group_grid.plugins[0];\ne.completeEdit();\nif(row >= 0){\n\tapp.group_grid.store.insert(row,{ORDERBY:row+1});//插入选中行的上一行\n    e.startEditByPosition({row:row,column:2});//开始编辑\n}\nelse{\n    app.group_grid.store.insert(total,{ORDERBY:total+1});//\n    e.startEditByPosition({row:total,column:2});//开始编辑\n\t//Wb.addEdit(app.group_grid,[{ORDERBY:total+1}]);//新增编号\n}"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#delBtn#}","itemId":"deleteButton","iconCls":"file_delete_icon"},"events":{"click":"var recs = app.group_grid.getSelection();//获得选中数据\nif (!recs.length) {//选中的数据条数\n\tWb.toast('请选择需要删除的记录。');\n\treturn;\n}\nWb.confirm('确定要删除选择的' + recs.length + '条记录吗？',function() {\n    Wb.request({\n        url : 'm?xwl=xc/gl/global/account/group/groupDB/groupDelete',//判断是否有会计科目数据\n        params : {'infoArray' : Wb.encode(Wb.getData(recs))},//传参\n        success: function(resp){\n            Wb.toast(recs.length+'条科目组删除成功');\n            Wb.remove(app.group_grid);//直接从表格中删除\n            app.searchButton.fireEvent('click');\n        }\n    });\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#saveBtn#}","itemId":"saveButton","iconCls":"save_icon"},"events":{"click":"var rec = app.group_grid.getSelection();//选择一行信息\n// var row = app.group_grid.store.indexOf(rec[0]);//获得选中行号\nvar modify = app.group_grid.store.getModifiedRecords();\nif(modify === '' || modify.length === 0){\n    Wb.toast('没有数据需要保存！');\n\treturn;\n}\nif(!Wb.verifyGrid(app.group_grid))//验证数据是否合法\n\treturn;\nWb.sync({\n    grid : app.group_grid,\n    url : 'm?xwl=xc/gl/global/account/group/groupDB/groupUpdate',\n    message : '正在保存中...',\n    success : function(resp) {\n        Wb.toast('数据保存成功！');\n\t\tapp.searchButton.fireEvent('click');\n    }\n});"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#importBtn#}","itemId":"importButton","iconCls":"import_icon"},"events":{"click":"var win = new Ext.window.Window(app._importDataWin);\nwin.show();"},"children":[],"expanded":false,"type":"button"},{"configs":{"text":"{#exprotBtn#}","itemId":"exportButton","iconCls":"export_icon"},"events":{"click":"window.location.href = '{#contextPath#}/glDataTransgerManageAction.do?method=exportBaseDataByModel&templateCode=XC_GL_ACC_GROUP';"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"toolbar"},{"configs":{"itemId":"columns"},"children":[{"configs":{"text":"ID","hidden":"true","dataIndex":"ACC_GROUP_ID","titleAlign":"center","itemId":"ACC_GROUP_ID_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#rownum#}","align":"center","width":"50","dataIndex":"ORDERBY","titleAlign":"center","itemId":"ORDERBY_COL"},"children":[],"expanded":false,"type":"column"},{"configs":{"text":"{#accCode#}","width":"150","dataIndex":"ACC_GROUP_CODE","titleAlign":"center","itemId":"ACC_GROUP_CODE_COL"},"children":[{"configs":{"allowBlank":"false","vtype":"alphanum","itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"column"},{"configs":{"text":"{#accGroupName#}","width":"200","dataIndex":"ACC_GROUP_NAME","titleAlign":"center","itemId":"ACC_GROUP_NAME_COL"},"children":[{"configs":{"allowBlank":"false","itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"column"},{"configs":{"text":"{#accGroupDesc#}","width":"300","dataIndex":"ACC_GROUP_DESC","titleAlign":"center","itemId":"ACC_GROUP_DESC_COL"},"children":[{"configs":{"itemId":"editor"},"children":[],"expanded":false,"type":"text"}],"expanded":false,"type":"column"}],"expanded":true,"type":"array"}],"expanded":true,"type":"grid"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}