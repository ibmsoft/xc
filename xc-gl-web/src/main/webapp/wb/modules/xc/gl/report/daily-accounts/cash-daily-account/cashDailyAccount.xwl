{"inframe":false,"title":"现金日记账","hidden":false,"roles":{"default":1},"children":[{"configs":{"title":"{#dailyTitle#}","serverScript":"com.xzsoft.xip.platform.util.XipUtil.getCurrentLang(request,\"xc/gl/report/daily-accounts/cash-daily-account/cashDailyAccount\");\n//现金日记账与银行日记账共用一个功能界面，通过配置不同参数来区分\nvar isCashDaily = request.getParameter(\"isCashDaily\");\nif(isCashDaily === null || \"\".equals(isCashDaily)){\n  isCashDaily = 'Y';\n}\nif(isCashDaily == 'Y'){\n  request.setAttribute('dailyTitle','现金日记账');\n}else{\n  request.setAttribute('dailyTitle','银行日记账');\n}\nrequest.setAttribute('contextPath',request.getContextPath());\nrequest.setAttribute('isCash',isCashDaily);\nvar sessionVars = request.getSession().getAttribute(com.xzsoft.xip.framework.common.SessionVariable.XZ_SESSION_VARS);\nvar la_system_language = sessionVars.get(com.xzsoft.xip.framework.common.SessionVariable.language);\nrequest.setAttribute('la_system_language',la_system_language);","itemId":"module"},"children":[{"configs":{"layout":"border","itemId":"viewport"},"events":{"afterrender":"app.ledgerId.getStore().load(function(records, operation, success){\n  if(records.length == 1){\n    app.ledgerId.setValue(records[0].data.CODE);\n    app.orgName.setValue(records[0].data.ORG_NAME);\n    app.currencyName.setValue(records[0].data.CURRENCY_NAME);\n    app.currencyCode.setValue(records[0].data.CURRENCY_CODE);\n    app.defaultCurrencyCode.setValue(records[0].data.CURRENCY_CODE);\n    app.orgId.setValue(records[0].data.ORG_ID);\n  }\n});\n//设置默认会计期间\nvar _currentDate = new Date();\nvar _defaultPeriodCode = Ext.Date.format(_currentDate,'Y-m');\napp.startPeriodCode.setValue(_defaultPeriodCode);\napp.startPeriodCode.setRawValue(_defaultPeriodCode);\napp.endPeriodCode.setValue(_defaultPeriodCode);\napp.endPeriodCode.setRawValue(_defaultPeriodCode);"},"children":[{"configs":{"region":"north","frame":"true","style":"border-width:0px","itemId":"queryForm","border":"false"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n\n}","layout":"column","itemId":"tr1","border":"false"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".20","itemId":"td1"},"children":[{"configs":{"labelWidth":"90","displayField":"NAME","valueField":"CODE","labelAlign":"right","itemId":"ledgerId","fieldLabel":"{#la_ledgerLabel#}"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}","select":"app.orgName.setValue(records[0].data.ORG_NAME);\napp.currencyName.setValue(records[0].data.CURRENCY_NAME);\napp.currencyCode.setValue(records[0].data.CURRENCY_CODE);\napp.defaultCurrencyCode.setValue(records[0].data.CURRENCY_CODE);\napp.orgId.setValue(records[0].data.ORG_ID);\napp.ledgerFormat.setValue('0');\napp.startPeriodCode.clearValue();\napp.endPeriodCode.clearValue();\napp.startAccCode.clearValue();\napp.endAccCode.clearValue();"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/gl/report/daily-accounts/cash-daily-account/data/getAllLedger"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".20","itemId":"td4"},"children":[{"configs":{"labelWidth":"{#la_labelWidth#}","displayField":"NAME","value":"CNY","valueField":"CODE","labelAlign":"right","itemId":"currencyCode","fieldLabel":"{#la_currency#}"},"events":{"select":"app.ledgerFormat.setValue('0');\n","beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","autoLoad":"true","itemId":"store","url":"m?xwl=xc/gl/report/daily-accounts/cash-daily-account/data/getCurrency"},"children":[],"expanded":false,"type":"store"}],"expanded":false,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"fit","columnWidth":".38","itemId":"td3"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"column","itemId":"td3.1"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".54","itemId":"td3.3.1"},"children":[{"configs":{"labelWidth":"{#la_labelWidth#}","displayField":"PERIOD_CODE","valueField":"PERIOD_CODE","labelAlign":"right","itemId":"startPeriodCode","fieldLabel":"{#la_startPeriod#}"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/gl/report/daily-accounts/cash-daily-account/data/getLedgerPeriod"},"events":{"beforeload":"if(!Ext.isEmpty(app.ledgerId.getValue())){\n  store.getProxy().extraParams.ledgerId = app.ledgerId.getValue();\n}else{\n  return ;\n}"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".04","itemId":"td3.3.2"},"children":[{"configs":{"text":"--","labelAlign":"center","itemId":"rangeFlag"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".38","itemId":"td3.3.3"},"children":[{"configs":{"displayField":"PERIOD_CODE","valueField":"PERIOD_CODE","labelAlign":"right","itemId":"endPeriodCode"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/gl/report/daily-accounts/cash-daily-account/data/getLedgerPeriod"},"events":{"beforeload":"if(!Ext.isEmpty(app.ledgerId.getValue())){\n  store.getProxy().extraParams.ledgerId = app.ledgerId.getValue();\n}else{\n  return ;\n}"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n\n}","layout":"column","itemId":"tr2","border":"false"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".20","itemId":"td1"},"children":[{"configs":{"labelWidth":"90","value":"0","pickList":"[['0','{#la_all#}'],['Y','{#la_y#}'],['N','{#la_x#}']]","labelAlign":"right","itemId":"isCasher","fieldLabel":"{#la_isSign#}"},"children":[],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".20","itemId":"td4"},"children":[{"configs":{"labelWidth":"{#la_labelWidth#}","value":"0","pickList":"[['1','{#la_x#}'],['0','{#la_y#}']]","labelAlign":"right","itemId":"isAccount","fieldLabel":"{#la_container#}"},"children":[],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"fit","columnWidth":".38","itemId":"td2"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"column","itemId":"td2.1"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".54","itemId":"td2.3.1"},"children":[{"configs":{"labelWidth":"{#la_labelWidth#}","displayField":"ACC_NAME","valueField":"ACC_CODE","labelAlign":"right","itemId":"startAccCode","fieldLabel":"{#la_account#}"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/gl/report/daily-accounts/cash-daily-account/data/getLedgerAccount"},"events":{"beforeload":"if(!Ext.isEmpty(app.ledgerId.getValue())){\n  store.getProxy().extraParams.ledgerId = app.ledgerId.getValue();\n  store.getProxy().extraParams.cashDaily = '{#isCash#}';  \n}else{\n  return ;\n}"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".04","itemId":"td2.3.2"},"children":[{"configs":{"text":"--","labelAlign":"center","itemId":"rangeFlag"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".38","itemId":"td2.3.3"},"children":[{"configs":{"displayField":"ACC_NAME","valueField":"ACC_CODE","labelAlign":"right","itemId":"endAccCode"},"events":{"beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}"},"children":[{"configs":{"pageSize":"-1","itemId":"store","url":"m?xwl=xc/gl/report/daily-accounts/cash-daily-account/data/getLedgerAccount"},"events":{"beforeload":"if(!Ext.isEmpty(app.ledgerId.getValue())){\n  store.getProxy().extraParams.ledgerId = app.ledgerId.getValue();\n}else{\n  return ;\n}"},"children":[],"expanded":false,"type":"store"}],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n\n}","layout":"column","itemId":"tr3","border":"false"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".20","itemId":"td3.1"},"children":[{"configs":{"labelWidth":"90","value":"0","pickList":"[['0','{#la_cashWay#}'],['1','{#la_foreign#}'],['2','{#la_amount#}']]","labelAlign":"right","itemId":"ledgerFormat","fieldLabel":"{#la_ledgerFormat#}"},"events":{"change":"if(app.currencyCode.getValue() == app.defaultCurrencyCode.getValue()){\n  if(newValue == '1' || newValue == '3'){\n    combo.setValue(oldValue);\n  }\n}","beforequery":"var combo = plan.combo;\nif (!plan.forceAll) {\n  var value = plan.query;\n  combo.store.filterBy(function(record, id) {\n    var text = record.get(combo.displayField);\n    return (text.indexOf(value) != -1);\n  });\n  combo.expand();\n  return false;\n}","select":"app.oriCurrencyCode.setValue(records[0].data.CURRENCY_CODE);\napp.orgName.setValue(records[0].data.ORG_NAME);\napp.currencyName.setValue(records[0].data.CURRENCY_NAME);"},"children":[],"expanded":true,"type":"combo"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".20","itemId":"td3.3"},"children":[{"configs":{"labelAlign":"center","itemId":"rangeFlag"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"fit","columnWidth":".38","itemId":"td3.2"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"column","itemId":"td2.1"},"children":[{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".54","itemId":"td2.3.1"},"children":[{"configs":{"labelAlign":"center","itemId":"rangeFlag"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".04","itemId":"td2.3.2"},"children":[{"configs":{"labelAlign":"center","itemId":"rangeFlag"},"children":[],"expanded":false,"type":"label"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".19","itemId":"td2.3.3"},"children":[{"configs":{"text":"{#la_queryBtn#}","width":"70","itemId":"queryBtn","iconCls":"seek_icon"},"events":{"click":"if(Ext.isEmpty(app.ledgerId.getValue())){\n  Wb.info('{#la_selectLedger#}');\n  return ;\n}\nif(Ext.isEmpty(app.startPeriodCode.getValue()) || Ext.isEmpty(app.endPeriodCode.getValue())){\n  Wb.info('{#la_selectPeriod#}');\n  return ;\n}\nvar map = new Ext.util.HashMap();\nmap.add('language','{#la_system_language#}');\nmap.add('LEDGER_ID',app.ledgerId.getValue());\nmap.add('START_PERIOD_DATE',app.startPeriodCode.getValue());\nmap.add('END_PERIOD_DATE',app.endPeriodCode.getValue());\n\nmap.add('CURRENCY_CODE',app.currencyCode.getValue());\nmap.add('ORG_NAME',app.orgName.getValue());\nmap.add('IS_CASH','{#isCash#}');\nmap.add('IS_CASHER',app.isCasher.getValue());\nmap.add('orgId',app.orgId.getValue());\nif(Ext.isEmpty(app.startAccCode.getValue())){\n  map.add('START_ACCOUNT','0');\n}else{\n  map.add('START_ACCOUNT',app.startAccCode.getValue());\n}\nif(Ext.isEmpty(app.endAccCode.getValue())){\n  map.add('END_ACCOUNT','0');\n}else{\n  map.add('END_ACCOUNT',app.endAccCode.getValue());\n}\nvar selRecord = app.ledgerId.findRecord('CODE',app.ledgerId.getValue());\nmap.add('DEFAULT_CURRENCY',selRecord.data.CURRENCY_CODE);\nmap.add('isFirst','N');\nvar params = '';\nmap.each(function(key, value, length){\n  params +='&'+key+'='+value;\n});\nvar targetUrl = '{#contextPath#}/ReportServer?reportlet=xc_daily_account/daily_account_cash.cpt&__bypagesize__=false';\nvar reportFrame = document.getElementById('cashBankReport');\nif('0'==app.ledgerFormat.getValue()){\n  if('1' == app.isAccount.getValue()){\n    targetUrl = '{#contextPath#}/ReportServer?reportlet=xc_daily_account/daily_account_cash_t.cpt&__bypagesize__=false';\n  }\n}else if('1'==app.ledgerFormat.getValue()){\n  targetUrl = '{#contextPath#}/ReportServer?reportlet=xc_daily_account/daily_account_foreign.cpt&__bypagesize__=false';\n  if('1' == app.isAccount.getValue()){\n    targetUrl = '{#contextPath#}/ReportServer?reportlet=xc_daily_account/daily_account_foreign_t.cpt&__bypagesize__=false';\n  }\n}else{\n  //数量金额式\n  targetUrl = '{#contextPath#}/ReportServer?reportlet=xc_daily_account/daily_account_amount.cpt&__bypagesize__=false';\n  if('1' == app.isAccount.getValue()){\n    targetUrl = '{#contextPath#}/ReportServer?reportlet=xc_daily_account/daily_account_amount_t.cpt&__bypagesize__=false';\n  }\n} \nparams = targetUrl+params;\nreportFrame.src = params;\n\n\n\n\n\n\n\n"},"children":[],"expanded":true,"type":"button"}],"expanded":true,"type":"panel"},{"configs":{"tagConfigs":"{\n  baseCls:'my-panel-no-border'\n}","layout":"form","columnWidth":".19","itemId":"td2.3.4"},"children":[{"configs":{"text":"{#la_resetBtn#}","width":"70","itemId":"resetBtn","iconCls":"refresh_icon"},"events":{"click":"app.queryForm.getForm().reset();\n\n\n\n\n\n\n\n\n"},"children":[],"expanded":false,"type":"button"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"}],"expanded":true,"type":"panel"},{"configs":{"itemId":"defaultCurrencyCode"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"itemId":"orgName"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"itemId":"orgId"},"children":[],"expanded":false,"type":"hidden"},{"configs":{"itemId":"currencyName"},"children":[],"expanded":true,"type":"hidden"}],"expanded":true,"type":"form"},{"configs":{"region":"center","layout":"fit","html":" <iframe  scrolling=no frameborder=0 width=100% height=100% id=cashBankReport src='{#contextPath#}/ReportServer?reportlet=xc_daily_account/daily_account_cash.cpt&language={#la_system_language#}&IS_CASH={#isCash#}&__bypagesize__=false'><\/iframe>\n","itemId":"reportPanel"},"children":[],"expanded":false,"type":"panel"}],"expanded":true,"type":"viewport"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}