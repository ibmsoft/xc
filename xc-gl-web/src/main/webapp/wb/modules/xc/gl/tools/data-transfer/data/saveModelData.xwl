{"inframe":false,"title":"保存模板数据","hidden":true,"roles":{"dev":1},"children":[{"configs":{"serverScript":"var subRows = Wb.decode(request.getParameter('operateData'));\nvar mainRow = Wb.decode(request.getParameter('mainData'));\nvar primaryKey = java.util.UUID.randomUUID().toString();\nvar mainRows = [];\nWb.apply(mainRow,{TEMPLATE_ID:primaryKey});\nmainRows.push(mainRow);\nvar createRows = subRows.create;\nWb.each(createRows, function(rec) {\n  var subKey = java.util.UUID.randomUUID().toString();\n  Wb.apply(rec, {\n    TEMPLATE_ID: primaryKey,\n    TEMPLATE_DTL_ID: subKey\n  });\n});\nrequest.setAttribute('mainRow', Wb.encode(mainRows));\nrequest.setAttribute('subRows', Wb.encode(createRows));\n","itemId":"module"},"children":[{"configs":{"sql":"insert into xc_gl_template(\n  TEMPLATE_ID,     \n  TEMPLATE_CODE,\n  APP_ID,\n  TEMPLATE_NAME,   \n  TEMPLATE_DESC,   \n  CREATION_DATE,   \n  CREATED_BY,      \n  LAST_UPDATE_DATE,\n  LAST_UPDATED_BY \n)values(\n {?TEMPLATE_ID?},\n {?TEMPLATE_CODE?},\n {?APP_ID?},\n {?TEMPLATE_NAME?},\n {?TEMPLATE_DESC?},\n {?timestamp.sys.date?},\n {?XIP.userId?},\n {?timestamp.sys.date?},\n {?XIP.userId?}\n)","transaction":"start","arrayName":"mainRow","itemId":"insertMainTable"},"children":[],"expanded":false,"type":"query"},{"configs":{"sql":"insert into xc_gl_template_dtl(\n TEMPLATE_DTL_ID, \n TEMPLATE_ID,     \n COL_CODE,        \n COL_NAME,        \n COL_ALIAS,       \n COL_TYPE,\n COL_SEQ,\n CREATION_DATE,   \n CREATED_BY,      \n LAST_UPDATE_DATE,\n LAST_UPDATED_BY \n)values(\n {?TEMPLATE_DTL_ID?},\n {?TEMPLATE_ID?},\n {?COL_CODE?},\n {?COL_NAME?},\n {?COL_ALIAS?},\n {?COL_TYPE?},\n {?Integer.COL_SEQ?},\n {?timestamp.sys.date?},\n {?XIP.userId?},\n {?timestamp.sys.date?},\n {?XIP.userId?}\n)","arrayName":"subRows","itemId":"insertSubTable"},"children":[],"expanded":false,"type":"query"}],"expanded":true,"type":"module"}],"pageLink":"","iconCls":""}